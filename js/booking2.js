function checkCancellationPolicyHours(e,s,t){var a=new Date,i=a.getTime(),o=a.getTimezoneOffset(),n=60*parseInt(o)*1e3,r=i+n,l="";l=e;var c=r+l,d="",m=t,p=0;if(p=s.getTime(),p<=c)return d="past";if(null==m||""==m||"Anytime"==m)d="yes";else if(parseInt(m)>0){var u=60*parseInt(m)*60*1e3,h=c+u;p>h&&(d="yes")}else"Never"==m&&(d="no");return d}function sendMessage(e,s){try{if(!e)return e="No message is entered",void console.log("There is no message");message.model=$.extend({},e),message.model.Comments=encodeURIComponent(message.model.Comments),message.type="paypalpayment",message.from=channels.clientID;var t=encodeURIComponent(JSON.stringify(message));message.page=window.location.href,$.ajax({type:"POST",url:"/sendMessage",data:"AccountID="+channels.clientID+"&message="+t,success:function(e){console.log(e)}})}catch(a){console.log(a.message)}}function countryValue(e,s){var t="",a=countryObject.getIntlCountryData(s,!0,!0,"iso2");if(!isNullOrEmpty(a))for(var i=0;i<a.length;i++)e.toLowerCase()===a[i]&&(t=a[i]);var o=isNullOrEmpty(a)?"":"ca"===a[0]?"us":a[0];return isNullOrEmpty(t)?o:t}function createCountryCodeDropdown(e,s,t){var a=isNullOrEmpty(app.CompanyModel.get("Country"))?"":app.CompanyModel.get("Country");isNullOrEmpty(a)&&(a=countryValue(a,app.CompanyModel.get("countryCode"))),isNullOrEmpty(a)?a=countryInitial&&"null"!=countryInitial&&"ZZ"!=countryInitial?countryInitial:"US":3==a.length&&(a=countryObject.getIntlCountryData(a.toLowerCase(),!0,!0,"iso3").iso2),a=a.toLowerCase(),isNullOrEmpty(a)&&$.get("https://ipinfo.io",function(){},"jsonp").always(function(e){a=e.country,a=e&&e.country?e.country:"US",t=t?t:a,console.log(a)}),a&&e.$el.find(s).intlTelInput({initialCountry:t,autoHideDialCode:!0,preferredCountries:new Array(a),separateDialCode:!0,geoIpLookup:function(e){e(a)}})}function setValueInfeilds(e,s){var t=app.CompanyModel.get("Country");t=isNullOrEmpty(t)||3!=t.length?countryInitial&&"null"!=countryInitial&&"ZZ"!=countryInitial?countryInitial:"US":countryObject.getIntlCountryData(t.toLowerCase(),!0,!0,"iso3").iso2;var a=t.toLowerCase();if("#MobileNo"==s)if(e.collection.selected)a=isNullOrEmpty(e.collection.selected.get("Country"))?"":countryObject.getIntlCountryData(e.collection.selected.get("Country").toLowerCase(),!0,!0,"iso3").iso2,a=isNullOrEmpty(a)?countryValue(t,e.collection.selected.get("countryCode")):a,i=formatPhoneNumber(e.collection.selected.get("countryCode"),e.collection.selected.get("MobileNo"),a),e.$el.find(s).val(e.collection.selected.get("countryCode")+i);else if(e.collection.models[0]){var i=formatPhoneNumber(e.collection.models[0].get("countryCode"),e.collection.models[0].get("MobileNo"),a);e.$el.find(s).val(e.collection.models[0].get("countryCode")+i)}else e.$el.find(s).val("+1");else if("#apptCust-MobileNo"==s){var o=e.appointmentModel.get("customer");a=o.isNewCustomerTemp?isNullOrEmpty(o.Country)?a:countryObject.getIntlCountryData(o.Country.toLowerCase(),!0,!0,"iso3").iso2:isNullOrEmpty(o.Country)?"":countryObject.getIntlCountryData(o.Country.toLowerCase(),!0,!0,"iso3").iso2,a=isNullOrEmpty(a)?countryValue(t,o.countryCode):a,e.$el.find(s).val(o.countryCode+o.MobileNo)}else if("#classCust-MobileNo"==s){var o=e.selectedCustomer;a=isNullOrEmpty(o.get("FirstName"))?isNullOrEmpty(o.get("Country"))?a:countryObject.getIntlCountryData(o.get("Country").toLowerCase(),!0,!0,"iso3").iso2:isNullOrEmpty(o.get("Country"))?"":countryObject.getIntlCountryData(o.get("Country").toLowerCase(),!0,!0,"iso3").iso2,a=isNullOrEmpty(a)?countryValue(t,e.selectedCustomer.get("countryCode")):a,e.$el.find(s).val(e.selectedCustomer.get("countryCode")+e.selectedCustomer.get("MobileNo"))}else"#staff_OfficeNumber"==s?e.$el.find(s).val().contains("+")?e.$el.find(s).val(app.StaffListView.selected.get("OfficeNumber")):e.$el.find(s).val(app.StaffListView.selected.get("countryCode")+app.StaffListView.selected.get("OfficeNumber")):"#companyDetails_OfficeNumber_phone"!=s&&"#setup-phoneNo"!=s||("#companyDetails_OfficeNumber_phone"==s&&(a=isNullOrEmpty(app.CompanyModel.get("Country"))?"":countryObject.getIntlCountryData(app.CompanyModel.get("Country").toLowerCase(),!0,!0,"iso3").iso2,a=isNullOrEmpty(a)?countryValue(t,app.CompanyModel.get("countryCode")):a),isNullOrEmpty(app.CompanyModel.get("countryCode"))?e.$el.find(s).val(app.CompanyModel.get("OfficeNumber")):!isNullOrEmpty(app.CompanyModel.get("OfficeNumber"))&&app.CompanyModel.get("OfficeNumber").contains("+")?e.$el.find(s).val(app.CompanyModel.get("OfficeNumber")):isNullOrEmpty(app.CompanyModel.get("OfficeNumber"))||isNullOrEmpty(app.CompanyModel.get("countryCode"))?isNullOrEmpty(app.CompanyModel.get("OfficeNumber"))?isNullOrEmpty(app.CompanyModel.get("countryCode"))||e.$el.find(s).val(app.CompanyModel.get("countryCode")):e.$el.find(s).val(app.CompanyModel.get("OfficeNumber")):e.$el.find(s).val(app.CompanyModel.get("countryCode")+app.CompanyModel.get("OfficeNumber")),e.$el.find(s).val().contains("Ext")&&e.$el.find(s).val(app.CompanyModel.get("countryCode")+app.CompanyModel.get("OfficeNumber").split("Ext")[0]));return a}function validatePhoneNumAndCountryCode(e,s){var t="",a="",i=$(s).val();return"#MobileNo"==s?a="+"+$("#customerDetailFormList #MobileNo").intlTelInput("getSelectedCountryData").dialCode:(a=$(".selected-flag").attr("title")?$(".selected-flag").attr("title").split(" "):"",isNullOrEmpty(a)||(a=a[a.length-1])),i.contains(a)&&(i=i.replace(a,"")),"0"===i.charAt(0)&&(i=i.replace("0","")),i=$(s).val(i.replace(/[^0-9]/g,"")),"#MobileNo"==s||".appt-customerlist-mobile"==s||".class-customerlist-mobile"==s||"#customerNewMobile"==s?i.val():(t=i.val(),$(s).val(),t)}var date_ex=clientDate;console.log("clientDate ::"+clientDate);var m=date_ex.getMonth(),d=date_ex.getDate(),y=date_ex.getFullYear(),blockedOutDates=[],restricted_Dates=[],restrictedDatesInRed=[],restricted_Month=[],unblockedDates=[];!function(e){var s=function(){var s={years:"datepickerViewYears",moths:"datepickerViewMonths",days:"datepickerViewDays"},t={wrapper:'<div class="datepicker"><div class="datepickerContainer"><table cellspacing="0" cellpadding="0"><tbody><tr></tr></tbody></table></div></div>',head:["<td>",'<table cellspacing="0" cellpadding="0">',"<thead>",'<tr class="month_header">','<th class="datepickerGoPrev"><a href="#"><span><%=prev%></span></a></th>','<th colspan="5" class="datepickerMonth"><a href="#"><span></span></a></th>','<th class="datepickerGoNext"><a href="#"><span><%=next%></span></a></th>',"</tr>",'<tr class="datepickerDoW">',"<th><span><%=day1%></span></th>","<th><span><%=day2%></span></th>","<th><span><%=day3%></span></th>","<th><span><%=day4%></span></th>","<th><span><%=day5%></span></th>","<th><span><%=day6%></span></th>","<th><span><%=day7%></span></th>","</tr>","</thead>","</table></td>"],space:'<td class="datepickerSpace"><div></div></td>',days:['<tbody class="datepickerDays skiptranslate">',"<tr>",'<td class="<%=weeks[0].days[0].classname%>"><a href="#"><span><%=weeks[0].days[0].text%></span></a></td>','<td class="<%=weeks[0].days[1].classname%>"><a href="#"><span><%=weeks[0].days[1].text%></span></a></td>','<td class="<%=weeks[0].days[2].classname%>"><a href="#"><span><%=weeks[0].days[2].text%></span></a></td>','<td class="<%=weeks[0].days[3].classname%>"><a href="#"><span><%=weeks[0].days[3].text%></span></a></td>','<td class="<%=weeks[0].days[4].classname%>"><a href="#"><span><%=weeks[0].days[4].text%></span></a></td>','<td class="<%=weeks[0].days[5].classname%>"><a href="#"><span><%=weeks[0].days[5].text%></span></a></td>','<td class="<%=weeks[0].days[6].classname%>"><a href="#"><span><%=weeks[0].days[6].text%></span></a></td>',"</tr>","<tr>",'<td class="<%=weeks[1].days[0].classname%>"><a href="#"><span><%=weeks[1].days[0].text%></span></a></td>','<td class="<%=weeks[1].days[1].classname%>"><a href="#"><span><%=weeks[1].days[1].text%></span></a></td>','<td class="<%=weeks[1].days[2].classname%>"><a href="#"><span><%=weeks[1].days[2].text%></span></a></td>','<td class="<%=weeks[1].days[3].classname%>"><a href="#"><span><%=weeks[1].days[3].text%></span></a></td>','<td class="<%=weeks[1].days[4].classname%>"><a href="#"><span><%=weeks[1].days[4].text%></span></a></td>','<td class="<%=weeks[1].days[5].classname%>"><a href="#"><span><%=weeks[1].days[5].text%></span></a></td>','<td class="<%=weeks[1].days[6].classname%>"><a href="#"><span><%=weeks[1].days[6].text%></span></a></td>',"</tr>","<tr>",'<td class="<%=weeks[2].days[0].classname%>"><a href="#"><span><%=weeks[2].days[0].text%></span></a></td>','<td class="<%=weeks[2].days[1].classname%>"><a href="#"><span><%=weeks[2].days[1].text%></span></a></td>','<td class="<%=weeks[2].days[2].classname%>"><a href="#"><span><%=weeks[2].days[2].text%></span></a></td>','<td class="<%=weeks[2].days[3].classname%>"><a href="#"><span><%=weeks[2].days[3].text%></span></a></td>','<td class="<%=weeks[2].days[4].classname%>"><a href="#"><span><%=weeks[2].days[4].text%></span></a></td>','<td class="<%=weeks[2].days[5].classname%>"><a href="#"><span><%=weeks[2].days[5].text%></span></a></td>','<td class="<%=weeks[2].days[6].classname%>"><a href="#"><span><%=weeks[2].days[6].text%></span></a></td>',"</tr>","<tr>",'<td class="<%=weeks[3].days[0].classname%>"><a href="#"><span><%=weeks[3].days[0].text%></span></a></td>','<td class="<%=weeks[3].days[1].classname%>"><a href="#"><span><%=weeks[3].days[1].text%></span></a></td>','<td class="<%=weeks[3].days[2].classname%>"><a href="#"><span><%=weeks[3].days[2].text%></span></a></td>','<td class="<%=weeks[3].days[3].classname%>"><a href="#"><span><%=weeks[3].days[3].text%></span></a></td>','<td class="<%=weeks[3].days[4].classname%>"><a href="#"><span><%=weeks[3].days[4].text%></span></a></td>','<td class="<%=weeks[3].days[5].classname%>"><a href="#"><span><%=weeks[3].days[5].text%></span></a></td>','<td class="<%=weeks[3].days[6].classname%>"><a href="#"><span><%=weeks[3].days[6].text%></span></a></td>',"</tr>","<tr>",'<td class="<%=weeks[4].days[0].classname%>"><a href="#"><span><%=weeks[4].days[0].text%></span></a></td>','<td class="<%=weeks[4].days[1].classname%>"><a href="#"><span><%=weeks[4].days[1].text%></span></a></td>','<td class="<%=weeks[4].days[2].classname%>"><a href="#"><span><%=weeks[4].days[2].text%></span></a></td>','<td class="<%=weeks[4].days[3].classname%>"><a href="#"><span><%=weeks[4].days[3].text%></span></a></td>','<td class="<%=weeks[4].days[4].classname%>"><a href="#"><span><%=weeks[4].days[4].text%></span></a></td>','<td class="<%=weeks[4].days[5].classname%>"><a href="#"><span><%=weeks[4].days[5].text%></span></a></td>','<td class="<%=weeks[4].days[6].classname%>"><a href="#"><span><%=weeks[4].days[6].text%></span></a></td>',"</tr>",'<tr class="dateNotInMonth">','<td class="<%=weeks[5].days[0].classname%>"><a href="#"><span><%=weeks[5].days[0].text%></span></a></td>','<td class="<%=weeks[5].days[1].classname%>"><a href="#"><span><%=weeks[5].days[1].text%></span></a></td>','<td class="<%=weeks[5].days[2].classname%>"><a href="#"><span><%=weeks[5].days[2].text%></span></a></td>','<td class="<%=weeks[5].days[3].classname%>"><a href="#"><span><%=weeks[5].days[3].text%></span></a></td>','<td class="<%=weeks[5].days[4].classname%>"><a href="#"><span><%=weeks[5].days[4].text%></span></a></td>','<td class="<%=weeks[5].days[5].classname%>"><a href="#"><span><%=weeks[5].days[5].text%></span></a></td>','<td class="<%=weeks[5].days[6].classname%>"><a href="#"><span><%=weeks[5].days[6].text%></span></a></td>',"</tr>","</tbody>"],months:['<tbody class="<%=className%>">',"<tr>",'<td colspan="2"><a href="#"><span><%=data[0]%></span></a></td>','<td colspan="2"><a href="#"><span><%=data[1]%></span></a></td>','<td colspan="2"><a href="#"><span><%=data[2]%></span></a></td>','<td colspan="2"><a href="#"><span><%=data[3]%></span></a></td>',"</tr>","<tr>",'<td colspan="2"><a href="#"><span><%=data[4]%></span></a></td>','<td colspan="2"><a href="#"><span><%=data[5]%></span></a></td>','<td colspan="2"><a href="#"><span><%=data[6]%></span></a></td>','<td colspan="2"><a href="#"><span><%=data[7]%></span></a></td>',"</tr>","<tr>",'<td colspan="2"><a href="#"><span><%=data[8]%></span></a></td>','<td colspan="2"><a href="#"><span><%=data[9]%></span></a></td>','<td colspan="2"><a href="#"><span><%=data[10]%></span></a></td>','<td colspan="2"><a href="#"><span><%=data[11]%></span></a></td>',"</tr>","</tbody>"]},a={flat:!1,starts:1,prev:"",next:"",lastSel:!1,mode:"single",view:"days",calendars:1,format:"Y-m-d",position:"bottom",eventName:"click",onRender:function(){return{}},onChange:function(){return!0},onShow:function(){return!0},onBeforeShow:function(){return!0},onHide:function(){return!0},locale:{days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],daysShort:[lang.sun,lang.mon,lang.tue,lang.wed,lang.thu,lang.fri,lang.sat,lang.sun],daysMin:[lang.su,lang.mo,lang.tu,lang.we,lang.th,lang.fr,lang.sa,lang.su],months:[lang.january,lang.february,lang.march,lang.april,lang.may,lang.june,lang.july,lang.august,lang.september,lang.october,lang.november,lang.december],monthsShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],weekMin:"wk"}},i=function(s){var a,i,o,r,l,c,p,u,h,v=e(s).data("datepicker"),g=e(s),f=Math.floor(v.calendars/2),C=0;g.find("td>table tbody").remove();for(var _=0;_<v.calendars;_++){switch(a=new Date(v.current),a.addMonths(-f+_),h=g.find("table").eq(_+1),h[0].className){case"datepickerViewDays":o=n(a,"B, Y");break;case"datepickerViewMonths":o=a.getFullYear();break;case"datepickerViewYears":o=a.getFullYear()-6+" - "+(a.getFullYear()+5)}h.find("thead tr:first th:eq(1) span").text(o),o=a.getFullYear()-6,i={data:[],className:"datepickerYears"};for(var b=0;b<12;b++)i.data.push(o+b);u=tmpl(t.months.join(""),i),a.setDate(1),i={weeks:[],test:10},r=a.getMonth();var o=(a.getDay()-v.starts)%7;for(a.addDays(-(o+(o<0?7:0))),l=-1,C=0;C<42;){c=parseInt(C/7,10),p=C%7,i.weeks[c]||(l=a.getWeekNumber(),i.weeks[c]={week:l,days:[]});try{i.weeks[c].days[p-1].text==a.getDate()&&a.addDays(1)}catch($){}if(i.weeks[c].days[p]={text:a.getDate(),classname:[]},""!=restricted_Dates)for(var _=0;_<restricted_Dates.length;_++){var k=restricted_Dates[_].getMonth(),D=restricted_Dates[_].getDate(),w=restricted_Dates[_].getFullYear();if(a.getMonth()==k&&a.getFullYear()==w&&a.getDate()==D){i.weeks[c].days[p].classname.push("datepickerDisabled");break}}if(""!=restrictedDatesInRed)for(var _=0;_<restrictedDatesInRed.length;_++){var k=restrictedDatesInRed[_].getMonth(),D=restrictedDatesInRed[_].getDate(),w=restrictedDatesInRed[_].getFullYear();if(a.getMonth()==k&&a.getFullYear()==w&&a.getDate()==D){i.weeks[c].days[p].classname.push("datepickerDisabled"),i.weeks[c].days[p].classname.push("datepickerDisabledRed");break}}if(restricted_Month!=-1)for(var _=0;_<restricted_Month.length;_++){var k=restricted_Month[_].getMonth(),D=restricted_Month[_].getDate(),w=restricted_Month[_].getFullYear();if(a.getMonth()==k&&a.getFullYear()==w&&a.getDate()==D){i.weeks[c].days[p].classname.push("datepickerDisabled");break}}if(""!=restrictAfterThisDate&&a.getTime()>restrictAfterThisDate.getTime()&&i.weeks[c].days[p].classname.push("datepickerDisabled"),(a.getFullYear()<y||a.getDate()<d&&a.getMonth()<=m&&a.getFullYear()<=y||a.getMonth()<m&&a.getFullYear()<=y)&&i.weeks[c].days[p].classname.push("datepickerDisabled"),r!=a.getMonth()&&i.weeks[c].days[p].classname.push("datepickerNotInMonth"),null!=blockedOutDates)for(var _=0;_<blockedOutDates.length;_++)a.getDay()==blockedOutDates[_]&&i.weeks[c].days[p].classname.push("datepickerDisabled");if(r!=a.getMonth()&&i.weeks[c].days[p].classname.push("datepickerNotInMonth"),0==a.getDay()&&i.weeks[c].days[p].classname.push("datepickerSunday"),6==a.getDay()&&i.weeks[c].days[p].classname.push("datepickerSaturday"),unblockedDates&&unblockedDates.length)for(var _=0;_<unblockedDates.length;_++)FormatDate(a,"%y%m%d")==unblockedDates[_]?i.weeks[c].days[p].classname.remove("datepickerDisabled"):unblockedDates.indexOf(FormatDate(a,"%y%m%d"))==-1&&i.weeks[c].days[p].classname.push("datepickerDisabled");var S=v.onRender(a),I=a.valueOf(),T=FormatDate(new Date(v.date),"%d %n %y"),L=FormatDate(new Date(I),"%d %n %y");(S.selected||T==L||e.inArray(I,v.date)>-1||"range"==v.mode&&I>=v.date[0]&&I<=v.date[1])&&i.weeks[c].days[p].classname.push("datepickerSelected"),S.disabled&&i.weeks[c].days[p].classname.push("datepickerDisabled"),S.className&&i.weeks[c].days[p].classname.push(S.className),i.weeks[c].days[p].classname=i.weeks[c].days[p].classname.join(" "),C++,a.addDays(1)}u=tmpl(t.days.join(""),i)+u,i={data:v.locale.monthsShort,className:"datepickerMonths"},u=tmpl(t.months.join(""),i)+u,h.append(u)}},o=function(e,s){if(e.constructor==Date)return new Date(e);for(var t,a,i,o,n,r=e.split(/\W+/),l=s.split(/\W+/),c=new Date,d=0;d<r.length;d++)switch(l[d]){case"d":case"e":t=parseInt(r[d],10);break;case"m":a=parseInt(r[d],10)-1;break;case"Y":case"y":i=parseInt(r[d],10),i+=i>100?0:i<29?2e3:1900;break;case"H":case"I":case"k":case"l":o=parseInt(r[d],10);break;case"P":case"p":/pm/i.test(r[d])&&o<12?o+=12:/am/i.test(r[d])&&o>=12&&(o-=12);break;case"M":n=parseInt(r[d],10)}return new Date(void 0===i?c.getFullYear():i,void 0===a?c.getMonth():a,void 0===t?c.getDate():t,void 0===o?c.getHours():o,void 0===n?c.getMinutes():n,0)},n=function(e,s){var t=e.getMonth(),a=e.getDate(),i=e.getFullYear(),o=(e.getWeekNumber(),e.getDay()),n=e.getHours(),r=n>=12,l=r?n-12:n,c=e.getDayOfYear();0==l&&(l=12);for(var d,m=e.getMinutes(),p=e.getSeconds(),u=s.split(""),h=0;h<u.length;h++){switch(d=u[h],u[h]){case"a":d=e.getDayName();break;case"A":d=e.getDayName(!0);break;case"b":d=e.getMonthName();break;case"B":d=e.getMonthName(!0);break;case"C":d=1+Math.floor(i/100);break;case"d":d=a<10?"0"+a:a;break;case"e":d=a;break;case"H":d=n<10?"0"+n:n;break;case"I":d=l<10?"0"+l:l;break;case"j":d=c<100?c<10?"00"+c:"0"+c:c;break;case"k":d=n;break;case"l":d=l;break;case"m":d=t<9?"0"+(1+t):1+t;break;case"M":d=m<10?"0"+m:m;break;case"p":case"P":d=r?"PM":"AM";break;case"s":d=Math.floor(e.getTime()/1e3);break;case"S":d=p<10?"0"+p:p;break;case"u":d=o+1;break;case"w":d=o;break;case"y":d=(""+i).substr(2,2);break;case"Y":d=i}u[h]=d}return u.join("")},r=function(e){Date.prototype.tempDate||(Date.prototype.tempDate=null,Date.prototype.months=e.months,Date.prototype.monthsShort=e.monthsShort,Date.prototype.days=e.days,Date.prototype.daysShort=e.daysShort,Date.prototype.getMonthName=function(e){return this[e?"months":"monthsShort"][this.getMonth()]},Date.prototype.getDayName=function(e){return this[e?"days":"daysShort"][this.getDay()]},Date.prototype.addDays=function(e){this.setDate(this.getDate()+e),this.tempDate=this.getDate()},Date.prototype.addMonths=function(e){null==this.tempDate&&(this.tempDate=this.getDate()),this.setDate(1),this.setMonth(this.getMonth()+e),this.setDate(Math.min(this.tempDate,this.getMaxDays()))},Date.prototype.addYears=function(e){null==this.tempDate&&(this.tempDate=this.getDate()),this.setDate(1),this.setFullYear(this.getFullYear()+e),this.setDate(Math.min(this.tempDate,this.getMaxDays()))},Date.prototype.getMaxDays=function(){var e,s=new Date(Date.parse(this)),t=28;for(e=s.getMonth(),t=28;s.getMonth()==e;)t++,s.setDate(t);return t-1},Date.prototype.getFirstDay=function(){var e=new Date(Date.parse(this));return e.setDate(1),e.getDay()},Date.prototype.getWeekNumber=function(){var e=new Date(this);e.setDate(e.getDate()-(e.getDay()+6)%7+3);var s=e.valueOf();return e.setMonth(0),e.setDate(4),Math.round((s-e.valueOf())/6048e5)+1},Date.prototype.getDayOfYear=function(){var e=new Date(this.getFullYear(),this.getMonth(),this.getDate(),0,0,0),s=new Date(this.getFullYear(),0,0,0,0,0),t=e-s;return Math.floor(t/24*60*60*1e3)})},l=function(s){var t=e(s).data("datepicker"),a=e("#"+t.id);if(!t.extraHeight){e(s).find("div")}var i=a.find("table:first").get(0),o=i.offsetWidth,n=i.offsetHeight;a.css({width:o+t.extraWidth+"px",height:n+t.extraHeight+"px"}).find("div.datepickerContainer").css({width:o+"px",height:n+"px"})},c=function(s){e(s.target).is("span")&&(s.target=s.target.parentNode);var t=e(s.target);if(t.is("a")){if(s.target.blur(),t.hasClass("datepickerDisabled"))return!1;var a=e(this).data("datepicker"),o=t.parent(),r=o.parent().parent().parent(),l=e("table",this).index(r.get(0))-1,c=new Date(a.current),d=!1,m=!1;if(o.is("th")){if(o.hasClass("datepickerWeek")&&"range"==a.mode&&!o.next().hasClass("datepickerDisabled")){var u=parseInt(o.next().text(),10);c.addMonths(l-Math.floor(a.calendars/2)),o.next().hasClass("datepickerNotInMonth")&&c.addMonths(u>15?-1:1),c.setDate(u),a.date[0]=c.setHours(0,0,0,0).valueOf(),c.setHours(23,59,59,0),c.addDays(6),a.date[1]=c.valueOf(),m=!0,d=!0,a.lastSel=!1}else if(o.hasClass("-"))switch(c.addMonths(l-Math.floor(a.calendars/2)),r.get(0).className){case"datepickerViewDays":r.get(0).className="datepickerViewMonths",t.find("span").text(c.getFullYear());break;case"datepickerViewMonths":r.get(0).className="datepickerViewYears",t.find("span").text(c.getFullYear()-6+" - "+(c.getFullYear()+5));break;case"datepickerViewYears":r.get(0).className="datepickerViewDays",t.find("span").text(n(c,"B, Y"))}else if(o.parent().parent().is("thead"))switch(r.get(0).className){case"datepickerViewDays":if((e(s.target).parent().hasClass("datepickerGoNext")||e(s.target).parent().hasClass("datepickerGoPrev"))&&"function"==typeof a.onMonthChange){var h=this,v=new Date(a.current);v.addMonths(o.hasClass("datepickerGoPrev")?-1:1),a.onMonthChange(+FormatDate(v,"%y%m"),function(){a.current.addMonths(o.hasClass("datepickerGoPrev")?-1:1),m=!0,i(h)})}else m=!0,a.current.addMonths(o.hasClass("datepickerGoPrev")?-1:1);break;case"datepickerViewMonths":a.current.addYears(o.hasClass("datepickerGoPrev")?-1:1),m=!0;break;case"datepickerViewYears":a.current.addYears(o.hasClass("datepickerGoPrev")?-12:12),m=!0}}else if(o.is("td")&&!o.hasClass("datepickerDisabled")){switch(r.get(0).className){case"datepickerViewMonths":a.current.setMonth(r.find("tbody.datepickerMonths td").index(o)),a.current.setFullYear(parseInt(r.find("thead th.datepickerMonth span").text(),10)),a.current.addMonths(Math.floor(a.calendars/2)-l),r.get(0).className="datepickerViewDays";break;case"datepickerViewYears":a.current.setFullYear(parseInt(t.text(),10)),r.get(0).className="datepickerViewMonths";break;default:var u=parseInt(t.text(),10);switch(c.addMonths(l-Math.floor(a.calendars/2)),o.hasClass("datepickerNotInMonth")&&c.addMonths(u>15?-1:1),c.setDate(u),a.mode){case"multiple":u=c.setHours(0,0,0,0).valueOf(),e.inArray(u,a.date)>-1?e.each(a.date,function(e,s){if(s==u)return a.date.splice(e,1),!1}):a.date.push(u);break;case"range":a.lastSel||(a.date[0]=c.setHours(0,0,0,0).valueOf()),u=c.setHours(23,59,59,0).valueOf(),u<a.date[0]?(a.date[1]=a.date[0]+86399e3,a.date[0]=u-86399e3):a.date[1]=u,a.lastSel=!a.lastSel;break;default:a.date=c.valueOf()}}m=!0,d=!0}m&&i(this),d&&a.onChange.apply(this,p(a))}return!1},p=function(s){var t;return"single"==s.mode?(t=new Date(s.date),[n(t,s.format),t,s.el]):(t=[[],[],s.el],e.each(s.date,function(e,a){var i=new Date(a);t[0].push(n(i,s.format)),t[1].push(i)}),t)},u=function(){var e="CSS1Compat"==document.compatMode;return{l:window.pageXOffset||(e?document.documentElement.scrollLeft:document.body.scrollLeft),t:window.pageYOffset||(e?document.documentElement.scrollTop:document.body.scrollTop),w:window.innerWidth||(e?document.documentElement.clientWidth:document.body.clientWidth),h:window.innerHeight||(e?document.documentElement.clientHeight:document.body.clientHeight)}},h=function(e,s,t){if(e==s)return!0;if(e.contains)return e.contains(s);if(e.compareDocumentPosition)return!!(16&e.compareDocumentPosition(s));for(var a=s.parentNode;a&&a!=t;){if(a==e)return!0;a=a.parentNode}return!1},v=function(s){var t=e("#"+e(this).data("datepickerId"));if(!t.is(":visible")){var a=t.get(0);i(a);var o=t.data("datepicker");o.onBeforeShow.apply(this,[t.get(0)]);var n=e(this).offset(),r=u(),c=n.top,d=n.left;e.curCSS(a,"display");switch(t.css({visibility:"hidden",display:"block"}),l(a),o.position){case"top":c-=a.offsetHeight;break;case"left":d-=a.offsetWidth;break;case"right":d+=this.offsetWidth;break;case"bottom":c+=this.offsetHeight}c+a.offsetHeight>r.t+r.h&&(c=n.top-a.offsetHeight),c<r.t&&(c=n.top+this.offsetHeight+a.offsetHeight),d+a.offsetWidth>r.l+r.w&&(d=n.left-a.offsetWidth),d<r.l&&(d=n.left+this.offsetWidth),t.css({visibility:"visible",display:"block",top:c+"px",left:d+"px"}),0!=o.onShow.apply(this,[t.get(0)])&&t.show(),e(document).bind("mousedown",{cal:t,trigger:this},g)}return!1},g=function(s){s.target==s.data.trigger||h(s.data.cal.get(0),s.target,s.data.cal.get(0))||(0!=s.data.cal.data("datepicker").onHide.apply(this,[s.data.cal.get(0)])&&s.data.cal.hide(),e(document).unbind("mousedown",g))};return{init:function(n){return n=e.extend({},a,n||{}),r(n.locale),n.calendars=Math.max(1,parseInt(n.calendars,10)||1),n.mode=/single|multiple|range/.test(n.mode)?n.mode:"single",this.each(function(){if(!e(this).data("datepicker")){if(n.el=this,n.date.constructor==String&&(n.date=o(n.date,n.format),n.date.setHours(0,0,0,0)),"single"!=n.mode)if(n.date.constructor!=Array)n.date=[n.date.valueOf()],"range"==n.mode&&n.date.push(new Date(n.date[0]).setHours(23,59,59,0).valueOf());else{for(var a=0;a<n.date.length;a++)n.date[a]=o(n.date[a],n.format).setHours(0,0,0,0).valueOf();"range"==n.mode&&(n.date[1]=new Date(n.date[1]).setHours(23,59,59,0).valueOf())}else n.date=n.date.valueOf();n.current?n.current=o(n.current,n.format):n.current=new Date,n.current.setDate(1);var r,d="datepicker_"+parseInt(1e3*Math.random());n.id=d,e(this).data("datepickerId",n.id);var m=e(t.wrapper).attr("id",d).bind("click",c).data("datepicker",n);n.className&&m.addClass(n.className);for(var p="",a=0;a<n.calendars;a++)r=n.starts,a>0&&(p+=t.space),p+=tmpl(t.head.join(""),{week:n.locale.weekMin,prev:n.prev,next:n.next,day1:n.locale.daysMin[r++%7],day2:n.locale.daysMin[r++%7],day3:n.locale.daysMin[r++%7],day4:n.locale.daysMin[r++%7],day5:n.locale.daysMin[r++%7],day6:n.locale.daysMin[r++%7],day7:n.locale.daysMin[r++%7]});m.find("tr:first").append(p).find("table").addClass(s[n.view]),i(m.get(0)),n.flat?(m.appendTo(this).show().css("position","relative"),l(m.get(0))):(m.appendTo(document.body),e(this).bind(n.eventName,v))}})},showPicker:function(){return this.each(function(){e(this).data("datepickerId")&&v.apply(this)})},hidePicker:function(){return this.each(function(){e(this).data("datepickerId")&&e("#"+e(this).data("datepickerId")).hide()})},setDate:function(s,t){return this.each(function(){if(e(this).data("datepickerId")){var a=e("#"+e(this).data("datepickerId")),n=a.data("datepicker");if(n.date=s,n.date.constructor==String&&(n.date=o(n.date,n.format),n.date.setHours(0,0,0,0)),"single"!=n.mode)if(n.date.constructor!=Array)n.date=[n.date.valueOf()],"range"==n.mode&&n.date.push(new Date(n.date[0]).setHours(23,59,59,0).valueOf());else{for(var r=0;r<n.date.length;r++)n.date[r]=o(n.date[r],n.format).setHours(0,0,0,0).valueOf();"range"==n.mode&&(n.date[1]=new Date(n.date[1]).setHours(23,59,59,0).valueOf())}else n.date=n.date.valueOf();t&&(n.current=new Date("single"!=n.mode?n.date[0]:n.date)),i(a.get(0))}})},getDate:function(s){if(this.size()>0)return p(e("#"+e(this).data("datepickerId")).data("datepicker"))[s?0:1]},clear:function(){return this.each(function(){if(e(this).data("datepickerId")){var s=e("#"+e(this).data("datepickerId")),t=s.data("datepicker");"single"!=t.mode&&(t.date=[],i(s.get(0)))}})},fixLayout:function(){return this.each(function(){if(e(this).data("datepickerId")){var s=e("#"+e(this).data("datepickerId")),t=s.data("datepicker");t.flat&&l(s.get(0))}})},setLocalTimeZoneDate:function(e){date_ex=e,m=date_ex.getMonth(),d=date_ex.getDate(),y=date_ex.getFullYear()},setRestrictedDates:function(e){restricted_Dates=e}}}();e.fn.extend({DatePicker:s.init,DatePickerHide:s.hidePicker,DatePickerShow:s.showPicker,DatePickerSetDate:s.setDate,DatePickerGetDate:s.getDate,DatePickerClear:s.clear,DatePickerLayout:s.fixLayout,DatePickerSetLocalTimeZoneDate:s.setLocalTimeZoneDate,DatePickerSetRestrictedDates:s.setRestrictedDates})}(jQuery),function(){var e={};this.tmpl=function s(t,a){var i=/\W/.test(t)?new Function("obj","var p=[],print=function(){p.push.apply(p,arguments);};with(obj){p.push('"+t.replace(/[\r\t\n]/g," ").split("<%").join("\t").replace(/((^|%>)[^\t]*)'/g,"$1\r").replace(/\t=(.*?)%>/g,"',$1,'").split("\t").join("');").split("%>").join("p.push('").split("\r").join("\\'")+"');}return p.join('');"):e[t]=e[t]||s(document.getElementById(t).innerHTML);return a?i(a):i}}();var BookAppointment=function(){function createContact(e){try{var s=e[0].customer?e[0].customer:{},t=s.email?s.email:"null",a={type:Wix.Activities.Type.CONTACT_CONTACT_FORM,info:{emails:[{email:t,tag:"main"}],addresses:[{tag:"Home"},{address:s.address},{city:s.city},{postalCode:s.zip}],phones:[{tag:"Home"},{phone:s.phone}],name:{first:s.firstName,last:s.lastName},fields:[{name:"comments",value:e[0].appointments[0].comments}]},contactUpdate:{name:{first:s.firstName,last:s.lastName},emails:[{tag:"main",email:t}]}};Wix.Activities.postActivity(a,function(e){console.log("successfully posted contact"+e)},function(e){console.log("failed to post contact"+e)})}catch(i){console.log(i)}}var _bookingPolicy="",isValueExists="false",EmailPattern=/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9_]+\.)+[a-zA-Z]{2,}))$/,regScript=/<(.|\n)*?>/g,contactFields=[],futureAppts=[],pastAppts=[],restrictedDays=[],customizedState="State",customizedZip="Zip",customizedCity="City",resourcesList="",resourceKey="",resourceName="",serviceKey="",serviceName="",serviceDuration="",serviceId="",dateFormatted="",selectedDate="",selectedDateUTC="",timingSelected="",custFirstName="",custLastName="",custPhoneNum="",custExt="",cusEmail="",cusAddress="",cusCity="",cusState="",cusZip="",cusComments="",custAdditionalFields="",cusProfile="",enPwd="",formattedNum="",tempunblockedDates=[],tempRestrDates="",tempRestDtsInRed="",tempBlockedDays="",temprestrictAfterThisDate="",tempAdvanceDays=0,_months=new Array("Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"),_dys=new Array("Sun","Mon","Tue","Wed","Thu","Fri","Sat"),_serCusObj={},_clsCusObj={},_allClasses=new Array,_classBookingDetails={},_fClsResMap="",_customizedClassName="Classes"!=customisedClassLabel?htmlDecode(customisedClassLabel):"en"!=language?lang.classes:"Classes",_customizedSerName="Service"!=customisedServiceLabel?htmlDecode(customisedServiceLabel):"en"!=language?lang.service:"Service",_customizedProName="Provider"!=customisedProviderLabel?htmlDecode(customisedProviderLabel):"en"!=language?lang.provider:"Provider",_clsName="Classes"==_customizedClassName?"Class":_customizedClassName,timeForPayments="",_canclPlcyHrs=customerInfo.cancellationPolicyHours?customerInfo.cancellationPolicyHours:"",_isSkipStaff=customerInfo.skipStaff?customerInfo.skipStaff:"false",_isMultiSer=customerInfo.isMultipleService?customerInfo.isMultipleService:0,_allServicesArr=new Array,selectedServicesKeys=new Array,_cacheResEle="",_isSkipMultiSer=!1,_disabledTabs=customerInfo.disabledTabs&&0!=customerInfo.disabledTabs.length?customerInfo.disabledTabs:[],instagramUserDetails=null,_startDate="",_endDate="";bookingPageSettings=null!=bookingPageSettings?bookingPageSettings:{showMenuBar:!0,enabledFields:[],showCategoryAccordion:!1},customerInfo.thirdPartyLogin=customerInfo.thirdPartyLogin?customerInfo.thirdPartyLogin:"false";var moretext="en"!=language||"English"!=language?lang.show_more:"show more",lesstext="en"!=language||"English"!=language?lang.show_less:"show less",_enabledCustLocalTimeZone=void 0==customerInfo.enableLocalTimezone||"true"==customerInfo.enableLocalTimezone,_selectedTimeZone="",_selectedTimeZoneOffSet="",_seletedTimeZoneFullName="",_apptCustomerLocalTime="",timeZoneObj={};window.isMobile=window.matchMedia("only screen and (max-width: 760px)");var _multipleServices=!1,apptDtInLocalTZ="",_companyTZ="",providerLabel="Dutch"==language?"":" Provided",choose_a_ser="German"==language?lang.choose_a_service:lang.choose_a,choose_a_pro="German"==language?lang.choose_a_provider:lang.choose_a,chooseDate=null,_classsCategoryOrder=[],nextAvailabilitySlotReq="",requestAbortState=!1,_countryCode="",country=countryInitial&&"null"!=countryInitial&&"ZZ"!=countryInitial?countryInitial:"US";
country=countryObject.getIntlCountryData(country.toLowerCase(),!0,!0,"iso2").iso3;var currentCall=null,retrySaveAppt=0,_selectedClassTZFUllName="",labels,labelsArr=[],maxLabelWidth,pastCustomerEvents={time:0,startTimeLong:0,endTimeLong:0,events:[],apptCursor:"",clsApptCursor:"",type:"past"},upcomingCustomerEvents={time:0,startTimeLong:0,endTimeLong:0,events:[],apptCursor:"",clsApptCursor:"",type:"upcoming"},customerServiceList={},rescheduleAndCancelLink={},isPhoneNumberValid=!1,getTimeZone=function(e){var s={HST:"Pacific/Honolulu",PST:"America/Los_Angeles",MST1:"America/Dawson_Creek",MST:"America/Edmonton",CST1:"America/Belize",CST:"America/Chicago",EST1:"America/Lima",EST:"America/New_York",GMT:"Etc/GMT",BST:"Europe/London",EAT:"Africa/Nairobi",ICT:"Asia/Bangkok",EEST:"Europe/Bucharest",CEST:"Europe/Vilnius",WAT:"Africa/Windhoek",CENTRALEUROPE:"Europe/Belgrade"};return e?e.contains("/")?e:s[e.toUpperCase().replace(" ","")]:"GMT"};"STAGING"==APP_MODE||"STAGING-SETMORE"==APP_MODE?"GBP"==currency||"POUND"==currency||"Pound"==currency?window.squareApplicationId="sandbox-sq0idb-WzC9RCQ4ZJ8MoJmrGOzdtQ":window.squareApplicationId="sandbox-sq0idb-Hhv1sfUM2hKl9uU9WL4xGg":window.squareApplicationId="sq0idp-phIbJuBc5Ox0SMWr6x3vgQ",window.StaffClassInventory=Backbone.Model.extend({defaults:{key:"",times:[]},initialize:function(){console.log("initialised")}}),window.connectService=[],window.StaffClassInventoryCollection=Backbone.Collection.extend({model:StaffClassInventory}),window.EventResources={serviceList:{},serviceCategoryKeys:[],serviceCategoryList:{},classKeys:[],classesList:[],classList:[],classCategoryKeys:[],classCategoryList:[],staffInventoryCollection:new StaffClassInventoryCollection,isClsFetched:!1,clsFetchInProcess:!1,isServiceFetched:!1,servFetchInProcess:!1,range:50,clsStaffKeysList:[],clsStaffTimesByClass:[],timezoneId:"",currentDate:"",isEventBinded:!1,isClsInMigration:!0,classTimeZoneId:""};var events=function(){$("input").focus(function(e){"checkbox"!==e.currentTarget.type&&$(e.currentTarget).next().addClass("placeholder-span-focus"),"setmore-signup"==$(e.currentTarget).parent().parent().attr("class")&&clkStMrSignUp()}).blur(function(e){var s=$("#"+$(e.currentTarget).attr("id")).val();s||$(e.currentTarget).next().removeClass("placeholder-span-focus")}),$(".Go-back").off("click").on("click",function(){$(".Go-back").addClass("active"),activateSerOrProTab()}),$("#cust-PhoneNo, .classes-container #class_cust-PhoneNo").off("click").on("click",function(e){var s=$(e.currentTarget);setFormattedNumber(s,"e164")}),$("div").on("click",function(e){$("#choose-tz-container").hide(),$("#choose-cls-tz-container").hide()}),$(document).keyup(function(e){e.preventDefault(),e.stopPropagation(),27==e.keyCode&&($("#choose-tz-container").hide(),$("#choose-tz-container, #choose-cls-tz-container").removeClass("active"),$("#choose-cls-tz-container").hide())}),$("#search-cls-tz-input").off("keyup").on("keyup",function(e){var s=$(this).val().toLowerCase();e.preventDefault(),e.stopPropagation(),$(".cls-tz-dropdown-menu li").map(function(e,t){var a=$(t).text().toLowerCase();$(t).toggle(a.indexOf(s)>=0||a.replace(/\s/g,"").indexOf(s)>=0||a.contains(s))})}),$("#search-tz-input").off("keyup").on("keyup",function(e){var s=$(this).val().toLowerCase();e.preventDefault(),e.stopPropagation(),$(".tz-dropdown-menu li").map(function(e,t){var a=$(t).text().toLowerCase();$(t).toggle(a.indexOf(s)>=0||a.replace(/\s/g,"").indexOf(s)>=0||a.contains(s))})});var e=window.screen.height;$(".screen-height").css({height:e}),$("#side-icon").off("click").on("click",function(){$("#side-icon").hasClass("icon-chevron-down")?($("#side-icon").removeClass("icon-chevron-down").addClass("icon-chevron-up"),$(".login-details-ul").show()):($("#side-icon").removeClass("icon-chevron-up").addClass("icon-chevron-down"),$(".login-details-ul").hide())}),$("#menuModel").off("click").on("click",function(e){stopEvents(e),$(".menu-bar").hide(),$(".side-menu").addClass("show"),$(".side-menu-col").show(),$(".reviewPopup , #notes_wrapper").hide(),"true"==facebookPage&&($("#side-login").hide(),$(".side-menu-login_details").hide()),0==customerInfo.branding&&$(".side-menu-header > a").hide(),$(".side-menu-col1").css({height:window.innerHeight-110});var s=$(".side-menu-col1").height(),t=window.innerWidth>0?window.innerWidth:screen.width;if(t<=539){var a=window.innerHeight>0?window.innerHeight:screen.height;$("#side-login").css("top",s),$(".login-details-footer").css("margin-top","0px"),$(".side-menu-login_details").css("margin-top",a-($(".side-menu-header").height()+$(".login-details-footer").height())),$(".sticky-overlay").css("top",s+25),$(".login-details-footer").css("position","relative"),$(".login-details-footer").css("width",$(".side-menu").width())}}),$(".close-icon-col1").off("click").on("click",function(){$(".customer-col1").hide(),$(".customer-profile-cancel").show(),$("#customerMenuModel").show()}),$(".close-menu").off("click").on("click",function(){$(".menu-bar").show(),$(".side-menu").hide(),$(".side-menu-col").hide(),$(".side-menu").removeClass("show"),$("body").css({overflow:"auto"})}),sEvents(),cEvents(),hEvent(),clkSideNavBar(),clkSerHeaderNavBar(),clkClsHeaderNavBar(),clkCusLoginEvents(),rEvents(),$(".class_global_btn2_rt").html(lang.book_my+" "+_clsName),"German"==language&&$(".class_global_btn2_rt").html(lang.book_my+" "+_clsName+" "+lang.book),"true"==isReschedulePage&&"class"==apptType?$(".class_global_btn2_rt").html("Reschedule "+_clsName):"true"==isReschedulePage&&$(".global_btn2_rt").html("Reschedule"),$("#skip_step").off("click").on("click",function(){showForm("skipStep"),$(".customerLoginContainer").addClass("removePaddingTop").removeClass("addPaddingTop")}),$("#sign_out,.customer-profile-signout, #side-menu-sign_out").off("click").on("click",function(){signout(),isWixApp&&wixStepTabService()}),$("#phone_num").off("blur").on("blur",function(){for(var e=$(this).val();"0"===e.charAt(0);)e=e.substr(1);$(this).val(e)}),$(".customer-details-list > li > .input-profile-fields ,.customerlist-comments").off("click").on("click",function(){$("#cust-continue").css({"background-color":"#11C3BC"}),$("#cust-continue").css({color:"#fff"})}),clkCusSchdl(),$(".customer-appointments ul ").off("click","li .editApptPopup .popover-title").on("click","li .editApptPopup .popover-title",function(){$(".editApptPopup").hide()}),$(".customer-appointments ul ").off("click","li a").on("click","li a",function(){$(".editApptPopup").hide(),editApptPopup(this.id)}),clkCusEdit(),saveCusDtls(),bkAnthrAppt(),$(".customer-appointments ul ").off("click","li").on("click","li",function(){var e=$(this).attr("class"),s=this.id;e.indexOf("apptMonthly")==-1&&s&&""!=s&&s.indexOf("isRecurring_hide")!=-1&&showValidationAletMsg("Recurring Appointments cannot be Cancelled/Rescheduled")}),$(".side-menu-col1 .photos_act").css({display:"block"}),$("#photos_act").on("scroll",function(){$("#photos_act").scrollTop()+$("#photos_act").innerHeight()>=$("#photos_act")[0].scrollHeight-30&&(!jQuery.active||jQuery.active<=0)&&$("#photos_act").trigger("scrolledToBottom")});try{isWixApp&&Wix.addEventListener(Wix.Events.SETTINGS_UPDATED,function(e){var s=e.serviceData;if("save"==e.type)serviceCategoryList[s.key]=s,categoryList[Object.keys(categoryList)[0]].serviceIdList.push(s.key);else{var t=categoryList[Object.keys(categoryList)[0]].serviceIdList;delete serviceCategoryList[s.key],console.log(categoryList),console.log(serviceCategoryList),console.log(t),console.log(_.without(t,s.key)),categoryList[Object.keys(categoryList)[0]].serviceIdList=_.without(t,s.key),console.log(categoryList[Object.keys(categoryList)[0]].serviceIdList)}renderSerAndCat()})}catch(s){console.log("exception ::"+s.message)}$(".view-more-details ").off("click").on("click",function(e){$(".confirm_appt").addClass("show-more-content-btn")}),$("#previous-state").off("click").on("click",function(e){stopEvents(e),$("#login-details-dropdown-ul").show(),$(".customer-profile-edit").hide(),$("#account_menu ul").show(),$("#blockpage").hide()}),$("#account_menu").off("click").on("click",function(e){$("#login-details-dropdown-ul").show()}),$("#blockpage").off("click").on("click",function(e){e.stopPropagation(),$("#login-details-dropdown-ul").hide()}),$("#bg-wrapper").off("click").on("click",function(e){e.stopPropagation(),$("#login-details-dropdown-ul").hide()})},validateAndFormatPhNo=function(e){var s=$(e),t=$(e).val(),a="";"undefined"!=typeof t&&!isNullOrEmpty(t)&&libPhoneNumberValidation(t,s)&&0==isPhoneNumberValid&&(a="e164"),setFormattedNumber(s,a)},activateSerOrProTab=function(){"true"==customerInfo.skipStaff||null!=staffResourceInfo?(serSt(),$("#service-back").addClass("hide")):proSt()},libPhoneNumberValidation=function(e,s){console.log(s.parent().find("input")),console.log(s.parent().find("input#cust-countryCode").val()),console.log(s.parent().find("input#cust-PhoneNo").val()),isPhoneNumberValid=!1;var t,a,i;if(s&&s.length>0){var o,n=s[0].id;"cust-PhoneNo"==n?o="#service":"class_cust-PhoneNo"==n?o="#class":"cust-edit-PhoneNo"==n&&(o="#myProfile")}if(isIE())t=s.parent().find("input")[0].value,e=s.parent().find("input")[1].value,r=countryCodeByGoogle,a="",i="";else{var r=s&&s.parent().find("input").intlTelInput("getSelectedCountryData").iso2?s.parent().find("input").intlTelInput("getSelectedCountryData").iso2.toUpperCase():"";t=s.parent().find(".flag-container .selected-flag .selected-dial-code").text();var l=s.attr("data-phone-required");e=e.replace(/[^\d\+]/g,""),a=t.slice(0,1),i=e.slice(0,1)}try{if("undefined"==typeof libphonenumber||"true"!=l&&"false"!=l){var c=e;if(v!==i){c=t+e;var d=c.indexOf(t);c=d!==-1?c.slice(0,d)+c.slice(d+t.length):e}else{var d=c.indexOf(t);d!==-1&&(c=c.slice(0,d)+c.slice(d+t.length))}c=c.replace(/[^\d]/g,""),$(s).val(c),$(s).parent().parent().removeClass("inputError")}else if(e){var a=t.slice(0,1),m=libphonenumber.isValidNumber(e,r),p=libphonenumber.isValidNumber(a+e,r),u=libphonenumber.isValidNumber(t+e,r);if(m?e=e:(u&&(e=t+e),p&&(e=a+e)),m||u||p){var h=!1,v=t.slice(0,1),i=e.slice(0,1),c=e;if(v!==i){c=t+e;var d=c.indexOf(t);c=d!==-1?c.slice(0,d)+c.slice(d+t.length):e,c=c.replace(/[^\d]/g,""),h=libphonenumber.isValidNumber(c,r)}else{h=libphonenumber.isValidNumber(c);var d=c.indexOf(t);d!==-1&&(c=c.slice(0,d)+c.slice(d+t.length)),c=c.replace(/[^\d\+]/g,"")}if(h){var d=c.indexOf(v);return d!==-1&&(c=c.slice(0,d)+c.slice(d+v.length)),$(s).val(c),$(s).parent().parent().removeClass("inputError"),$(s).parent().removeClass("inputError"),$(s).parent().parent().removeClass("focus"),"true"!=l&&hideOrDisplayWarn("valid",o,lang.phone_number_warn_msg),isPhoneNumberValid=!0,"true"}var g=libphonenumber.parseNumber(c,r,{extended:!0}),f=g.phone,y=g.country;return y!==r?($(s).parent().parent().removeClass("focus"),"true"==l?($(s).parent().parent().addClass("inputError"),"false"):(hideOrDisplayWarn("invalid",o,lang.phone_number_warn_msg),"true")):($(s).val(f),$(s).parent().parent().removeClass("inputError"),$(s).parent().parent().removeClass("focus"),"true"!=l&&hideOrDisplayWarn("valid",o,lang.phone_number_warn_msg),isPhoneNumberValid=!0,"true")}return $(s).parent().parent().removeClass("focus"),"true"==l?($(s).parent().parent().addClass("inputError"),"false"):(hideOrDisplayWarn("invalid",o,lang.phone_number_warn_msg),"true")}hideOrDisplayWarn("hideAll",o),$(s).parent().parent().removeClass("focus")}catch(C){return $(s).parent().parent().addClass("inputError"),$(s).parent().parent().removeClass("focus"),"false"}},selectServiceTabList=function(e){$("#services_act").off("click","ul > li").on("click","ul > li",function(e){e.stopPropagation(),_disabledTabs.indexOf("bookAppt")>-1&&_disabledTabs.indexOf("bookClass")>-1||(nextAvailabilitySlotReq&&nextAvailabilitySlotReq.abort(),requestAbortState=!0,aftrSelectService(this))})},selectClassesTabList=function(e){$("#classes_act").off("click","ul > li").on("click","ul > li",function(e){e.stopPropagation(),_disabledTabs.indexOf("bookAppt")>-1&&_disabledTabs.indexOf("bookClass")>-1||(e.stopPropagation(),afterSelectingClass(this))})},selectMultiSer=function(e){var s=$(e.currentTarget).attr("id");$(e.currentTarget).hasClass("active")?(console.log(" active has"),$(e.currentTarget).removeClass("active"),$(e.currentTarget).find("a").removeClass("serviceActive"),selectedServicesKeys.remove(s)):($(e.currentTarget).addClass("active"),$(e.currentTarget).find("a").addClass("serviceActive"),selectedServicesKeys.push(s))},moreLessEvent=function(){$(".morelink").off("click").on("click",function(e){return e.stopPropagation(),$(this).hasClass("less")?($(this).removeClass("less"),$(this).html(moretext)):($(this).addClass("less"),$(this).html(lesstext)),$(this).parent().prev().toggle(),$(this).prev().toggle(),!1})},multiSerEvents=function(){$(".multiple-service-list").off("click").on("click","li",function(e){selectMultiSer(e)}),$(".multiple-service-continue-btn").off("click").on("click",function(e){_multipleServices=!0,null!=staffResourceInfo?getResources(_cacheResEle,"multipleServices"):"true"==_isSkipStaff&&1==customerInfo.resourcesInOrder.length&&""!=customerInfo.resourcesInOrder[0].trim()?getResources(_cacheResEle,"multipleServices"):showTimings(_cacheResEle,"","multipleServices"),_isSkipMultiSer=!1,$("body").removeClass("hideScroll"),$(".multiple-service-holder").hide()}),$(".multiple-service-skip-btn").off("click").on("click",function(e){$(".multiple-service-holder").hide(),selectedServicesKeys=[],selectedServicesKeys.indexOf(serviceKey)==-1&&selectedServicesKeys.push(serviceKey),null!=staffResourceInfo?getResources(_cacheResEle):"true"==_isSkipStaff&&1==customerInfo.resourcesInOrder.length&&""!=customerInfo.resourcesInOrder[0].trim()?getResources(_cacheResEle):showTimings(_cacheResEle),_isSkipMultiSer=!0,_multipleServices=!1,$("body").removeClass("hideScroll")}),$(".multiple-service-header-close").off("click").on("click",function(e){_multipleServices=!1,$(".multiple-service-holder").hide(),selectedServicesKeys=[],$("body").removeClass("hideScroll")})},tzEvents=function(){timeZoneObj.companyTimeZoneObj.timeZoneID!=timeZoneObj.localTimeZoneObj.timeZoneID&&($("#cmpyTZ, .classes-container #cmpyTZ").show(),$("#companyTimezone, .classes-container #companyTimezone").text(timeZoneObj.companyTimeZoneObj.timeZoneFullName),$("#companyTimezone").attr("index",timeZoneObj.companyTimeZoneObj.timeZoneID),$(".classes-container #companyTimezone").attr("index",timeZoneObj.companyTimeZoneObj.timeZoneID)),timeZoneObj.localTimeZoneObj.timeZoneOffset==companyTimeZoneOffset&&($(".chng-tz-a > span, .chng-cls-tz-a > span").html(timeZoneObj.companyTimeZoneObj.timeZoneFullName),$(".timesIn, .cls-timesIn").attr("index",timeZoneObj.companyTimeZoneObj.timeZoneID),$(".tz-lst > a, .cls-tz-dropdown-menu > .tz-lst > a ").removeClass("localTimeZone"),_selectedTimeZoneOffSet=timeZoneObj.localTimeZoneObj.timeZoneOffset),apptLocalTZChange(),classLocalTZChange()},apptLocalTZChange=function(){$(".tz-dropdown-menu > li").off("click").on("click",function(e){$("#choose-tz-container").hide(),$("#choose-tz-container").removeClass("active"),$("#loading_icon").is(":visible")||$("#timesheet").html('<img id="loading_icon_timings"  class="loading_icon_timings"  src="/setmore-loader.gif" style="display:show"></img>'),chooseTZEvent();var s=$(this).find("a").attr("index"),t=allTimeZones.length;"Asia/Kolkata"==s&&(s="Asia/Calcutta");for(var a=0;a<=t;a++)if(allTimeZones[a]&&allTimeZones[a].timeZoneID==s){$(".chng-tz-a > span").html(allTimeZones[a].timeZoneFullName);var i=allTimeZones[a].timeZoneID;if($(".timesIn").attr("index",i),$(".service_title").html(""),_selectedTimeZone=i,_selectedTimeZoneOffSet=allTimeZones[a].timeZoneOffset,_seletedTimeZoneFullName=allTimeZones[a].timeZoneFullName,_enabledCustLocalTimeZone){var o=_selectedTimeZone?_selectedTimeZone:timeZoneObj.localTimeZoneObj.timeZoneID,n={type:"GET",url:"/getCurrentLocationBasedTime",data:"localTZ="+o,dataType:"html",async:!0,cache:!1};makeRequest(n).done(function(e){if(e){var t=String(e).split("/"),a=new Date(t[2],t[1]-1,t[0]);clientDate=new Date(t[2],t[1]-1,t[0]),clientDateToInitiliazeDatePicker=new Date(t[2],t[1]-1,t[0]);var i=chooseDate;if(adavanceDays>0?(clientDate.setDate(clientDate.getDate()+parseInt(adavanceDays)),clientDateToInitiliazeDatePicker.setDate(a.getDate()+parseInt(adavanceDays))):clientDateToInitiliazeDatePicker.setDate(clientDate.getDate()),$("#calendars").DatePickerSetLocalTimeZoneDate(clientDate),calculateRestrictedDate(t),i?clientDate=i:clientDate=clientDate,0!=totalRestrictedDates){restricted_Dates=[];var o=1;adavanceDays>0&&(o=0),(timeZoneObj.companyTimeZoneObj.timeZoneID!=_selectedTimeZone||""==_selectedTimeZone&&timeZoneObj.companyTimeZoneObj.timeZoneID!=timeZoneObj.localTimeZoneObj.timeZoneID)&&restrictAfterThisDate.setDate(restrictAfterThisDate.getDate()+1);var n=new Date(t[2],t[1]-1,t[0]);n.setDate(clientDate.getDate()+totalRestrictedDates+o),restricted_Dates.push(n),$("#calendars").DatePickerSetRestrictedDates(restricted_Dates)}restrictedDatesInRed&&restrictedDatesInRed[0]&&(restrictedDatesInRed=[]),$(".tz-dropdown-menu > li > a").removeClass("active");var r=clientDate.getMonth()+1+"/"+clientDate.getDate()+"/"+clientDate.getFullYear(),l=Date.UTC(clientDate.getFullYear(),clientDate.getMonth(),clientDate.getDate(),0,0,0);"true"!=_isSkipStaff&&null==staffResourceInfo?getWorkingHoursForSingleResource(companyKey,clientDate,serviceDuration,r,l,s):null!=staffResourceInfo?_multipleServices?showTimings(staffResourceInfo.key,"staffPage","multipleServices"):showTimings(staffResourceInfo.key,"staffPage"):_multipleServices?showTimingsForAllResources("multipleServices"):showTimingsForAllResources()}}).fail(function(e){console.log("Error  :: While fetching the customer local timezone")})}}})},classLocalTZChange=function(){$(".cls-tz-dropdown-menu > li").off("click").on("click",function(e){$("#choose-cls-tz-container").hide(),$("#choose-cls-tz-container").removeClass("active"),$("#loading_icon").is(":visible")||$("#class_sessions_sheet").html('<img id="loading_icon_timings"  class="loading_icon_timings"  src="/setmore-loader.gif" style="display:show"></img>'),chooseTZEvent();var s=$(this).find("a").attr("index"),t=allTimeZones.length;"Asia/Kolkata"==s&&(s="Asia/Calcutta");for(var a=0;a<=t;a++)if(allTimeZones[a]&&allTimeZones[a].timeZoneID==s){_selectedClassTZFUllName=allTimeZones[a].timeZoneFullName,$(".chng-cls-tz-a > span").html(_selectedClassTZFUllName);var i=allTimeZones[a].timeZoneID;$(".cls-timesIn").attr("index",i),EventResources.classTimeZoneId=i;var o=FormatDate(clientClassDate,"%y%m%d");unblockedDates.indexOf(o)==-1&&unblockedDates.push(o+""),$("#classCalendars").DatePickerSetDate(FormatDate(clientClassDate,"%y-%d-%m"),!0),fetchClsInventoryResByClsKey(_classBookingDetails.classKey,"tzchange")}})},chooseTZEvent=function(){$(".chng-tz-a").off("click").on("click",function(e){stopEvents(e),changeTZActions("service")}),$(".chng-cls-tz-a").off("click").on("click",function(e){stopEvents(e),changeTZActions("classes")}),$("#search-tz-input").off("click").on("click",function(e){stopEvents(e)}),$("#search-cls-tz-input").off("click").on("click",function(e){stopEvents(e)})},stopEvents=function(e){e.preventDefault(),e.stopPropagation()},changeTZActions=function(e){var s="choose-tz-container",t="";"classes"==e&&(s="choose-cls-tz-container",t="cls-"),$("#"+s).hasClass("active")?($("#"+s).hide(),$("#"+s).removeClass("active")):$("#loading_icon").is(":visible")||$("#loading_icon_timings").is(":visible")?($(".chng-"+t+"tz-a").css({color:"#b6b6b6"}),setTimeout(function(){$(".chng-"+t+"tz-a").css({color:"#1a93d0"})},150)):($("#"+s).show(),$("#search-"+t+"tz-input").focus(),$("#"+s).removeClass("active"))},sEvents=function(){$(".service > span.step-li").html(_customizedSerName),$(".service > span.step-li").attr("title",htmlDecode(_customizedSerName.toUpperCase())),$(".provider > span.step-li").html(_customizedProName),$(".provider > span.step-li").attr("title",htmlDecode(_customizedProName).toUpperCase()),clkSerNavBar(),disPrgrsIcon("services"),serPrgrs(),clkSer(),clkSerRes(),clkSerTimeSlt(),clkCusSerCon(),bkAppt()},cEvents=function(){clkClsNavBar(),disPrgrsIcon("classes"),clsPrgrs(),clkCls(),clkClsRes(),clkClsTimeSlt(),clkCusClsCon(),bkClsAppt()},hEvent=function(){$("#staff_act, #services_act, #classes_act").off("mouseover","ul > li").on("mouseover","ul > li",function(){showDetailedDes(this),offsetDescPopup()}).off("mouseout","ul > li").on("mouseout","ul > li",function(){hideDetailedDes(this)})},switchToSerOrClsTab=function(){if(_disabledTabs.indexOf("bookAppt")>-1&&_disabledTabs.indexOf("bookClass")>-1)return void showNoBookingsDiv();if("cls"==arguments[0]){$(".col1 > .nav > .gt > #gt_sr , .side-menu-col1 > .nav > .gt > #gt_sr").parent().removeClass("active");var e=!0;if(_disabledTabs.indexOf("bookClassTab")!=-1&&_disabledTabs.indexOf("classes")!=-1?e=!1:"bookClassTab"==arguments[1]&&_disabledTabs.indexOf("bookClass")!=-1?e=!1:"classesTab"==arguments[1]&&_disabledTabs.indexOf("classes")!=-1&&(e=!1),_disabledTabs.indexOf("bookClass")!=-1&&window.location.pathname.includes("bookclass")&&(e=!1),_disabledTabs.indexOf("classes")!=-1&&window.location.pathname.includes("/class")&&(e=!1),!e||0==classes.length)return void showNoClsDiv();if($(".classes-container").show(),$(".service-container").hide(),$(".class_step_tab").show(),$("#chs_class_act").show(),$("#classes-tab").parent().addClass("active"),$("#class_progress-icon").hide(),$(".col1 > .nav > .gt, .side-menu-col1 > .nav > .gt").removeClass("active"),$(".col1 > .nav > .gt_cls , .side-menu-col1 > .nav > .gt_cls").show(),$(".col1 > .nav > .gt_cls, .side-menu-col1 > .nav > .gt_cls").addClass("active"),_bookingPolicy&&($("#policy_link").show(),$(".policyNote").hide(),$(".policyNote").hasClass("viewed")||$(".policyNote").show()),"class"==apptType&&"true"==isReschedulePage)$(".showClassesTab, #classes-tab").hide(),$("#chs_class_act").hide();else{var s="Classes"!=customisedClassLabel?customisedClassLabel:"en"!=language?lang.Class:"Class";$(".class_step_tab > h2").html(choose_a_ser+" "+s);var t="Provider"!=customisedProviderLabel?customisedProviderLabel:"en"!=language?lang.provider:"Provider";$(".class_provider > span.mobile-navbar").html('<i class="icon-group"></i><label>'+t+"<label>"),$(".class_provider > span.class_step-li").html(t)}$("#policy_link").addClass("pClsActive"),$("#notes_wrapper").addClass("nClsActive"),$("#classes-tab").parent().show(),0==$("#chs_service_act > ul").length&&$("#services-tab").parent().hide(),$(".col1 > .nav > .gt_cls , .side-menu-col1 > .nav > .gt_cls").show(),0!=bookingPageSettings.showMenuBar&&($(".chng-tz").addClass(" noMenu"),$(".detail-navbar > ul").hide()),$(".bookingpage_loader").hide(),showSerTabsOnClsTabClicked()}"ser"==arguments[0]&&((0==$("#chs_service_act > ul").length||window.location.pathname.contains("bookappointment")&&_disabledTabs.indexOf("bookAppt")!=-1)&&($(".step_tab").hide(),$(".service-container").show(),$("#services-tab").parent().removeClass("active"),$("#chs_service_act").addClass("noServices"),$("#chs_service_act").html("<p>"+lang.booking_services_unavailable+"</p>"),$(".classes-container").hide(),$("#chs_class_act").hide(),$("#policy_link, .policyNote").hide(),$(".service_title").html(""),$(".col1 > .nav > .gt_cls, .side-menu-col1 > .nav > .gt_cls").removeClass("active"),$(".col1 > .nav > .gt > #gt_sr , .side-menu-col1 > .nav > .gt > #gt_sr").parent().addClass("active"),$(".col1 > .nav > .gt > #gt_sr , .side-menu-col1 > .nav > .gt > #gt_sr").parent().show()),showClsTabsOnSerTabClicked())},showClsTabsOnSerTabClicked=function(){_disabledTabs&&_disabledTabs.indexOf("bookClass")!=-1?$(".col1 > .nav > .gt_cls, .side-menu-col1 > .nav > .gt_cls").hide():window.location.pathname.contains("bookappointment")||window.location.pathname.contains("services")||!_.isEmpty(serviceCategoryList)?$(".col1 > .nav > .gt_cls , .side-menu-col1 > .nav > .gt_cls").show():($(".col1 > .nav > .gt_cls , .side-menu-col1 > .nav > .gt_cls").show(),$("#gt_cls").trigger("click")),_disabledTabs&&_disabledTabs.indexOf("classes")==-1&&$(".col1 > .nav > .cls , .side-menu-col1 > .nav > .cls").show()},showSerTabsOnClsTabClicked=function(){_disabledTabs&&_disabledTabs.indexOf("bookAppt")!=-1?$(".col1 > .nav > .gt > #gt_sr , .side-menu-col1 > .nav > .gt > #gt_sr").parent().hide():$(".col1 > .nav > .gt > #gt_sr , .side-menu-col1 > .nav > .gt > #gt_sr").parent().show(),_disabledTabs&&_disabledTabs.indexOf("services")==-1&&$(".col1 > .nav .srvs, .side-menu-col1 > .nav .srvs").show()},disPrgrsIcon=function(e){ele=$("#progress-icon"),"classes"==e&&(ele=$("#class_progress-icon")),ele.mouseenter(function(){$(this).addClass("icon-arrow-left")}).mouseleave(function(){$(this).removeClass("icon-arrow-left")})},clsPrgrs=function(){$("#class_progress-icon").off("click").on("click",function(){validateAndFormatPhNo("#class_cust-PhoneNo"),$("#class_progress-icon").hasClass("clsLst")?("true"!=_isSkipStaff&&null==staffResourceInfo?($("#classes-tab").removeClass("clsPro").addClass("clsLst"),$(".class_provider > .class_step-li").removeClass("active"),$("#chs_class_act").show(),$(".class_step_tab > h2").html(choose_a_ser+" "+_customizedClassName)):($("#classes-tab").removeClass("clsDt").addClass("clsLst"),$(".class_date > .class_step-li").removeClass("class_done").removeClass("active")),$(".class > .class_step-li").removeClass("class_done")):$("#class_progress-icon").hasClass("clsPro")?($("#classes-tab").removeClass("clsDt").addClass("clsPro"),$(".class_provider > .class_step-li").removeClass("class_done"),$(".class_date > .class_step-li").removeClass("class_done").removeClass("active"),"null"===rescheduleClassKey&&"null"===selectedClassKey||(_classBookingDetails.classKey=getClassKeyFromRequest(),reqClsRes(_classBookingDetails.classKey))):$("#class_progress-icon").hasClass("clsDt")?("true"!=_isSkipStaff&&null==staffResourceInfo?$("#classes-tab").removeClass("clsInfo").addClass("clsDt"):($("#classes-tab").removeClass("clsInfo").addClass("clsDt"),$(".class_date > .class_step-li").removeClass("class_done").removeClass("active")),$(".class_date > .class_step-li").removeClass("class_done").removeClass("active"),$(".class_info > .class_step-li").removeClass("active"),$(".class_info").addClass("pointer_events")):$("#class_progress-icon").hasClass("signInFrm")?($("#classes-tab").removeClass("signInFrm").addClass("clsDt"),$(".class_date > .class_step-li").removeClass("class_done").removeClass("active")):$("#class_progress-icon").hasClass("skipForm")?($("#classes-tab").removeClass("skipForm").addClass("clsDt"),$(".class_date > .class_step-li").removeClass("class_done").removeClass("active"),$(".class_info > .class_step-li").removeClass("class_done").removeClass("active"),$(".class_info").addClass("pointer_events")):$("#class_progress-icon").hasClass("clsInfo")&&($("#classes-tab").removeClass("clsCon").addClass("clsInfo"),$(".class_info > .class_step-li").removeClass("class_done").removeClass("active")),$("#class-payments-info-holder").is(":visible")&&($("#class-payments-info-holder").hide(),removePaymentView("class")),animateProgressBar("class"),showCurClsSts()})},serPrgrs=function(){$("#progressStatus").off("click",".serviceIcon").on("click",".serviceIcon",function(){serSt()}),$("#progressStatus").off("click",".providerIcon").on("click",".providerIcon",function(){proSt()}),$("#progressStatus").off("click",".appt_dateIcon").on("click",".appt_dateIcon",function(){appDateSt()}),$("#progressStatus").off("click",".infoIcon").on("click",".infoIcon",function(){infoSt()}),$("#service-back").off("click").on("click",function(){$("#service-back").hasClass("back-to-service")&&($("#service-back").addClass("hide"),serSt()),$("#service-back").hasClass("back-to-provider")&&proSt(),$("#service-back").hasClass("back-to-datePicker")&&appDateSt(),$("#service-back").hasClass("back-to-info")&&infoSt()})},clkSerNavBar=function(){$(".nav").off("click","#services-tab").on("click","#services-tab",function(){$(".classes-container").hide(),$(".service-container").show(),$("#services-tab").parent().addClass("active"),$("#classes-tab").parent().removeClass("active"),bkPolicy("ser"),showCurSerSts()})},clkSer=function(){$("#chs_service_act").off("click","ul > li").on("click","ul > li",function(e){return e.stopPropagation(),e.preventDefault(),$(".Go-back").hasClass("active")&&$(".Go-back").removeClass("active"),e.handled!==!0&&(aftrSelectService(this),void(e.handled=!0))}),0==window.isMobile.matches&&$("#chs_service_act").off("mouseover","ul  li").on("mouseover","ul  li",function(){$(this).find("p").hasClass("srDesc")&&(showDetailedDes(this),offsetDescPopup())}).off("mouseout","ul  li").on("mouseout","ul  li",function(){hideDetailedDes(this)})},aftrSelectService=function(e){if(selectedServicesKeys=[],1==_isMultiSer&&"true"!=isReschedulePage&&Object.keys(serviceCategoryList).length>1?getResKeyForMultiSer(e,"Services"):getResources(e),isWixApp){var s=$("#sp_act").height();wixHeightGenerator(s)}},clkSerRes=function(){$("#sp_act").off("click","ul > li").on("click","ul > li",function(e){return e.stopPropagation(),e.preventDefault(),$(".Go-back").hasClass("active")&&$(".Go-back").removeClass("active"),e.handled!==!0&&(1==_isMultiSer&&"true"!=isReschedulePage&&Object.keys(serviceCategoryList).length>1?getResKeyForMultiSer(this,"Resources"):showTimings(this),void(e.handled=!0))}),window.isMobile.matches||$("#sp_act").off("mouseover","ul > li").on("mouseover","ul > li",function(){showDetailedDes(this),offsetDescPopup()}).off("mouseout","ul > li").on("mouseout","ul > li",function(){hideDetailedDes(this)})},clkSerTimeSlt=function(){$(".time_sheet").off("click","a").on("click","a",function(){$(".gt_act").addClass("timeslot_tab").removeClass("service_tab").removeClass("provider_tab"),$("#sign_out").removeClass("providerSelected").addClass("timeSlotsSelected"),resourceKey=$(this).attr("resourceKey"),resourceKeySelected=resourceKey;var e=parseInt(clientDate.getMonth()),s=monthsInOtherLang(_months[e]),t=clientDate.getDate()+" "+s+" "+clientDate.getFullYear()+"  "+lang.at+" "+$(this).html();_startDate=new Date(clientDate.getDate()+" "+_months[e]+" "+clientDate.getFullYear()+" "+$(this).html());var a=$(this).html();if("12 Hours"==customerInfo.timeFormat&&0+a<"12:00"&&null!=a.match(/\s(.*)$/)&&(a=convertTimeFormat(a)),$(".service-container #cust-countryCode, .classes-container #class_cust-countryCode").attr("placeholder",""),_enabledCustLocalTimeZone){var i=FormatDate(clientDate,"%m/%d/%y");null!=bookingSettings?getDateTZByCompany($(this).attr("data-company_time")):$.ajax({type:"GET",url:"/convertSlotToCompanyTZ",data:"selectedSlot="+a+"&selectedDate="+i+"&selectedTZ="+_selectedTimeZone+"&companyTZ="+companyDetails.timezone,success:function(e){getDateTZByCompany(e)}})}setTimeout(function(){$(".service-container #cust-IName").focus(),$(".service-container #cust-continue").css({"background-color":"#11c3bc"}),$(".service-container #cust-continue").css({color:"#fff"})},100),$("#appt_date").find("span.step-li").attr("class","done step-li"),$("#appt_date").find("span.step-li").attr("title",t),$(".info").removeClass("pointer_events"),timingSelected=$(this).html(),$("#dateCont").hide(),chkShrtBp(),$(".bottomclass").hasClass("hide")&&$(".bottomclass").removeClass("hide"),chkCusLogin("service-container"),$(".service-container .customer-details-list > li > .input-profile-fields").hasClass("inputError")&&$(".service-container .customer-details-list > li > .input-profile-fields").removeClass("inputError"),$("#service-back").removeClass("back-to-service").removeClass("back-to-provider").addClass("back-to-datePicker"),$(".mobile-navbar").removeClass("active"),$(".info > span.step-li").addClass("active"),$(".info > span.mobile-navbar").addClass("active"),$("#contact_col").show(),$(".service-container .yourinfo").show(),null!=rescheduleResourceInfo&&($(".service-container .customer-login-form").show(),$(".service-container .customerImg").hide()),$(".service-container .continue").hasClass("normalLogin")?($(".service-container .customer-login-form").show(),
$(".service-container .customerImg").hide(),$(".service-container .customer-details-list").css({"margin-top":"0px"}),$("#services-tab").removeClass("srLst").removeClass("srPro").removeClass("srDt").removeClass("srCon").removeClass("srBkd").removeClass("signInFrm").addClass("srInfo")):$(".service-container .continue").hasClass("socialLogin")&&($(".signUp").hide(),$("#login").addClass("hidded"),$(".service-container .customerLoginContainer").addClass("signActive")),$("#progress-icon").removeClass("providerIcon").removeClass("serviceIcon").addClass("appt_dateIcon"),$(".signIn").hasClass("active")&&($(".info").addClass("pointer_events"),$(".info > span").removeClass("active")),isWixApp&&wixStepTabCustomerForm($(".customer-login-form").height()+$("#company_name").height()),animateProgressBar(),reschCusInfo(),$(".login_details").is(":visible")||loginFormPadding()})},loginFormPadding=function(){1==window.isMobile.matches?$(".customerLoginContainer").addClass("addPaddingTop").removeClass("removePaddingTop"):$(".customerLoginContainer").addClass("removePaddingTop").removeClass("addPaddingTop")},getDateTZByCompany=function(e){var s=e.split("/")[2],t=s.split(" ")[1];s=s.split(" ")[0],_timeInCmpTZ=new Date(e.split("/")[0]+" "+e.split("/")[1]+" "+(s+" "+t)),_companyTZ=e.split(" ")[2]},updateSer=function(){$("#class_cust-PhoneNo").val(_serCusObj.custPhoneNum),$("#class_cust-Address").val(_serCusObj.cusAddress),$("#class_cust-City").val(_serCusObj.cusCity),$("#class_cust-State").val(_serCusObj.cusState),$("#class_cust-Zip").val(_serCusObj.cusZip);var e=_serCusObj.custAdditionalFields.split("smspace");""==e[0]&&e.shift();for(var s=0;s<e.length;s++)$("#class_custAdditionalFields_"+s).val(e[s])},clkCusSerCon=function(){$(".service-container").off("click","#cust-continue").on("click","#cust-continue",function(){validateAndFormatPhNo("#cust-PhoneNo");try{custFirstName="",custLastName="",custPhoneNum="",custExt="",cusEmail="",cusAddress="",cusCity="",cusState="",cusZip="",cusComments="",cusProfile="",$("#service-back").addClass("back-to-info").removeClass("back-to-datePicker").removeClass("back-to-provider"),$("#sign_out").addClass("continueBtn").removeClass("timeSlotsSelected"),$(".signIn").removeClass("active"),$("#sc_act > div.list_dtl").hide(),$(".confirmation  > div.list_dtl").show(),$("#progress-icon").removeClass("serviceIcon").removeClass("appt_dateIcon").addClass("infoIcon"),chkShrtBp();var e=daysInLang(_dys[clientDate.getDay()]),s=monthsInOtherLang(_months[clientDate.getMonth()]),t=0,a=clientDate.getDate();if("Japanese"==language&&(a=a+""+htmlDecode("&#x65e5;")),dateFormatted=e+" "+s+" "+a+", "+clientDate.getFullYear(),_apptCustomerLocalTime=new Date(clientDate.getMonth()+1+"/"+clientDate.getDate()+"/"+clientDate.getFullYear()),validFormFields("service")){fbbdp&&$("#required-feilds-error").html(""),$("#cnfAppt_global_btn2").addClass("fbbdp_cnfApptBtn"),$(".step_tab > h2").html(lang.confirm_your_appt),0==classes.length&&$(".confirm_appt").css({"margin-top":"0px"}),$(".gt_act").addClass("confirmCusDetails_tab").removeClass("timeslot_tab").removeClass("eCusDetails_tab").removeClass("signIn_tab"),$("#services-tab").removeClass("srLst").removeClass("srPro").removeClass("srDt").removeClass("srInfo").removeClass("signInFrm").addClass("srCon");var i=serviceDuration;for(indexServices in serviceCategoryList)serviceCategoryList[indexServices].ServiceName==serviceName&&serviceId==serviceCategoryList[indexServices].key&&0!=serviceCategoryList[indexServices].bufferDuration&&(i=serviceCategoryList[indexServices].Duration-serviceCategoryList[indexServices].bufferDuration);var o=customerInfo.showLabel&&customerInfo.showLabel.indexOf("servicename")!=-1?" - "+i+" "+lang.minutes:"",n="";null==isStaffBookingPage&&null==staffResourceInfo||(_isSkipStaff="true"),n=null!=rescheduleResourceInfo&&null!=resuchduleServicesInfo?"true"==_isSkipStaff?"":"<li><label>"+_customizedProName+":</label><span>"+rescheduleResourceInfo.FirstName+" "+rescheduleResourceInfo.LastName+"</span></li>":"true"==_isSkipStaff?"":"<li><label>"+_customizedProName+":</label><span>"+resourcesList[resourceKey].FirstName+" "+resourcesList[resourceKey].LastName+"</span></li>";var r="";if(_isSkipMultiSer)r+=window.connectService.indexOf(serviceId)!=-1?"<li><label>"+_customizedSerName+":</label><span>"+serviceName+o+' <img alt="" style="top: 2px;width: 14px;position: relative;" src="/bookingpage/images/teleport-icon.png"></span></li>':"<li><label>"+_customizedSerName+":</label><span>"+serviceName+o+"</span></li>";else{var l=selectedServicesKeys.length,c="Service"!=customisedServiceLabel?customisedServiceLabel:"en"!=language?lang.services:"Services";r+="<li><label>"+c+":</label>";for(var d=0;d<l;d++){var m=serviceCategoryList[selectedServicesKeys[d]].Duration;t+=serviceCategoryList[selectedServicesKeys[d]].Cost,0!=serviceCategoryList[selectedServicesKeys[d]].bufferDuration&&(m=serviceCategoryList[selectedServicesKeys[d]].Duration-serviceCategoryList[selectedServicesKeys[d]].bufferDuration);var p=customerInfo.showLabel&&customerInfo.showLabel.indexOf("servicename")!=-1?" - "+m+" "+lang.minutes:"",u=serviceCategoryList[selectedServicesKeys[d]].ServiceName;r+=window.connectService.indexOf(selectedServicesKeys[d])!=-1?"<span>"+u+p+' <img alt="" style="top: 2px;width: 14px;position: relative;" src="/bookingpage/images/teleport-icon.png"></span><br/>':"<span>"+u+p+" </span><br/>",d!=l-1&&(r+="<label>&nbsp;</label>")}r+="</li>"}var h=shortTimeZone;if(_enabledCustLocalTimeZone&&(h=timeZoneObj.localTimeZoneObj.timeZoneShortName,_selectedTimeZone!=timeZoneObj.localTimeZoneObj.timeZoneID))for(var d=0;d<allTimeZones.length;d++)console.log(allTimeZones[d].timeZoneID==_selectedTimeZone),allTimeZones[d].timeZoneID==_selectedTimeZone&&(h=allTimeZones[d].timeZoneShortName);var v="%w %n %d, %y, %H:%M",g=timingSelected;"24 Hours"!=customerInfo.timeFormat&&0+timingSelected<"12:00"&&null!=timingSelected.match(/\s(.*)$/)&&(g=convertTimeFormat(timingSelected),v="%w %n %d, %y, %h:%M %p");var f=g.split(":");_apptCustomerLocalTime=new Date(_apptCustomerLocalTime.setHours(f[0])),_apptCustomerLocalTime=new Date(_apptCustomerLocalTime.setMinutes(f[1]));var y="<li><label>"+lang.dateandtime+':</label><span id="date_time_selected">'+dateFormatted+", "+timingSelected.toLowerCase()+" ("+h+")</span>";"Asia/Kolkata"==_selectedTimeZone&&(_selectedTimeZone="Asia/Calcutta"),_enabledCustLocalTimeZone&&_selectedTimeZone!=timeZoneObj.companyTimeZoneObj.timeZoneID&&(_companyTZ=_companyTZ=_companyTZ,apptDtInLocalTZ=dateFormatted+", "+timingSelected.toLowerCase()+" ("+h+")",apptDtInAcclTZ=FormatDateNew(_timeInCmpTZ,v)+"  ("+_companyTZ+")",y="<li><label>"+lang.dateandtime+':</label><span id="date_time_selected"><label class="localTime">'+lang.your_tz+":</label>"+dateFormatted+", "+timingSelected.toLowerCase()+" ("+h+')</span><li><label> &nbsp; </label><span id="date_time_selected_cmpy"><label class="localTime">'+lang.your_compy_tz+":</label> "+apptDtInAcclTZ+"</span>");var C=r+n+y,_="";timeForPayments=timingSelected;var b=$(".info > span.step-li").html();$(".info > span.step-li").html(b.substr(0,5)),$(".info > span.step-li").attr("class","done step-li"),$(".mobile-navbar").removeClass("active"),$(".info").removeClass("pointer_events"),animateProgressBar(),$(".service-container #sc_act , .service-container .customer-login-form").hide(),$(".confirmation").show();var k=$(".customerlist-MobileNo").hasClass("showFields")?$(".service-container .customerlist-countryCode").html():isIE()?$(".service-container #cust-countryCode").val():$(".service-container #cust-PhoneNo").intlTelInput("getSelectedCountryData").dialCode,D="";_serCusObj.custPhoneNum&&""!=_serCusObj.custPhoneNum&&(D=k?(k.contains("+")?k:"+"+k)+" "+_serCusObj.custPhoneNum:"+"+countryCodeByGoogle+" "+_serCusObj.custPhoneNum),C+="<li><label>"+lang.your_info+":</label><span><ul><li>"+htmlDecode(_serCusObj.custFirstName)+" "+htmlDecode(_serCusObj.custLastName)+"</li><li>"+D+"</li>",_serCusObj.cusEmail&&(C+="<li>"+_serCusObj.cusEmail+"</li>");var w="";_serCusObj.cusAddress&&""!=_serCusObj.cusAddress&&(w+=_serCusObj.cusAddress),_serCusObj.cusCity&&""!=_serCusObj.cusCity&&(w+=""!=w?", "+_serCusObj.cusCity:_serCusObj.cusCity),_serCusObj.cusState&&"null"!=_serCusObj.cusState&&(w+=""!=w?", "+_serCusObj.cusState:_serCusObj.cusState),_serCusObj.cusZip&&"null"!=_serCusObj.cusZip&&(w+=""!=w?", "+_serCusObj.cusZip:_serCusObj.cusZip),""!=w&&(C+="<li>"+htmlDecode(w)+"</li>"),C+="</ul></span></li></ul>";var S=_serCusObj.custAdditionalFields.split("smspace"),I="";if(updateSer(),$.each(S,function(e){if(S[e]&&""!=S[e])if(htmlDecode(S[e]).length>50&&$(".confirm_appt").css("min-height","375px"),htmlDecode(S[e]).length<=90)I+="<li>"+S[e]+"</li>";else{var s=S[e].substring(0,90)+". . .";I+="<li>"+s+"</li>"}_serCusObj.custAdditionalFields=""}),I&&""!=I&&(C+="<li><label>"+lang.other_info+":</label><span><ul>"+I+"</ul></span></li>"),cusComments&&""!=cusComments)if(_serCusObj.cusComments=cusComments,htmlDecode(cusComments).length<=110)C+="<li><label>"+lang.comments+":</label><span>"+cusComments+'</span><div class="clear_all"></div></li>';else{var T=_serCusObj.cusComments.substring(0,110)+". . .";C+="<li><label>"+lang.comments+":</label><span>"+T+'</span><div class="clear_all"></div></li>'}else C+="<li></li>";if(($(".service-container #cust-continue").hasClass("normalLogin")||$(".service-container  #cust-continue").hasClass("socialLogin"))&&("true"==companyDetails.haveTextReminderEnabled&&"true"==companyDetails.haveEmailReminderEnabled?_serCusObj.custPhoneNum&&_serCusObj.cusEmail?_+='<li id="confirm_remainder" class="emailAndSMSReminder"><label class="reminder-title">'+lang.reminder+':</label><span><input type="checkbox" checked="checked" id="message_remainder_check"><label for="message_remainder_check" class="checkbox_label">'+lang.send_email_sms_reminder+"</label></span></li>":_serCusObj.custPhoneNum?_+='<li id="confirm_remainder" class="SMSReminder"><label class="reminder-title">'+lang.reminder+':</label><span><input type="checkbox" checked="checked" id="message_remainder_check"><label for="message_remainder_check" class="checkbox_label">'+lang.send_sms_reminder+"</label></span></li>":_serCusObj.cusEmail&&(_+='<li id="confirm_remainder" class="emailReminder"><label class="reminder-title">'+lang.reminder+':</label><span><input type="checkbox" checked="checked" id="message_remainder_check"><label for="message_remainder_check" class="checkbox_label">'+lang.send_email_reminder+"</label></span></li>"):"true"==companyDetails.haveTextReminderEnabled&&"true"!=companyDetails.haveEmailReminderEnabled?_serCusObj.custPhoneNum&&(_+='<li id="confirm_remainder" class="SMSReminder"><label class="reminder-title">'+lang.reminder+':</label><span><input type="checkbox" checked="checked" id="message_remainder_check"><label for="message_remainder_check" class="checkbox_label">'+lang.send_sms_reminder+"</label></span></li>"):"true"==companyDetails.haveEmailReminderEnabled&&"true"!=companyDetails.haveTextReminderEnabled&&_serCusObj.cusEmail&&(_+='<li id="confirm_remainder" class="emailReminder"><label class="reminder-title">'+lang.reminder+':</label><span><input type="checkbox" checked="checked" id="message_remainder_check"><label for="message_remainder_check" class="checkbox_label">'+lang.send_email_reminder+"</label></span></li>")),$(".global_btn2_lt").show(),$(".bookAnotherAppt").hide(),$(".socialButtonLineAndShare").hide(),$(".confirm_appt").show(),$(".gdpr_info_container").show(),animateProgressBar(),$("#confirm_ul").html(C),$("#view_more_reminderCheck").html(_),$(".confirm_appt").removeClass("show-more-content-btn"),$("#message_remainder_check").unbind("click").click(function(e){$(this).is(":checked")?window.smsStatus="true":window.smsStatus="false"}),$(".confirm > .mobile-navbar").addClass("active"),1==selectedServicesKeys.length&&null!=PaymentBookingPolicy&&1==PaymentBookingPolicy.isPaymentEnabled&&"square"==PaymentBookingPolicy.gateWayType&&null==rescheudleAppointmentInfo&&(serviceCategoryList[serviceKey].Cost>.5||t>.5)?($("#pageBlock").css("height",$("body").height()),$("#pageBlock, #loading_set, #loading_set #setmore_loading_icon").show(),apptDtlsBefrSave("pymt",PaymentBookingPolicy),$(".gdpr_info_container").hide(),$("#services-tab").removeClass("srCon").removeClass("skipForm").addClass("srPay")):selectedServicesKeys.length>=1&&null!=PaymentBookingPolicy&&1==PaymentBookingPolicy.isPaymentEnabled&&null==rescheudleAppointmentInfo&&(serviceCategoryList[serviceKey].Cost>.5||t>.5)&&($("#pageBlock").css("height",$("body").height()),$("#pageBlock, #loading_set, #loading_set #setmore_loading_icon").show(),apptDtlsBefrSave("pymt",PaymentBookingPolicy),$(".gdpr_info_container").hide(),$("#services-tab").removeClass("srCon").removeClass("skipForm").addClass("srPay")),isWixApp){var L=$(".confirm_appt").height();wixHeightGenerator(L)}}else{if(fbbdp){var A=lang.required_field_error;$("#required-feilds-error").html('<li style="list-style: none; color: #ff0000 !important; text-align: center !important;"> <image src="/bookingpage/images/alert-icon-bkpage.svg" class="alert-icon-bkpage" style="vertical-align: middle;"></image> <span style="vertical-align: middle;margin-left: 2px;">'+A+":</span></li>")}changeLabelWidth()}}catch(P){showFailureMessage("jserror","",P)}})},cancellationPolicy=function(){var e="";if(_canclPlcyHrs&&"Anytime"!=_canclPlcyHrs){$(".custom-cancellation-policy").show();var s="";s="Never"==_canclPlcyHrs?lang.no_cancel_or_resch_once_appt:"168"==_canclPlcyHrs?lang.no_cancel_or_resch_1wk_appt:"336"==_canclPlcyHrs?"No cancellation or rescheduling is permitted within 2 weeks of the appointment time":lang.no_canel_or_resch_within+" "+_canclPlcyHrs+" "+lang.hours_appt_time,e+='<div class="appointmentMsg">'+s+"</div>",e+='<li class="agreeCancellationPolicyTerms"><div class="agreecancellationpolicy"><input id="acceptCancellationPolicyTerms" type="checkbox" /><p class="cancellation-terms">'+lang.agree_cancellation_policy+"</p></div>",e+='<li class="errorMsg">'+lang.plz_agree_cancellation_policy+"</li>"}else $(".custom-cancellation-policy").hide();return e},addTermNcondService=function(){var e="";if(bookingPageSettings&&bookingPageSettings.termsNCond&&""!=bookingPageSettings.termsNCond){$(".TnCBP").show();var s=bookingPageSettings.termsNCond;if(s.indexOf("http")!==-1||s.indexOf("https")!==-1||s.indexOf("://")!==-1||(s="http://"+s),bookingPageSettings.termsNCondLabel&&""!=bookingPageSettings.termsNCondLabel){var t=bookingPageSettings.termsNCondLabel,a="<a href='"+s+'\' target="_blank" id="cus" class="label-link"> '+t+" </a>";e+='<li class="agreeCancellationPolicyTerms"><div class="agreecancellationpolicy"><input id="TnCcheckbox" type="checkbox" /> '+a+"</div>",e+='<li class="TnCErr">'+lang.plz_agree_terms+"</li>"}else{var a=" "+lang.I_agree_the+" <a href='"+s+'\' target="_blank"> '+lang.terms_conditions+" </a>";e+='<li class="agreeCancellationPolicyTerms"><div class="agreecancellationpolicy"><input id="TnCcheckbox" type="checkbox" /> '+a+"</div>",e+='<li class="TnCErr">'+lang.plz_agree_terms+"</li>"}}return e},addTermNcondClass=function(){var e="";if(bookingPageSettings&&bookingPageSettings.termsNCond&&""!=bookingPageSettings.termsNCond){$(".TnCBP").show();var s=bookingPageSettings.termsNCond;if(s.indexOf("http")!==-1||s.indexOf("https")!==-1||s.indexOf("://")!==-1||(s="http://"+s),bookingPageSettings.termsNCondLabel&&""!=bookingPageSettings.termsNCondLabel){var t=bookingPageSettings.termsNCondLabel,a="<a href='"+s+'\' target="_blank" id="cus"> '+t+" </a>";e+='<li class="agreeCancellationPolicyTerms"><div class="agreecancellationpolicy"><input id="TnCcheckboxClass" type="checkbox" /> '+a+"</div>",e+='<li class="TnCErr">'+lang.plz_agree_terms+"</li>"}else{var a=" "+lang.I_agree_the+" <a href='"+s+'\' target="_blank"> '+lang.terms_conditions+" </a>";e+='<li class="agreeCancellationPolicyTerms"><div class="agreecancellationpolicy"><input id="TnCcheckboxClass" type="checkbox" /> '+a+"</div>",e+='<li class="TnCErr">'+lang.plz_agree_terms+"</li>"}}return e},bkAppt=function(){$(".global_btn2_rt").off("click").on("click",function(){$("#pageBlock").css("height",$("body").height()),$("#pageBlock, #loading_set, #loading_set #setmore_loading_icon").show(),$("#service-back").removeClass("back-to-info").removeClass("back-to-datePicker").addClass("hide"),$(".gdpr_info_container").hide(),apptDtlsBefrSave("nrml")})},apptDtlsBefrSave=function(e,s){"pymt"==e?$(".col1 #gt_sr, .side-menu-col1 #gt_sr").removeClass("confirmCusDetails_tab").addClass("payappt_tab"):($("#progress-icon").hide(),$("#progressStatus").animate({width:"100%"},100).css("overflow","visible"),$(".col1 #gt_sr, .side-menu-col1 #gt_sr").removeClass("confirmCusDetails_tab").addClass("submitapp_tab"),$(".service, .provider, .date, .info ").addClass("pointer_events")),$("#sign_out").addClass("apptBooked"),$(".global_btn2_lt").hide(),cusState=cusState&&cusState?cusState:"",cusZip=cusZip&&cusZip?cusZip:"";var t='{"resourceKey": "'+resourceKey+'","serviceKey": "'+serviceKey+'","selectedDate": "'+selectedDate+'","worktiming": "'+timingSelected+'","comments": "'+$("#comments").val()+'","duration": "'+serviceDuration+'","cust_firstname": "'+custFirstName+',"cust_lastname": "'+custLastName+',"phone": "'+custLastName+'","ph_ext":"'+custExt+'","email":"'+cusEmail+'","addr": "'+cusAddress+'","city": "'+cusCity+'","state": "'+cusState+'","zip": "'+cusZip+'","comments": "'+cusComments+'","cust_additionalFields":"'+custAdditionalFields+'"}';_isMultiSer||(t={isMultipleService:!0,selectedServiceKeys:selectedServicesKeys}),getApptDetails(t,e,s)},clsDtlsBefrSave=function(e,s){"pymt"==e?$("#gt_cls").removeClass("confirmCusDetails_tab").addClass("payappt_tab"):($("#progress-icon").hide(),$("#progressStatus").animate({width:"100%"},100).css("overflow","visible"),$("#gt_cls").removeClass("confirmCusDetails_tab").addClass("submitapp_tab"),$(".classes, .provider, .date, .info ").addClass("pointer_events")),classBookAppt("payment",s)},apptCustomerDetails=function(){for(var e={},s=additionalFields.length,t=0;t<s;t++)if(e[additionalFields[t].toString()]=$(".customerlistAdditionalFields_"+t).hasClass("showFields")?$.trim($(".customerlistAdditionalFields_"+t).html()):htmlEscape($("#custAdditionalFields_"+[t]).val()),$("html").hasClass("translated-ltr")){var a=htmlDecode(e[additionalFields[t].toString()]),i=/<[a-z\/][\s\S]*>/i;i.test(a)&&(e[additionalFields[t].toString()]=htmlEscape($(a).text()))}$.isEmptyObject(e)&&(e="");var o="+"+countryCodeByGoogle;null!=contactFields&&contactFields.indexOf("phone")!=-1||(isIE()?(o=$(".customerlist-MobileNo").hasClass("showFields")?$(".customerlist-countryCode").html().trim():$(".service-container #cust-countryCode").val(),country=countryObject.getIntlCountryData(countryInitial.toLowerCase(),!0,!0,"iso2").iso3):(o=$(".customerlist-MobileNo").hasClass("showFields")&&$(".customerlist-countryCode")&&$(".customerlist-countryCode").html()?$(".customerlist-countryCode").html().trim():$(".service-container #cust-PhoneNo").intlTelInput("getSelectedCountryData").dialCode,country=$(".service-container #cust-PhoneNo").intlTelInput("getSelectedCountryData").iso3)),rescheduleResourceInfo&&resuchduleServicesInfo&&"true"==customerInfo.thirdPartyLogin&&customerInfo.requiredContactFields&&customerInfo.requiredContactFields.indexOf("email")==-1&&(cusEmail=customerEmailId&&"null"!=customerEmailId?customerEmailId:cusEmail),o=o?o.contains("+")?o:"+"+o:"+"+countryCodeByGoogle;var n={customerKey:customerKey?customerKey:"",firstName:custFirstName,lastName:custLastName,mobile:formatPhoneNumber(o,custPhoneNum,country,"e164"),countryCode:o,Country:country,ph_ext:custExt,email:cusEmail,address:cusAddress,city:cusCity,state:cusState,zip:htmlEscape(cusZip),profilePic:cusProfile,password:sPwd?sPwd:"",companyKey:companyKey,loginType:loginType?loginType:"",additionalFields:e};return $(".service-container #cust-continue").hasClass("normalLogin")&&null!=rescheduleResourceInfo&&null!=resuchduleServicesInfo&&(n.profilePic=rescheduleCustomerInfo.CompanyLogoPath?rescheduleCustomerInfo.CompanyLogoPath:""),n},appointmentDetails=function(){var e=new Array,s=selectedServicesKeys.length,t=resourceKeySelected,a=selectedServicesKeys;if(cusComments.length>500&&(cusComments=cusComments.substring(0,500)),a){(null==_startDate||""==_startDate||"null"==_startDate||"string"==typeof _startDate&&(_startDate.contains("undefined")||_startDate.contains("NaN"))||"Invalid Date"==_startDate)&&alert("Something went wrong please try again"),_enabledCustLocalTimeZone&&_timeInCmpTZ&&(_startDate=_timeInCmpTZ,_apptCustomerLocalTime=FormatDate(_apptCustomerLocalTime,"%y%m%d%H%M"));var i=FormatDate(_startDate,"%d %n %y %h:%M %p"),o=_startDate.toString(),n=FormatDate(_startDate,"%n %d, %y %h:%M:%S %P"),r=60*_startDate.getHours()+_startDate.getMinutes(),l=_startDate.getTime(),c=appointmentReminderTime&&"null"!=appointmentReminderTime?appointmentReminderTime:0,d=appointmentReminderTimeStaff?appointmentReminderTimeStaff:0,m=60*+c*1e3+companyTimeZoneOffset,p=60*+d*1e3+companyTimeZoneOffset,u="No Label",h=r+parseInt(serviceCategoryList[a[0]].Duration),v=new Date(_startDate);_endDate=v,_endDate.setHours(h/60),_endDate.setMinutes(h%60);var g=_endDate.toString(),f=FormatDate(_endDate,"%n %d, %y %h:%M:%S %P"),y=FormatDate(_endDate,"%d %n %y %h:%M %p"),C=_endDate.getTime(),_=a[0],b={startDate:i,startTime:r,endTime:h,endDate:y,startTimeLong:l,endTimeLong:C,resourceKey:t,serviceKey:_,serviceName:serviceCategoryList[a[0]].ServiceName,serviceDuration:serviceCategoryList[a[0]].Duration,From_date:n,To_date:f,reminderValue:m,reminderValueStaff:p,comments:cusComments,AptStartDate:o,AptEndDate:g,appointmentLabel:u,bufferDuration:null!=serviceCategoryList[a[0]].bufferDuration&&""!=serviceCategoryList[a[0]].bufferDuration?serviceCategoryList[a[0]].bufferDuration:0,cost:null!=serviceCategoryList[a[0]].Cost&&""!=serviceCategoryList[a[0]].Cost?serviceCategoryList[a[0]].Cost:0,apptStartTimeStr:new Date(i).toISOString(),apptEndTimeStr:new Date(y).toISOString()};_enabledCustLocalTimeZone&&(""==_selectedTimeZone&&timeZoneObj.companyTimeZoneObj.timeZoneID!=timeZoneObj.localTimeZoneObj.timeZoneID?(b.customerLocalTime=_apptCustomerLocalTime,b.customerTimeZone=_selectedTimeZone?_selectedTimeZone:timeZoneObj.localTimeZoneObj.timeZoneID):timeZoneObj.companyTimeZoneObj.timeZoneID!=_selectedTimeZone&&(b.customerLocalTime=_apptCustomerLocalTime,b.customerTimeZone=_selectedTimeZone?_selectedTimeZone:timeZoneObj.localTimeZoneObj.timeZoneID)),e.push(b);var s=a.length;if(s>1)for(var $=1;$<s;$++){var k=FormatDate(_endDate,"%d %n %y %h:%M %p"),o=_endDate.toString(),n=FormatDate(_endDate,"%n %d, %y %h:%M:%S %P"),D=60*_endDate.getHours()+_endDate.getMinutes(),l=_endDate.getTime(),u="No Label",w=D+parseInt(serviceCategoryList[a[$]].Duration),S=_endDate;S.setHours(w/60),S.setMinutes(w%60);var g=S.toString(),f=FormatDate(_endDate,"%n %d, %y %h:%M:%S %P"),I=FormatDate(S,"%d %n %y %h:%M %p"),C=S.getTime(),T="";_enabledCustLocalTimeZone&&(""==_selectedTimeZone&&timeZoneObj.companyTimeZoneObj.timeZoneID!=timeZoneObj.localTimeZoneObj.timeZoneID?T=_selectedTimeZone?_selectedTimeZone:timeZoneObj.localTimeZoneObj.timeZoneID:timeZoneObj.companyTimeZoneObj.timeZoneID!=_selectedTimeZone&&(T=_selectedTimeZone?_selectedTimeZone:timeZoneObj.localTimeZoneObj.timeZoneID)),e.push({startDate:k,startTime:D,endTime:w,endDate:I,startTimeLong:l,endTimeLong:C,resourceKey:t,serviceKey:serviceCategoryList[a[$]].key,serviceName:serviceCategoryList[a[$]].ServiceName,serviceDuration:serviceCategoryList[a[$]].Duration,From_date:n,To_date:f,reminderValue:m,reminderValueStaff:p,comments:cusComments,AptStartDate:o,AptEndDate:g,appointmentLabel:u,bufferDuration:null!=serviceCategoryList[a[$]].bufferDuration&&""!=serviceCategoryList[a[$]].bufferDuration?serviceCategoryList[a[$]].bufferDuration:0,cost:null!=serviceCategoryList[a[$]].Cost&&""!=serviceCategoryList[a[$]].Cost?serviceCategoryList[a[$]].Cost:0,customerTimeZone:T,apptStartTimeStr:new Date(k).toISOString(),apptEndTimeStr:new Date(I).toISOString()})}}return e},getApptDetails=function(e,s,t){try{var a=apptCustomerDetails(),i=appointmentDetails(),o={companyKey:companyKey,customer:a,appointments:i};"nrml"==s&&(o.isPaymentEnabled="continue-to-pay"==$(this).attr("id")),null!=rescheduleResourceInfo&&null!=resuchduleServicesInfo&&(o.appointmentKey=appointmentKey,o.customerKey=rescheduleCustomerInfo.key,o.cancellationKey=rescheudleAppointmentInfo.cancelAppointmentKey);var n="",r="";null!=contactFields&&contactFields.indexOf("phone")!=-1||(n=$("#cust-PhoneNo").val()?$("#cust-PhoneNo").val().trim():$(".customerlist-PhoneNo").html()?$(".customerlist-PhoneNo").html().trim():""),null!=contactFields&&contactFields.indexOf("email")!=-1||(r=$("#cust-IEmailId").val()?$("#cust-IEmailId").val().trim():$(".customerlist-emailId").html()?$(".customerlist-emailId").html().trim():""),haveTextReminderEnabled="true",haveEmailReminderEnabled="true",0==!$("#message_remainder_check").length&&($("#message_remainder_check").is(":checked")||($("#confirm_remainder").hasClass("emailAndSMSReminder")?(haveTextReminderEnabled="false",haveEmailReminderEnabled="false"):$("#confirm_remainder").hasClass("emailReminder")?haveEmailReminderEnabled="false":$("#confirm_remainder").hasClass("SMSReminder")&&(haveTextReminderEnabled="false"))),o.haveTextReminderEnabled=haveTextReminderEnabled,o.haveEmailReminderEnabled=haveEmailReminderEnabled,o.haveEmailReminderEnabledStaff=haveEmailReminderEnabledStaff,o.haveTextReminderEnabledStaff=haveTextReminderEnabledStaff,o.connectStatus=window.connectService.indexOf(i[0].serviceKey)!=-1,o.isVideoEnabled=o.connectStatus;var l=new Array;l.push(o),saveAppointment(l,s,t)}catch(c){showFailureMessage("jserror","",c)}},clkClsNavBar=function(){$(".nav").off("click","#classes-tab").on("click","#classes-tab",function(){$(".classes-container .loading_icon_timings").show(),$(".service-container").hide(),$(".classes-container").show(),$("#classes-tab").parent().addClass("active"),$("#services-tab").parent().removeClass("active"),$(".class").removeClass("pointer_events"),$(".col1 > .nav > .gt_cls , .side-menu-col1 > .nav > .gt_cls").show(),bkPolicy("cls"),showCurClsSts()})},clkCls=function(){$("#chs_class_act").off("click","ul > li").on("click","ul > li",function(){afterSelectingClass(this)}),window.isMobile.matches||$("#chs_class_act").off("mouseover","ul > li").on("mouseover","ul > li",function(){$(this).find("p").hasClass("clsDesc")&&(showDetailedDes(this),offsetDescPopup())}).off("mouseout","ul > li").on("mouseout","ul > li",function(){hideDetailedDes(this)})},afterSelectingClass=function(e){if(getClassResources(e),isWixApp){var s=$("#sp_act").height();wixHeightGenerator(s)}},clkClsRes=function(){$("#class_provider").off("click","ul > li").on("click","ul > li",function(){showClsTimingsForRes(this,"nbp")}),window.isMobile.matches||$("#class_provider").off("mouseover","ul > li").on("mouseover","ul > li",function(){showDetailedDes(this),offsetDescPopup()}).off("mouseout","ul > li").on("mouseout","ul > li",function(){hideDetailedDes(this)})},clkClsTimeSlt=function(){$(".class_sessions_sheet").off("click","a").on("click","a",function(){var e=$(this).attr("appointmentKey");_classBookingDetails.classApptKey=e,_classBookingDetails.sessionCompanyTime=$(this).attr("sessionCompTime"),$("#classDateCont").hide(),$("#class_appt_date").find("span.class_step-li").attr("class","class_done class_step-li"),$("#class_appt_date").find("span.class_step-li").attr("title",a),$(".class_info").removeClass("pointer_events"),$(".chng-cls-tz").hide(),animateProgressBar("class"),$("#classes-tab").removeClass("clsLst").removeClass("clsPro").removeClass("clsDt").addClass("clsInfo"),$("#class_progress-icon").removeClass("clsLst").removeClass("clsPro").addClass("clsDt"),$("#class-back").removeClass("back-to-classes").removeClass("back-to-classProvider").addClass("back-to-classDatePicker"),$(".bottomclass").hasClass("hide")&&$(".bottomclass").removeClass("hide"),chkCusLogin("classes-container"),_classBookingDetails.classDate=$(this).html();var s=parseInt(clientDate.getMonth()),t=monthsInOtherLang(_months[s]),a=clientClassDate.getDate()+" "+t+" "+clientClassDate.getFullYear()+" "+lang.at+" "+$(this).html();if(setTimeout(function(){$(".classes-container #class_cust-IName").focus(),$(".classes-container #cust-continue").css({"background-color":"#11c3bc"}),$(".classes-container #cust-continue").css({color:"#fff"})},100),chkShrtBp(),$("#classDateCont").hide(),$("#contact_col").show(),$(".mobile-navbar").removeClass("active"),$(".class_info > span.class_step-li").addClass("active"),$(".class_info > span.mobile-navbar").addClass("active"),$(".classes-container #class_cust-countryCode").attr("placeholder",""),$(".signIn").hasClass("active")&&($(".class_info").addClass("pointer_events"),$(".class_info > span").removeClass("active"),$(".classes-container #sc_act").hide(),$(".classes-container .customer-login-form").hide(),isWixApp)){var i=$(".classes-container").height()+$("#company_name").height();wixHeightGenerator(i)}reschCusInfo(),loginFormPadding()})},updateCls=function(){$("#cust-PhoneNo").val(_clsCusObj.custPhoneNum),$("#cust-Address").val(_clsCusObj.cusAddress),$("#cust-City").val(_clsCusObj.cusCity),$("#cust-State").val(_clsCusObj.cusState),$("#cust-Zip").val(_clsCusObj.cusZip);var e=_clsCusObj.custAdditionalFields.split("smspace");""==e[0]&&e.shift();for(var s=0;s<e.length;s++)$("#custAdditionalFields_"+s).val(e[s])},clkCusClsCon=function(){$(".classes-container #sc_act .customer-login-form ").off("click","#cust-continue").on("click","#cust-continue",function(){validateAndFormatPhNo("#class_cust-PhoneNo"),custFirstName="",custLastName="",custPhoneNum="",custExt="",cusEmail="",cusAddress="",cusCity="",cusState="",cusZip="",cusProfile="",$("#sc_act > div.list_dtl").hide(),$(".class_confirmation  > div.list_dtl").show(),chkShrtBp();var e=monthsInOtherLang(_months[clientClassDate.getMonth()]),s=daysInLang(_dys[clientClassDate.getDay()]);if(dateFormatted=s+" "+e+" "+clientClassDate.getDate()+", "+clientClassDate.getFullYear(),validFormFields("classes")){var t="",a="",i="";$("#classes-tab").removeClass("clsLst").removeClass("clsPro").removeClass("clsDt").removeClass("clsInfo").removeClass("signInFrm").removeClass("skipForm").addClass("clsCon"),$("#class_progress-icon").removeClass("clsLst").removeClass("clsPro").removeClass("clsDt").removeClass("signInFrm").removeClass("skipForm").addClass("clsInfo"),$(".classes-container #sc_act").hide(),$(".classes-container .customer-login-form").hide(),$(".class_step_tab > h2").html(lang.confirm_your_appt),$("#class-back").removeClass("back-to-classes").removeClass("back-to-classProvider").removeClass("back-to-classDatePicker").addClass("back-to-classCustInfo");for(var o=(classes.length,0);o<classes.length;o++)_classBookingDetails.classKey==classes[o].key&&(t=classes[o].duration,_classBookingDetails.className=classes[o].title);if(getVideoLinkEnabled(_classBookingDetails.classApptKey),a=t&&customerInfo.showLabel&&customerInfo.showLabel.indexOf("servicename")!=-1?" - "+t+" "+lang.minutes:"",null==isStaffBookingPage&&null==staffResourceInfo||(_isSkipStaff="true"),null!=rescheduleResourceInfo&&null!=resuchduleServicesInfo)i="true"==_isSkipStaff?"":"<li><label>"+_customizedProName+":</label><span>"+rescheduleResourceInfo.FirstName+" "+rescheduleResourceInfo.LastName+"</span></li>";else{var n=resourceMap;i="true"==_isSkipStaff?"":"<li><label>"+_customizedProName+":</label><span>"+n[_classBookingDetails.resourceKey].FirstName+" "+n[_classBookingDetails.resourceKey].LastName+"</span></li>"}var r="Classes"!=customisedClassLabel?customisedClassLabel:"en"!=language?lang.Class:"CLASS";if(_classBookingDetails.isVideoEnabled)var l="<li><label>"+r+":</label><span>"+_classBookingDetails.className+a+'<img alt="" style="left: 5px;width: 14px;position: relative;" src="/bookingpage/images/teleport-icon.png"></span></li>'+i;else var l="<li><label>"+r+":</label><span>"+_classBookingDetails.className+a+"</span></li>"+i;
var c="<li><label>"+lang.dateandtime+':</label><span id="date_time_selected">'+dateFormatted+", "+_classBookingDetails.classDate+" ("+shortTimeZone+")</span>",d=shortTimeZone;if(_enabledCustLocalTimeZone){for(var o=0;o<allTimeZones.length;o++)allTimeZones[o].timeZoneID==EventResources.classTimeZoneId&&(d=allTimeZones[o].timeZoneShortName,_selectedClassTZFUllName=allTimeZones[o].timeZoneFullName);if(EventResources.classTimeZoneId!=timeZoneObj.companyTimeZoneObj.timeZoneID){var m="24 Hours"==customerInfo.timeFormat?"ddd MMM D, YYYY, HH:mm":"ddd MMM D, YYYY, h:mm a";_classBookingDetails.classCompanyTZDate=moment(parseInt(_classBookingDetails.sessionCompanyTime)).tz(getTimeZone(companyDetails.timezone)).format(m)+" ("+shortTimeZone+")",_classBookingDetails.classLocalTZDate=dateFormatted+", "+_classBookingDetails.classDate+" ("+d+")",c="<li><label>"+lang.dateandtime+':</label><span id="date_time_selected"><label class="localTime">'+lang.your_tz+":</label>"+_classBookingDetails.classLocalTZDate+'</span><li><label> &nbsp; </label><span id="date_time_selected_cmpy"><label class="localTime">'+lang.your_compy_tz+":</label> "+_classBookingDetails.classCompanyTZDate+"</span>"}}l+=c;var p=$(".class_info > span.class_step-li").html();$(".class_info > span.class_step-li").html(p.substr(0,5)),$(".class_info > span.class_step-li").attr("class","class_done class_step-li"),$(".mobile-navbar").removeClass("active"),$(".class_info").removeClass("pointer_events"),animateProgressBar("class"),$(".class_confirmation").show();var u=$(".classes-container .customerlist-MobileNo").hasClass("showFields")?$(".classes-container .customerlist-countryCode").html():isIE()?$("#class_cust-countryCode").val():$(".classes-container #class_cust-PhoneNo").intlTelInput("getSelectedCountryData").dialCode;_clsCusObj.custExt=u?u.contains("+")?u:"+"+u:"+"+countryCodeByGoogle;var h=custPhoneNum?_clsCusObj.custExt+" "+custPhoneNum:"",v=countryObject.getIntlCountryData(countryInitial.toLowerCase(),!0,!0,"iso2").iso3;v=$(".classes-container .customerlist-MobileNo").hasClass("showFields")?v:isIE()?v:$(".classes-container #class_cust-PhoneNo").intlTelInput("getSelectedCountryData").iso3,_clsCusObj.country=v,l+="<li><label>"+lang.your_info+":</label><span><ul><li>"+htmlDecode(custFirstName)+" "+htmlDecode(custLastName)+"</li><li>"+h+"</li>",l+=cusEmail&&""!=cusEmail?"<li>"+cusEmail+"</li>":"";var g="";_clsCusObj.cusAddress&&""!=_clsCusObj.cusAddress&&(g+=_clsCusObj.cusAddress),_clsCusObj.cusCity&&""!=_clsCusObj.cusCity&&(g+=""!=g?", "+_clsCusObj.cusCity:_clsCusObj.cusCity),_clsCusObj.cusState&&""!=_clsCusObj.cusState&&(g+=""!=g?", "+_clsCusObj.cusState:_clsCusObj.cusState),_clsCusObj.cusZip&&""!=_clsCusObj.cusZip&&(g+=""!=g?", "+_clsCusObj.cusZip:_clsCusObj.cusZip),""!=g&&(l+="<li>"+g+"</li>"),l+="</ul></span></li></ul>";var f=_clsCusObj.custAdditionalFields.split("smspace"),y="";updateCls(),$.each(f,function(e){if(f[e]&&""!=f[e])if(htmlDecode(f[e]).length>50&&$(".class_confirm_appt").css("min-height","375px"),htmlDecode(f[e]).length<=90)y+="<li>"+f[e]+"</li>";else{var s=f[e].substring(0,90)+". . .";y+="<li>"+s+"</li>"}_clsCusObj.custAdditionalFields=""}),y&&""!=y&&(l+="<li><label>"+lang.other_info+":</label><span><ul>"+y+"</ul></span></li>"),_clsCusObj.cusComments="",($(".classes-container #cust-continue").hasClass("normalLogin")||$(".classes-container  #cust-continue").hasClass("socialLogin"))&&("true"==companyDetails.haveTextReminderEnabled&&"true"==companyDetails.haveEmailReminderEnabled?_clsCusObj.custPhoneNum&&_clsCusObj.cusEmail?l+='<li id="confirm_remainder" class="emailAndSMSReminder" style = "display: none; "><label class="reminder-title">'+lang.reminder+':</label><span><input type="checkbox" checked="checked" id="message_remainder_check"><label for="message_remainder_check" class="checkbox_label">'+lang.send_email_sms_reminder+"</label></span></li>":_clsCusObj.custPhoneNum?l+='<li id="confirm_remainder" class="SMSReminder" style = "display: none; "><label class="reminder-title">'+lang.reminder+':</label><span><input type="checkbox" checked="checked" id="message_remainder_check"><label for="message_remainder_check" class="checkbox_label">'+lang.send_sms_reminder+"</label></span></li>":_clsCusObj.cusEmail&&(l+='<li id="confirm_remainder" class="emailReminder" style = "display: none; "><label class="reminder-title">'+lang.reminder+':</label><span><input type="checkbox" checked="checked" id="message_remainder_check"><label for="message_remainder_check" class="checkbox_label">'+lang.send_email_reminder+"</label></span></li>"):"true"==companyDetails.haveTextReminderEnabled&&"true"!=companyDetails.haveEmailReminderEnabled?_clsCusObj.custPhoneNum&&(l+='<li id="confirm_remainder" class="SMSReminder" style = "display: none; "><label class="reminder-title">'+lang.reminder+':</label><span><input type="checkbox" checked="checked" id="message_remainder_check"><label for="message_remainder_check" class="checkbox_label">'+lang.send_sms_reminder+"</label></span></li>"):"true"==companyDetails.haveEmailReminderEnabled&&"true"!=companyDetails.haveTextReminderEnabled&&_clsCusObj.cusEmail&&(l+='<li id="confirm_remainder" class="emailReminder" style = "display: none; "><label class="reminder-title">'+lang.reminder+':</label><span><input type="checkbox" checked="checked" id="message_remainder_check"><label for="message_remainder_check" class="checkbox_label">'+lang.send_email_reminder+"</label></span></li>")),l+="<li></li>",$(".class_global_btn2_lt").show(),$(".bookAnotherAppt").hide(),$(".socialButtonLineAndShare").hide(),$(".class_confirm_appt").show(),$(".gdpr_info_container").show(),animateProgressBar("class"),$("#class_confirm_ul").html(l),$("#confirm_remainder").hasClass("emailAndSMSReminder")||$("#confirm_remainder").hasClass("SMSReminder")?isClassSMSAllowed(function(e){if(e)$("#confirm_remainder").show();else if(_clsCusObj.cusEmail){var s='<label class="reminder-title">'+lang.reminder+':</label><span><input type="checkbox" checked="checked" id="message_remainder_check"><label for="message_remainder_check" class="checkbox_label">'+lang.send_email_reminder+"</label></span>";$("#confirm_remainder").removeClass("emailAndSMSReminder SMSReminder"),$("#confirm_remainder").addClass("emailReminder"),$("#confirm_remainder").html(s),$("#confirm_remainder").show()}}):$("#confirm_remainder").show(),$(".class_confirm > .mobile-navbar").addClass("active");for(var C="",o=0;o<classes.length;o++)classes[o].key==_classBookingDetails.classKey&&(C=classes[o].cost);null!=_classBookingDetails.classApptKey&&$.ajax({type:"GET",url:"/getClsSesCost",async:!1,data:"clsSesAptKey="+_classBookingDetails.classApptKey+"&companyKey="+companyKey,success:function(e){null!=e&&(C=e)}}),null!=PaymentBookingPolicy&&1==PaymentBookingPolicy.isPaymentEnabled&&null==rescheudleAppointmentInfo&&C>.5&&"true"!=isReschedulePage&&($("#pageBlock").css("height",$("body").height()),$("#pageBlock, #loading_set, #loading_set #setmore_loading_icon").show(),$(".gdpr_info_container").hide(),clsDtlsBefrSave("pymt",PaymentBookingPolicy),$("#classes-tab").removeClass("clsCon").removeClass("skipForm").addClass("clsPay"))}})},getVideoLinkEnabled=function(e){var s=[];_classBookingDetails.isVideoEnabled=!1,s.push(e);var t=JSON.stringify(s).replace(/[\[\]"]+/g,"");$.ajax({type:"GET",url:"/fetchConnectURL/"+t,dataType:"json",async:!1,success:function(e){window.connectClass.length>0&&e.length>0&&"Active"==e[0].status&&(console.log(!0),_classBookingDetails.isVideoEnabled=!0)}})},bkClsAppt=function(e){$(".class_global_btn2_rt").off("click").on("click",function(){$("#class-back").removeClass("back-to-classes").removeClass("back-to-classProvider").removeClass("back-to-classDatePicker").removeClass("back-to-classCustInfo").addClass("hide"),$("#class_progress-icon").hide(),$("#class_progressStatus").animate({width:"100%"},100).css("overflow","visible"),$(".class, .class_provider, .class_date, .class_info ").addClass("pointer_events"),$(".gdpr_info_container").hide(),classBookAppt()})},classBookAppt=function(e,s){$(".class_global_btn2_lt").hide(),$("#pageBlock").css("height",$("body").height()),$("#pageBlock, #loading_set, #loading_set #setmore_loading_icon").show();for(var t={value:{}},a={},i=0;i<additionalFields.length;i++)$(".classes-container .customerlistAdditionalFields_"+i).hasClass("showFields")?a[String(additionalFields[i])]=htmlEscape($.trim($(".classes-container .customerlistAdditionalFields_"+i).html())):a[String(additionalFields[i])]=htmlEscape($(".classes-container #class_custAdditionalFields_"+[i]).val());$.isEmptyObject(a),t.value=a,_clsCusObj.custAdditionalFields=t;var o="true",n="true",r="";null!=contactFields&&contactFields.indexOf("email")!=-1||(r=$("#class_cust-IEmailId").val()?$("#class_cust-IEmailId").val().trim():$(".customerlist-emailId").html()?$(".customerlist-emailId").html().trim():""),0==!$("#message_remainder_check").length&&($("#message_remainder_check").is(":checked")||($("#confirm_remainder").hasClass("emailAndSMSReminder")?(o="false",n="false"):$("#confirm_remainder").hasClass("emailReminder")?o="false":$("#confirm_remainder").hasClass("SMSReminder")&&(n="false")));var l={FirstName:_clsCusObj.custFirstName,LastName:_clsCusObj.custLastName,countryCode:_clsCusObj.custExt,Country:_clsCusObj.country,MobileNo:formatPhoneNumber(_clsCusObj.custExt,custPhoneNum,_clsCusObj.country,"e164"),LoginId:_clsCusObj.cusEmail,Address:_clsCusObj.cusAddress,City:_clsCusObj.cusCity,State:_clsCusObj.cusState,Zip:_clsCusObj.cusZip,notes:cusComments,additionalFields:""!=_clsCusObj.custAdditionalFields?_clsCusObj.custAdditionalFields:"{value:{}}",F_Key:companyKey,CompanyName:companyDetails.companyName,ContactType:"Customer",HomeNumber:"",OfficeNumber:"",Status:"Active",CompanyLogoPath:"",companyLogBlobKey:"",EncryptedPassword:enPwd?enPwd:"",loginType:[],isFromBookingPage:"true",haveEmailReminderEnabled:o,haveTextReminderEnabled:n,isNewCustomer:"true",CustomerTags:"",isReschedule:"true"==isReschedulePage&&"class"==apptType?"true":"false",oldSessionKey:rescheduleSessionKey?rescheduleSessionKey:null,custLocalTimeZone:_.isEmpty(timeZoneObj)?"":timeZoneObj.companyTimeZoneObj.timeZoneID!=EventResources.classTimeZoneId?EventResources.classTimeZoneId:""};"true"==l.isReschedule?l.key=rescheduleCustomerInfo.key:customerKey&&(l.key=customerKey,l.isNewCustomer="false",l.loginType=loginType,l.haveEmailReminderEnabled=o);var c={classAppointmentKey:_classBookingDetails.classApptKey,newCustomer:l,isPaymentEnabled:!1};"payment"==e&&(c.isPaymentEnabled=!0),saveClsAppt(c,s)},clkSerHeaderNavBar=function(){$(".step_tab ul").off("click",".service").on("click"," .service",function(){validateAndFormatPhNo("#cust-PhoneNo"),$(".Go-back").hasClass("active")||$(".Go-back").addClass("active"),serSt(),isWixApp&&wixStepTabService()}),$(".step_tab ul").off("click",".provider").on("click",".provider",function(){if(validateAndFormatPhNo("#cust-PhoneNo"),$(".Go-back").hasClass("active")||$(".Go-back").addClass("active"),proSt(),isWixApp){var e=$("#sp_act").height();wixHeightGenerator(e)}}),$(".step_tab ul li").off("click",".appt_date").on("click",".appt_date",function(){appDateSt()}),$(".step_tab ul").off("click",".info").on("click",".info",function(){infoSt()}),clkSerInfoHdrNavBar()},clkSerInfoHdrNavBar=function(){$("#appt_date").off("click").on("click",function(){if($("#appt_date > span").hasClass("active")||$("#appt_date > span").hasClass("done")){if(validateAndFormatPhNo("#cust-PhoneNo"),$("#appt_date > span").removeClass("active").removeClass("done"),$(".info > span").removeClass("done").removeClass("active"),$(".service_title").html(lang.choose_dateandtime+" ("+shortTimeZone+")"),fbbdp?($(".service_title").html(lang.select_preferredtime),$(".chng-tz").addClass("fbbdp-adjustment")):_enabledCustLocalTimeZone&&$(".service_title").html(""),$(".yourinfo").hide(),$(".your_info_form").hide(),$(".customer-login-form").show(),$("#dateCont").show(),isWixApp){var e=$("#timesheet").height();wixHeightGenerator(e)}$(".info").addClass("pointer_events"),$(".mobile-navbar").removeClass("active"),$("#appt_date > span.mobile-navbar").addClass("active"),chkShrtBp(),$(".yourinfo").hide(),$(".confirmation").hide(),$(".gt_act").hasClass("signIn_tab")&&$(".gt_act").removeClass("signIn_tab"),$(".customerLoginContainer").hide(),$("#login").hasClass("hidded")&&($("#login").show(),$(".login-icon-div").removeClass("hide").addClass("show-login-icon")),$("#login").removeClass("sSkipLogin").removeClass("cSkipLogin"),$(".login_details").is(":visible")&&($("#login").hide(),$(".login-icon-div").removeClass("show-login-icon").addClass("hide")),$(".gt_act").removeClass("eCusDetails_tab"),$(".gt_act").addClass("timeslot_tab"),$("#services-tab").removeClass("srLst").removeClass("srPro").removeClass("signInFrm").removeClass("srInfo").removeClass("srCon").removeClass("srBkd").removeClass("srPay"),$("#services-tab").hasClass("srDt")||$("#services-tab").addClass("srDt"),$("#payments-info-holder").is(":visible")&&removePaymentView()}bookingPolicy("link"),_enabledCustLocalTimeZone&&_bookingPolicy&&$("#policy_link").hide(),animateProgressBar(),loginFormPadding()})},clkClsHeaderNavBar=function(){clkClsHNavBar(),clkClsProHNavBar(),clkClsDtHNavBar(),clkClsInfoHNavBar(),$("#class-back").off("click").on("click",function(){$("#class-back").hasClass("back-to-classes")&&($("#class-back").addClass("hide"),$(".class").trigger("click")),$("#class-back").hasClass("back-to-classProvider")&&clsProviderNavBar(),$("#class-back").hasClass("back-to-classDatePicker")&&$(".class_date").trigger("click"),$("#class-back").hasClass("back-to-classCustInfo")&&$(".class_info").trigger("click")})},clkClsHNavBar=function(){$(".class").off("click").on("click",function(){validateAndFormatPhNo("#class_cust-PhoneNo"),$("#classDateCont").hide(),$("#class_progress-icon").hide(),$(".class > span, .class_provider > span , .class_date > span , .class_info > span").removeClass("active"),$(".class > span, .class_provider > span , .class_date > span , .class_info > span").removeClass("class_done"),$("#chs_class_act").show(),$(".class_step_tab > h2").html(choose_a_ser+" "+_customizedClassName),$(".customerLoginContainer").hide(),$(".classes-container .loading_icon_timings").hide(),$(".classes-container .loading_icon_timings").hasClass("done")||$(".classes-container .loading_icon_timings").addClass("done"),$("#class_provider, #classDateCont, .class_confirmation").hide(),$(".classes-container > .yourinfo").hide(),$(".class > span.class_step-li").attr("class","class_step-li active"),$(".mobile-navbar").removeClass("active"),$(".class > span.mobile-navbar").attr("class","mobile-navbar active"),$(".class > span.mobile-navbar").addClass("active"),$(".class > span.mobile-navbar").html('<i class="icon-sitemap"></i><label>'+_customizedClassName+"<label>"),animateProgressBar("class"),$("#classes-tab").removeClass("clsPro").removeClass("clsDt").removeClass("signInFrm").removeClass("clsInfo").removeClass("clsCon").removeClass("clsBkd").removeClass("skipForm"),$("#classes-tab").hasClass("clsLst")||$("#classes-tab").addClass("clsLst"),$(".class_provider,.class_date,.class_info,.class_confirm").addClass("pointer_events"),showLoginIcon(),bookingPolicy("link"),isWixApp&&wixStepTabService(),$("#class-payments-info-holder").is(":visible")&&removePaymentView("class"),"null"===rescheduleClassKey&&"null"===selectedClassKey||("true"===isReschedulePage&&$("#login").hide(),$(".login-icon-div").removeClass("show-login-icon").addClass("hide"),_classBookingDetails.classKey=getClassKeyFromRequest(),renderClasses()),$(".chng-cls-tz").hide()})},showLoginIcon=function(){"true"!=customerInfo.thirdPartyLogin||$("#login").is(":visible")||$("#account_menu").is(":visible")||"false"===isReschedulePage&&"true"!=facebookPage&&($("#login").show(),$(".login-icon-div").addClass("show-login-icon").removeClass("hide"))},getClassKeyFromRequest=function(){var e=rescheduleClassKey;return"null"!==selectedClassKey&&(e=selectedClassKey),e},clkClsProHNavBar=function(){$(".class_provider").off("click").on("click",function(){validateAndFormatPhNo("#class_cust-PhoneNo"),clsProviderNavBar()})},clsProviderNavBar=function(){if(($(".class_provider > span").hasClass("active")||$(".class_provider > span").hasClass("class_done"))&&($(".class_provider > span , .class_date > span , .class_info > span ").removeClass("active"),$(".class_provider > span, .class_date > span , .class_info > span").removeClass("class_done"),$("#class-back").removeClass("back-to-classProvider").addClass("back-to-classes"),animateProgressBar("class"),$("#class_provider").show(),$("#classDateCont, .class_confirmation").hide(),$(".customerLoginContainer").hide(),$(".class_step_tab > h2").html(choose_a_pro+" "+_customizedProName),$(".classes-container > .yourinfo").hide(),$(".class_confirmation").hide(),$(".class_global_btn2_lt").hide(),$(".mobile-navbar").removeClass("active"),$(".class_provider > span.mobile-navbar").addClass("active"),$("#classes-tab").removeClass("clsLst").removeClass("clsDt").removeClass("signInFrm").removeClass("clsInfo").removeClass("clsCon").removeClass("clsBkd").removeClass("skipForm"),$("#classes-tab").hasClass("clsPro")||$("#classes-tab").addClass("clsPro"),$(".class_date,.class_info,.class_confirm").addClass("pointer_events"),$(".class_provider").removeClass("pointer_events"),showLoginIcon(),$("#class-payments-info-holder").is(":visible")&&removePaymentView("class")),bookingPolicy("link"),isWixApp){var e=$("#class_provider").height();wixHeightGenerator(e)}"null"===rescheduleClassKey&&"null"===selectedClassKey||(_classBookingDetails.classKey=getClassKeyFromRequest(),reqClsRes(_classBookingDetails.classKey)),$(".chng-cls-tz").hide()},clkClsDtHNavBar=function(){$(".class_date").off("click").on("click",function(){if(validateAndFormatPhNo("#class_cust-PhoneNo"),($(".class_date > span").hasClass("active")||$(".class_date > span").hasClass("class_done"))&&($(".classes-container .loading_icon_timings").hide(),$("#classDateCont").show(),_enabledCustLocalTimeZone?($(".class_step_tab > h2").html(""),$(".chng-cls-tz").show()):($(".class_step_tab > h2").html(lang.choose_dateandtime+" ("+shortTimeZone+")"),$(".chng-cls-tz").hide()),$("#class_provider,.customerLoginContainer,.classes-container .customer-login-form,.class_confirmation").hide(),$(".class_date > span, .class_info > span").removeClass("active"),$(".class_date > span, .class_info > span").removeClass("class_done"),$(".mobile-navbar").removeClass("active"),$(".class_date > span.mobile-navbar").addClass("active"),animateProgressBar("class"),$("#classes-tab").removeClass("clsLst").removeClass("clsPro").removeClass("signInFrm").removeClass("clsInfo").removeClass("clsCon").removeClass("clsBkd").removeClass("skipForm"),$("#classes-tab").hasClass("clsPro")||$("#classes-tab").addClass("clsDt"),$(".class_info,.class_confirm").addClass("pointer_events"),showLoginIcon(),$("#class-payments-info-holder").is(":visible")&&removePaymentView("class"),"true"==customerInfo.skipStaff||null!=staffResourceInfo?$("#class-back").addClass("back-to-classes").removeClass("back-to-classDatePicker").removeClass("back-to-classProvider"):$("#class-back").addClass("back-to-classProvider").removeClass("back-to-classDatePicker")),$("#policy_link").hide(),$("#notes_wrapper").hide(),isWixApp){var e=$("#sessionSheet").height();wixHeightGenerator(e)}})},clkClsInfoHNavBar=function(){$(".class_info").off("click").on("click",function(){if(validateAndFormatPhNo("#class_cust-PhoneNo"),$("#class-payments-info-holder").is(":visible")&&removePaymentView("class"),$(".class_info > span").hasClass("active")||$(".class_info > span").hasClass("class_done")){if($(".class_confirmation").hide(),$(".classes-container #sc_act , .classes-container .customer-login-form").show(),$(".classes-container .continue").hasClass("normalLogin"))$(".class_step_tab > h2").html(lang.enter_your_information);else if(!$(".signIn").hasClass("active")){var e=$(".classes-container #cust-FirstName")&&$(".classes-container #cust-FirstName").html()?$(".classes-container #cust-FirstName").html():$(".classes-container #class_cust-IName")&&$(".classes-container #class_cust-IName").val()?$(".classes-container #class_cust-IName").val():"";$(".class_step_tab > h2").html(lang.hi+" "+e.trim()+", "+lang.please_review_your_info)}$(".class_info > span").removeClass("active"),$(".class_info > span").removeClass("class_done"),$(".mobile-navbar").removeClass("active"),$(".class_info > span.mobile-navbar").addClass("active"),animateProgressBar("class"),$("#classes-tab").removeClass("clsLst").removeClass("clsPro").removeClass("clsDt").removeClass("signInFrm").removeClass("clsCon").removeClass("clsBkd").removeClass("clsPay"),$("#classes-tab").hasClass("clsInfo")||$("#classes-tab").addClass("clsDt"),$("#class-back").removeClass("back-to-classCustInfo").addClass("back-to-classDatePicker")}bookingPolicy("link"),$(".chng-cls-tz").hide()})},hideAllContainers=function(){$(".bookingpage_loader").show(),$(".service-container").hide(),$(".classes-container").hide(),$("#staff_act").hide(),$("#services_act").hide(),$("#classes_act").hide(),$("#review_act").hide(),$("#photos_act").hide(),$(".customerLoginContainer").hide(),$(".bookAnotherAppt").hide(),$(".callBackUrl").hide(),$("#abts_act").hide()},hideOtherMenusByServiceBpage=function(){$(".nav .gt_cls").hide(),$(".nav .staff_act").hide(),$(".nav .srvs").hide(),$(".nav .cls").hide()},apptTab=function(e){hideAllContainers(),fetchCompanyServiceDetails(e,!0)},serviceRenderCallBack=function(e){$("#chs_service_act").removeClass("noServices"),$("#services-tab").trigger("click"),checkBrowser(e,renderSerAndCat),$(".col1 > .nav > .gt_cls, .side-menu-col1 > .nav > .gt_cls").removeClass("active"),$(".col1 > .nav > .gt, .side-menu-col1 > .nav > .gt").addClass("active"),clkApptSideNavBar("ser"),$(".gt > .gt_act").hasClass("submitapp_tab")&&$("#policy_link").hide(),$(".col1 > .nav > .gt_cls, .col1 > .nav > .abts, .col1 > .nav > .sm, .col1 > .nav > .srvs, .col1 > .nav > .cls, .col1 > .nav > .pto, .col1 > .nav > .rvw").removeClass("active"),$(".side-menu-col1 > .nav > .gt_cls, .side-menu-col1 > .nav > .abts, .side-menu-col1 > .nav > .sm, .side-menu-col1 > .nav > .srvs, .side-menu-col1 > .nav > .cls, .side-menu-col1 > .nav > .pto, .side-menu-col1 > .nav > .rvw").removeClass("active"),$(".col1 > .nav > .gt > #gt_sr , .side-menu-col1 > .nav > .gt > #gt_sr").parent().addClass("active"),$("#abts_act,#staff_act,#services_act,#classes_act,#photos_act,#review_act").hide(),$(".classes-container").hide(),$("#services-tab").parent().addClass("active"),$("#classes-tab").parent().removeClass("active"),$(".side-menu").hide(),$(".menu-bar").show(),$(".side-menu").removeClass("show"),$("body").css({overflow:"auto"}),$("#side-icon").removeClass("icon-chevron-up").addClass("icon-chevron-down")},classTab=function(e){hideAllContainers(),fetchCompanyClassesDetails(e,!0),getResourcesJDOMap()},classRenderCallBack=function(e){$("#classes-tab").trigger("click"),checkBrowser(e,renderClasses),$(".col1 > .nav > .gt_cls , .side-menu-col1 > .nav > .gt_cls ").addClass("active"),$(".col1 > .nav > .gt > #gt_sr , .side-menu-col1 > .nav > .gt > #gt_sr").parent().removeClass("active"),clkApptSideNavBar("cls"),$(".reviewPopup").hide(),$("#gt_act").show(),$(".gt, .col1 > .nav > .abts,  .side-menu-col1 > .nav > .abts, .sm, .srvs, .cls, .pto, .rvw").removeClass("active"),$(".col1 > .nav > .gt_cls , .side-menu-col1 > .nav > .gt_cls ").addClass("active"),$("#gt_cls").removeClass("payappt_tab"),$("#abts_act,#staff_act,#services_act,#classes_act,#photos_act,#review_act").hide(),$(".side-menu").hide(),$(".menu-bar").show(),$(".side-menu").removeClass("show"),$("body").css({overflow:"auto"}),$("#side-icon").removeClass("icon-chevron-up").addClass("icon-chevron-down"),hideLogin()},clkSideNavBar=function(){$(".col1 .nav #gt_sr, .side-menu-col1 .nav #gt_sr").off("click").on("click",function(e){e.preventDefault(),nextAvailabilitySlotReq&&1==requestAbortState&&showTimingsForAllResources(),apptTab(e)}),$(".col1 .nav #gt_cls, .side-menu-col1 .nav #gt_cls").off("click").on("click",function(e){$("#classes-tab").parent().addClass("active"),$("#services-tab").parent().removeClass("active"),e.preventDefault(),nextAvailabilitySlotReq&&nextAvailabilitySlotReq.abort(),requestAbortState=!0,classTab(e)}),$(".nav").off("click",".abts").on("click",".abts",function(e){nextAvailabilitySlotReq&&nextAvailabilitySlotReq.abort(),requestAbortState=!0,$("#gt_act,#staff_act,#services_act,#classes_act,#photos_act,#review_act").hide(),$(".gt, .gt_cls, .sm, .srvs, .cls, .pto, .rvw").removeClass("active"),$(".col1 > .nav >.abts, .side-menu-col1 > .nav >.abts").addClass("active"),$("#abts_act").show(),$("#abts_act > h2").html(lang.about_us),checkBrowser(e,map.callMap),$("#aboutus_map").hide(),$("#policy_link,#notes_wrapper").hide(),""!=customerInfo.aboutCompany&&""!=customerInfo.aboutCompany.value&&$(".ul_map_addr_businesshours").hide(),showLoginButton(),$(".side-menu").hide(),$(".menu-bar").show(),$(".side-menu").removeClass("show"),$("body").css({overflow:"auto"}),$("#wrapper").addClass("wrapper1"),$(".login-details-ul").hide(),$("#side-icon").removeClass("icon-chevron-up").addClass("icon-chevron-down"),hideLogin()}),$(".nav").off("click",".staff_act").on("click",".staff_act",function(e){nextAvailabilitySlotReq&&nextAvailabilitySlotReq.abort(),requestAbortState=!0,checkBrowser(e,renderStaff),showLoginButton(),$(".side-menu").hide(),$(".menu-bar").show(),$(".side-menu").removeClass("show"),$("body").css({overflow:"auto"}),hideLogin(),$("#side-icon").removeClass("icon-chevron-up").addClass("icon-chevron-down")}),$(".nav").off("click",".srvs").on("click",".srvs",function(e){e.preventDefault(),nextAvailabilitySlotReq&&nextAvailabilitySlotReq.abort(),requestAbortState=!0,EventResources.servFetchInProcess||EventResources.isServiceFetched?(checkBrowser(e,renderSerAndCatTab),showLoginButton()):checkBrowser(e,fetchCompanyServiceDetails),$(".side-menu").hide(),$(".menu-bar").show(),$(".side-menu").removeClass("show"),$("body").css({overflow:"auto"}),hideLogin(),$("#side-icon").removeClass("icon-chevron-up").addClass("icon-chevron-down")}),$(".nav").off("click",".classes_act").on("click",".classes_act",function(e){e.preventDefault(),nextAvailabilitySlotReq&&nextAvailabilitySlotReq.abort(),requestAbortState=!0,showLoginIcon(),EventResources.clsFetchInProcess||EventResources.isClsFetched?($(".customerLoginContainer").hide(),checkBrowser(e,rClsAndCatTab)):checkBrowser(e,fetchCompanyClassesDetails),$(".side-menu").hide(),$(".menu-bar").show(),$(".side-menu").removeClass("show"),$("body").css({overflow:"auto"}),hideLogin(),$("#side-icon").removeClass("icon-chevron-up").addClass("icon-chevron-down")}),$(".nav").off("click",".pto").on("click",".pto",function(e){nextAvailabilitySlotReq&&nextAvailabilitySlotReq.abort(),requestAbortState=!0,checkBrowser(e,function(){photosTab(),bookingPageInstagram.render()}),showLoginButton(),$(".side-menu").hide(),$(".menu-bar").show(),$(".side-menu").removeClass("show"),$("body").css({overflow:"auto"}),$("#side-icon").removeClass("icon-chevron-up").addClass("icon-chevron-down"),hideLogin()}),$(".nav").off("click",".rvw").on("click",".rvw",function(e){nextAvailabilitySlotReq&&nextAvailabilitySlotReq.abort(),requestAbortState=!0,checkBrowser(e,renderReviews),showLoginButton(),$(".side-menu").hide(),$(".menu-bar").show(),$(".side-menu").removeClass("show"),$("body").css({overflow:"auto"}),$("#wrapper").css({top:"10px"}),$("#side-icon").removeClass("icon-chevron-up").addClass("icon-chevron-down"),hideLogin()})},clkApptSideNavBar=function(e){if("true"==customerInfo.thirdPartyLogin){if(0!=$("#progress-icon").is(":visible")||$(".gt_act").hasClass("submitapp_tab")||$(".gt_act").hasClass("appt_date")||$("#gt_sr").hasClass("payappt_tab")||($("#chs_service_act").show(),$(".step_tab > h2").html(choose_a_ser+" "+_customizedSerName)),"false"==_isSkipStaff&&$("#progress-icon").is(":visible")&&$("#progress-icon").hasClass("serviceIcon")&&($(".service_title").html(""+choose_a_pro+" "+_customizedProName),$("#sp_act").show()),$("#progress-icon").hasClass("providerIcon")){if($("#dateCont").show(),$(".loaderMessage").show(),_enabledCustLocalTimeZone){$(".step_tab > h2").html("");var s=_seletedTimeZoneFullName?_seletedTimeZoneFullName:timeZoneObj.localTimeZoneObj.timeZoneFullName;$(".chng-tz-a > span").html(s)}else $(".step_tab > h2").html(lang.choose_dateandtime+" ("+shortTimeZone+")"),$(".chng-tz").hide();_enabledCustLocalTimeZone&&_bookingPolicy&&$("#policy_link").hide()}if($(".customerLoginContainer").removeClass("login-container"),_isSkipStaff&&$("#progress-icon").hasClass("appt_dateIcon")&&!$(".gt_act").hasClass("signIn_tab")&&!$(".gt_act").hasClass("eCusDetails_tab")){if($("#dateCont").show(),$(".loaderMessage").show(),_enabledCustLocalTimeZone){$(".step_tab > h2").html("");var s=_seletedTimeZoneFullName?_seletedTimeZoneFullName:timeZoneObj.localTimeZoneObj.timeZoneFullName;$(".chng-tz-a > span").html(s)}else $(".step_tab > h2").html(lang.choose_dateandtime+" ("+shortTimeZone+")"),$(".chng-tz").hide();_enabledCustLocalTimeZone&&_bookingPolicy&&$("#policy_link").hide()}classes.length?$(".customerLoginContainer").css({top:"210px"}):$(".customerLoginContainer").css({top:"150px"}),""==companyDetails.companyName&&$(".customerLoginContainer").css({top:"144px"}),null!=staffResourceInfo&&$(".customerLoginContainer").css({top:"211px"});var t=$("#gt_sr");"cls"==e&&(t=$("#gt_cls")),t.hasClass("signIn_tab")&&$(".signIn").hasClass("active")?($(".customerLoginContainer").show(),$(".setmore-login-container").is(":visible")?$("#skip_step").hide():$("#skip_step").show(),$("#login, .Log-in").hide()):showLoginButton(),!$("#progress-icon").is(":visible")||0!=$(".customer-details-list").is("visible")||$(".gt_act").hasClass("signIn_tab")||$(".gt_act").hasClass("submitapp_tab")||$("#gt_sr").hasClass("payappt_tab")||$(".customer-login-form").show(),"cls"==e?$("#login").hasClass("cSkipLogin")&&$("#login, .Log-in").hide():$("#login").hasClass("sSkipLogin")&&$("#login, .Log-in").hide(),$(".gt > .gt_act").hasClass("confirmCusDetails_tab")&&$(".customer-login-form").hide(),$(".cust-details").is(":visible")&&($("#cust-FirstName").show(),$("#cust-LoginId").show(),$("#cust-LoginId").html()&&$("#cust-IEmailId").parent().parent().hide()),$(".gt > .gt_act").hasClass("submitapp_tab")&&($("h2").html(lang.appt_confirmed),$(".customer-details-list").hide(),$(".customer-login-form").hide()),$("#login").hasClass("active")&&$(".forget-pwd-container").is(":visible")&&$(".skip_step").addClass("noskip")}"cls"==e?(switchToSerOrClsTab("cls","bookClassTab"),showCurClsSts()):"ser"==e&&(switchToSerOrClsTab("ser"),showCurSerSts(),handlingTabs("ser")),hideLogin()},hideLogin=function(){void 0!=bookingPageSettings.showMenuBar&&null!=bookingPageSettings.showMenuBar&&1!=bookingPageSettings.showMenuBar||($(".customerLoginContainer").addClass("menu-bar-active"),$("#login").addClass("active-login"))},rEvents=function(){$("#review_act").off("click",".writeReview").on("click",".writeReview",function(){renderReviews(),showPopup()}),$(".starRating").off("click","i").on("click","i",function(){setRating(this)}),submitRvw(),$(".cancel ").off("click").on("click",function(){$("#pageBlock").hide(),$("#pageBlock").css({opacity:".9"}),$(".reviewPopup").hide(),$("#rating").attr("value",""),$("#rating > i").removeClass(".icon-star-empty").removeClass("icon-star-empty-active"),$("#customerName,#customerReview,#customerEmail").val(""),setCustomerInfoReviewPopup(),$("#customerName,#customerReview,#customerEmail").removeClass("inputError")})},submitRvw=function(){$(".submitReview").off("click").on("click",function(){var e="true",s=htmlEscape($("#customerName").val().trim()),t=htmlEscape($("#customerReview").val().trim());if(_.isEmpty(s)&&(e="false",$("#customerName").addClass("inputError")),_.isEmpty($("#customerEmail").val().trim())?(e="false",$("#customerEmail").addClass("inputError")):/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test($("#customerEmail").val())||(e="false",
$("#customerEmail").addClass("inputError"),showValidationAletMsg(lang.invalid_email)),_.isEmpty(t)&&(e="false",$("#customerReview").addClass("inputError")),""==document.getElementById("rating").getAttribute("value")&&(e="false",showValidationAletMsg(lang.please_rate)),"true"===e){var a=$("#rating").attr("value")&&$("#rating").attr("value")?$("#rating").attr("value"):$("#rating").val(),i={companyLoginId:companyDetails.loginId,companyName:htmlEscape(companyDetails.companyName?companyDetails.companyName:""),customerName:s,customerEmail:$("#customerEmail").val(),customerReview:t,rating:a,companyLogoPath:companyDetails.companyLogoPath?companyDetails.companyLogoPath:""};saveReviews(i),renderReviews()}})},frgtPwd=function(){$(".forget_pwd").off("click").on("click",function(){setTimeout(function(){$("#forget-email").focus()},100);var e=$("#setCustEmail").val();$("#forget-email").val(e?e:""),$(".signIn").hide(),$(".forget-pwd-container").show(),$(".signIn").addClass("forgotPassword"),$("#skip_step").addClass("noskip"),$("#forget-email").removeClass("inputError"),$(".forget-pwd-container .placeholder-span-focus").removeClass("label-error")})},resetPwd=function(){$("#resetPwd").off("click").on("click",function(){var e="";$("#forget-email").val().trim()?EmailPattern.test($("#forget-email").val().trim())?(e=$("#forget-email").val().trim(),$("#forget-email").removeClass("inputError"),$(".forget-pwd-container .placeholder-span-focus").removeClass("label-error")):(showValidationAletMsg(lang.Invalid_emailId),$("#forget-email").addClass("inputError"),$(".forget-pwd-container .placeholder-span-focus").addClass("label-error")):(showValidationAletMsg(lang.email_cant_empty),$("#forget-email").addClass("inputError"),$(".forget-pwd-container .placeholder-span-focus").addClass("label-error")),e&&forgetPassword(e)})},clkCrtNewProfl=function(){$(".createNewProfile").off("click").on("click",function(){$(".signIn").hide(),$(".signUp,.setmore_login,.newProfile").show(),$(".setmore-login-container,.createMyProfile").hide(),$("#noAcc").hide(),bookingPageSettings.enabledFields&&bookingPageSettings.enabledFields.indexOf("thirdPartyLoginReq")!=-1?$("#skip_step").hide():$("#skip_step").show(),$(".setmore-login-container input").val(""),$(".setmore-login-container input").hasClass("inputError")&&($(".setmore-login-container input").removeClass("inputError"),$(".setmore-login-container span").removeClass("label-error")),$(".setmore-signup input").hasClass("inputError")&&($(".setmore-signup input").removeClass("inputError"),$(".setmore-signup span").removeClass("label-error")),$(".button-facebook").css({"background-color":"#5A84C3",color:"#fff"}),$(".button-google").css({"background-color":"#EA5E5E",color:"#fff"}),$(".col2").css({"margin-bottom":"10px"})})},clkCrtMyProfl=function(){$(".createMyProfile").off("click").on("click",function(){var e="",s="",t="";if($("#setName").val().trim()?1==regScript.test($("#setName").val().trim())?(showValidationAletMsg("Name cannot contain HTML tags"),$("#setName").addClass("inputError"),$(".setmore-signup .name-label .placeholder-span-focus").addClass("label-error")):(e=$("#setName").val().trim(),e=htmlEscape(e),e.contains("amp;")&&(e=e.replace("amp;","")),$("#setName").removeClass("inputError"),$(".setmore-signup .name-label .placeholder-span-focus").removeClass("label-error")):(showValidationAletMsg(lang.name_field_empty),$("#setName").addClass("inputError"),$(".setmore-signup .name-label .placeholder-span-focus").addClass("label-error")),$("#setEmail").val().trim()){var a=$("#setEmail").val().trim();EmailPattern.test(a.toLowerCase())?(s=a.toLowerCase(),$("#setEmail").removeClass("inputError"),$(".setmore-signup .email-label .placeholder-span-focus").removeClass("label-error")):(showValidationAletMsg(lang.Invalid_emailId),$("#setEmail").addClass("inputError"),$(".setmore-signup .email-label .placeholder-span-focus").addClass("label-error"))}else showValidationAletMsg(lang.email_cant_empty),$("#setEmail").addClass("inputError"),$(".setmore-signup .email-label .placeholder-span-focus").addClass("label-error");$("#setPassword").val().trim()?($("#setPassword").val().trim().length<6&&(showValidationAletMsg(lang.password_mini_sixchar),$("#setPassword").addClass("inputError"),$(".setmore-signup .password-label .placeholder-span-focus").addClass("label-error")),1==regScript.test($("#setPassword").val().trim())?(showValidationAletMsg("HTML tags not allowed"),$("#setPassword").addClass("inputError"),$(".setmore-signup .password-label .placeholder-span-focus").addClass("label-error")):$("#setPassword").val().trim().length>128?(showValidationAletMsg("Password should not exceed 128 characters!"),$("#setPassword").addClass("inputError"),$(".setmore-signup .password-label .placeholder-span-focus").addClass("label-error")):(t=$("#setPassword").val().trim(),$("#setPassword").removeClass("inputError"),$(".setmore-signup .password-label .placeholder-span-focus").removeClass("label-error"))):(showValidationAletMsg(lang.password_cant_empty),$("#setPassword").addClass("inputError"),$(".setmore-signup .password-label .placeholder-span-focus").addClass("label-error")),e&&s&&t&&setmoreSignup(e,s,t)})},clkSetmoreLogin=function(){$("#setmoreLogin").off("click").on("click",function(){var e="",s="";$("#setCustEmail").val().trim()?EmailPattern.test($("#setCustEmail").val().trim())?(e=$("#setCustEmail").val().trim(),$("#setCustEmail").removeClass("inputError"),$(".setmore-login-container .email-label .placeholder-span-focus").removeClass("label-error")):(showValidationAletMsg(lang.Invalid_emailId),$("#setCustEmail").addClass("inputError"),$(".setmore-login-container .email-label .placeholder-span-focus").addClass("label-error")):(showValidationAletMsg(lang.email_cant_empty),$("#setCustEmail").addClass("inputError")),$("#setCustPassword").val().trim()?$("#setCustPassword").val().trim().length<6?(showValidationAletMsg(lang.password_mini_sixchar),$("#setCustPassword").addClass("inputError"),$(".setmore-login-container .password-label .placeholder-span-focus").addClass("label-error")):(s=$("#setCustPassword").val().trim(),$("#setCustPassword").removeClass("inputError"),$(".setmore-login-container .password-label .placeholder-span-focus").removeClass("label-error")):(showValidationAletMsg(lang.password_cant_empty),$("#setCustPassword").addClass("inputError"),$(".setmore-login-container .password-label .placeholder-span-focus").addClass("label-error")),e&&s&&($(".setmore-login-container > input").removeClass("inputError"),$(".setmore-login-container span").removeClass("label-error"),getCusSetmoreLoginInfo(e,s)),$("#login-details-dropdown-ul").show()})},backToSignIn=function(){$(".backToSigin").off("click").on("click",function(){setTimeout(function(){$("#setCustEmail").focus()},100),$(".signIn").show(),$(".signIn").addClass("active"),$(".signUp").hide(),$(".forget-pwd-container").hide(),$(".setmore-signup  input").removeClass("inputError"),$(".setmore-signup span").removeClass("label-error"),$(".setmore-login-container input").removeClass("inputError"),$(".setmore-login-container span").removeClass("label-error"),$(".setmore-signup > input").val(""),$("#forget-email").val(""),$(".setmore-login-container > input").val(""),$(".customerLoginContainer").hasClass("login-container")?$("#skip_step").hide():0==$("#noAcc").is(":visible")&&$("#login").hasClass("active")&&$("#login").hasClass("hidded")?$("#skip_step").hasClass("noskip")?($("#skip_step").hide(),$("#skip_step").removeClass("noskip")):bookingPageSettings.enabledFields&&bookingPageSettings.enabledFields.indexOf("thirdPartyLoginReq")!=-1?$("#skip_step").hide():$("#skip_step").show():$("#skip_step").hasClass("noskip")?($("#skip_step").hide(),$("#skip_step").removeClass("noskip")):bookingPageSettings.enabledFields&&bookingPageSettings.enabledFields.indexOf("thirdPartyLoginReq")!=-1?$("#skip_step").hide():$("#skip_step").show()})},clkStMrLgnBtn=function(){$(".setmore_login").off("click").on("click",function(){setTimeout(function(){$("#setCustEmail").focus()},100),$(".newProfile").hide(),$(".createMyProfile").show(),$("#noAcc").show(),$("#skip_step").hide(),$(".setmore-login-container").show(),$(".setmore_login").hide()})},clkStMrSignUp=function(){$(".createMyProfile").show(),$(".button-facebook").css({"background-color":"#ecf2f5",color:"#8599a3"}),$(".button-google").css({"background-color":"#ecf2f5",color:"#8599a3"}),$(".col2").css({"margin-bottom":"90px"})},clkLogin=function(){$("#login").off("click").on("click",function(){loginActions()}),$(".login-icon-div").off("click").on("click",function(){loginActions(),loginFormPadding()})},loginActions=function(){$(".side-menu").removeClass("show"),$(".menu-bar").show(),$(".customerLoginContainer , .signIn").show(),$("#login").addClass("active"),$("#skip_step").hide(),$("#login").hide(),$(".close-sign-in").removeClass("hide-close-icon"),$(".login-icon-div").addClass("hide").removeClass("show-login-icon"),$(".customer-profile-cancel").addClass("sign-in-close"),$(".step_tab").hide(),$("#chs_service_act").hide(),$(".detail-navbar,.service-container, .classes-container").hide(),$("#sp_act").hide(),$("#dateCont").hide(),$("#policy_link").hide(),$(".policyNote").hide(),$(".customerLoginContainer").addClass("login-container"),$(".customerLoginContainer").css({top:"110px"}),$(".bookAnotherAppt, .callBackUrl").hide(),$(".bottomclass").hasClass("hide")&&$(".bottomclass").removeClass("hide"),$(".staff_act").hasClass("active")?$("#staff_act").hide():$(".srvs").hasClass("active")?$("#services_act").hide():$(".rvw").hasClass("active")?$("#review_act").hide():$(".abts").hasClass("active")?$("#abts_act").hide():$(".pto").hasClass("active")?$("#photos_act").hide():$(".cls").hasClass("active")&&$("#classes_act").hide(),($("#login").hasClass("sSkipLogin")||$("#login").hasClass("cSkipLogin"))&&$(".customer-login-form").hide(),$(".reviewPopup").is(":visible")&&$(".reviewPopup").hide(),$(".signIn").is(":visible")&&$(".signUp").hide(),$(".forget-pwd-container").is(":visible")&&$(".forget-pwd-container").hide()},sliderEvents=function(){},clkCanclProfl=function(){$(".customer-profile-cancel").off("click").on("click",function(e){e.stopPropagation(),$(".customer-profile-edit").hide(),$("#login-details-dropdown-ul").hide(),$("#blockpage").hide(),$(".loaderMessage").hide(),$(".customer-profile-cancel").hasClass("sign-in-close")&&$(".customerLoginContainer").hide(),showTabs(),$("#cust-continue").hasClass("normalLogin")&&($(".service-container #cust-continue").removeClass("normalLogin").addClass("socialLogin"),$(".classes-container #cust-continue").removeClass("normalLogin").addClass("socialLogin")),$(".confirm_appt").is(":visible")&&($(".confirm_appt").css({"margin-top":"0px"}),$("#policy_link").css("display","none")),fbbdp||isNullOrEmpty(_bookingPolicy)||$(".policyNote").hasClass("viewed")||$("#notes_wrapper").show(),$(".gt_cls").hasClass("active")&&$(".classes-container").hasClass("noServices")&&$("#notes_wrapper").hide(),$(".gt").hasClass("active")&&$("#chs_service_act").hasClass("noServices")&&$("#notes_wrapper").hide(),$(".login-details-ul").hide(),$("#side-icon").removeClass("icon-chevron-up").addClass("icon-chevron-down"),hideOrDisplayWarn("hideAll","#myProfile"),$(".customerLoginContainer").addClass("removePaddingTop").removeClass("addPaddingTop")})},showLoaderCustApptView=function(e){e&&$(".customer-appointments > ul").html(""),$(".customer-appointments #setmore-loader").remove(),$(".customer-appointments > ul").append('<div id="setmore-loader" class="appt-loader"><img alt="" src="/setmore-loader.gif"></div>'),$("#setmore-loader").show()},clkApptViewType=function(){$(".pastAppts").off("click").on("click",function(e){e.stopPropagation(),$(".todaydropdown > a").html(lang.past+' <i class="icon-angle-down"></i>'),$(".UpcomingAppointments,.TodayAppointments").hide(),$(".oldAppointments").show(),$(".upcomingAppts").show(),$(".pastAppts").hide(),$(".noUpcomingAppts").hide(),$(".noCurrentAppts").hide(),$("#noAppointments").hide(),$("#notes_wrapper").hide(),window.customerEventScrollType="past";var s=0===pastCustomerEvents.events.length;s&&showLoaderCustApptView(!0),0==pastCustomerEvents.events.length?getCusBks(customerKey,pastCustomerEvents,s):renderCusAppt("past")}),$(".upcomingAppts").off("click").on("click",function(e){e.stopPropagation(),$(".todaydropdown > a").html(lang.upcoming+' <i class="icon-angle-down"></i>'),$(".oldAppointments,.TodayAppointments").hide(),$(".UpcomingAppointments").show(),$(".pastAppts").show(),$(".upcomingAppts").hide(),$(".noCurrentAppts").hide(),$(".noPastAppts").hide(),$("#noAppointments").hide(),$("#notes_wrapper").hide(),window.customerEventScrollType="upcoming";var s=0===upcomingCustomerEvents.events.length;s&&showLoaderCustApptView(!0),0==upcomingCustomerEvents.events.length?getCusBks(customerKey,upcomingCustomerEvents,s):renderCusAppt("upcoming")})},clkCusLoginEvents=function(){$(".facebook_signin_btn").off("click").on("click",function(){popitup("/facebookBookingPage.do")}),$(".google_signin_btn").off("click").on("click",function(){popitup("/bookingPageAuthorization.do")}),resetPwd(),frgtPwd(),clkCrtNewProfl(),clkCrtMyProfl(),clkSetmoreLogin(),backToSignIn(),clkStMrLgnBtn(),clkStMrSignUp(),clkLogin(),clkCanclProfl(),clkApptViewType()},clkCusSchdl=function(){$(".custSchedule").off("click").on("click",function(e){stopEvents(e),$("#login-details-dropdown-ul").hide(),$(".customer-profile-edit, .customer-appointments").show(),$(".customer-profile-profile").removeClass("active"),$(".customer-profile-schedule").addClass("active"),$("#customer-profile-header").html(lang.my_schedule),$(".customer-profile-image").attr("src",$(".customerlist-image").attr("src")),$(".customer-edit-form").hide(),$(".upcomingAppts").hide(),$(".pastAppts").show(),$(".appt-holder").show(),$("#blockpage").css("height",$("body").height()),$("#blockpage").show(),$(".noUpcomingAppts").hide(),$(".noPastAppts").hide(),$(".noCurrentAppts").hide(),$("#notes_wrapper").hide(),isWixApp&&wixStepTab(),getEmailInfoDetails(companyKey);var s=$("#cust-LoginId").html().trim(),t=htmlEscape($("#cust-FirstName").html().trim()),a=t.split(" ")[0],i=$.trim(t.replace(a,""));if($(".customer-profile-Name").html(a+" "+i),showLoaderCustApptView(!0),$(".todaydropdown > a").html(lang.upcoming+' <i class="icon-angle-down"></i>'),s){var o=moment().utc().valueOf()+companyTimeZoneOffset;0===pastCustomerEvents.time&&0===upcomingCustomerEvents.time&&(upcomingCustomerEvents.startTimeLong=o,pastCustomerEvents.endTimeLong=o),0==upcomingCustomerEvents.events.length&&0==pastCustomerEvents.events.length?getCusBks(customerKey,upcomingCustomerEvents,!0):renderCusAppt("upcoming")}$(".customer-col1").addClass("hide-cust-col1"),$(".close-icon").show(),$(".customer-menu-bar").hasClass("active")&&$(".customer-menu-bar").addClass("show-cust-menu"),$(".save-and-cancel").hide(),window.innerWidth<=539&&$(".customer-appointments ul").height(window.innerHeight-$(".my-account-header").innerHeight()-50)})},clkCusEdit=function(){$(".edit").off("click").on("click",function(e){if(stopEvents(e),$("#login-details-dropdown-ul").hide(),$(".customer-profile-edit").show(),$(".customer-profile-schedule").removeClass("active"),$(".customer-profile-profile").addClass("active"),$("#customer-profile-header").html(lang.my_profile),$(".customer-edit-form > ul > li > .input-profile-fields, .customer-edit-form > ul > li > .input-profile-fields input").removeClass("inputError"),$(".customer-edit-form > ul > li > li > .input-profile-fields").removeClass("inputError"),$(".customer-edit-form > ul > li > .input-profile-fields .placeholder-span-focus").removeClass("label-error"),$(".customer-edit-form > ul > li > li > .input-profile-fields .placeholder-span-focus").removeClass("label-error"),$(".upcomingAppts,.appt-holder").hide(),$(".customer-edit-form").show(),$("#backgroundPopup").show(),$(".customer-appointments").hide(),$("#blockpage").css("height",$("body").height()),$("#blockpage").show(),$("#customer-edit-form .intl-tel-input .selected-dial-code").attr("id","cust-edit-countryCode"),$("#notes_wrapper").hide(),$(".save-and-cancel").show(),isWixApp&&($(".wixbody").css("overflow","auto"),isWixApp)){var s=$("#customer-edit-form").height()+$("#company_name").height();wixStepTabCustomerForm(s)}var t=$(".service-container #cust-FirstName").text().trim()?$(".service-container #cust-FirstName").text().trim():$(".classes-container #cust-FirstName").text().trim()?$(".classes-container #cust-FirstName").text().trim():"",a=htmlEscape(t),i=htmlDecode(a),o=i.split(" ")[0],n=$.trim(i.replace(o,""));loginType&&"setmore"!=loginType&&(o=reviewerInfo&&reviewerInfo.hasOwnProperty("FirstName")?htmlDecode(reviewerInfo.FirstName):o,n=reviewerInfo&&reviewerInfo.hasOwnProperty("LastName")?htmlDecode(reviewerInfo.LastName):n);var r=$(".service-container #cust-LoginId").html().trim()?$(".service-container #cust-LoginId").html().trim():$(".classes-container #cust-LoginId").html().trim()?$(".classes-container #cust-LoginId").html().trim():"",l=$(".service-container .customerlist-MobileNo").hasClass("showFields")?$(".service-container .customerlist-PhoneNo").html().trim():$(".classes-container .customerlist-MobileNo").hasClass("showFields")?$(".classes-container .customerlist-PhoneNo").html().trim():$(".service-container #cust-PhoneNo").val()?$(".service-container #cust-PhoneNo").val():$(".classes-container #class_cust-PhoneNo").val(),c=$(".service-container .customerlist-Address").hasClass("showFields")?$(".service-container .customerlist-Address").html().trim():$(".classes-container .customerlist-Address").hasClass("showFields")?$(".classes-container .customerlist-Address").html().trim():$(".service-container #cust-Address").val()?$(".service-container #cust-Address").val():$(".classes-container #class_cust-Address").val(),d=$(".service-container .customerlist-City").hasClass("showFields")?$(".service-container .customerlist-City").html().trim():$(".classes-container .customerlist-City").hasClass("showFields")?$(".classes-container .customerlist-City").html().trim():$(".service-container #cust-City").val()?$(".service-container #cust-City").val():$(".classes-container #class_cust-City").val(),m=$(".service-container .customerlist-State").hasClass("showFields")?$(".service-container .customerlist-State").html().trim():$(".classes-container .customerlist-State").hasClass("showFields")?$(".classes-container .customerlist-State").html().trim():$(".service-container #cust-State").val()?$(".service-container #cust-State").val():$(".classes-container #class_cust-State").val(),p=$(".service-container .customerlist-Zip").hasClass("showFields")?$(".service-container .customerlist-Zip").html().trim():$(".classes-container .customerlist-Zip").hasClass("showFields")?$(".classes-container .customerlist-Zip").html().trim():$(".service-container #cust-Zip").val()?$(".service-container #cust-Zip").val():$(".classes-container #class_cust-Zip").val();if(hideOrDisplayWarn("hideAll","#myProfile"),isIE()){var u=$(".service-container .customerlist-MobileNo").hasClass("showFields")?$(".service-container .customerlist-countryCode").html().trim():$(".classes-container .customerlist-MobileNo").hasClass("showFields")?$(".classes-container .customerlist-countryCode").html().trim():$(".service-container #cust-PhoneNo").val()?$(".service-container #cust-countryCode").val():$(".classes-container #class_cust-PhoneNo").val();u&&(u=u.replace(/\+/g,""),u="+"+u,$("#cust-edit-countryCode").val(u))}else $("#cust-edit-countryCode").hide(),$(".service-container .customerlist-MobileNo").hasClass("showFields")?$("#cust-edit-PhoneNo").intlTelInput("setNumber",$(".service-container .customerlist-countryCode").html().trim()):$(".classes-container .customerlist-MobileNo").hasClass("showFields")?$("#cust-edit-PhoneNo").intlTelInput("setNumber",$(".classes-container .customerlist-countryCode").html().trim()):$(".service-container #cust-PhoneNo").intlTelInput("getSelectedCountryData").dialCode?$("#cust-edit-PhoneNo").intlTelInput("setNumber",_countryCode?_countryCode:$(".service-container .selected-dial-code").text()):$(".classes-container #class_cust-PhoneNo").intlTelInput("getSelectedCountryData").dialCode?$("#cust-edit-PhoneNo").intlTelInput("setNumber",_countryCode?_countryCode:$(".classes-container .selected-dial-code").text()):$("#cust-edit-PhoneNo").intlTelInput("setNumber",_countryCode?_countryCode:$(".classes-container .selected-dial-code").text());var h=o+" "+n;if($(".customer-profile-Name").html(h),$("#cust-edit-FirstName").val(h),$("#cust-edit-LoginId").val(r),$("#cust-edit-PhoneNo").val(l),isNullOrEmpty($("#cust-edit-PhoneNo").val())&&hideOrDisplayWarn("hideAll","#myProfile"),$("#cust-edit-City").val(d),$("#cust-edit-State").val(m),$("#cust-edit-Zip").val(p),$("#cust-edit-PhoneNo").off("blur").on("blur",function(e){var s=$(e.currentTarget),t=$(s).val();t=t.replace(/[^\d\+]/g,""),$(s).val(t.replace(/[^\d]/g,"")),libPhoneNumberValidation(t,s)}),$("#cust-edit-Address").val(htmlDecode(c)),c&&$("#cust-edit-Address").next().addClass("placeholder-span-focus"),""==r&&(document.getElementById("cust-edit-LoginId").removeAttribute("readonly"),document.getElementById("cust-edit-PhoneNo").removeAttribute("readonly")),$(".customerlist-City-State-Zip").hasClass("showFields")){var m=$(".service-container .state-cust").hasClass("showFields")?$(".service-container .state-cust").html().trim():$(".classes-container .state-cust").hasClass("showFields")?$(".classes-container .state-cust").html().trim():"";m=""!=m?m.contains(",")?m.replace(",","").trim():m:"",$("#cust-edit-State").val(htmlDecode(m));var d=$(".service-container .city-cust").hasClass("showFields")?$(".service-container .city-cust").html().trim():$(".classes-container .city-cust").hasClass("showFields")?$(".classes-container .city-cust").html().trim():"";d=""!=d?d.contains(",")?d.replace(",","").trim():d:"",$("#cust-edit-City").val(htmlDecode(d));var p=$(".service-container .zip-cust").hasClass("showFields")?$(".service-container .zip-cust").html().trim():$(".classes-container .zip-cust").hasClass("showFields")?$(".classes-container .zip-cust").html().trim():"";p=""!=p?p.contains(",")?p.replace(",","").trim():p:"",$("#cust-edit-Zip").val(htmlDecode(p))}if(customerInfo.requiredContactFields&&customerInfo.requiredContactFields.indexOf("address")==-1){var d=$(".service-container .city-cust").hasClass("showFields")?$(".service-container .city-cust").html().trim():$(".classes-container .city-cust").hasClass("showFields")?$(".classes-container .city-cust").html().trim():$(".service-container #cust-City").val()?$(".service-container #cust-City").val():$(".classes-container #class_cust-City").val(),m=$(".service-container .state-cust").hasClass("showFields")?$(".service-container .state-cust").html().trim():$(".classes-container .state-cust").hasClass("showFields")?$(".classes-container .state-cust").html().trim():$(".service-container #cust-State").val()?$(".service-container #cust-State").val():$(".classes-container #class_cust-State").val(),p=$(".service-container .zip-cust").hasClass("showFields")?$(".service-container .zip-cust").html().trim():$(".classes-container .zip-cust").hasClass("showFields")?$(".classes-container .zip-cust").html().trim():$(".service-container #cust-Zip").val()?$(".service-container #cust-Zip").val():$(".classes-container #class_cust-Zip").val();$("#cust-edit-City").val(""!=d?d.contains(",")?htmlDecode(d.replace(",","").trim()):htmlDecode(d):""),$("#cust-edit-State").val(""!=m?m.contains(",")?htmlDecode(m.replace(",","").trim()):htmlDecode(m):""),$("#cust-edit-Zip").val(""!=p?p.contains(",")?htmlDecode(p.replace(",","").trim()):htmlDecode(p):"")}$(".customer-profile-image").attr("src",$(".customerlist-image").attr("src")),$("#cust-edit-City").val()&&$("#cust-edit-City").next().addClass("placeholder-span-focus"),$("#cust-edit-State").val()&&$("#cust-edit-State").next().addClass("placeholder-span-focus"),$("#cust-edit-Zip").val()&&$("#cust-edit-Zip").next().addClass("placeholder-span-focus");for(var v=additionalFields.length,g=0;g<v;g++){var f=$(".service-container .customerlistAdditionalFields_"+[g]).hasClass("showFields")?$(".service-container .customerlistAdditionalFields_"+[g]).html().trim():$(".classes-container .customerlistAdditionalFields_"+[g]).hasClass("showFields")?$(".classes-container .customerlistAdditionalFields_"+[g]).html().trim():$(".service-container #custAdditionalFields_"+[g]).val()?$(".service-container #custAdditionalFields_"+[g]).val():$(".classes-container #class_custAdditionalFields_"+[g]).val();$("#cust_edit_AdditionalFields_"+[g]).val(htmlDecode(f)),f&&$("#cust_edit_AdditionalFields_"+[g]).next().addClass("placeholder-span-focus")}$(".customer-profile-signout").hasClass("loginActive")||$(".customer-profile-signout").addClass("loginActive"),($(".service-container .continue").hasClass("normalLogin")||$(".classes-container .continue").hasClass("normalLogin"))&&($(".service-container .continue").addClass("socialLogin").removeClass("normalLogin"),$(".classes-container .continue").addClass("socialLogin").removeClass("normalLogin"),$(".edit").show()),$(".customer-col1").addClass("hide-cust-col1"),$(".close-icon").show(),$(".customer-menu-bar").hasClass("active")&&$(".customer-menu-bar").addClass("show-cust-menu"),window.innerWidth<=539&&$(".customer-edit-form ul").height(window.innerHeight-$(".my-account-header").innerHeight()-100)})},saveCusDtls=function(){$(".save-changes").off("click").on("click",function(){var e="",s="",t="",a="",i="",o="",n="",r="",l="",c="",d="true",m=/<(.|\n)*?>/g;if($("#cust-edit-FirstName")&&""!=$("#cust-edit-FirstName").val().trim()){var p=htmlEscape($("#cust-edit-FirstName").val().trim());e=p.split(" ").slice(0,1).join(" "),s=p.split(" ").slice(1).join(" ")}else d="false",$("#cust-edit-FirstName").parent().addClass("inputError");$("#cust-edit-LoginId")&&""!=$("#cust-edit-LoginId").val().trim()?EmailPattern.test($("#cust-edit-LoginId").val().trim())?(t=$("#cust-edit-LoginId").val().trim(),$("#customer-edit-form .input-profile-fields .email-label .placeholder-span-focus").removeClass("label-error")):(d="false",$("#cust-edit-LoginId").addClass("inputError"),$("#customer-edit-form .input-profile-fields .email-label .placeholder-span-focus").addClass("label-error")):(d="false",$("#cust-edit-LoginId").parent().addClass("inputError"),$("#customer-edit-form .input-profile-fields .email-label .placeholder-span-focus").addClass("label-error")),null!=contactFields&&contactFields.indexOf("phone")!=-1||(requiredFields.indexOf("phone")!=-1?(1==m.test($("#cust-edit-PhoneNo").val().trim())?(d="false",$("#cust-edit-PhoneNo").addClass("inputError"),$("#customer-edit-form .input-profile-fields .phone-label .placeholder-span-focus").addClass("label-error")):($("#cust-edit-PhoneNo").removeClass("inputError"),$("#customer-edit-form .input-profile-fields .phone-label .placeholder-span-focus").removeClass("label-error")),$("#cust-edit-PhoneNo")&&""!=$("#cust-edit-PhoneNo").val().trim()?a=$("#cust-edit-PhoneNo").val():(d="false",$("#cust-edit-PhoneNo").parent().parent().addClass("inputError"),$("#customer-edit-form .input-profile-fields .phone-label .placeholder-span-focus").addClass("label-error"))):$("#cust-edit-PhoneNo")&&""!=$("#cust-edit-PhoneNo").val().trim()?(1==m.test($("#cust-edit-PhoneNo").val().trim())?(d="false",$("#cust-edit-PhoneNo").addClass("inputError"),$("#customer-edit-form .input-profile-fields .phone-label .placeholder-span-focus").addClass("label-error")):($("#cust-edit-PhoneNo").removeClass("inputError"),$("#customer-edit-form .input-profile-fields .phone-label .placeholder-span-focus").removeClass("label-error")),a=$("#cust-edit-PhoneNo").val()):($("#cust-edit-PhoneNo").removeClass("inputError"),$("#customer-edit-form .input-profile-fields .phone-label .placeholder-span-focus").removeClass("label-error")),d="false"==libPhoneNumberValidation($("#cust-edit-PhoneNo").val().trim(),$("#cust-edit-PhoneNo"))?"false":d),null!=contactFields&&contactFields.indexOf("address")!=-1||(requiredFields.indexOf("address")!=-1&&(requiredFields.push("city"),requiredFields.push("state"),requiredFields.push("zip")),requiredFields.indexOf("address")!=-1?(1==m.test($("#cust-edit-Address").val().trim())?(d="false",$("#cust-edit-Address").parent().parent().addClass("inputError"),$("#customer-edit-form .input-profile-fields .address-label .placeholder-span-focus").addClass("label-error")):($("#cust-edit-Address").parent().parent().removeClass("inputError"),$("#customer-edit-form .input-profile-fields .address-label .placeholder-span-focus").removeClass("label-error")),$("#cust-edit-Address")&&""!=$("#cust-edit-Address").val().trim()?i=htmlEscape($("#cust-edit-Address").val().trim()):(d="false",$("#cust-edit-Address").parent().parent().addClass("inputError"),$("#customer-edit-form .input-profile-fields .address-label .placeholder-span-focus").addClass("label-error"))):$("#cust-edit-Address")&&""!=$("#cust-edit-Address").val().trim()?(1==m.test($("#cust-edit-Address").val().trim())?(d="false",$("#cust-edit-Address").parent().parent().addClass("inputError"),$("#customer-edit-form .input-profile-fields .address-label .placeholder-span-focus").addClass("label-error")):($("#cust-edit-Address").parent().parent().removeClass("inputError"),$("#customer-edit-form .input-profile-fields .address-label .placeholder-span-focus").removeClass("label-error")),i=htmlEscape($("#cust-edit-Address").val().trim())):($("#cust-edit-Address").parent().parent().removeClass("inputError"),$("#customer-edit-form .input-profile-fields .address-label .placeholder-span-focus").removeClass("label-error")),requiredFields.indexOf("city")!=-1?(1==m.test($("#cust-edit-City").val().trim())?(d="false",$("#cust-edit-City").addClass("inputError"),$("#customer-edit-form .input-profile-fields .city-label .placeholder-span-focus").addClass("label-error")):($("#cust-edit-City").removeClass("inputError"),$("#customer-edit-form .input-profile-fields .city-label .placeholder-span-focus").removeClass("label-error")),$("#cust-edit-City")&&""!=$("#cust-edit-City").val().trim()?o=htmlEscape($("#cust-edit-City").val().trim()):(d="false",$("#cust-edit-City").addClass("inputError"),$("#customer-edit-form .input-profile-fields .city-label .placeholder-span-focus").addClass("label-error"))):$("#cust-edit-City")&&""!=$("#cust-edit-City").val().trim()?(1==m.test($("#cust-edit-City").val().trim())?(d="false",$("#cust-edit-City").addClass("inputError"),$("#customer-edit-form .input-profile-fields .city-label .placeholder-span-focus").addClass("label-error")):($("#cust-edit-City").removeClass("inputError"),$("#customer-edit-form .input-profile-fields .city-label .placeholder-span-focus").removeClass("label-error")),o=htmlEscape($("#cust-edit-City").val().trim())):($("#cust-edit-City").parent().parent().removeClass("inputError"),$("#customer-edit-form .input-profile-fields .city-label .placeholder-span-focus").removeClass("label-error")),requiredFields.indexOf("state")!=-1?(1==m.test($("#cust-edit-State").val().trim())?(d="false",$("#cust-edit-State").addClass("inputError"),$("#customer-edit-form .input-profile-fields .state-label .placeholder-span-focus").addClass("label-error")):($("#cust-edit-State").removeClass("inputError"),$("#customer-edit-form .input-profile-fields .state-label .placeholder-span-focus").removeClass("label-error")),$("#cust-edit-State")&&""!=$("#cust-edit-State").val().trim()?n=htmlEscape($("#cust-edit-State").val().trim()):(d="false",$("#cust-edit-State").addClass("inputError"),$("#customer-edit-form .input-profile-fields .state-label .placeholder-span-focus").addClass("label-error"))):$("#cust-edit-State")&&""!=$("#cust-edit-State").val().trim()?(1==m.test($("#cust-edit-State").val().trim())?(d="false",$("#cust-edit-State").addClass("inputError"),$("#customer-edit-form .input-profile-fields .state-label .placeholder-span-focus").addClass("label-error")):($("#cust-edit-State").removeClass("inputError"),$("#customer-edit-form .input-profile-fields .state-label .placeholder-span-focus").removeClass("label-error")),
n=htmlEscape($("#cust-edit-State").val().trim())):($("#cust-edit-State").removeClass("inputError"),$("#customer-edit-form .input-profile-fields .state-label .placeholder-span-focus").removeClass("label-error")),requiredFields.indexOf("state")!=-1?(1==m.test($("#cust-edit-Zip").val().trim())?(d="false",$("#cust-edit-Zip").addClass("inputError"),$("#customer-edit-form .input-profile-fields .zip-label .placeholder-span-focus").addClass("label-error")):($("#cust-edit-Zip").removeClass("inputError"),$("#customer-edit-form .input-profile-fields .zip-label .placeholder-span-focus").removeClass("label-error")),$("#cust-edit-Zip")&&""!=$("#cust-edit-Zip").val().trim()?(1==m.test($("#cust-edit-Zip").val().trim())?(d="false",$("#cust-edit-Zip").addClass("inputError"),$("#customer-edit-form .input-profile-fields .zip-label .placeholder-span-focus").addClass("label-error")):($("#cust-edit-Zip").removeClass("inputError"),$("#customer-edit-form .input-profile-fields .zip-label .placeholder-span-focus").removeClass("label-error")),r=$("#cust-edit-Zip").val().trim()):(d="false",$("#cust-edit-Zip").addClass("inputError"),$("#customer-edit-form .input-profile-fields .zip-label .placeholder-span-focus").addClass("label-error"))):$("#cust-edit-Zip")&&""!=$("#cust-edit-Zip").val().trim()?(1==m.test($("#cust-edit-Zip").val().trim())?(d="false",$("#cust-edit-Zip").addClass("inputError"),$("#customer-edit-form .input-profile-fields .zip-label .placeholder-span-focus").addClass("label-error")):($("#cust-edit-Zip").removeClass("inputError"),$("#customer-edit-form .input-profile-fields .zip-label .placeholder-span-focus").removeClass("label-error")),r=$("#cust-edit-Zip").val().trim()):($("#cust-edit-Zip").removeClass("inputError"),$("#customer-edit-form .input-profile-fields .zip-label .placeholder-span-focus").removeClass("label-error")));for(var u="",h="",v="",g=additionalFields.length,f=0;f<g;f++)u=htmlDecode("cust_edit_AdditionalFields_"+f),h=$.trim($("#cust_edit_AdditionalFields_"+f).val()),v=".additionalFields-label-"+f,requiredFields.indexOf(additionalFields[f])!=-1?(1==m.test($("#cust_edit_AdditionalFields_"+f).val().trim())?(d="false",$("#cust_edit_AdditionalFields_"+f).parent().parent().addClass("inputError"),$(v+" .placeholder-span-focus").addClass("label-error")):($("#cust_edit_AdditionalFields_"+f).parent().parent().removeClass("inputError"),$(v+" .placeholder-span-focus").removeClass("label-error")),""!=$("#"+u).val()&&""!=$("#"+u).val().trim()||(d="false",$("#cust_edit_AdditionalFields_"+f).parent().parent().addClass("inputError"),$(v+" .placeholder-span-focus").addClass("label-error"))):h&&1==m.test($("#cust_edit_AdditionalFields_"+f).val().trim())?(d="false",$("#cust_edit_AdditionalFields_"+f).parent().parent().addClass("inputError"),$(v+" .placeholder-span-focus").addClass("label-error")):($("#cust_edit_AdditionalFields_"+f).parent().parent().removeClass("inputError"),$(v+" .placeholder-span-focus").removeClass("label-error"));for(var y={},C=0;C<g;C++)y[String(additionalFields[C])]=$("#cust_edit_AdditionalFields_"+[C]).val();$.isEmptyObject(y),"/bookingpage/images/bookappt_v3/provider_img2.png"!=$(".customerlist-image").attr("src")&&""!=$(".customerlist-image").attr("src")&&(cusProfile=$(".customerlist-image").attr("src"));var _;isIE()?(_=$("#cust-edit-countryCode").val()?$("#cust-edit-countryCode").val():"+"+countryCodeByGoogle,_&&(_=_.replace(/\+/g,""),_="+"+_),country=countryObject.getIntlCountryData(countryInitial.toLowerCase(),!0,!0,"iso2").iso3):(_=$(" #cust-edit-PhoneNo").intlTelInput("getSelectedCountryData").dialCode?"+"+$(" #cust-edit-PhoneNo").intlTelInput("getSelectedCountryData").dialCode:"+"+countryCodeByGoogle,country=$("#cust-edit-PhoneNo").intlTelInput("getSelectedCountryData").iso3);var b={companyKey:companyKey,customerKey:customerKey,firstName:e,lastName:s,emailId:t,phoneNo:a,address:i,city:o,state:n,zip:r,customerImage:cusProfile,countryCode:_,Country:country,additionalFields:y,loginType:loginType,haveEmailReminderEnabled:l,haveTextReminderEnabled:c};"true"==d&&($(".customer-edit-form > ul > li > .input-profile-fields, .customer-edit-form > ul > li > .input-profile-fields input").removeClass("inputError"),$(".customer-edit-form > ul > li > .input-profile-fields .placeholder-span-focus").removeClass("label-error"),$(".customer-edit-form > ul > li > li > .input-profile-fields").removeClass("inputError"),$(".customer-edit-form > ul > li > li > .input-profile-fields .placeholder-span-focus").removeClass("label-error"),updateCusLoginDts(b),$(".loaderMessage").hide()),$(".login-details-ul").hide(),$(".lt_tbcont > a").css("display","none"),window.location.pathname.contains("reviews")&&$("#review_act #review_btn").show(),$("#side-icon").removeClass("icon-chevron-up").addClass("icon-chevron-down"),$(".customerLoginContainer").addClass("removePaddingTop").removeClass("addPaddingTop")})},bkAnthrAppt=function(){$(".bookAnotherAppt").off("click","#another_appt").on("click","#another_appt",function(){var e=window.location.href;window.location.href.contains("/reviews")&&(e=window.location.pathname.replace("/reviews",""),history.pushState?window.history.pushState("","",e):window.location=e),window.location.href=e,isWixApp&&wixStepTabService()})},bkPolicy=function(e){var s=$("#chs_service_act  li"),t=$("#services-tab"),a="srBkd";"cls"==e&&(s=$("#chs_class_act  li"),eleTab=$("#classes-tab"),a="clsBkd"),0==s.length&&_bookingPolicy?$("#policy_link, .policyNote").hide():t.hasClass(a)?$("#policy_link, .policyNote").hide():_bookingPolicy&&($("#policy_link").show(),$(".policyNote").hide(),$(".policyNote").hasClass("viewed")||$(".policyNote").show())},showCurSerSts=function(){$(".customerLoginContainer").hide(),$(".bookAnotherAppt").hide(),$(".callBackUrl").hide();var e="Service"!=customisedServiceLabel?customisedServiceLabel:"en"!=language?lang.service:"Service",s="Provider"!=customisedProviderLabel?customisedProviderLabel:"en"!=language?lang.provider:"Provider";$("#services-tab").hasClass("srPro")?($(".step_tab > h2").html(choose_a_pro+" "+s),$("#sp_act").show(),$("#chs_service_act , #dateCont , #sc_act , #confirmation").hide(),$("#services-tab").removeClass("srLst").removeClass("srDt").removeClass("signInFrm").removeClass("srInfo").removeClass("srCon").removeClass("srBkd").removeClass("srPay")):$("#services-tab").hasClass("srDt")?("true"==_isSkipStaff&&$("#loading_icon").hide(),$("#sLoader").hide(),tempunblockedDates=unblockedDates&&0!=unblockedDates.length?unblockedDates:tempunblockedDates,unblockedDates=[],blockedOutDates=""!=tempBlockedDays?tempBlockedDays:blockedOutDates,restricted_Dates=""!=tempRestrDates?tempRestrDates:restricted_Dates,restrictedDatesInRed=""!=tempRestDtsInRed?tempRestDtsInRed:restrictedDatesInRed,restrictAfterThisDate=""!=temprestrictAfterThisDate?temprestrictAfterThisDate:restrictAfterThisDate,adavanceDays=0!=tempAdvanceDays&&null!=tempAdvanceDays?tempAdvanceDays:adavanceDays,showDatePageHeaderTitle(),$("#dateCont").show(),$("#chs_service_act , #sp_act , #sc_act , #confirmation").hide(),$("#services-tab").removeClass("srLst").removeClass("srPro").removeClass("signInFrm").removeClass("srInfo").removeClass("srCon").removeClass("srBkd").removeClass("srPay")):$("#services-tab").hasClass("signInFrm")?$(".customerLoginContainer").hasClass("selectedFromSlots")?(showDatePageHeaderTitle(),$("#dateCont").show(),"true"==customerInfo.skipStaff||null!=staffResourceInfo?$("#service-back").addClass("back-to-service").addClass("back-to-provider").removeClass("back-to-datePicker"):$("#service-back").addClass("back-to-provider").removeClass("back-to-datePicker"),$("#services-tab").removeClass("srLst").removeClass("srPro").removeClass("signInFrm").removeClass("srInfo").removeClass("srCon").removeClass("srBkd").removeClass("srPay").addClass("srDt")):($(".step_tab > h2").empty(),$(".customerLoginContainer").show(),$(".signIn").show(),$(".signUp,.forget-pwd-container").hide(),$("#chs_service_act , #sp_act, #dateCont , #sc_act , #confirmation").hide(),$("#services-tab").removeClass("srLst").removeClass("srPro").removeClass("srDt").removeClass("srInfo").removeClass("srCon").removeClass("srBkd").removeClass("srPay"),$("#classes-tab").hasClass("clsInfo")&&$("#chs_service_act, #sp_act,#dateCont").hide(),$("#login").hide(),$(".login-icon-div").removeClass("show-login-icon").addClass("hide")):$("#services-tab").hasClass("srInfo")?($(".service-container #sc_act").show(),$(".service-container .customer-login-form").show(),$("#chs_service_act , #sp_act, #dateCont , #confirmation").hide(),$("#services-tab").removeClass("srLst").removeClass("srPro").removeClass("srDt").removeClass("signInFrm").removeClass("srCon").removeClass("srBkd").removeClass("srPay"),chkCusLogin("service-container"),hTitle("service-container")):$("#services-tab").hasClass("srCon")?($(".step_tab > h2").html(lang.confirm_your_appt),$("#confirmation").show(),$("#chs_service_act, #sp_act , #dateCont , #sc_act").hide(),$(".confirm_appt").css({"margin-top":"0px"}),$("#services-tab").removeClass("srLst").removeClass("srPro").removeClass("srDt").removeClass("signInFrm").removeClass("srInfo").removeClass("srBkd").removeClass("srPay")):$("#services-tab").hasClass("srBkd")?($(".step_tab > h2").html(lang.appt_confirmed),$("#confirmation").show(),$(".gdpr_info_container").hide(),$("#policy_link").hide(),$(".policyNote").hide(),$(".confirm_appt").css({"margin-top":"0px"}),$("#chs_service_act, #sp_act , #dateCont , #sc_act").hide(),$("#services-tab").addClass("srBk"),$("#services-tab").removeClass("srLst").removeClass("srPro").removeClass("srDt").removeClass("signInFrm").removeClass("srInfo").removeClass("srCon").removeClass("srPay"),bookAnotherAppt(),showCalBkUrl()):$("#services-tab").hasClass("skipForm")?(hTitle("service-container"),$(".service-container #sc_act, .service-container .customer-login-form").show(),$(".service-container #chs_service_act , .service-container #sp_act, .service-container #dateCont , .service-container #confirmation").hide(),$("#services-tab").removeClass("srLst").removeClass("srPro").removeClass("srDt").removeClass("signInFrom").removeClass("srCon").removeClass("srBkd").removeClass("srInfo")):$("#services-tab").hasClass("srPay")?($(".service_title").html(lang.payment_title),$("#payments-info-holder").show(),$("#chs_service_act, #sp_act , #dateCont , #sc_act , #policy_link").hide(),$(".confirm_appt").css({"margin-top":"0px"}),$("#services-tab").removeClass("srLst").removeClass("srPro").removeClass("srDt").removeClass("signInFrm").removeClass("srInfo").removeClass("srBkd")):($(".step_tab > h2").html(choose_a_ser+" "+e),$("#chs_service_act").show(),$("#sp_act , #dateCont , #sc_act , #confirmation").hide(),$("#services-tab").removeClass("srPro").removeClass("srDt").removeClass("signInFrm").removeClass("srInfo").removeClass("srCon").removeClass("srBkd").removeClass("srPay"),$(".info > span").removeClass("active"),0==$("#chs_service_act > ul").length&&$("#chs_service_act").html("<p>"+lang.booking_services_unavailable+"</p>")),showActiveMobileTab()},showDatePageHeaderTitle=function(){if(_enabledCustLocalTimeZone){$(".step_tab > h2").html("");var e=_seletedTimeZoneFullName?_seletedTimeZoneFullName:timeZoneObj.localTimeZoneObj.timeZoneFullName;$(".chng-tz-a > span").html(e),_bookingPolicy&&$("#policy_link").hide()}else $(".step_tab > h2").html(lang.choose_dateandtime+" ("+shortTimeZone+")"),$(".chng-tz").hide();fbbdp&&($(".service_title").html(lang.select_preferredtime),$(".chng-tz").addClass("fbbdp-adjustment"))},showCurClsSts=function(){if($(".service-container").hide(),$(".classes-container #sc_act").hide(),$("#class_progress-icon").show(),$(".classes-container .loading_icon_timings").hide(),$(".customerLoginContainer").hide(),$(".bookAnotherAppt").hide(),$(".callBackUrl").hide(),$(".mobile-navbar").removeClass("active"),$(".class span.mobile-navbar").addClass("active"),$(".chng-cls-tz").hide(),$("#classes-tab").hasClass("clsPro")){$(".mobile-navbar").removeClass("active"),$(".class_provider span.mobile-navbar").addClass("active"),$("#chs_class_act").hide(),$("#class_provider").show(),$(".classes-container").show();var e="Provider"!=customisedProviderLabel?customisedProviderLabel:"en"!=language?lang.provider:"Provider";$(".class_step_tab h2").html(choose_a_pro+" "+e),$("#class_progress-icon").removeClass("clsPro").removeClass("signInFrm").addClass("clsLst"),$("#classDateCont, .class-container #sc_act, .class_confirmation, .bookAnotherAppt, .callBackUrl").hide(),$("#classes-tab").removeClass("clsLst").removeClass("clsDt").removeClass("signInFrm").removeClass("clsInfo").removeClass("clsCon").removeClass("clsBkd"),showLoginIcon(),bookingPolicy("link")}else if($("#classes-tab").hasClass("clsDt"))tempRestDtsInRed=restrictedDatesInRed&&0!=restrictedDatesInRed.length?restrictedDatesInRed:restrictedDatesInRed,restrictedDatesInRed=[],tempRestrDates=restricted_Dates&&0!=restricted_Dates.length?restricted_Dates:tempRestrDates,restricted_Dates=[],tempBlockedDays=blockedOutDates&&0!=blockedOutDates.length?blockedOutDates:tempBlockedDays,blockedOutDates=[],temprestrictAfterThisDate=restrictAfterThisDate?restrictAfterThisDate:temprestrictAfterThisDate,restrictAfterThisDate="",tempAdvanceDays=adavanceDays?adavanceDays:tempAdvanceDays,adavanceDays=0,unblockedDates=tempunblockedDates,$(".mobile-navbar").removeClass("active"),$(".class_date span.mobile-navbar").addClass("active"),$("#classDateCont").show(),$(".classes-container").show(),$(".customerLoginContainer").hide(),$("#chs_class_act, #class_provider").hide(),$(".class_confirm_appt , .class_global_btn2_lt").hide(),$(".class_step_tab h2").html(lang.choose_dateandtime+" ("+shortTimeZone+")"),$("#classes-tab").removeClass("clsLst").removeClass("clsPro").removeClass("signInFrm").removeClass("clsInfo").removeClass("clsCon").removeClass("clsBkd"),"true"!=_isSkipStaff&&null==staffResourceInfo?$("#class_progress-icon").removeClass("clsDt").removeClass("clsLst").removeClass("signInFrm").removeClass("skipForm").addClass("clsPro"):$("#class_progress-icon").removeClass("clsDt").removeClass("clsLst").removeClass("signInFrm").removeClass("skipForm").removeClass("clsPro").addClass("clsLst"),showLoginIcon(),_enabledCustLocalTimeZone?($(".class_step_tab > h2").html(""),$(".chng-cls-tz").show()):($(".class_step_tab > h2").html(lang.choose_dateandtime+" ("+shortTimeZone+")"),$(".chng-cls-tz").hide()),bookingPolicy("link"),_enabledCustLocalTimeZone&&_bookingPolicy&&$("#policy_link").hide();else if($("#classes-tab").hasClass("signInFrm"))$(".customerLoginContainer").hasClass("selectedFromSlots")?($("#classDateCont").show(),"true"==customerInfo.skipStaff||null!=staffResourceInfo?$("#class-back").addClass("back-to-classes").removeClass("back-to-classDatePicker").removeClass("back-to-classProvider"):$("#class-back").addClass("back-to-classProvider").removeClass("back-to-classDatePicker"),$("#classes-tab").removeClass("clsLst").removeClass("signInFrm").removeClass("clsPro").removeClass("clsInfo").removeClass("clsCon").removeClass("clsBkd").removeClass("clsPay").addClass("clsDt")):($(".class_step_tab > h2").empty(),$(".signIn").show(),$(".signUp,.forget-pwd-container").hide(),$("#chs_class_act").hide(),$(".customerLoginContainer").show(),$("#services-tab").hasClass("srInfo")&&$("#chs_class_act,#class_provider,#classDateCont").hide(),chkCusLogin("classes-container"),$("#classes-tab").removeClass("clsLst").removeClass("clsDt").removeClass("clsPro").removeClass("clsInfo").removeClass("clsCon").removeClass("clsBkd").removeClass("clsPay")),$(".mobile-navbar").removeClass("active"),$(".classes-container").show(),$("#login").hide(),$(".login-icon-div").removeClass("show-login-icon").addClass("hide"),$(".class_confirm_appt , .class_global_btn2_lt").hide();else if($("#classes-tab").hasClass("clsInfo"))$(".mobile-navbar").removeClass("active"),$(".class_info span.mobile-navbar").addClass("active"),$("#class_progress-icon").removeClass("clsInfo").removeClass("signInFrm").addClass("clsDt"),$(".class_confirmation").hide(),$(".classes-container .customer-login-form").show(),$("#chs_class_act, #class_provider,#classDateCont").hide(),$(".classes-container , .classes-container #sc_act ,  .classes-container .customer-login-form").show(),$("#classes-tab").removeClass("clsLst").removeClass("clsPro").removeClass("clsDt").removeClass("signInFrom").removeClass("clsCon").removeClass("clsBkd").removeClass("clsPay"),chkCusLogin("classes-container"),hTitle("classes-container"),bookingPolicy("link");else if($("#classes-tab").hasClass("clsCon"))$(".mobile-navbar").removeClass("active"),$(".class_confirm span.mobile-navbar").addClass("active"),$(".classes-container").show(),$(".class_step_tab h2").html(lang.confirm_your_appt),$("#chs_class_act, #class_provider,#classDateCont").hide(),$(".classes-container #sc_act").hide(),$(".class_confirmation").show(),$(".class_confirmation").css({"margin-top":"30px"}),$("#classes-tab").removeClass("clsLst").removeClass("clsPro").removeClass("clsDt").removeClass("signInFrom").removeClass("clsInfo").removeClass("clsBkd").removeClass("clsPay"),$("#classes-tab").hasClass("clsRebk")&&$("#class_progress-icon").hide();else if($("#classes-tab").hasClass("clsBkd"))$(".mobile-navbar").removeClass("active"),$(".class_confirm span.mobile-navbar").addClass("active"),$(".classes-container").show(),$(".gdpr_info_container").hide(),$(".class_step_tab h2").html(_clsName+" "+lang.confirmed),$(".class_confirmation, .class_confirm_appt").show(),$(".class_confirm_appt").css({"margin-top":"0px"}),$("#class_progress-icon").hide(),$("#chs_class_act").hide(),$("#policy_link").hide(),$(".policyNote").hide(),bookAnotherAppt(),showCalBkUrl(),$("#classes-tab").removeClass("clsLst").removeClass("clsPro").removeClass("clsDt").removeClass("signInFrom").removeClass("clsInfo").removeClass("clsCon").removeClass("clsPay");else if($("#classes-tab").hasClass("skipForm"))$(".mobile-navbar").removeClass("active"),$(".class_info span.mobile-navbar").addClass("active"),hTitle("classes-container"),$(".classes-container , .classes-container #sc_act ,  .classes-container .customer-login-form").show(),$(".classes-container .customer-login-form").show(),$(".classes-container .customer-details-list").show(),$("#chs_class_act, #class_provider,#classDateCont").hide(),$("#classes-tab").removeClass("clsLst").removeClass("clsPro").removeClass("clsDt").removeClass("signInFrom").removeClass("clsCon").removeClass("clsBkd").removeClass("clsPay");else if($("#classes-tab").hasClass("clsPay"))$(".class_step_tab h2").html(lang.payment_title),$("#class-payments-info-holder").show(),$("#chs_class_act, #class_provider , #classDateCont , .classes-container #sc_act, #policy_link").hide(),$(".confirm_appt").css({"margin-top":"0px"}),$("#classes-tab").removeClass("clsLst").removeClass("clsPro").removeClass("clsDt").removeClass("signInFrm").removeClass("clsInfo").removeClass("clsBkd");else{var s="Provider"!=customisedProviderLabel?customisedProviderLabel:"en"!=language?lang.provider:"Provider";if($(".class_provider > span.mobile-navbar").html('<i class="icon-group"></i><label>'+s+"<label>"),$(".class_provider > span.class_step-li").html(s),$("#classes-tab").removeClass("load"),0!=$("#chs_class_act > ul").length){$(".loading_icon_timings").hide(),$("#class_progress-icon").hide(),$(".classes-container,.class_step_tab,.class_title").show();var t="Classes"!=customisedClassLabel?customisedClassLabel:"en"!=language?lang.Class:"Class";$(".class_step_tab > h2").html(choose_a_ser+" "+t),$("#chs_class_act").show(),$(".classes-container .customer-login-form").hide(),$("#classes-tab").removeClass("clsPro").removeClass("clsDt").removeClass("signInFrom").removeClass("clsInfo").removeClass("clsCon").removeClass("clsBkd"),$("#class_progress-icon").removeClass("clsLst").removeClass("clsPro"),$(".class > span.class_step-li").attr("title",htmlDecode(t).toUpperCase()),$(".class_provider > span.class_step-li").attr("title",htmlDecode(s).toUpperCase())}$("#class_provider , #classDateCont , .class_confirmation, .bookAnotherAppt, .callBackUrl").hide(),switchToSerOrClsTab("cls"),$(".classes-container #sc_act").hide(),bookingPolicy("link"),0===$("#chs_class_act > ul").length&&$("#policy_link").hide()}"true"===isReschedulePage&&"null"!==rescheduleClassKey&&($("#login").hide(),$(".login-icon-div").removeClass("show-login-icon").addClass("hide"))},chkCusLogin=function(e){var s=".service-container",t="";if("classes-container"==e&&(s=".classes-container",t="class_"),customerLogin()){$("#login").hide(),$("#login").addClass("hidded"),$(".login-icon-div").removeClass("show-login-icon").addClass("hide");var a=0!==$(".service-container #cust-FirstName").length&&""!=$(".service-container #cust-FirstName").html().trim()&&null!=$(".service-container #cust-FirstName").html().trim()||0!==$(".service-container #cust-IName").length&&""!=$(".service-container #cust-IName").val().trim()||0!==$(".classes-container #cust-FirstName").length&&""!=$(".classes-container #cust-FirstName").html().trim()&&null!=$(".classes-container #cust-FirstName").html().trim()||0!==$(".classes-container #class_cust-IName").length&&""!=$(".classes-container #class_cust-IName").val().trim();if(a){$(".signIn").hide(),$(" "+s+" .yourinfo").show(),$(" "+s+" .customer-login-form").show(),$(" "+s+" .customer-details-list").show(),$("#customer-edit-form .intl-tel-input .selected-dial-code").attr("id","cust-edit-countryCode");var i=$(" "+s+" #cust-FirstName").html()?$(" "+s+" #cust-FirstName").html():$(" "+s+" #cust-FirstName").html();if(i=i?i:$(" "+s+" #"+t+"cust-IName").val()?$(" "+s+" #"+t+"cust-IName").val():$(" "+s+" #"+t+"cust-IName").val(),""==i||fromZendesk||$(" "+s+" #"+t+"cust-IName").val()&&""==$(" "+s+" #cust-FirstName").html())$(" "+s+" #"+t+"cust-IEmailId").parent().parent().show(),$(" "+s+" #"+t+"cust-IName").parent().show(),$(" "+s+" .cust-details,  "+s+" .customerImg, "+s+" #customerEdit ").hide(),"classes-container"==e?($(".class_step_tab > h2").html(lang.enter_your_information),$(".classes-container .intl-tel-input .selected-dial-code").attr("id","class_cust-countryCode")):($(".step_tab > h2").html(lang.enter_your_information),$(".service-container .intl-tel-input .selected-dial-code").attr("id","cust-countryCode")),formVals(e);else{var o=i.trim();"classes-container"==e?($(".class_step_tab > h2").html(lang.hi+" "+o+", "+lang.please_review_your_info),$(".classes-container .customer-details-list").show(),$(".classes-container .intl-tel-input .selected-dial-code").attr("id","class_cust-countryCode")):(window.isMobile.matches?$(".step_tab > h2").html(lang.hi+" "+o+", <br/>"+lang.please_review_your_info):$(".step_tab > h2").html(lang.hi+" "+o+", "+lang.please_review_your_info),$(".service-container .intl-tel-input .selected-dial-code").attr("id","cust-countryCode")),$(" ."+e+" .yourinfo").show(),$(" ."+e+" .customer-login-form").show(),formVals(e)}"service-container"==e&&($(".gt_act").removeClass("timeslot_tab"),$(".gt_act").addClass("eCusDetails_tab"),$("#services-tab").removeClass("srLst").removeClass("srPro").removeClass("srDt").removeClass("srCon").removeClass("srBkd").removeClass("signInFrm").addClass("srInfo").removeClass("srPay"))}else{bookingPageSettings.enabledFields&&bookingPageSettings.enabledFields.indexOf("thirdPartyLoginReq")!=-1?$("#skip_step").hide():bookingPageSettings.enabledFields&&bookingPageSettings.enabledFields.indexOf("thirdPartyLoginReq")==-1&&"true"==customerInfo.thirdPartyLogin?$("#skip_step").show():$("#skip_step").hide(),$(".signIn").addClass("active"),$(".customerLoginContainer").show(),$(".customerLoginContainer, .signIn").show(),window.isMobile.matches?$(".customerLoginContainer").addClass("selectedFromSlots"):$(".close-sign-in").addClass("hide-close-icon"),$(".signUp").hide(),classes.length?$(".customerLoginContainer").css({top:"165px"}):$(".customerLoginContainer").css({top:"150px"}),$("#policy_link").hide(),""==companyDetails.companyName&&$(".customerLoginContainer").css({top:"144px"});var n=htmlDecode(companyDetails.companyName);(null!=staffResourceInfo||n.length>45)&&(classes.length?($(".customerLoginContainer").css({top:"165px"}),$(".customerLoginContainer").addClass("cStaffPLog")):($(".customerLoginContainer").css({top:"170px"}),$(".customerLoginContainer").addClass("sStaffPLog"))),$(".col2").css({"margin-bottom":"20px"}),$(".signIn").hasClass("forgotPassword")&&$(".forget-pwd-container").hide(),$("#noAcc").is(":visible")&&$("#skip_step").hide(),"classes-container"==e?($("#classes-tab").hasClass("skipForm")||($("#classes-tab").removeClass("clsLst").removeClass("clsPro").removeClass("clsDt").removeClass("clsInfo").removeClass("clsCon").removeClass("clsBkd").addClass("signInFrm"),"true"!=_isSkipStaff&&null==staffResourceInfo?$("#class_progress-icon").removeClass("clsLst").removeClass("clsPro").removeClass("clsDt").removeClass("clsInfo").removeClass("clsCon").addClass("signInFrm"):$("#class_progress-icon").removeClass("clsLst").removeClass("clsPro").removeClass("signInFrm").removeClass("clsInfo").removeClass("clsCon").addClass("clsDt")),$(".class_step_tab > h2").empty()):($("#services-tab").hasClass("skipForm")||$("#services-tab").removeClass("srLst").removeClass("srPro").removeClass("srDt").removeClass("srCon").removeClass("srBkd").removeClass("srInfo").addClass("signInFrm").removeClass("srPay"),$(".step_tab > h2").empty()),0==fromZendesk&&($(" "+s+" .continue").removeClass("normalLogin").addClass("socialLogin"),$(" "+s+" .continue").removeClass("normalLogin").addClass("socialLogin")),$(".col1 > .nav > .gt, .side-menu-col1 > .nav > .gt").hasClass("active")?$(".col1 > .nav > .gt > #gt_sr , .side-menu-col1 > .nav > .gt > #gt_sr").addClass("signIn_tab"):$(".gt_cls").hasClass("active")&&$("#gt_cls").addClass("signIn_tab"),$(" "+s+" .customer-login-form").hide(),$(" "+s+" #"+t+"cust-IName").parent().hide(),$(" "+s+" #"+t+"cust-IEmailId").parent().parent().hide(),$(" "+s+" #cust-FirstName").show(),$(" "+s+" #cust-FirstName, "+s+" #cust-LastName, "+s+" #cust-LoginId").show()}}else"classes-container"==e?($(".service-container").hide(),$(".classes-container #sc_act, .classes-container .customer-login-form").show(),$(".classes-container .customer-details-list").css({"margin-top":"0"}),$(".classes-container .customerImg").hide()):$(".classes-container").hide(),$(" "+s+" #customerEdit").hide(),void 0!=typeof facebookPage&&"true"==facebookPage?(console.log("here into if"),showForm()):formVals(e)},formVals=function(e){var s=".classes-container";"service-container"==e&&(s=".service-container"),$(""+s+" #cust-IName").val()?$("."+e+" #cust-IName").val($(""+s+" #cust-IName").val().trim()):$(""+s+" #cust-FirstName").html()&&($("."+e+" #cust-FirstName").html($(""+s+" #cust-FirstName").html().trim()),$("."+e+" #cust-FirstName").show()),$(""+s+" #cust-IEmailId").val()?$("."+e+" #cust-IEmailId").val($(""+s+" #cust-IEmailId").val().trim()):$(""+s+" #cust-LoginId").html()&&($("."+e+" #cust-LoginId").html($(""+s+" #cust-LoginId").html().trim()),$("."+e+" #cust-LoginId").show()),$(""+s+" #cust-countryCode").val()&&$("."+e+" #cust-countryCode").val($(""+s+" #cust-countryCode").val().trim()),$(""+s+" #cust-PhoneNo").val()&&$("."+e+" #cust-PhoneNo").val($(""+s+" #cust-PhoneNo").val().trim()),$(""+s+" #cust-Address").val()&&$("."+e+" #cust-Address").val($(""+s+" #cust-Address").val().trim()),$(""+s+" #cust-City").val()&&$("."+e+" #cust-City").val($(""+s+" #cust-City").val().trim()),$(""+s+" #cust-State").val()&&$("."+e+" #cust-State").val($(""+s+" #cust-State").val().trim()),$(""+s+" #cust-Zip").val()&&$("."+e+" #cust-Zip").val($(""+s+" #cust-Zip").val().trim()),$(""+s+" #cust-Comments").val()&&$("."+e+" #cust-Comments").val($(""+s+" #cust-Comments").val().trim());for(var t=0;t<additionalFields.length;t++)$(""+s+" #custAdditionalFields_"+t).val()&&$("."+e+"  #custAdditionalFields_"+t).val($(""+s+"  #custAdditionalFields_"+t).val().trim())},validFormFields=function(e){var s=".service-container",t="";"classes"==e&&(t="class_",s=".classes-container"),requiredFields.indexOf("address")!=-1&&(requiredFields.push("city"),requiredFields.push("state"),requiredFields.push("zip"));var a="true",i=/<(.|\n)*?>/g;if("/bookingpage/images/bookappt_v3/provider_img2.png"!=$(""+s+" .customerlist-image").attr("src")&&""!=$(""+s+" .customerlist-image").attr("src")&&(cusProfile=$(""+s+" .customerlist-image").attr("src")),!$(""+s+" #sc_act .continue").hasClass("socialLogin")||$(""+s+" #sc_act .customer-details-list #"+t+"cust-IName").val()&&""==$(""+s+" #sc_act #cust-FirstName").html().trim()){if(1==i.test($(""+s+" #sc_act .customer-details-list #"+t+"cust-IName").val().trim()))a="false",$(""+s+" #sc_act .customer-details-list #"+t+"cust-IName").parent().addClass("inputError");else if($(""+s+" #sc_act .customer-details-list #"+t+"cust-IName").val().trim()){var o=htmlEscape($(""+s+" #sc_act .customer-details-list #"+t+"cust-IName").val().trim());custFirstName=o.split(" ")[0],custLastName=$.trim(o.replace(custFirstName,"")),custLastName.contains("amp;","")?custLastName=custLastName.replace(/amp;/gi,""):custFirstName.contains("amp;","")&&(custFirstName=custFirstName.replace(/amp;/gi,"")),$(""+s+" #sc_act .customer-details-list #"+t+"cust-IName").parent().hasClass("inputError")&&$(""+s+" #sc_act .customer-details-list #"+t+"cust-IName").parent().removeClass("inputError")}else a="false",$(""+s+" #sc_act .customer-details-list #"+t+"cust-IName").parent().addClass("inputError");null!=contactFields&&contactFields.indexOf("email")!=-1||(requiredFields.indexOf("email")!=-1&&($(""+s+" #sc_act .customer-details-list #"+t+"cust-IEmailId")&&""!=$(""+s+" #sc_act .customer-details-list #"+t+"cust-IEmailId").val().trim()?EmailPattern.test($(""+s+" #sc_act .customer-details-list #"+t+"cust-IEmailId").val().trim())?(cusEmail=$(""+s+" #sc_act .customer-details-list #"+t+"cust-IEmailId").val().trim(),$(""+s+" #sc_act .customer-details-list #"+t+"cust-IEmailId").parent().hasClass("inputError")&&$(""+s+" #sc_act .customer-details-list #"+t+"cust-IEmailId").parent().removeClass("inputError")):(a="false",$(""+s+" #sc_act .customer-details-list #"+t+"cust-IEmailId").parent().addClass("inputError")):(a="false",$(""+s+" #"+t+"cust-IEmailId").parent().addClass("inputError"))),$(""+s+" #"+t+"cust-IEmailId")&&""!=$(""+s+" #"+t+"cust-IEmailId").val().trim()&&(EmailPattern.test($(""+s+" #"+t+"cust-IEmailId").val().trim())?(cusEmail=$(""+s+" #"+t+"cust-IEmailId").val().trim().toLowerCase(),$(""+s+" #"+t+"cust-IEmailId").parent().hasClass("inputError")&&$(""+s+" #"+t+"cust-IEmailId").parent().removeClass("inputError")):(a="false",$(""+s+" #"+t+"cust-IEmailId").parent().addClass("inputError")))),null!=contactFields&&contactFields.indexOf("phone")!=-1||(requiredFields.indexOf("phone")!=-1?1==i.test($(""+s+" #"+t+"cust-PhoneNo").val().trim())||1==i.test($(""+s+" #"+t+"cust-PhoneNo").intlTelInput("getSelectedCountryData").dialCode)?(a="false",$(""+s+" #"+t+"cust-PhoneNo").parent().addClass("inputError"),showValidationAletMsg("Invalid phone number")):$(""+s+" #"+t+"cust-PhoneNo")&&""!=$(""+s+" #"+t+"cust-PhoneNo").val().trim()?(custPhoneNum=$(""+s+" #"+t+"cust-PhoneNo").val().trim(),$(""+s+" #"+t+"cust-PhoneNo").parent().hasClass("inputError")&&$(""+s+" #"+t+"cust-PhoneNo").parent().removeClass("inputError")):(a="false",$(""+s+" #"+t+"cust-PhoneNo").parent().addClass("inputError")):1==i.test($(""+s+" #"+t+"cust-PhoneNo").val().trim())||1==i.test($(""+s+" #"+t+"cust-PhoneNo").intlTelInput("getSelectedCountryData").dialCode)?(a="false",$(""+s+" #"+t+"cust-PhoneNo").parent().addClass("inputError"),showValidationAletMsg("Invalid phone number")):$(""+s+" #"+t+"cust-PhoneNo")&&""!=$(""+s+" #"+t+"cust-PhoneNo").val().trim()&&(custPhoneNum=$(""+s+" #"+t+"cust-PhoneNo").val().trim(),$(""+s+" #"+t+"cust-PhoneNo").parent().hasClass("inputError")&&$(""+s+" #"+t+"cust-PhoneNo").parent().removeClass("inputError")),a="false"==libPhoneNumberValidation($(""+s+" #"+t+"cust-PhoneNo").val().trim(),$(""+s+" #"+t+"cust-PhoneNo"))?"false":a),null!=contactFields&&contactFields.indexOf("address")!=-1||(1==i.test($(""+s+" #"+t+"cust-Address").val().trim())?(a="false",
$(""+s+" #"+t+"cust-Address").addClass("inputError")):requiredFields.indexOf("address")!=-1&&($(""+s+" #"+t+"cust-Address")&&""!=$(""+s+" #"+t+"cust-Address").val().trim()?(cusAddress=htmlEscape($(""+s+" #"+t+"cust-Address").val()),$(""+s+" #"+t+"cust-Address").parent().hasClass("inputError")&&$(""+s+" #"+t+"cust-Address").parent().removeClass("inputError")):(a="false",$(""+s+" #"+t+"cust-Address").parent().addClass("inputError"))),$(""+s+" #"+t+"cust-Address")&&""!=$(""+s+" #"+t+"cust-Address").val().trim()&&(cusAddress=htmlEscape($(""+s+" #"+t+"cust-Address").val()),$(""+s+" #"+t+"cust-Address").parent().hasClass("inputError")&&$(""+s+" #"+t+"cust-Address").parent().removeClass("inputError")),requiredFields.indexOf("city")!=-1&&($(""+s+" #"+t+"cust-City")&&""!=$(""+s+" #"+t+"cust-City").val().trim()?cusCity=htmlEscape($(""+s+" #"+t+"cust-City").val()):(a="false",$(""+s+" #"+t+"cust-City").addClass("inputError"))),1==i.test($(""+s+" #"+t+"cust-City").val().trim())?(a="false",$(""+s+" #"+t+"cust-City").addClass("inputError")):$(""+s+" #"+t+"cust-City")&&""!=$(""+s+" #"+t+"cust-City").val().trim()&&(cusCity=htmlEscape($(""+s+" #"+t+"cust-City").val()),$(""+s+" #"+t+"cust-City").removeClass("inputError")),requiredFields.indexOf("state")!=-1&&($(""+s+" #"+t+"cust-State")&&""!=$(""+s+" #"+t+"cust-State").val().trim()?cusState=htmlEscape($(""+s+" #"+t+"cust-State").val()):(a="false",$(""+s+" #"+t+"cust-State").addClass("inputError"))),1==i.test($(""+s+" #"+t+"cust-State").val().trim())?(a="false",$(""+s+" #"+t+"cust-State").addClass("inputError")):$(""+s+" #"+t+"cust-State")&&""!=$(""+s+" #"+t+"cust-State").val().trim()&&(cusState=htmlEscape($(""+s+" #"+t+"cust-State").val()),$(""+s+" #"+t+"cust-State").removeClass("inputError")),requiredFields.indexOf("zip")!=-1&&($(""+s+" #"+t+"cust-Zip")&&""!=$(""+s+" #"+t+"cust-Zip").val().trim()?cusZip=$("#"+t+"cust-Zip").val():(a="false",$(""+s+" #"+t+"cust-Zip").addClass("inputError"))),1==i.test($(""+s+" #"+t+"cust-Zip").val().trim())?(a="false",$(""+s+" #"+t+"cust-Zip").addClass("inputError")):$(""+s+" #"+t+"cust-Zip")&&""!=$(""+s+" #"+t+"cust-Zip").val().trim()&&(cusZip=$(""+s+" #"+t+"cust-Zip").val(),$(""+s+" #"+t+"cust-Zip").removeClass("inputError")))}else if($(""+s+" #sc_act .continue").hasClass("socialLogin")){if($(""+s+" #sc_act #cust-FirstName").html().trim()){var o=htmlEscape($(""+s+" #cust-FirstName").html().trim());custFirstName=o.split(" ")[0],custLastName=$.trim(o.replace(custFirstName,"")),custLastName.contains("amp;","")&&(custLastName=custLastName.replace(/amp;/gi,"")),custFirstName.contains("amp;","")&&(custFirstName=custFirstName.replace(/amp;/gi,"")),$(""+s+" #"+t+"cust-IName").parent().hasClass("inputError")&&$(""+s+" #"+t+"cust-IName").parent().removeClass("inputError")}$(""+s+" #cust-LoginId")&&""!=$(""+s+" #cust-LoginId").html().trim()&&(EmailPattern.test($(""+s+" #cust-LoginId").html())?(cusEmail=$(""+s+" #cust-LoginId").html(),$(""+s+" #"+t+"cust-IEmailId").parent().hasClass("inputError")&&$(""+s+" #"+t+"cust-IEmailId").parent().removeClass("inputError")):(a="false",$(""+s+" #cust-LoginId").addClass("inputError"))),$(""+s+" .customerlist-MobileNo").hasClass("showFields")?$(""+s+" .customerlist-PhoneNo")&&""!=$(""+s+" .customerlist-PhoneNo").html().trim()&&(custPhoneNum=$(""+s+" .customerlist-PhoneNo").html()):null!=contactFields&&contactFields.indexOf("phone")!=-1||(requiredFields.indexOf("phone")!=-1?(1==i.test($(""+s+" #"+t+"cust-PhoneNo").val().trim())?(a="false",$(""+s+" #"+t+"cust-PhoneNo").addClass("inputError")):$(""+s+" #"+t+"cust-PhoneNo").removeClass("inputError"),$(""+s+" #"+t+"cust-PhoneNo")&&""!=$(""+s+" #"+t+"cust-PhoneNo").val().trim()?(custPhoneNum=$(""+s+" #"+t+"cust-PhoneNo").val().trim(),$(""+s+" #"+t+"cust-PhoneNo").parent().hasClass("inputError")&&$(""+s+" #"+t+"cust-PhoneNo").parent().removeClass("inputError")):(a="false",$(""+s+" #"+t+"cust-PhoneNo").parent().addClass("inputError")),a="false"==libPhoneNumberValidation($(""+s+" #"+t+"cust-PhoneNo").val().trim(),$(""+s+" #"+t+"cust-PhoneNo"))?"false":a):$(""+s+" #"+t+"cust-PhoneNo")&&""!=$(""+s+" #"+t+"cust-PhoneNo").val().trim()&&(1==i.test($(""+s+" #"+t+"cust-PhoneNo").val().trim())?(a="false",$(""+s+" #"+t+"cust-PhoneNo").addClass("inputError")):$(""+s+" #"+t+"cust-PhoneNo").removeClass("inputError"),custPhoneNum=$(""+s+" #"+t+"cust-PhoneNo").val(),$(""+s+" #"+t+"cust-PhoneNo").parent().hasClass("inputError")&&$(""+s+" #"+t+"cust-PhoneNo").parent().removeClass("inputError"),a="false"==libPhoneNumberValidation($(""+s+" #"+t+"cust-PhoneNo").val().trim(),$(""+s+" #"+t+"cust-PhoneNo"))?"false":a)),null!=contactFields&&contactFields.indexOf("address")!=-1||(1==i.test($(""+s+" #"+t+"cust-Address").val().trim())?(a="false",$(""+s+" #"+t+"cust-Address").addClass("inputError")):$(""+s+" #"+t+"cust-Address").removeClass("inputError"),1==i.test($(""+s+" #"+t+"cust-City").val().trim())?(a="false",$(""+s+" #"+t+"cust-City").addClass("inputError")):$(""+s+" #"+t+"cust-City").removeClass("inputError"),1==i.test($(""+s+" #"+t+"cust-State").val().trim())?(a="false",$(""+s+" #"+t+"cust-State").addClass("inputError")):$(""+s+" #"+t+"cust-State").removeClass("inputError"),1==i.test($(""+s+" #"+t+"cust-Zip").val().trim())?(a="false",$(""+s+" #"+t+"cust-Zip").addClass("inputError")):$(""+s+" #"+t+"cust-Zip").removeClass("inputError"),$(""+s+" .customerlist-Address").hasClass("showFields")?$(""+s+" .customerlist-Address")&&""!=$(""+s+" .customerlist-Address").html().trim()&&(cusAddress=htmlEscape($(""+s+" .customerlist-Address").text())):(requiredFields.indexOf("address")!=-1&&($(""+s+" #"+t+"cust-Address")&&""!=$(""+s+" #"+t+"cust-Address").val().trim()?(cusAddress=htmlEscape($(""+s+" #"+t+"cust-Address").val()),$(""+s+" #"+t+"cust-Address").parent().hasClass("inputError")&&$(""+s+" #"+t+"cust-Address").parent().removeClass("inputError")):(a="false",$(""+s+" #"+t+"cust-Address").parent().addClass("inputError"))),$(""+s+" #"+t+"cust-Address")&&0!=$(""+s+" #"+t+"cust-Address").length&&""!=$(""+s+" #"+t+"cust-Address").val().trim()&&(cusAddress=htmlEscape($(""+s+" #"+t+"cust-Address").val()),$(""+s+" #"+t+"cust-Address").parent().hasClass("inputError")&&$(""+s+" #"+t+"cust-Address").parent().removeClass("inputError"))),$(""+s+" .city-cust").hasClass("showFields")?$(""+s+" .city-cust")&&""!=$(""+s+" .city-cust").html().trim()&&(cusCity=htmlEscape($(""+s+" .city-cust").text())):(requiredFields.indexOf("city")!=-1&&($(""+s+" #"+t+"cust-City")&&""!=$(""+s+" #"+t+"cust-City").val().trim()?cusCity=htmlEscape($(""+s+" #"+t+"cust-City").val().trim()):(a="false",$(""+s+" #"+t+"cust-City").addClass("inputError"))),$(""+s+" #"+t+"cust-City")&&""!=$(""+s+" #"+t+"cust-City").val().trim()&&(cusCity=htmlEscape($(""+s+" #"+t+"cust-City").val().trim()))),$(""+s+" .state-cust").hasClass("showFields")?$(""+s+" .state-cust")&&""!=$(""+s+" .state-cust").html().trim()&&(cusState=htmlEscape($(""+s+" .state-cust").text().trim()).replace(",","").trim()):(requiredFields.indexOf("state")!=-1&&($(""+s+" #"+t+"cust-State")&&""!=$(""+s+" #"+t+"cust-State").val().trim()?(cusState=htmlEscape($(""+s+" #"+t+"cust-State").val().trim()),$(""+s+" #"+t+"cust-State").removeClass("inputError")):(a="false",$(""+s+" #"+t+"cust-State").addClass("inputError"))),$(""+s+" #"+t+"cust-State")&&""!=$(""+s+" #"+t+"cust-State").val().trim()&&(cusState=htmlEscape($(""+s+" #"+t+"cust-State").val().trim()))),$(""+s+" .zip-cust").hasClass("showFields")?$(""+s+" .zip-cust")&&""!=$(""+s+" .zip-cust").html().trim()&&(cusZip=$(""+s+" .zip-cust").text().trim().replace(",","").trim()):(requiredFields.indexOf("zip")!=-1&&($(""+s+" #"+t+"cust-Zip")&&""!=$(""+s+" #"+t+"cust-Zip").val().trim()?(cusZip=$(""+s+" #"+t+"cust-Zip").val().trim(),$(""+s+" #"+t+"cust-Zip").removeClass("inputError")):(a="false",$(""+s+" #"+t+"cust-Zip").addClass("inputError"))),$(""+s+" #"+t+"cust-Zip")&&""!=$(""+s+" #"+t+"cust-Zip").val().trim()&&(cusZip=$(""+s+" #"+t+"cust-Zip").val().trim())))}"classes"!=e&&(requiredFields.indexOf("comments")!=-1&&($(""+s+" #cust-Comments")&&""!=$(""+s+" #cust-Comments").val().trim()?(cusComments=htmlEscape($(""+s+" #cust-Comments").val()),$(""+s+" #cust-Comments").removeClass("inputError")):(a="false",$(""+s+" #cust-Comments").addClass("inputError"))),1==i.test($(""+s+" #cust-Comments").val().trim())?(a="false",$(""+s+" #cust-Comments").addClass("inputError")):$(""+s+" #cust-Comments")&&""!=$(""+s+" #cust-Comments").val().trim()?(cusComments=htmlEscape($(""+s+" #cust-Comments").val()),$(""+s+" #cust-Comments").removeClass("inputError")):$(""+s+" #cust-Comments").removeClass("inputError"));var n="",r="";custAdditionalFields="",additionalFields.remove("name","phone","email","address");for(var l=0;l<additionalFields.length;l++)n=htmlDecode(t+"custAdditionalFields_"+l),r=$.trim($(""+s+" #sc_act #"+t+"custAdditionalFields_"+l).val()),$(""+s+" #sc_act .continue").hasClass("normalLogin")||null!=rescheduleResourceInfo&&null!=resuchduleServicesInfo?requiredFields.indexOf(additionalFields[l])!=-1?(i.test(r)&&(a="false",$(""+s+"#"+t+"custAdditionalFields_"+l).addClass("inputError")),""==$(""+s+" #sc_act #"+n).val()||""==$(""+s+" #sc_act #"+n).val().trim()?(a="false",$(""+s+" #sc_act #"+t+"custAdditionalFields_"+l).addClass("inputError")):custAdditionalFields+="smspace"+r):(r?i.test($(""+s+" #sc_act #"+n).val().trim())?(a="false",$(""+s+"#"+t+"custAdditionalFields_"+l).addClass("inputError")):$(""+s+"#"+t+"custAdditionalFields_"+l).removeClass("inputError"):$(""+s+" #sc_act #"+t+"custAdditionalFields_"+l).parent().removeClass("inputError"),custAdditionalFields+="smspace"+r):$(""+s+" #sc_act .continue").hasClass("socialLogin")&&($(""+s+" #sc_act .customerlistAdditionalFields_"+l).hasClass("showFields")?$(""+s+" #sc_act .customerlistAdditionalFields_"+l)&&""!=$(""+s+" #sc_act .customerlistAdditionalFields_"+l).html()&&(r=$.trim($(""+s+" #sc_act .customerlistAdditionalFields_"+l).text()),custAdditionalFields+="smspace"+r):requiredFields.indexOf(additionalFields[l])!=-1?(i.test($(""+s+" #sc_act #"+n).val().trim())?(a="false",$(""+s+" #sc_act #"+t+"custAdditionalFields_"+l).parent().addClass("inputError")):$(""+s+" #sc_act #"+t+"custAdditionalFields_"+l).parent().removeClass("inputError"),""==$(""+s+" #sc_act #"+n).val()||""==$(""+s+" #sc_act #"+n).val().trim()?(a="false",$(""+s+" #sc_act #"+t+"custAdditionalFields_"+l).parent().addClass("inputError")):custAdditionalFields+="smspace"+r):(r&&i.test($(""+s+" #sc_act #"+n).val().trim())?(a="false",$(""+s+" #sc_act #"+t+"custAdditionalFields_"+l).parent().addClass("inputError")):$(""+s+" #sc_act #"+t+"custAdditionalFields_"+l).parent().removeClass("inputError"),custAdditionalFields+="smspace"+r));if(_canclPlcyHrs&&"Anytime"!=_canclPlcyHrs&&($(""+s+" #acceptCancellationPolicyTerms").is(":checked")||($(""+s+" .errorMsg").show(),a="false")),bookingPageSettings&&bookingPageSettings.termsNCond&&""!=bookingPageSettings.termsNCond&&(".classes-container"!=s||$(""+s+" #TnCcheckboxClass").is(":checked")?".service-container"!=s||$(""+s+" #TnCcheckbox").is(":checked")||($(""+s+" .TnCErr").show(),a="false"):($(""+s+" .TnCErr").show(),a="false")),"true"==a)return $(""+s+" .customer-details-list").find("input").removeClass("inputError"),$(".errorMsg").hide(),$(""+s+" .customer-holder > ul").children().each(function(){$(""+s+" .customer-details-list > li > .input-profile-fields").hasClass("inputError")&&$(""+s+" .customer-details-list > li > .input-profile-fields").removeClass("inputError")}),"service"==e?(_serCusObj={cusProfile:cusProfile,custFirstName:custFirstName,custLastName:custLastName,cusEmail:cusEmail,custPhoneNum:custPhoneNum,cusAddress:cusAddress,cusCity:cusCity,cusState:cusState,cusZip:cusZip,custAdditionalFields:custAdditionalFields},setCustInfo(_serCusObj)):"classes"==e&&(_clsCusObj={cusProfile:cusProfile,custFirstName:custFirstName,custLastName:custLastName,cusEmail:cusEmail,custPhoneNum:custPhoneNum,cusAddress:cusAddress,cusCity:cusCity,cusState:cusState,cusZip:cusZip,custAdditionalFields:custAdditionalFields},setCustInfo(_clsCusObj)),!0},updateCompanyDetails=function(){if($("#progress-icon").hide(),""!=companyLogo&&null!=companyLogo&&"null"!=companyLogo&&void 0!=companyLogo){var e=companyDetails.companyLogoPath.contains("http:")?companyDetails.companyLogoPath.replace("http:","https:"):companyDetails.companyLogoPath;$(".logo").html("<img src="+e+"=s220></img>"),$(".logo > img").on("load",function(){var e=$(".col1").width(),s=$(".logo > img").width(),t=e-s>0?(e-s)/2+"px":0;$(".logo > img").css({"margin-top":t,"margin-bottom":t})}),$("#company-logo").css("background-image","url("+e+")")}else $(".logo").html('<img src="/bookingpage/images/bookappt_v3/logo-placeholder.png"></img>'),$("#company-logo").css("background-image",'url("/bookingpage/images/bookappt_v3/logo-placeholder.png")');var s="Service"!=customisedServiceLabel?customisedServiceLabel:"en"!=language?lang.service:"Service";$(".step_tab > h2").html(choose_a_ser+"  "+s),fbbdp&&($("#required-feilds-error").css({display:"none"}),$(".step_tab > h2").css({"padding-left":"0px"})),bookingPolicy(fbbdp?"link":"load"),$(".map_addr_businesshours").show(),"Premium Plan"!=planJDOMap.planName&&"Legacy Plan"!=planJDOMap.planName||($("#TextReminders").show(),$(".textReminder").show()),$("#classes-tab").html('<i class="icon-sitemap"></i>  '+_customizedClassName),$("#class_name").html("Classes"!=customisedClassLabel?customisedClassLabel:"en"!=language?lang.Class:"CLASS"),$(".classes_act").html('<i class="icon-sitemap icon-2x"></i>'+_customizedClassName),classes.length&&($(".detail-navbar").addClass("showClassesTab"),$(".chng-tz").addClass("tzCss")),1==customerInfo.thirdPartyLogin&&($(".login_details").hasClass(lVissible)?($("#login, .Log-in").hide(),$(".login-icon-div").addClass("hide").removeClass("show-login-icon")):($("#login, .Log-in").show(),$(".login-icon-div").addClass("show-login-icon").removeClass("hide"))),0==bookingPageSettings.showMenuBar?($(".menu-header").hide(),$("#company_name").addClass("no-menu-bar"),$(".row1").addClass("menu-hide")):$("#gt_act").addClass("menu_tb"),"Arabic"==language?$("#side-login").css({left:"24px"}):"French"==language&&$("#side-login").css({left:"19px"}),null!=additionalFields&&$(".service-container #cust-continue , .classes-container #cust-continue").addClass("resp-cont-btn"),window.isMobile.matches&&$("#inner_header > a").attr("href","//www.setmore.com/?utm_source=header&utm_medium=booking%20page")},bookingPolicy=function(e){if(_bookingPolicy="",customerInfo.customerNotes&&void 0!=customerInfo.customerNotes.value&&""!=customerInfo.customerNotes.value&&"undefined"!=customerInfo.customerNotes.value&&null!=customerInfo.customerNotes.value){var s=new RegExp("\n","g");_bookingPolicy+=String(customerInfo.customerNotes.value.replace(s,"<br />"))}""!=_bookingPolicy?($("#policy_link").show(),"link"!=e&&($("#notes_wrapper").show(),$("#customerNotes").html(_bookingPolicy),$("#customerNotes").attr("original-title",customerInfo.customerNotes.value))):($("#policy_link").hide(),$("#notes_wrapper").hide())},checkBrowser=function(e,s){$(".iebrowser").length<1&&(e.preventDefault(),e.stopPropagation(),e.stopImmediatePropagation(),changeUrl(e,s))},changeUrl=function(e,s){url=$(e.currentTarget).attr("href"),void 0==url&&(url=$(e.currentTarget).find("a").attr("href"),url="//www.setmore.com/?utm_source=header&utm_medium=booking%20page"==url||"//www.setmore.com/"==url?"":url),history.pushState?window.history.pushState("","",url):window.location=url,s&&s()},aboutUsTab=function(){customerInfo.aboutCompany&&customerInfo.aboutCompany.value||customerInfo.mapCoordinates?($("#gt_act").hide(),$("#abts_act").show(),$(".col1 > .nav > .abts, .side-menu-col1 > .nav > .abts ").addClass("active"),$(".col1 > .nav > .gt, .side-menu-col1 > .nav > .gt").removeClass("active"),$("#abts_act > h2").html(lang.about_us),$("#aboutus_map").hide(),$("#policy_link,#notes_wrapper").hide(),$("#chs_service_act").css({display:"none"}),$(".gt_cls").removeClass("active"),""!=customerInfo.aboutCompany&&""!=customerInfo.aboutCompany.value&&$(".ul_map_addr_businesshours").hide(),$(".step_tab").hide()):$("#abts_act").hide()},staffTab=function(){String(_isSkipStaff).indexOf("true")!=-1?$("#staff_act").hide():($("#gt_act").hide(),$(".step_tab").hide(),$(".col1 > .nav > .gt, .side-menu-col1 > .nav > .gt").removeClass("active"),$(".staff_act").addClass("active"),$("#chs_service_act").css({display:"none"}),getResourcesJDOMap("isLoadStaff"))},servicesTab=function(){$("#gt_act").hide(),$(".step_tab").hide(),$(".srvs").addClass("active"),$(".col1 > .nav > .gt, .side-menu-col1 > .nav > .gt").removeClass("active"),$("#chs_service_act").css({display:"none"}),getResourcesJDOMap(),renderSerAndCatTab()},classesTab=function(){$("#gt_act").hide(),classes&&0!=classes.length?($("#gt_act").hide(),$(".col1 > .nav > .gt, .side-menu-col1 > .nav > .gt").removeClass("active"),$(".cls").addClass("active"),$(".cls").show(),$(".classes_act").show(),getResourcesJDOMap("isLoadCls")):_disabledTabs&&_disabledTabs.indexOf("classes")!=-1&&_disabledTabs.indexOf("bookClass")!=-1&&($(".col1 > .nav > .gt, .side-menu-col1 > .nav > .gt").addClass("active"),$("#gt_act").show())},reviewTab=function(){$("#gt_act").hide(),$(".step_tab").hide(),$(".rvw").addClass("active"),$(".col1 > .nav > .gt, .side-menu-col1 > .nav > .gt").removeClass("active"),$("#chs_service_act").css({display:"none"}),$("#review_act #review_btn").show(),renderReviews()},photosTab=function(){$(".gt, .gt_cls, .abts, .sm, .srvs, .cls,.rvw").removeClass("active"),$(".pto").addClass("active"),$(".reviewPopup").hide(),$("#gt_act,#abts_act,#staff_act,#services_act,#classes_act,#review_act").hide(),$(".photos_act").addClass("active"),$("#photos_act").show(),$("#policy_link,.policyNote").hide()},changeLocation=function(){var e=window.location.pathname;e.substring(e.lastIndexOf("/")+1,e.length);window.location.pathname.contains("aboutus")?_disabledTabs.indexOf("aboutUs")!=-1?($(".abts").hide(),$("#abts_act").hide()):aboutUsTab():window.location.pathname.contains("staff")?_disabledTabs.indexOf("staffMembers")!=-1?$(".staff_act").hide():staffTab():"null"!==selectedServiceKey&&window.location.pathname.contains(selectedServiceKey)?renderStaffsByServiceKey(selectedServiceKey):"null"!==selectedClassKey&&window.location.pathname.contains(selectedClassKey)?renderStaffsByClassKey(selectedClassKey):window.location.pathname.contains("services")?_disabledTabs.indexOf("services")!=-1?$(".srvs").hide():servicesTab():window.location.pathname.contains("photos")?"true"==customerInfo.enableInstagram&&(photosTab(),bookingPageInstagram.render()):window.location.pathname.contains("reviews/writeReview")?1==showReviews?(reviewTab(),showPopup()):$(".rvw").hide():window.location.pathname.contains("reviews")?1==showReviews?reviewTab():$(".rvw").hide():_disabledTabs&&(_disabledTabs.indexOf("bookAppt")==-1&&_disabledTabs.indexOf("bookClass")!=-1||_disabledTabs.indexOf("services")==-1&&window.location.pathname.contains("services")||_disabledTabs.indexOf("bookAppt")==-1&&_disabledTabs.indexOf("bookClass")==-1||_disabledTabs.indexOf("bookAppt")!=-1&&window.location.pathname.contains("bookappointment"))&&!window.location.pathname.toLowerCase().contains("class")?renderSerAndCat():_disabledTabs.indexOf("bookClass")==-1||_disabledTabs.indexOf("classes")==-1?($(".col1 > .nav > .gt_cls, .side-menu-col1 > .nav > .gt_cls").addClass("active"),$(".col1 > .nav > .gt > #gt_sr , .side-menu-col1 > .nav > .gt > #gt_sr").parent().removeClass("active"),$("#classes-tab").trigger("click"),renderClasses("onLoad")):switchToSerOrClsTab("cls","bookClassTab")},renderStaffsByServiceKey=function(e){getResourcesJDOMap(e)},renderStaffsByClassKey=function(e){getResourcesJDOMap(e)},showNoClsDiv=function(){EventResources.isEventBinded||bindEventsAndOtherProbTab(),$(".col1 > .nav li, .side-menu-col1 > .nav li").removeClass("active"),$("#classes_act").hide(),$(".classes-container").hide(),window.location.pathname.contains("bookclass")?($(".classes-container").html("<div><p>"+lang.booking_class_unavailable+"</p></div>"),$(".classes-container").show(),$(".classes-container").addClass("noServices"),$(".col1 > .nav>li.gt_cls, .side-menu-col1 > .nav>li.gt_cls").addClass("active")):window.location.pathname.contains("class")?($("#classes_act").html("<div><p>"+lang.no_classes_available+"</p></div>"),$("#classes_act").show(),$("#classes_act").addClass("noServices"),$(".col1 > .nav>li.cls, .side-menu-col1 > .nav>li.cls").addClass("active")):_disabledTabs.indexOf("bookAppt")==-1&&_.isEmpty(serviceCategoryList)?($(".service-container").show(),$("#services-tab").parent().removeClass("active"),$("#chs_service_act").addClass("noServices"),$("#chs_service_act").html("<p>"+lang.booking_services_unavailable+"</p>"),$(".classes-container").hide(),$("#chs_class_act").hide(),$(".col1 > .nav > .gt, .side-menu-col1 > .nav > .gt").addClass("active")):($(".classes-container").html("<div><p>"+lang.booking_class_unavailable+"</p></div>"),$(".classes-container").show(),$(".classes-container").addClass("noServices"),$(".col1 > .nav>li.gt_cls, .side-menu-col1 > .nav>li.gt_cls").addClass("active")),$("#policy_link, .policyNote").hide(),$(".bookingpage_loader").hide()},showNoBookingsDiv=function(){EventResources.isEventBinded||bindEventsAndOtherProbTab();var e=htmlDecode(lang.bookings_closed);$(".col1 > .nav li, .side-menu-col1 > .nav li").removeClass("active"),$("#classes_act").hide(),$("#services_act").hide(),$(".classes-container").html("<div><p>"+e+"</p></div>"),$(".classes-container").addClass("noServices"),$(".col1 > .nav>li.gt_cls, .side-menu-col1 > .nav>li.gt_cls").addClass("active"),$(".service-container").show(),$("#services-tab").parent().removeClass("active"),$("#chs_service_act").addClass("noServices"),$("#chs_service_act").html("<p>"+e+"</p>"),$(".classes-container").hide(),$("#chs_class_act").hide(),$(".col1 > .nav > .gt, .side-menu-col1 > .nav > .gt").addClass("active"),$("#policy_link, .policyNote").hide(),$(".bookingpage_loader").hide()},sClsTab=function(e){window.location.pathname.contains("class")&&!window.location.pathname.contains("bookclass")?_disabledTabs.indexOf("classes")!=-1?($(".cls").hide(),$(".classes_act").hide()):classesTab():_disabledTabs.indexOf("classes")==-1&&(classes&&0!=classes.length?(getResourcesJDOMap(),$(".cls, .classes_act").show()):$(".cls").hide())},hComAndStaffName=function(){var e=htmlDecode(companyDetails.companyName).trim();if(null!=staffResourceInfo){var s=htmlDecode(staffResourceInfo.FirstName+" "+staffResourceInfo.LastName).trim(),t=$("#cBkPgUrl"),a=$("#staffname");e=compressName(e,88,t,"s"),s=compressName(s,23,a,"s");var i='<div class="bgimage_holder">';i+=staffResourceInfo.CompanyLogoPath&&"undefined"!=staffResourceInfo.CompanyLogoPath?"<img src="+(staffResourceInfo.CompanyLogoPath.contains("http:")?staffResourceInfo.CompanyLogoPath.replace("http:","https:"):staffResourceInfo.CompanyLogoPath)+' width="75" height="75" class="p_img">':'<img src="/bookingpage/images/bookappt_v3/provider_img2.png" width="75" height="75" class="p_img">',i+='<div><h1 id="staffname">'+s+"</h1>",i+=e?'<p  id="cBkPgUrl" >'+e+"<p>":"",i+="</div></div>",$("#company_name").html(i)}else{classes.length?$(".customerLoginContainer").css({top:"210px"}):$(".customerLoginContainer").css({top:"150px"});var t=$("#company_name");e=compressName(e,45,t,"s"),$("#company_name").html(e)}},showingTabs=function(){_disabledTabs.indexOf("bookAppt")!=-1?showClsTabsOnSerTabClicked():_disabledTabs.indexOf("bookClass")==-1?renderClasses():_disabledTabs.indexOf("aboutUs")==-1?aboutUsTab():_disabledTabs.indexOf("staffMembers")==-1?staffTab():_disabledTabs.indexOf("services")==-1?servicesTab():_disabledTabs.indexOf("classes")==-1&&classes&&0!=classes.length?classesTab():1==showReviews?reviewTab():"true"!=customerInfo.enableInstagram&&$(".pto").hide()},showOrHideTabs=function(){if(String(_isSkipStaff).indexOf("true")!=-1&&$(".staff_act").hide(),1!=showReviews&&$(".rvw").hide(),_disabledTabs&&0!=_disabledTabs.length&&(_disabledTabs.indexOf("bookAppt")!=-1&&_disabledTabs.indexOf("bookClass")==-1&&showingTabs(),_disabledTabs.indexOf("aboutUs")!=-1&&$(".abts").hide(),_disabledTabs.indexOf("staffMembers")!=-1&&$(".staff_act").hide(),_disabledTabs.indexOf("services")!=-1&&$(".srvs").hide()),"true"!=customerInfo.enableInstagram&&$(".pto").hide(),String(isShortBookingPage).indexOf("true")!=-1&&($(".col1,div.map_addr_businesshours").hide(),$(".header").addClass("wordPress"),$("#footer_wrap").addClass("wordPress"),$("body").css("background-color","white"),$("#bg-wrapper").addClass("fb_520"),$(".row").css("width","500px"),$(".row").css("padding-left","30px"),$("#policy_link").css("right","40px"),$("#wrapper").css("width","500px"),$("#wrapper").css("margin","-29px auto"),$("#company_name").css({"font-size":"30px"}),String($("#company_name").html()).length>28)){var e=String($("#company_name").html()).substring(0,28);e+="...",$("#company_name").html(e)}},redirectProtocolForIEBrw=function(){var e=window.navigator.userAgent,s=e.indexOf("MSIE");if(s>0||navigator.userAgent.match(/Trident.*rv\:11\./)){var t=window.location.href;t.contains("http://")&&(t=window.location.href.replace("http","https"),window.location=t)}Function("/*@cc_on return document.documentMode===10@*/")()&&($("#cust-Zip").addClass("IEcust-Zip"),$(".newProfile label").addClass("IEnewProfile"),$("#cust-Comments").addClass("IEcust-Comments"),$("#account_menu img").addClass("IEaccount_menuImg"),$("#cust-edit-FirstName").addClass("IEcust-edit-firstname"),$("#cust-edit-LastName").addClass("IEcust-edit-LastName"),$("#cust-edit-LoginId").addClass("IEcust-edit-LoginId"),$("#cust-edit-Address").addClass("IEcust-edit-Address"),$("#cust-edit-City").addClass("IEcust-edit-City"),$("#cust-edit-State").addClass("IEcust-edit-State"),$("#cust-edit-Zip").addClass("IEcust-edit-Zip"),$("#cust-IName,#cust-Address,#cust-IEmailId").addClass("IEcust-name"),$(".input-holder").addClass("IEinput-holder")),e.indexOf("FBAN/FBIOS;")==-1&&e.indexOf("FB_IAB/FB4A;")==-1&&e.indexOf("Instagram")==-1&&e.indexOf("FBExtensions")==-1||(facebookPage="true")},buildAddFields=function(){if(additionalFields.remove("name","email","phone","address"),0!=additionalFields.length){var e="",s="";null==customerInfo.requiredContactFields&&(customerInfo.requiredContactFields=[]);for(var t=0;t<additionalFields.length;t++)if(customerInfo.requiredContactFields&&customerInfo.requiredContactFields.indexOf(additionalFields[t])==-1){$(".service-container .customer-AdditionalFields, .classes-container .customer-AdditionalFields, .cust-edit-additionalFields").show(),e=htmlDecode(additionalFields[t]),s=e.split(" ").join("");var a="<li class=customerlistAdditionalFields_"+t+" style=display:none;></li>";$(".service-container .cust-details").append(a),$(".classes-container .cust-details").append(a);var i='<li><label class="customer-addition-label">&nbsp;</label><div id="'+t+'_cust_holder" class="input-profile-fields fields" ><input id="custAdditionalFields_'+t+'" class="inputB no_border" name= "'+e+'" type="text" placeholder ="'+e+'"  style="width:100%;" /><div class="clear"></div></li>',o='<li><label class="customer-addition-label">&nbsp;</label><div id="'+t+'_cust_holder" class="input-profile-fields fields" ><input id="class_custAdditionalFields_'+t+'" class="inputB no_border" name= "'+e+'" type="text" placeholder ="'+e+'"  style="width:100%;" /><div class="clear"></div></li>';$(".service-container .customer-details-list").append(i),$(".classes-container .customer-details-list").append(o);var n='<li class = skiptranslate><div id="'+t+'_cust_edit_holder" class="input-profile-fields fields" ><label class="additionalFields-label-'+t+'"><input id="cust_edit_AdditionalFields_'+t+'" class="inputB no_border skiptranslate" name= "'+e+'" type="text"  style="width:100%;" /><span class="placeholder-span">'+e+'</span></label><div class="clear"></div></li>';$(".customer-edit-form > ul > .cust-edit-additionalFields").append(n)}var r=requiredFields.slice(0,requiredFields.length);r.remove("name","phone","email","address","No Limit");for(var l=0;l<r.length;l++){var c=additionalFields.indexOf(r[l]),d=htmlDecode(r[l]);$("#additionalFields_"+c).attr("placeholder",""+d+" *"),$(".service-container #custAdditionalFields_"+c).attr("placeholder",""+d+" *"),$(".classes-container #class_custAdditionalFields_"+c).attr("placeholder",""+d+" *"),$("#cust_edit_AdditionalFields_"+c).next().html(d+" *")}}if(requiredFields.indexOf("phone")!=-1){var m=$(".service-container #cust-PhoneNo").attr("placeholder"),p=$(".classes-container #class_cust-PhoneNo").attr("placeholder");$(".service-container #cust-PhoneNo").attr("placeholder",m+" *"),$(".classes-container #class_cust-PhoneNo").attr("placeholder",p+" *"),isIE()?$(".service-container #cust-PhoneNo , .classes-container #class_cust-PhoneNo").parent().parent().find("label").append('<span style="color: red;font-weight: bold;margin-left:2px">*</span>'):$(".service-container #cust-PhoneNo, .classes-container #class_cust-PhoneNo").parent().hasClass("intl-tel-input")?$(".service-container #cust-PhoneNo , .classes-container #class_cust-PhoneNo").parent().parent().parent().find("label").append('<span style="color: red;font-weight: bold;margin-left:2px">*</span>'):$(".service-container #cust-PhoneNo , .classes-container #class_cust-PhoneNo").parent().parent().find("label").append('<span style="color: red;font-weight: bold;margin-left:2px">*</span>'),$("#cust-edit-PhoneNo").parent().parent().find("span.placeholder-span").html($("#cust-edit-PhoneNo").parent().parent().find("span.placeholder-span").html()+"*")}if(requiredFields.indexOf("email")!=-1){if($(".service-container .continue").hasClass("normalLogin")){$(".service-container #cust-IEmailId").parent().parent().find("label").append('<span style="color: red;font-weight: bold;margin-left:2px">*</span>');var m=$(".service-container #cust-IEmailId").attr("placeholder");$(".service-container #cust-IEmailId").attr("placeholder",m+" *")}if($(".classes-container .continue").hasClass("normalLogin")){$(".classes-container #class_cust-IEmailId").parent().parent().find("label").append('<span style="color: red;font-weight: bold;margin-left:2px">*</span>');var m=$(".classes-container #class_cust-IEmailId").attr("placeholder");$(".classes-container #class_cust-IEmailId").attr("placeholder",m+" *")}$("#cust-edit-LoginId").next().html($("#cust-edit-LoginId").next().html()+" *")}if(requiredFields.indexOf("address")!=-1){$(".service-container #cust-Address, .classes-container #class_cust-Address").parent().parent().find("label.lAddress").append('<span style="color: red;font-weight: bold;margin-left:2px">*</span>');var m=$(".service-container #cust-Address").attr("placeholder"),u=$(".classes-container #class_cust-Address").attr("placeholder");$(".service-container #cust-Address").attr("placeholder",m+" *"),$(".classes-container #class_cust-Address").attr("placeholder",u+" *"),$("#cust-edit-Address").next().html($("#cust-edit-Address").next().html()+" *")}var h=cancellationPolicy();$(".service-container .custom-cancellation-policy").append(h),$(".classes-container .custom-cancellation-policy").append(h);var v=addTermNcondService();$(".service-container .TnCBP").append(v);var v=addTermNcondClass();$(".classes-container .TnCBP").append(v)},customLabelAndForm=function(){var e="Provider"!=customisedProviderLabel?customisedProviderLabel:"en"!=language?lang.staff_members:"Staff Members",s="Service"!=customisedServiceLabel?customisedServiceLabel:"en"!=language?lang.services:"Services",t="Provider"!=customisedProviderLabel?customisedProviderLabel:"en"!=language?lang.provider:"Provider";if($(".service > span.mobile-navbar").html('<i class="icon-truck"></i><label>'+_customizedSerName+"<label>"),$(".provider > span.mobile-navbar").html('<i class="icon-group"></i><label>'+t+"<label>"),null!=staffResourceInfo?window.location.pathname.contains(staffResourceInfo.key)&&$(".staff_act").hide():window.location.pathname.contains(companyKey)?null==requestParam||"null"==requestParam?$(".staff_act").html('<a class="staff_act" href="/bookingpage/'+companyKey+'/staff">'+e+"</a>"):$(".staff_act").html('<a class="staff_act" href="/bookingpage/'+companyKey+"/staff?"+requestParam+'">'+e+"</a>"):null==requestParam||"null"==requestParam?$(".staff_act").html('<a class="staff_act" href="/staff">'+e+"</a>"):$(".staff_act").html('<a class="staff_act" href="/staff?'+requestParam+'">'+e+"</a>"),
$(".services_act").html(s),contactFields=customerInfo.requiredContactFields&&"undefined"!=customerInfo.requiredContactFields?customerInfo.requiredContactFields:[],contactFields&&contactFields.indexOf("phone")!=-1&&($("#phone_field").remove(),isIE()?($(".service-container #cust-PhoneNo, .classes-container #class_cust-PhoneNo").parent().parent("li").remove(),$("#cust-edit-PhoneNo").parent().parent().parent("li").remove()):$(".service-container #cust-PhoneNo, .classes-container #class_cust-PhoneNo").parent().hasClass("intl-tel-input")?($(".service-container #cust-PhoneNo, .classes-container #class_cust-PhoneNo").parent().parent().parent("li").remove(),$("#cust-edit-PhoneNo").parent().parent().parent().parent("li").remove()):($(".service-container #cust-PhoneNo, .classes-container #class_cust-PhoneNo").parent().parent("li").remove(),$("#cust-edit-PhoneNo").parent().parent().parent("li").remove())),contactFields&&contactFields.indexOf("email")!=-1&&($("#email_field").remove(),($(".service-container .continue").hasClass("normalLogin")||$(".classes-container .continue").hasClass("normalLogin"))&&($(".service-container #cust-IEmailId , .classes-container #class_cust-IEmailId").parent().parent("li").remove(),$(".service-container #cust-LoginId, .classes-container #class_cust-IEmailId").remove(),$("#cust-edit-LoginId").parent().parent().parent("li").remove())),contactFields&&contactFields.indexOf("address")!=-1&&($(".address_field").remove(),$(".service-container #cust-Address, .classes-container #class_cust-Address ").parent().parent("li").remove(),$("#cust-edit-Address").parent().parent().parent("li").remove(),$(".service-container #cust-City, .classes-container #class_cust-City ").parent().parent("li").remove(),$("#cust-edit-City").parent().parent().parent("li").remove()),customerInfo.customisedLabels&&"undefined"!=customerInfo.customisedLabels){var a=customerInfo.customisedLabels&&"undefined"!=customerInfo.customisedLabels&&0!=customerInfo.customisedLabels.length?JSON.parse(customerInfo.customisedLabels):"";customizedCustomerName=a.CustomerName&&"undefined"!=a.CustomerName&&""!=a.CustomerName?a.CustomerName:"Name",customizedCity=a.City&&"undefined"!=a.City&&""!=a.City?a.City:"City",customizedState=a.State&&"undefined"!=a.State&&""!=a.State?a.State:"State",customizedZip=a.Zip&&"undefinded"!=a.Zip&&""!=a.Zip?a.Zip:"Zip",customizedCustomerName="Name"!=customizedCustomerName?customizedCustomerName:lang.name,customizedCity="City"!=customizedCity?customizedCity:lang.city,customizedState="State"!=customizedState?customizedState:lang.state,customizedZip="Zip"!=customizedZip?customizedZip:lang.zip,$("#cust-name-label, #cust-edit-name").html(htmlDecode(customizedCustomerName)+"<span style='color: red; font-weight: bold; margin-left: 2px'>*</span>"),$("#city").attr("value",htmlDecode(customizedCity)),$("#state").attr("value",htmlDecode(customizedState)),$("#zip").attr("value",htmlDecode(customizedZip)),$(".service-container #cust-IName, .classes-container #class_cust-IName").attr("placeholder",htmlDecode(customizedCustomerName)+" *");var i=requiredFields.indexOf("address")!=-1?"*":"";$(".service-container #cust-City, .classes-container #class_cust-City").attr("placeholder",htmlDecode(customizedCity)+" "+i),$(".service-container #cust-State, .classes-container #class_cust-State").attr("placeholder",htmlDecode(customizedState)+" "+i),$(".service-container #cust-Zip, .classes-container #class_cust-Zip").attr("placeholder",htmlDecode(customizedZip)+" "+i),$("#cust-edit-City").next().html(htmlDecode(customizedCity)+" "+i),$("#cust-edit-State").next().html(htmlDecode(customizedState)+" "+i),$("#cust-edit-Zip").next().html(htmlDecode(customizedZip)+" "+i)}var o=($("#gt_sr"),$("#gt_cls")),n="Classes"!=customisedClassLabel?customisedClassLabel:"en"!=language?lang.Class:"Class",r=compressName(lang.book+" "+n,18,o,"e"),s="Service"!=customisedServiceLabel?customisedServiceLabel:"en"!=language?lang.services:"Services";"German"==language&&"Classes"==customisedClassLabel&&(r=n+" "+lang.book),$("a#gt_cls.gt_act").html('<i class="icon-calendar icon-2x"></i> '+r),$("#services-tab").html('<i class="icon-truck"></i> '+s),$(".service > span.step-li").attr("title",htmlDecode(_customizedSerName.toUpperCase()))},reschedulePage=function(){if("class"==apptType)rescheduleResourceInfo&&null!=rescheduleClassKey&&(_classBookingDetails.classKey=rescheduleClassKey,getClassResources(),$("#policy_link").hide(),$(".policyNote").hide(),$(".signIn").hide(),$("#login").hide(),$(".login-icon-div").removeClass("show-login-icon").addClass("hide"),$(".classes-container .customer-login-form").show(),$(".classes-container .continue ").addClass("normalLogin"),$(".booking-tabs, .tabs").hide());else if(null!=rescheduleResourceInfo&&null!=resuchduleServicesInfo){$(".step_tab").show(),$("#chs_service_act").hide(),$("#sp_act").hide(),$(".step_tab > h2").html(lang.choose_dateandtime+" ("+shortTimeZone+")"),$("#dateCont").show(),$("#dateCont").show(),$("#calendars").show(),$(".loaderMessage").show(),resourceKey=rescheduleResourceInfo.key,serviceKey=resuchduleServicesInfo.key,duration=resuchduleServicesInfo.Duration,customerInfo.skipStaff=customerInfo.skipStaff?customerInfo.skipStaff:"false",ServiceName=resuchduleServicesInfo.ServiceName,$("#servicename").html(ServiceName);var e='<li id="'+rescheduleResourceInfo.key+'"class="last"><div class="bg_holder"><div class="hover-arrow"></div><img src="/bookingpage/images/bookappt_v3/provider_img2.png" width="40" height="40" class="p_img"><b>'+rescheduleResourceInfo.FirstName+" "+rescheduleResourceInfo.LastName+"</b></div></li>";$(".providerlist").html(e),$(".service > span.step-li").attr("class","step-li done"),$(".provider > span.step-li").attr("class","step-li done"),animateProgressBar(),$(".container-fluid").remove(),$(".classes-container").remove(),$(".tzCss").css({top:"83px"}),showTimings(rescheduleResourceInfo.key,"reschedulePage"),$("#policy_link").hide(),$(".policyNote").hide(),$("#progress-icon").show(),$(".signIn").hide(),$(".service-container .customer-login-form").show(),$(".service-container .continue , .classes-container .continue ").addClass("normalLogin")}},renderSerAndCat=function(){if(_disabledTabs.indexOf("bookAppt")>-1&&_disabledTabs.indexOf("bookClass")>-1)return void showNoBookingsDiv();if(_disabledTabs.indexOf("bookAppt")==-1||_disabledTabs.indexOf("services")==-1){if($("#gt_act").show(),$(".step_tab").show(),$(".col1 > .nav > .gt, .side-menu-col1 > .nav > .gt").addClass("active"),$(".reviewPopup").hide(),$("#abts_act,#staff_act,#services_act,#review_act,#photo_act").hide(),$(".abts,.staff_act,.srvs,.classes,.pto,.rvw").removeClass("active"),$(".customer-login-form").hide(),$(".service > span.step-li").attr("title",htmlDecode(_customizedSerName.toUpperCase())),_bookingPolicy&&$("#policy_link").show(),$(".signIn").hasClass("active")||$(".customerLoginContainer").hide(),null!=staffResourceInfo&&"Active"!=staffResourceInfo.Status)return void(null==$(".servicecategoryheader").html()&&$("#chs_service_act").append('<h3 class="servicecategoryheader" style="">No service is assigned to display</h3>'));var e="";for(indexCategory in categoryList)if(""!=indexCategory&&"null"!=indexCategory&&"undefined"!=indexCategory&&""!=categoryList[indexCategory].serviceIdList&&null!=categoryList[indexCategory].serviceIdList){if("All Services"==categoryList[indexCategory].categoryName){var s=new Array,t=new Array;if(String(categoryList[indexCategory].serviceIdList).indexOf(",")!=-1){s=String(categoryList[indexCategory].serviceIdList).split(",");for(var a=0;a<s.length;a++)for(indexService in serviceCategoryList)String(serviceCategoryList[indexService].key).indexOf(s[a])!=-1&&("null"!=serviceCategoryList[indexService].isPrivateService&&null!=serviceCategoryList[indexService].isPrivateService&&String(serviceCategoryList[indexService].isPrivateService).indexOf("false")==-1||t.push(serviceCategoryList[indexService].key))}else if(""!=categoryList[indexCategory].serviceIdList)for(indexService in serviceCategoryList)String(serviceCategoryList[indexService].key).indexOf(categoryList[indexCategory].serviceIdList)!=-1&&("null"!=serviceCategoryList[indexService].isPrivateService&&null!=serviceCategoryList[indexService].isPrivateService&&String(serviceCategoryList[indexService].isPrivateService).indexOf("false")==-1||t.push(serviceCategoryList[indexService].key))}var i=new Array,o=new Array;if(String(categoryList[indexCategory].serviceIdList).indexOf(",")!=-1){i=String(categoryList[indexCategory].serviceIdList).split(",");for(var a=0;a<i.length;a++)for(indexService in serviceCategoryList)String(serviceCategoryList[indexService].key).indexOf(i[a])!=-1&&("null"!=serviceCategoryList[indexService].isPrivateService&&null!=serviceCategoryList[indexService].isPrivateService&&String(serviceCategoryList[indexService].isPrivateService).indexOf("false")==-1||o.push(serviceCategoryList[indexService].key))}else if(""!=categoryList[indexCategory].serviceIdList)for(indexService in serviceCategoryList)String(serviceCategoryList[indexService].key).indexOf(categoryList[indexCategory].serviceIdList)!=-1&&("null"!=serviceCategoryList[indexService].isPrivateService&&null!=serviceCategoryList[indexService].isPrivateService&&String(serviceCategoryList[indexService].isPrivateService).indexOf("false")==-1||o.push(serviceCategoryList[indexService].key));var n=!1;if("All Services"!=String(categoryList[indexCategory].categoryName))for(var r=!0,l=0;l<o.length;l++)for(indexService in serviceCategoryList)if(indexService.indexOf(o[l])!=-1&&""!=serviceCategoryList[indexService].ResourceKey&&null!=serviceCategoryList[indexService].ResourceKey&&void 0!=serviceCategoryList[indexService].ResourceKey){n=!0;var c=1==bookingPageSettings.showCategoryAccordion?"accordion":"",d=1==bookingPageSettings.showCategoryAccordion,m=d?"catergoryservice hide":"",p=d?"":"hide";null!=staffResourceInfo?serviceCategoryList[indexService].ResourceKey.contains(staffResourceInfo.key)&&(r===!0&&(e+='<h3 class="servicecategoryheader '+c+'" style="display:none"><span class = "category-header-text">'+categoryList[indexCategory].categoryName+'</span><i class = "icon icon-angle-right category-header-icon '+p+'"></i><div class = "clear"></div></h3><ul id="catergoryservice" class = "'+m+'">',r=!1),e+=buildCatSerList(indexService)):("hide"!=p?r===!0&&(e+='<h3 class="servicecategoryheader '+c+'" style="display:none"><span class = "category-header-text">'+categoryList[indexCategory].categoryName+'</span><i class = "icon icon-angle-right category-header-icon  '+p+'"></i><div class = "clear"></div></h3><ul id="catergoryservice" class = "'+m+'">',r=!1):r===!0&&(e+='<h3 class="servicecategoryheader category-header-text'+c+'" style="display:none">'+categoryList[indexCategory].categoryName+'</h3><ul id="catergoryservice">',r=!1),e+=buildCatSerList(indexService))}e+="</ul>"}$("#chs_service_act").html(e),$("#chs_service_act > ul").children().each(function(){for(var e=0;e<t.length;e++)t[e].indexOf($(this).attr("id"))!=-1&&t.splice(e,1)}),$("#catergoryservice").closest("ul").children("li").length>0?$("#chs_service_act .servicecategoryheader").show():$("#chs_service_act .servicecategoryheader").hide();var u="";for(indexCategory in categoryList)if("All Services"==categoryList[indexCategory].categoryName)for(var l=0;l<t.length;l++)for(indexService in serviceCategoryList)indexService.indexOf(t[l])!=-1&&""!=serviceCategoryList[indexService].ResourceKey&&null!=serviceCategoryList[indexService].ResourceKey&&void 0!=serviceCategoryList[indexService].ResourceKey&&(n=!0,null!=staffResourceInfo?serviceCategoryList[indexService].ResourceKey.contains(staffResourceInfo.key)&&(u+=buildAllSer(indexService)):u+=buildAllSer(indexService));var h="Service"!=customisedServiceLabel?customisedServiceLabel:"en"!=language?lang.services:"Services";""!=u&&(1==bookingPageSettings.showCategoryAccordion&&1==n?$("#chs_service_act").prepend('<ul class = "all-service-nomargin"><h3 class="servicecategoryheader accordion"><span class = "category-header-text">'+lang.all+" "+h+'</span><i class = "icon icon-angle-right category-header-icon"></i><div class = "clear"></div></h3><ul class="catergoryservice hide" >'+u):$("#chs_service_act").prepend("<ul><h3>"+lang.all+" "+h+"</h3><ul>"+u)),""==u&&0==$("#chs_service_act #catergoryservice").closest("ul").children("li").length&&($(".servicecategoryheader").show(),$(".servicecategoryheader").html("No service is assigned to display")),$("#chs_service_act > ul").children().each(function(){$(this).last().addClass("last")}),1==bookingPageSettings.showCategoryAccordion&&($(".servicecategoryheader.accordion").off(),$(".servicecategoryheader.accordion").on("click",function(){$(".servicecategoryheader.accordion").removeClass("open");var e=!!$(this).next(".catergoryservice").hasClass("hide");$(".catergoryservice").removeClass("hide").addClass("hide"),e?($(this).addClass("open"),$(this).next(".catergoryservice").removeClass("hide")):($(this).removeClass("open"),$(this).next(".catergoryservice").addClass("hide")),adjustServiceImgAndNameAlignment($("#chs_service_act li"))})),adjustServiceImgAndNameAlignment($("#chs_service_act li")),switchToSerOrClsTab("ser")}else switchToSerOrClsTab("ser");getResourcesJDOMap()},getResources=function(e,s){var t="";if("null"===s||"undefined"!=typeof e)serviceKey=$(e).attr("id"),serviceDuration=$(e).find(".service-duration").html(),serviceDuration=serviceDuration?serviceDuration.replace(" mins ",""):"",serviceDuration=serviceDuration.trim(),t=$(e).find(".serviceName").html();else{var a=EventResources.serviceList[s];serviceKey=a.key,serviceDuration=a.Duration.toString(),serviceDuration=serviceDuration?serviceDuration.replace(" mins ",""):"",serviceDuration=serviceDuration.trim(),t=a.ServiceName}var i="Service"!=customisedServiceLabel?customisedServiceLabel:"en"!=language?lang.service:"Service",o="Provider"!=customisedProviderLabel?customisedProviderLabel:"en"!=language?lang.provider:"Provider";null!=selectedServicesKeys&&""!=selectedServicesKeys&&selectedServicesKeys.indexOf(serviceKey)!=-1||selectedServicesKeys.push(serviceKey),$(".gt_act").addClass("services_tab"),$("#sign_out").addClass("serviceSelected"),$("#service-back").addClass("back-to-service").removeClass("hide"),$("#chs_service_act").hide(),$("#sp_act").show(),$("#progress-icon").show(),$(".service > span.step-li").addClass("skiptranslate"),$(".service > span.step-li").html(t.substr(0,6)),$(".service > span.step-li").attr("title",htmlDecode(t)),$(".service > span.step-li").addClass("done"),$(".service > span.mobile-navbar").html('<i class="icon-truck"></i><label>'+i+"<label>"),$(".provider > span.step-li").addClass("active"),$(".provider > span.mobile-navbar").html('<i class="icon-group"></i><label>'+o+"<label>"),$(".provider > span.step-li").html(o),$(".mobile-navbar").removeClass("active"),$(".provider > span.mobile-navbar").addClass("active"),$("#progress-icon").hasClass("serviceIcon")||$("#progress-icon").addClass("serviceIcon"),$("#progress-icon").removeClass("service"),animateProgressBar(),resourcesList=resourceMap;var n=peopleServicesMap,r="<ul>",l=new Array,c="Service"!=customisedServiceLabel?customisedServiceLabel+" "+providerLabel:"en"!=language?lang.services_provided:"Services Provided";if($("#services_act").hide(),_disabledTabs.indexOf("bookAppt")==-1&&$(".srvs").removeClass("active"),$(".gt").addClass("active"),$(".step_tab").removeClass("hide"),$(".step_tab").show(),$("#gt_act").show(),$(".classes-container").hide(),$(".service-container").show(),$(".bookAnotherAppt").hide(),$(".callBackUrl").hide(),$(".step_tab > ul").show(),$("#classes-tab").parent().removeClass("active"),$("#services-tab").parent().addClass("active"),fbbdp&&showServiceNameForFbbdp(selectedServicesKeys),String(_isSkipStaff).indexOf("true")!=-1||null!=staffResourceInfo?appDateSt():proSt(),null!=staffResourceInfo)$("#sLoader").show(),$(".loaderMessage").show(),$("#progress-icon").removeClass("service").addClass("serviceIcon"),arguments[1]&&"multipleServices"==arguments[1]?showTimings(staffResourceInfo.key,"staffPage","multipleServices"):showTimings(staffResourceInfo.key,"staffPage");else if(String(_isSkipStaff).indexOf("true")!=-1)$("#sLoader").show(),$(".loaderMessage").show(),arguments[1]&&"multipleServices"==arguments[1]?showTimingsForAllResources("multipleServices"):showTimingsForAllResources();else{$(".provider").removeClass("pointer_events"),fbbdp&&$("#required-feilds-error").css({display:"none"}),$(".service_title").html(""+choose_a_pro+" "+o),$("#services-tab").removeClass("srLst").addClass("srPro").removeClass("srPay");for(indexServiceListMap in serviceCategoryList)String(serviceCategoryList[indexServiceListMap].key).indexOf(serviceKey)!=-1&&l.push(serviceCategoryList[indexServiceListMap].ResourceKey);var d=new Array;try{if(String(customerInfo.resourcesInOrder)&&"null"!=String(customerInfo.resourcesInOrder))d=String(customerInfo.resourcesInOrder).split(",");else for(indexResources in resourcesList)d.push(resourcesList[indexResources].key)}catch(m){for(indexResources in resourcesList)d.push(resourcesList[indexResources].key)}for(var p=0;p<d.length;p++)for(indexResources in resourcesList)if(String(l).indexOf(indexResources)!=-1&&resourcesList[indexResources].key===d[p]){if(r+='<li id="'+resourcesList[indexResources].key+'"><div class="bg_holder"><div class="hover-arrow"></div>',resourceMap[indexResources].CompanyLogoPath&&"null"!=resourceMap[indexResources].CompanyLogoPath&&null!=resourceMap[indexResources].CompanyLogoPath){var u=resourceMap[indexResources].CompanyLogoPath.contains("http:")?resourceMap[indexResources].CompanyLogoPath.replace("http:","https:"):resourceMap[indexResources].CompanyLogoPath;r+='<img src="'+u+'=s75" width="40" height="40" />'}else r+='<img src="/bookingpage/images/bookappt_v3/provider_img2.png" width="40" height="40" class="p_img">';var h=resourcesList[indexResources].LastName&&"undefined"!=resourcesList[indexResources].LastName?resourcesList[indexResources].FirstName+" "+resourcesList[indexResources].LastName:resourcesList[indexResources].FirstName;if(r+="<b>"+h+'</b></div><!--- bg_holder---><div class="list_dtl fixedDet staff_det_popup">',resourceMap[indexResources].CompanyLogoPath&&""!=resourceMap[indexResources].CompanyLogoPath&&"null"!=resourceMap[indexResources].CompanyLogoPath&&null!=resourceMap[indexResources].CompanyLogoPath){var u=resourceMap[indexResources].CompanyLogoPath.contains("http:")?resourceMap[indexResources].CompanyLogoPath.replace("http:","https:"):resourceMap[indexResources].CompanyLogoPath;r+='<img src="'+u+'=s156" width="156" height="158"/>'}else r+='<img src="/bookingpage/images/bookappt_v3/provider_img2.png"  width="156" height="156" class="p_img">';r+='<h2 style="width:190px !important;">'+h+'</h2><div class="weekly_schedule sidebar_widget"><h3>'+lang.weekly_schedule+" ("+shortTimeZone+')</h3><ul class="bh sm">',r+=buildResWrkHrs(n,indexResources,resourcesList),r+='</ul></div><div class="services_provided sidebar_widget"><h3>'+c+"</h3><p>";for(indexService in serviceCategoryList)String(serviceCategoryList[indexService].ResourceKey).indexOf(String(resourcesList[indexResources].key))!=-1&&"true"!=serviceCategoryList[indexService].isPrivateService&&(r+=serviceCategoryList[indexService].ServiceName+"<br />");r+="</p></div>";var v=resourcesList[indexResources].comment&&resourcesList[indexResources].comment.value?resourcesList[indexResources].comment.value:"";v&&(r+='<h3 class="staffDesc">'+lang.description+'</h3><p class="staff_desc">'+v+"</p>"),r+="</div></li>"}$("#sp_act").html(r+"</ul>"),String(isShortBookingPage).indexOf("true")!=-1&&$(".hover-arrow").addClass("wordPress"),$("#sp_act > ul").children().each(function(){$(this).last().attr("class","last")})}},showServiceNameForFbbdp=function(e){var s="";if(_isSkipMultiSer)s+=serviceName;else for(var t=e.length,a=0;a<t;a++){var i=serviceCategoryList[e[a]].ServiceName;s+=0==a?i:", "+i}s.length>50&&(s=s.substring(0,46).trim(),s+="..."),$(".step_tab > h1").html(""+s)},getResKeyForMultiSer=function(e,s){_cacheResEle=e;var t="";"Services"==s?null!=staffResourceInfo?(serviceKey=$(e).attr("id"),t=staffResourceInfo.key,renderMultiSerForRes(serviceKey,t)):"true"==_isSkipStaff&&1==customerInfo.resourcesInOrder.length&&""!=customerInfo.resourcesInOrder[0].trim()?(serviceKey=$(e).attr("id"),t=customerInfo.resourcesInOrder[0],renderMultiSerForRes(serviceKey,t)):getResources(e):"Resources"==s&&(selectedServicesKeys=[serviceKey],t=$(e).attr("id"),renderMultiSerForRes(serviceKey,t))},renderMultiSerForRes=function(e,s){var t="",a="";selectedServicesKeys.indexOf(e)==-1&&selectedServicesKeys.push(e);for(c in categoryList)if("All Services"==categoryList[c].categoryName)for(var i=categoryList[c].serviceIdList,o=0;o<i.length;o++)_allServicesArr.indexOf(i[o])==-1&&_allServicesArr.push(i[o]);for(n in serviceCategoryList)for(j in categoryList)"All Services"!=categoryList[j].categoryName&&categoryList[j].serviceIdList.indexOf(serviceCategoryList[n].key)!=-1&&_allServicesArr.remove(serviceCategoryList[n].key);for(var n=0;n<_allServicesArr.length;n++)serviceCategoryList[_allServicesArr[n]]&&serviceCategoryList[_allServicesArr[n]].key!=e&&"true"!=serviceCategoryList[_allServicesArr[n].toString()].isPrivateService&&"true"==String(serviceCategoryList[_allServicesArr[n].toString()].ResourceKey.contains(s))&&(t+=buildResMultiSer(_allServicesArr[n]));for(n in categoryList)if("All Services"!=categoryList[n].categoryName)for(var r=!0,l=categoryList[n].serviceIdList,c=0;c<l.length;c++)serviceCategoryList[l[c]]&&serviceCategoryList[l[c]].key!=e&&serviceCategoryList[l[c].toString()]&&"true"!=serviceCategoryList[l[c].toString()].isPrivateService&&"true"==String(serviceCategoryList[l[c].toString()].ResourceKey.contains(s))&&(r===!0&&(a+='</ul><h3 class  = "multiple-category-text">'+categoryList[n].categoryName+'</h3><ul class = "multiple-service-list">',r=!1),a+=buildResMultiSer(l[c]));buildSelectedSer(e),""==t?$(".multiple-service-container > h3").hide():$(".multiple-service-container > h3").show(),$(".multiple-service-container > ul.multiple-service-list").html(t+"</ul>"),$(".multiple-category-container").html(a+"</ul>"),$(".multiple-service-holder").addClass("blockPage");var d="Service"==_customizedSerName?lang.book_additional+" "+htmlDecode(_customizedSerName.toLowerCase())+"(s) :":lang.book_additional+" "+htmlDecode(_customizedSerName.toLowerCase())+":";$(".multiple-service-header-text").text(d),multiSerEvents(),$("body").addClass("hideScroll"),$(".multiple-service-holder").show()},buildSelectedSer=function(e){var s=serviceCategoryList[e].bufferDuration?serviceCategoryList[e].Duration-serviceCategoryList[e].bufferDuration:serviceCategoryList[e].Duration,t=customerInfo.showLabel&&customerInfo.showLabel.toString().indexOf("price")!=-1?'<span class="multiple-service-cost">'+sign+(isFloat(serviceCategoryList[e].Cost)?parseFloat(serviceCategoryList[e].Cost).toFixed(2):serviceCategoryList[e].Cost)+"</span>":"",a=customerInfo.showLabel&&customerInfo.showLabel.toString().indexOf("servicename")!=-1?'<span class="multiple-service-duration">'+s+" "+lang.mins+"</span>":"";$(".multiple-service-selected-container > ul.multiple-service-list").html('<li class="active pointer_events" id='+serviceCategoryList[e].key+'><a class = "muliple-check-box serviceActive"></a><b class="multiple-service-name">'+serviceCategoryList[e].ServiceName+"</b><p class=multiple-service-price>"+a+t+'</p><div class="clear"></div></li>'),$(".multiple-service-selected-container > h3").text(lang.selected+" "+_customizedSerName)},buildResMultiSer=function(e){var s=serviceCategoryList[e].bufferDuration?serviceCategoryList[e].Duration-serviceCategoryList[e].bufferDuration:serviceCategoryList[e].Duration,t=customerInfo.showLabel&&customerInfo.showLabel.toString().indexOf("price")!=-1?'<span class="multiple-service-cost">'+sign+(isFloat(serviceCategoryList[e].Cost)?parseFloat(serviceCategoryList[e].Cost).toFixed(2):serviceCategoryList[e].Cost)+"</span>":"",a=customerInfo.showLabel&&customerInfo.showLabel.toString().indexOf("servicename")!=-1?'<span class="multiple-service-duration">'+s+" "+lang.mins+"</span>":"",i="<li id="+serviceCategoryList[e].key+'><a class = muliple-check-box></a><b class="multiple-service-name">'+serviceCategoryList[e].ServiceName+"</b><p class=multiple-service-price>"+a+t+'</p><div class="clear"></div></li>';return i},showTimings=function(ele,type){if(resourceKeySelected=$(ele).attr("id"),"staffPage"!=type&&"reschedulePage"!=type||(resourceKeySelected=ele),null!=selectedServicesKeys&&""!=selectedServicesKeys&&selectedServicesKeys.indexOf(serviceKey)!=-1||selectedServicesKeys.push(serviceKey),$(".gt_act").removeClass("services_tab"),$(".gt_act").addClass("provider_tab"),$("#service-back").removeClass("back-to-service").addClass("back-to-provider"),$("#calendars").hide(),$("#loading_icon").show(),$("#timesheet").empty(),$("#sign_out").removeClass("serviceSelected"),$("#sign_out").addClass("providerSelected"),$("#services-tab").removeClass("srLst").removeClass("srPro").addClass("srDt"),null==staffResourceInfo&&$("#progress-icon").removeClass("serviceIcon").removeClass("service").addClass("providerIcon"),$(".date").removeClass("pointer_events"),chkShrtBp(),$("#sp_act").hide(),$("#dateCont").show(),$("#sLoader").show(),$(".loaderMessage").show(),$(".chng-tz").hide(),fbbdp&&($("#required-feilds-error").css({display:"none"}),showServiceNameForFbbdp(selectedServicesKeys)),_enabledCustLocalTimeZone){fbbdp?($(".step_tab > h2").html(lang.select_preferredtime),$(".chng-tz").addClass("fbbdp-adjustment")):$(".step_tab > h2").html("");var ltz=_seletedTimeZoneFullName?_seletedTimeZoneFullName:timeZoneObj.localTimeZoneObj.timeZoneFullName;if($(".chng-tz-a > span").html(ltz),_selectedTimeZone&&_selectedTimeZone!=timeZoneObj.localTimeZoneObj.timeZoneID)for(var i=0;i<=allTimeZones.length;i++)allTimeZones[i]&&allTimeZones[i].timeZoneID==_selectedTimeZone&&$(".chng-tz-a > span").html(allTimeZones[i].timeZoneFullName);_bookingPolicy&&$("#policy_link").hide()}else fbbdp?$(".step_tab > h2").html(lang.select_preferredtime):$(".step_tab > h2").html(lang.choose_dateandtime+" ("+shortTimeZone+")"),$(".chng-tz").hide();resourceKey=resourceKeySelected,restrictedDatesInRed=new Array;for(index in resourceMap)String(resourceMap[index].key).indexOf(String(resourceKey))!=-1&&(resourceName=resourceMap[index].FirstName+" "+String(resourceMap[index].LastName),null==staffResourceInfo&&($(".provider > span.step-li").html(htmlDecode(String(resourceMap[index].FirstName)).substr(0,6)),$(".provider > span.step-li").attr("class","done step-li"),$(".provider > span.step-li").attr("title",htmlDecode(resourceMap[index].FirstName)+" "+htmlDecode(String(resourceMap[index].LastName))),animateProgressBar()));if(arguments[2]&&"multipleServices"==arguments[2]){for(var tempSerDur=0,serviceKeyLen=selectedServicesKeys.length,i=0;i<serviceKeyLen;i++)tempSerDur+=serviceCategoryList[selectedServicesKeys[i]].Duration;serviceDuration=tempSerDur}else for(indexService in serviceCategoryList)indexService.indexOf(String(serviceKey))!=-1&&(serviceName=serviceCategoryList[indexService].ServiceName,serviceDuration=serviceCategoryList[indexService].Duration,serviceId=serviceCategoryList[indexService].key);customerInfo.timeSlot||(customerInfo.timeSlot=15);for(indexPeopleServicesMap in peopleServicesMap)if(clientDate=clientDateToInitiliazeDatePicker,String(peopleServicesMap[indexPeopleServicesMap].CompanyKey).indexOf(companyKey)!=-1&&String(peopleServicesMap[indexPeopleServicesMap].ResourceKey).indexOf(resourceKey)!=-1){restrictedDays=new Array;for(var i=0;i<String(peopleServicesMap[indexPeopleServicesMap].WorkingDays).length;i++)restrictedDays.push(String(peopleServicesMap[indexPeopleServicesMap].WorkingDays).charAt(i));if(restrictedDays.length>0){restrictedDays=restrictedDays.sort();for(var weekdays=new Array(0,1,2,3,4,5,6),i=0;i<restrictedDays.length;i++)for(var j=0;j<weekdays.length;j++)if(restrictedDays[i]==weekdays[j]){weekdays[j]="-1";break}for(var i=1;i<weekdays.length;i++)weekdays[i]===weekdays[i-1]&&weekdays.splice(i--,1);blockedOutDates=weekdays}}selectedDate=clientDate.getMonth()+1+"/"+clientDate.getDate()+"/"+clientDate.getFullYear(),currentCall=$.ajax({type:"GET",url:"/getRestrictedHours.do",data:"resourceKey="+resourceKey+"&companyKey="+companyKey,dataType:"html",async:!0,cache:!1,beforeSend:function(){null!=currentCall&&currentCall.abort()}}).done(function(data){if(data){var responseText="",restrictedDates="",resDates=new Array;responseText=eval("("+data+")");var bulkResDates=new Array,bulkResDatesSeperated=new Array;if(restricted_Dates=new Array,restrictedLongDate=new Array,responseText.blockedDates){bulkResDates=new String(responseText.blockedDates).split(",");for(var i=0;i<bulkResDates.length;i++){bulkResDatesSeperated[i]=new String(bulkResDates[i]),bulkResDatesSeperated[i]=bulkResDatesSeperated[i].trim(),resDates=bulkResDatesSeperated[i].split("/");var fromDate=new Date;fromDate.setFullYear(resDates[2]),fromDate.setMonth(parseInt(resDates[0])-1,!0),fromDate.setDate(resDates[1]),fromDate.setHours(0),fromDate.setMinutes(0),fromDate.setSeconds(0),fromDate.setMilliseconds(0),restricted_Dates[i]=fromDate}}}for(var i=0;i<restricted_Dates.length;i++)restrictedLongDate[i]=restricted_Dates[i].getTime();selectedDateUTC=Date.UTC(clientDate.getFullYear(),clientDate.getMonth(),clientDate.getDate(),0,0,0);var dateString=clientDate.getDate()+" "+_months[clientDate.getMonth()]+"...",monthsInLang=monthsInOtherLang(_months[clientDate.getMonth()]),dateStrings=clientDate.getDate()+" "+monthsInLang+"...";$("#appt_date > span.step-li").html(dateStrings),$("#appt_date > span.step-li").attr("class","active step-li"),$(".mobile-navbar").removeClass("active"),$("#appt_date > span.mobile-navbar").attr("class","active mobile-navbar"),$("#appt_date > span.step-li").attr("title",clientDate.getDate()+" "+monthsInLang+" "+clientDate.getFullYear());var checkForAppointmentCount="true";if(planJDOMap.appointmentCount!=-1){var remainingApptCount=displayAppointmentCount(parseInt(clientDate.getMonth())+1);parseInt(remainingApptCount)>parseInt(planJDOMap.appointmentCount)&&(checkForAppointmentCount="false")}if(restrictedDatesInRed=new Array,checkForAppointmentCount.indexOf("true")!=-1)if(restrictedLongDate.indexOf(clientDate.getTime())==-1)try{setTimeout(function(){getWorkingHoursForSingleResource(companyKey,clientDate,serviceDuration,selectedDate,selectedDateUTC)},500)}catch(e){console.log("Error occured in ajax call for showwokringhours ::"+e.message)}else if(String(isNextAvailableDate).indexOf("true")!=-1){restrictedDatesInRed.push(new Date(clientDate));var nextDate=new Date(clientDate);nextDate.setDate(nextDate.getDate()+1),findTheNextAvailableDate(nextDate)}else $(".loading_icon, .loaderMessage").hide(),$("#calendars").show(),$("#timesheet").html(lang.non_working_day),$("#timesheet").addClass("noSlots"),$("#timesheet").show();else $("#loading_icon").hide(),$(".searching-availability, .Go-back").hide(),$("#time_sheet").removeClass("time_sheet"),$("#time_sheet").html('<div style="float: right; margin-right: 75px; margin-top:50px" class="" id="time_sheet"><div style="text-align: center;"><span style="width: 230px; display: block; line-height: 18px;"><b style="font-weight: 600; display: block;">This Month has no more avaliable online appointment times</b><br><p style="font-size: 11px;">Please contact us via email or phone if you\'d like to book an appointment for this month</p></span></div></div>');var dateString=clientDateToInitiliazeDatePicker.getFullYear()+"-"+clientDateToInitiliazeDatePicker.getDate()+"-"+(clientDateToInitiliazeDatePicker.getMonth()+1),now=new Date;tempunblockedDates=unblockedDates,unblockedDates=[],restrictedDatesInRed=""!=tempRestDtsInRed?tempRestDtsInRed:restrictedDatesInRed,restricted_Dates=""!=tempRestrDates?tempRestrDates:restricted_Dates,blockedOutDates=""!=tempBlockedDays?tempBlockedDays:blockedOutDates,_enabledCustLocalTimeZone&&(blockedOutDates=[],
restricted_Dates=[]),restrictAfterThisDate=""!=temprestrictAfterThisDate?temprestrictAfterThisDate:restrictAfterThisDate,adavanceDays=0!=tempAdvanceDays&&null!=tempAdvanceDays?tempAdvanceDays:adavanceDays,$("#calendars").DatePicker({flat:!0,date:dateString,current:new Date(clientsDateInMilliSec),format:"Y-d-m",calendars:1,starts:startDay,onChange:function(e,s){selectedDate=s.getMonth()+1+"/"+s.getDate()+"/"+s.getFullYear();var t=new Array("Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"),a=s.getDate()+" "+t[s.getMonth()],i=monthsInOtherLang(_months[clientDate.getMonth()]);console.log(i),console.log(new Date(clientsDateInMilliSec)),console.log(a),window.selectedDate=s,chooseDate=s,$("#appt_date").children("span.step-li").html(a),$("#appt_date > span.step-li").attr("title",s.getDate()+" "+i+" "+s.getFullYear()),compressText(".date");try{$("#timesheet").html('<img id="loading_icon_timings"  class="loading_icon_timings"  src="/setmore-loader.gif" style="display:show"></img>'),clientDate=s;var o=Date.UTC(s.getFullYear(),s.getMonth(),s.getDate(),0,0,0);setTimeout(function(){getWorkingHoursForSingleResource(companyKey,clientDate,serviceDuration,selectedDate,o)},500)}catch(n){alert("Error occured in ajax call for showwokringhours ::"+n.message)}}}),$("#calendars").children().length>1&&$("#calendars").children().first().remove()}).fail(function(e){console.error(" Fails while getting restricted Hours ")})},buildCatSerList=function(e){var s="",t=serviceCategoryList[e].description?serviceCategoryList[e].description:{};t=1!=$.isEmptyObject(t)&&""!=t.value?t.value.trim().split("\n").join("<br>"):"";var a=serviceCategoryList[e].imageURL&&"null"!=serviceCategoryList[e].imageURL?serviceCategoryList[e].imageURL:"/bookingpage/images/service-icon-big.png";a=a.contains("http:")?a.replace("http:","https:"):a,s+=""!=t?'<li style="line-height:37px" id="'+e+'"><div class="staff_desc_connector"></div><div class="bg_holder service__holder"><div class="hover-arrow"></div>':'<li style="line-height:37px" id="'+e+'"><div class="bg_holder service__holder"><div class="arrow" style="display: none;"></div>',window.isMobile.matches&&(s+='<img class = "service__image" src="'+a+'" width="40" height="40">'),s+=window.connectService.indexOf(e)!=-1?'<b class="serviceName service__name" id="serviceName_toolTip">'+String(serviceCategoryList[e].ServiceName)+' <img alt="" style="width: 14px;bottom: 2px;position: relative;" src="/bookingpage/images/teleport-icon.png"></b>':'<b class="serviceName service__name" id="serviceName_toolTip">'+String(serviceCategoryList[e].ServiceName)+"</b>";var i=customerInfo.showLabel&&String(customerInfo.showLabel).indexOf("servicename")!=-1,o=customerInfo.showLabel&&String(customerInfo.showLabel).indexOf("price")!=-1;if((i||o)&&(s+='<p class= "servicePrice service__details">'),i)if(0==serviceCategoryList[e].bufferDuration)s+='<span class="service-duration service__duration">'+serviceCategoryList[e].Duration+" "+lang.mins+"</span>";else{var n=serviceCategoryList[e].Duration-serviceCategoryList[e].bufferDuration;s+='<span class="service-duration service__duration">'+n+" "+lang.mins+"</span>"}if(o){var r=isMobile.matches&&String(customerInfo.showLabel).indexOf("servicename")!=-1?" add_comma_before":"";s+='<span style="width:auto;" class = "service__price '+r+'">'+sign+(isFloat(serviceCategoryList[e].Cost)?parseFloat(serviceCategoryList[e].Cost).toFixed(2):serviceCategoryList[e].Cost)+"</span>"}if((i||o)&&(s+="</p>"),s+='</p></div><div class="clear"></div><div class="list_dtl staff_det_popup" style="height: 231px;">',serviceCategoryList[e].imageURL&&"null"!=serviceCategoryList[e].imageURL){var l=serviceCategoryList[e].imageURL.contains("http:")?serviceCategoryList[e].imageURL.replace("http:","https:"):serviceCategoryList[e].imageURL;s+='<img src="'+l+'=s200"  width="156" height="158"  />'}else s+='<img src="/bookingpage/images/service-icon-big.png" width="156" height="158" class="p_img">';return t&&(s+='<h3 style="line-height:30px;" class="descServ">'+lang.description+'</h3><p class="srDesc">'+t+"</p>"),s},buildAllSer=function(e){var s="",t=serviceCategoryList[e].description?serviceCategoryList[e].description:{};t=1!=$.isEmptyObject(t)&&""!=t.value?t.value.trim().split("\n").join("<br>"):"";var a=serviceCategoryList[e].imageURL&&"null"!=serviceCategoryList[e].imageURL?serviceCategoryList[e].imageURL:"/bookingpage/images/service-icon-big.png";a=a.contains("http:")?a.replace("http:","https:"):a,s+=""!=t?'<li style="line-height:37px" id="'+e+'"><div class="staff_desc_connector"></div><div class="bg_holder service__holder"><div class="hover-arrow"></div>':'<li style="line-height:37px" id="'+e+'"><div class="bg_holder service__holder"><div class="arrow" style="display: none;"></div>',window.isMobile.matches&&(s+='<img class = "service__image" src="'+a+'" width="40" height="40">'),s+=window.connectService.indexOf(e)!=-1?'<b class="serviceName service__name" id="serviceName_toolTip">'+String(serviceCategoryList[e].ServiceName)+' <img alt="" style="width: 14px;bottom: 2px;position: relative; margin-right:0px;" src="/bookingpage/images/teleport-icon.png"></b>':'<b class="serviceName service__name" id="serviceName_toolTip">'+String(serviceCategoryList[e].ServiceName)+"</b>";var i=customerInfo.showLabel&&String(customerInfo.showLabel).indexOf("servicename")!=-1,o=customerInfo.showLabel&&String(customerInfo.showLabel).indexOf("price")!=-1;if((i||o)&&(s+='<p class= "servicePrice service__details">'),i)if(0==serviceCategoryList[e].bufferDuration)s+='<span class="service-duration service__duration">'+serviceCategoryList[e].Duration+" "+lang.mins+"</span>";else{var n=serviceCategoryList[e].Duration-serviceCategoryList[e].bufferDuration;s+='<span class="service-duration service__duration">'+n+" "+lang.mins+"</span>"}if(o){var r=isMobile.matches&&String(customerInfo.showLabel).indexOf("servicename")!=-1?" add_comma_before":"";s+='<span style="width:auto;" class = "service__price '+r+'">'+sign+(isFloat(serviceCategoryList[e].Cost)?parseFloat(serviceCategoryList[e].Cost).toFixed(2):serviceCategoryList[e].Cost)+"</span>"}if((i||o)&&(s+="</p>"),s+='</div><div class="clear"></div><div class="list_dtl staff_det_popup" style="height: 231px;">',serviceCategoryList[e].imageURL&&"null"!=serviceCategoryList[e].imageURL){var l=serviceCategoryList[e].imageURL.contains("http:")?serviceCategoryList[e].imageURL.replace("http:","https:"):serviceCategoryList[e].imageURL;s+='<img src="'+l+'=s200"  width="156" height="158"  />'}else s+='<img src="/bookingpage/images/service-icon-big.png" width="156" height="158" class="p_img">';return t&&(s+='<h3 style="line-height:30px;" class="descServ">'+lang.description+'</h3><p class="srDesc">'+t+"</p>"),s},buildResWrkHrs=function(e,s,t){var a="";for(indexWeekly in e)if(String(e[indexWeekly].ResourceKey).indexOf(s)!=-1&&e[indexWeekly].ResourceKey.indexOf(String(t[s].key))!=-1){if("24 Hours"!=customerInfo.timeFormat){a+=e[indexWeekly].WorkingDays.indexOf(String(e[indexWeekly].mo).split(",")[0])!=-1?"<li><span>"+lang.mon+"</span> <div>"+String(e[indexWeekly].mo).split(",")[1].toLowerCase()+" - "+String(e[indexWeekly].mo).split(",")[3].toLowerCase()+"</div></li>":"<li><span>"+lang.mon+"</span> <div>"+htmlDecode(lang_closed)+"</div></li>",a+=e[indexWeekly].WorkingDays.indexOf(String(e[indexWeekly].tu).split(",")[0])!=-1?"<li><span>"+lang.tue+"</span> <div>"+String(e[indexWeekly].tu).split(",")[1].toLowerCase()+" - "+String(e[indexWeekly].tu).split(",")[3].toLowerCase()+"</div></li>":"<li><span>"+lang.tue+"</span> <div>"+htmlDecode(lang_closed)+"</div></li>",a+=e[indexWeekly].WorkingDays.indexOf(String(e[indexWeekly].we).split(",")[0])!=-1?"<li><span>"+lang.wed+"</span> <div>"+String(e[indexWeekly].we).split(",")[1].toLowerCase()+" - "+String(e[indexWeekly].we).split(",")[3].toLowerCase()+"</div></li>":"<li><span>"+lang.wed+"</span> <div>"+htmlDecode(lang_closed)+"</div></li>",a+=e[indexWeekly].WorkingDays.indexOf(String(e[indexWeekly].th).split(",")[0])!=-1?"<li><span>"+lang.thu+"</span> <div>"+String(e[indexWeekly].th).split(",")[1].toLowerCase()+" - "+String(e[indexWeekly].th).split(",")[3].toLowerCase()+"</div></li>":"<li><span>"+lang.thu+"</span> <div>"+htmlDecode(lang_closed)+"</div></li>",a+=e[indexWeekly].WorkingDays.indexOf(String(e[indexWeekly].fr).split(",")[0])!=-1?"<li><span>"+lang.fri+"</span> <div>"+String(e[indexWeekly].fr).split(",")[1].toLowerCase()+" - "+String(e[indexWeekly].fr).split(",")[3].toLowerCase()+"</div></li>":"<li><span>"+lang.fri+"</span> <div>"+htmlDecode(lang_closed)+"</div></li>",a+=e[indexWeekly].WorkingDays.indexOf(String(e[indexWeekly].sa).split(",")[0])!=-1?"<li><span>"+lang.sat+"</span> <div>"+String(e[indexWeekly].sa).split(",")[1].toLowerCase()+" - "+String(e[indexWeekly].sa).split(",")[3].toLowerCase()+"</div></li>":"<li><span>"+lang.sat+"</span> <div>"+htmlDecode(lang_closed)+"</div></li>",a+=e[indexWeekly].WorkingDays.indexOf(String(e[indexWeekly].su).split(",")[0])!=-1?"<li><span>"+lang.sun+"</span> <div>"+String(e[indexWeekly].su).split(",")[1].toLowerCase()+" - "+String(e[indexWeekly].su).split(",")[3].toLowerCase()+"</div></li>":"<li><span>"+lang.sun+"</span> <div>"+htmlDecode(lang_closed)+"</div></li>";break}if(e[indexWeekly].WorkingDays.indexOf(String(e[indexWeekly].mo).split(",")[0])!=-1){var i=convertTimeFormat(String(e[indexWeekly].mo).split(",")[1]),o=convertTimeFormat(String(e[indexWeekly].mo).split(",")[3]);a+="<li><span>"+lang.mon+"</span> <div>"+i+" - "+o+"</div></li>"}else a+="<li><span>"+lang.mon+"</span> <div>"+htmlDecode(lang_closed)+"</div></li>";if(e[indexWeekly].WorkingDays.indexOf(String(e[indexWeekly].tu).split(",")[0])!=-1){var i=convertTimeFormat(String(e[indexWeekly].tu).split(",")[1]),o=convertTimeFormat(String(e[indexWeekly].tu).split(",")[3]);a+="<li><span>"+lang.tue+"</span> <div>"+i+" - "+o+"</div></li>"}else a+="<li><span>"+lang.tue+"</span> <div>"+htmlDecode(lang_closed)+"</div></li>";if(e[indexWeekly].WorkingDays.indexOf(String(e[indexWeekly].we).split(",")[0])!=-1){var i=convertTimeFormat(String(e[indexWeekly].we).split(",")[1]),o=convertTimeFormat(String(e[indexWeekly].we).split(",")[3]);a+="<li><span>"+lang.wed+"</span> <div>"+i+" - "+o+"</div></li>"}else a+="<li><span>"+lang.wed+"</span> <div>"+htmlDecode(lang_closed)+"</div></li>";if(e[indexWeekly].WorkingDays.indexOf(String(e[indexWeekly].th).split(",")[0])!=-1){var i=convertTimeFormat(String(e[indexWeekly].th).split(",")[1]),o=convertTimeFormat(String(e[indexWeekly].th).split(",")[3]);a+="<li><span>"+lang.thu+"</span> <div>"+i+" - "+o+"</div></li>"}else a+="<li><span>"+lang.thu+"</span> <div>"+htmlDecode(lang_closed)+"</div></li>";if(e[indexWeekly].WorkingDays.indexOf(String(e[indexWeekly].fr).split(",")[0])!=-1){var i=convertTimeFormat(String(e[indexWeekly].fr).split(",")[1]),o=convertTimeFormat(String(e[indexWeekly].fr).split(",")[3]);a+="<li><span>"+lang.fri+"</span> <div>"+i+" - "+o+"</div></li>"}else a+="<li><span>"+lang.fri+"</span> <div>"+htmlDecode(lang_closed)+"</div></li>";if(e[indexWeekly].WorkingDays.indexOf(String(e[indexWeekly].sa).split(",")[0])!=-1){var i=convertTimeFormat(String(e[indexWeekly].sa).split(",")[1]),o=convertTimeFormat(String(e[indexWeekly].sa).split(",")[3]);a+="<li><span>"+lang.sat+"</span> <div>"+i+" - "+o+"</div></li>"}else a+="<li><span>"+lang.sat+"</span> <div>"+htmlDecode(lang_closed)+"</div></li>";if(e[indexWeekly].WorkingDays.indexOf(String(e[indexWeekly].su).split(",")[0])!=-1){var i=convertTimeFormat(String(e[indexWeekly].su).split(",")[1]),o=convertTimeFormat(String(e[indexWeekly].su).split(",")[3]);a+="<li><span>"+lang.sun+"</span> <div>"+i+" - "+o+"</div></li>"}else a+="<li><span>"+lang.sun+"</span> <div>"+htmlDecode(lang_closed)+"</div></li>";break}return a},saveReviews=function(e){var s=getUrlVars().appointmentKey?getUrlVars().appointmentKey:"",t={type:"POST",url:"/setCustomerReviews.do",data:"companyKey="+companyKey+"&appointmentKey="+s+"&reviewJson="+urlencode(JSON.stringify(e)),dataType:"html",async:!0,cache:!1};makeRequest(t).done(function(e){$("#pageBlock").hide(),$("#pageBlock").css({opacity:".9"}),showValidationAletMsg(lang.thankyou_for_review)}).fail(function(e){console.error(" Failed while saving the reviews")}),$(".reviewPopup").hide(),$("#rating").attr("value",""),$("#rating > i").removeClass(".icon-star-empty").removeClass("icon-star-empty-active"),$("#customerName").val(""),$("#customerReview").val(""),$("#customerEmail").val(""),$("#customerName").removeClass("inputError"),$("#customerReview").removeClass("inputError"),$("#customerEmail").removeClass("inputError")},showTabs=function(){if($(".customer-profile-cancel").hasClass("login-active")||$(".customer-profile-cancel").hasClass("sign-in-close"))if($(".customer-profile-cancel").removeClass("sign-in-close"),($(".col1 > .nav > .gt, .side-menu-col1 > .nav > .gt").hasClass("active")||$(".gt_cls").hasClass("active"))&&($(".detail-navbar").length?($(".detail-navbar").addClass("showClassesTabs"),$("#services-tab").parent().hasClass("active")?handlingTabs("ser"):$("#classes-tab").parent().hasClass("active")&&(bkPolicy("cls"),showCurClsSts())):handlingTabs("ser")),$(".abts").hasClass("active")&&$("#abts_act").show(),$(".staff_act").hasClass("active"))$("#staff_act").show();else if($(".srvs").hasClass("active"))$("#services_act").show();else if($(".pto").hasClass("active"))$("#photos_act").show();else if($(".rvw").hasClass("active")){$("#review_act").show();var e=$("#cust-edit-FirstName")&&$("#cust-edit-FirstName").val().trim();$("#customerName").val(e),$("#customerEmail").val($("#cust-edit-LoginId")&&$("#cust-edit-LoginId").val().trim())}else $(".cls").hasClass("active")&&$("#classes_act").show();else $(".detail-navbar").length?$("#services-tab").parent().hasClass("active")?showCurSerSts():showCurClsSts():handlingTabs("ser");"true"==customerInfo.thirdPartyLogin&&0==$(".login_details").is(":visible")&&($(".login-icon-div").addClass("show-login-icon").removeClass("hide"),$(".login-icon-div img").show(),$("#login").show())},showActiveMobileTab=function(){var e=".gt";$(".mobile-navbar").removeClass("active"),$(".service > span.mobile-navbar").addClass("active"),$(e+" .gt_act").hasClass("services_tab")?($(".mobile-navbar").removeClass("active"),$(".provider > span.mobile-navbar").addClass("active")):$(e+" .gt_act").hasClass("provider_tab")?($(".mobile-navbar").removeClass("active"),$(".date > span.mobile-navbar").addClass("active")):$(e+" .gt_act").hasClass("timeslot_tab")&&!$(e+" .gt_act").hasClass("signIn_tab")?($(".mobile-navbar").removeClass("active"),$(".date > span.mobile-navbar").addClass("active")):$(e+" .gt_act").hasClass("timeslot_tab")&&$(e+" .gt_act").hasClass("signIn_tab")?($(".mobile-navbar").removeClass("active"),$(".info > span.mobile-navbar").addClass("active")):$(e+".gt_act").hasClass("signInCont")?($(".mobile-navbar").removeClass("active"),$(".info > span.mobile-navbar").addClass("active")):$(e+" .gt_act").hasClass("confirmCusDetails_tab")?($(".mobile-navbar").removeClass("active"),$(".confirm > span.mobile-navbar").addClass("active")):$(e+" .gt_act").hasClass("eCusDetails_tab")?($(".mobile-navbar").removeClass("active"),$(".info > span.mobile-navbar").addClass("active")):$(e+" .gt_act").hasClass("payappt_tab")&&($(".mobile-navbar").removeClass("active"),$(".info > span.mobile-navbar").addClass("active")),$("#classes-tab").parent().hasClass("active")&&$("#classes-tab").hasClass("clsInfo")&&$(".class_info span.mobile-navbar").addClass("active")},handlingTabs=function(e){var s=".gt";if(bkPolicy("ser"),$(".service-container").show(),$(".step_tab").show(),$("#chs_service_act").show(),$(".step_tab h2").html(""+choose_a_ser+" "+_customizedSerName),$(".loaderMessage").hide(),$(".service-container #sc_act, .service-container  .customer-login-form").hide(),$(".confirm_appt").css({"margin-top":"0px"}),0==$("#chs_service_act > ul").length&&($("#chs_service_act").html("<p>"+lang.booking_services_unavailable+"</p>"),$(".service_title").show()),fbbdp&&$(".chng-tz").removeClass("fbbdp-adjustment"),$(s+" .gt_act").hasClass("services_tab")){var t="Provider"!=customisedProviderLabel?customisedProviderLabel:"en"!=language?lang.provider:"Provider";$("#sp_act").show(),$(".step_tab h2").html(""+choose_a_pro+" "+t),$("#chs_service_act").hide()}else $(s+" .gt_act").hasClass("provider_tab")?($("#chs_service_act").hide(),$("#dateCont").show(),showDatePageHeaderTitle()):$(s+" .gt_act").hasClass("timeslot_tab")&&!$(s+" .gt_act").hasClass("signIn_tab")?($("#chs_service_act").hide(),$("#dateCont").show(),showDatePageHeaderTitle()):$(s+" .gt_act").hasClass("timeslot_tab")&&$(s+" .gt_act").hasClass("signIn_tab")?($(".customerLoginContainer").hasClass("selectedFromSlots")?($("#dateCont").show(),$(".customerLoginContainer").removeClass("selectedFromSlots"),$(".gt .gt_act").removeClass("signIn_tab").addClass("timeslot_tab"),showDatePageHeaderTitle()):($("#dateCont").hide(),chkCusLogin("service-container")),$("#chs_service_act").hide()):$(s+".gt_act").hasClass("signInCont")?($("#chs_service_act").hide(),$("#dateCont").hide(),chkCusLogin("service-container")):$(s+" .gt_act").hasClass("confirmCusDetails_tab")?($(".step_tab > h2").html(lang.confirm_your_appt),$("#chs_service_act").hide(),$("#policy_link").hide()):$(s+" .gt_act").hasClass("eCusDetails_tab")?($("#chs_service_act").hide(),$(".service-container #sc_act, .service-container  .customer-login-form").show(),hTitle("service-container")):$(s+" #gt_sr").hasClass("payappt_tab")?($(".step_tab h2").html(lang.appt_confirmed),$("#chs_service_act, #sp_act , #dateCont , #sc_act , #policy_link").hide(),$("#services-tab").removeClass("srLst").removeClass("srPro").removeClass("srDt").removeClass("signInFrm").removeClass("srInfo").removeClass("srBkd"),$(".bookAnotherAppt").css("display","block")):$(s+" .gt_act").hasClass("submitapp_tab")&&($("#chs_service_act").hide(),$("h2").html(lang.appt_confirmed),bookAnotherAppt(),showCalBkUrl());showActiveMobileTab()},getWorkingHoursForSingleResource=function(e,s,t,a,i){$("#dateCont").show();var o=moment(a).format("DD/MM/YYYY"),n=new Array;n.push(""!=restrictAfterThisDate?restrictAfterThisDate.getTime():"");try{for(var r in peopleServicesMap)if(resourceKey==peopleServicesMap[r].ResourceKey&&""==peopleServicesMap[r].WorkingDays)return alert("This staff doesn't have any working days"),void location.reload();if(void 0==resourceKey||null==resourceKey||""==resourceKey||"undefined"==resourceKey)return alert("Something went wrong!"),void location.reload();var l="companyKey="+e+"&currentDay="+s.getDay()+"&duration="+t+"&resourceKey="+resourceKey+"&selectedDate="+o+"&UTCDate="+i+"&slotLimit="+customerInfo.timeSlot;if(_enabledCustLocalTimeZone&&timeZoneObj.companyTimeZoneObj.timeZoneID!=_selectedTimeZone){var c=timeZoneObj.localTimeZoneObj.timeZoneID;arguments[5]?c=arguments[5]:_selectedTimeZone&&(c=_selectedTimeZone),l="companyKey="+e+"&currentDay="+s.getDay()+"&duration="+t+"&resourceKey="+resourceKey+"&selectedDate="+o+"&UTCDate="+i+"&slotLimit="+customerInfo.timeSlot+"&lTZ="+c;var d="";if(adavanceDays>0){var m=s.getTime(),p=new Date(m),u=new Date(p.setDate(s.getDate()-parseInt(adavanceDays))),h=FormatDate(u,"%d/%m/%y");d=new Date(clientDateSplit[2],clientDateSplit[1]-1,clientDateSplit[0]);var v=FormatDate(d,"%d/%m/%y"),g=new Date(compclientDateSplit[2],compclientDateSplit[1]-1,compclientDateSplit[0]),f=FormatDate(g,"%d/%m/%y");if(h==v||u.getTime()<d.getTime()||h==f){var y=FormatDate(tempcompyClientDate,"%d/%m/%y"),i=Date.UTC(tempcompyClientDate.getFullYear(),tempcompyClientDate.getMonth(),tempcompyClientDate.getDate(),0,0,0),C=FormatDate(s,"%d/%m/%y");l="companyKey="+e+"&currentDay="+tempcompyClientDate.getDay()+"&duration="+t+"&resourceKey="+resourceKey+"&selectedDate="+y+"&UTCDate="+i+"&slotLimit="+customerInfo.timeSlot+"&lTZ="+c+"&advDays="+adavanceDays,companyWorkingDetails.companyWorkingDetails.restrictedBookingDays||(l=l+"&cusDtWithApptLeadTime="+C)}}if(companyWorkingDetails.companyWorkingDetails.restrictedBookingDays){var _=d;_=d?new Date(_.setDate(d.getDate()+parseInt(adavanceDays))):s;var C=FormatDate(_,"%d/%m/%y"),b=FormatDate(restrictAfterThisAccDate,"%d/%m/%y");l=0==l.contains("cusDtWithApptLeadTime")?l+"&cusDtWithApptLeadTime="+C+"&restrictFromDate="+b+"&advDays="+adavanceDays:l+"&restrictFromDate="+b+"&advDays="+adavanceDays,adavanceDays>0&&(l=l+"&sLocDt="+FormatDate(s,"%d/%m/%y"))}}if(!t||null==bookingSettings&&"da213e03-c857-41aa-a91f-bcc9a9b5b88d"!=e&&"6890a6d5-9f10-4ff6-94de-1429a334816a"!=e&&"4229656f-e5ad-41ce-9dad-52c810707942"!=e&&"0f5e06dc-8978-454d-8839-68c25e455968"!=e&&"e2c38cc0-b299-4096-ada7-468d014d5b13"!=e&&"15f58bc2-275d-43a0-8654-62161ee0a702"!=e&&"c09f4065-aead-46b1-8437-76b095356d8a"!=e&&"ce988387-ae27-42ee-beef-aa70db25c1e1"!=e&&"31e67443-89d9-4a9d-ac26-d7fb771e00a1"!=e&&"91294834-c80d-4b48-a1e1-ad476f8057cc"!=e&&"00ecfa32-7c5f-4225-8680-f993ff199fde"!=e)pullSlots(l,s,n);else{String(isNextAvailableDate).indexOf("true")!=-1?(count=30,F_avl=1):(count=1,F_avl=0),A_D_min=getAdvanceDurationMins();var k={};k.url="/slots/v1/"+e+"/"+resourceKey+"/"+t+"/"+A_D_min+"/"+count+"/"+F_avl,k.dateStr=moment(a).format("MM/DD/YYYY"),c?k.timezone=c:timeZoneObj.companyTimeZoneObj?k.timezone=timeZoneObj.companyTimeZoneObj.timeZoneID:k.timezone=companyDetails.timezone;var D="h:mm a";"24 Hours"==customerInfo.timeFormat&&(D="HH:mm"),k.format=D,pullNewGenSlots(k,s,n)}}catch(w){console.log("Error occured in ajax call for getWorkingHoursForSingleResource ::"+w.message)}},pullNewGenSlots=function(e,s,t){$.ajax({type:"GET",url:e.url+"?timezone="+e.timezone+"&date="+e.dateStr+"&timeFormat="+e.format,contentType:"application/json",dataType:"json",success:function(e){if(e)if(String(isNextAvailableDate).indexOf("true")!=-1){var a=new Date(s);for(i=0;i<30;i++){var o=customerInfo&&"false"==customerInfo.enableLocalTimezone?restrictAfterThisDate:restrictAfterThisAccDate;if(t.indexOf(a.getTime())!=-1||""!=o&&o.getTime()<=a.getTime()){var n=new Date(a);n.setDate(a.getDate()-1),buildingtheSlots(n,"NonWorkingDay","No Slots Available");break}var r=moment(a).format("MM/DD/YYYY");if(String(isNextAvailableDate).indexOf("true")!=-1&&null!=e.data.slots[r]&&0!=e.data.slots[r].length)return window.clientDate=a,selectedDate=a.getMonth()+1+"/"+a.getDate()+"/"+a.getFullYear(),void buildingtheSlots(a,"WorkingDay",e.data.slots[r]);restrictedDatesInRed.push(new Date(a)),a.setDate(a.getDate()+1),29==i&&findTheNextAvailableDate(a)}}else""==restrictAfterThisDate||""!=restrictAfterThisDate&&s.getTime()<restrictAfterThisDate.getTime()?(e=e.data.slots[moment(selectedDate).format("MM/DD/YYYY")],null!=e&&0!=e.length?buildingtheSlots(s,"WorkingDay",e):buildingtheSlots(s,"WorkingDay","No Slots Available")):buildingtheSlots(s,"NonWorkingDay","No Slots Available")}})},getAdvanceDurationMins=function(){var e=companyWorkingDetails.companyWorkingDetails;return 24*e.advanceBookingDays*60+60*e.advanceBookingHours+e.advanceBookingMins},pullSlots=function(e,s,t){currentCall=$.ajax({type:"GET",url:"/showWorkinghoursForResource.do",data:e,dataType:"html",async:!0,cache:!1,beforeSend:function(){null!=currentCall&&currentCall.abort()}}).done(function(e){if(e)if(String(isNextAvailableDate).indexOf("true")!=-1)if(t.indexOf(s.getTime())==-1){if(_enabledCustLocalTimeZone&&restrictAfterThisAccDate&&(String(e).indexOf("No Slots Available")!=-1||String(e).indexOf("Non Working Day")!=-1)&&(restrictAfterThisAccDate.getTime()==s.getTime()||s.getTime()>restrictAfterThisAccDate.getTime()))return void buildingtheSlots(s,"NonWorkingDay",e);if(String(e).indexOf("No Slots Available")!=-1||String(e).indexOf("Non Working Day")!=-1){$("#loading_icon").is(":visible")||$("#timesheet").html('<img id="loading_icon_timings"  class="loading_icon_timings"  src="/setmore-loader.gif" style="display:show"></img>'),restrictedDatesInRed.push(new Date(s));var a=new Date(s);a.setDate(a.getDate()+1),findTheNextAvailableDate(a)}else""!=restrictAfterThisDate?s.getTime()<restrictAfterThisDate.getTime()?buildingtheSlots(s,"WorkingDay",e):buildingtheSlots(s,"NonWorkingDay",e):buildingtheSlots(s,"WorkingDay",e)}else{var i=s;i.setDate(i.getDate()-1),buildingtheSlots(s,"NonWorkingDay",e)}else""!=restrictAfterThisDate?s.getTime()<restrictAfterThisDate.getTime()?buildingtheSlots(s,"WorkingDay",e):buildingtheSlots(s,"NonWorkingDay",e):buildingtheSlots(s,"WorkingDay",e)}).fail(function(e){})},buildingtheSlots=function(e,s,t){if($("#sLoader").hide(),$(".loaderMessage").hide(),$("#dateCont").show(),$(".Go-back").hasClass("active"))return $("#dateCont").hide(),activateSerOrProTab(),void $(".Go-back").removeClass("active");_enabledCustLocalTimeZone&&$(".chng-tz").show();var a=e.getDate();if("Japanese"==language&&(a=a+""+htmlDecode("&#x65e5;")),"NonWorkingDay"==s||"NoSlotsAvailable"==s){var i=monthsInOtherLang(_months[e.getMonth()]),o=a+" "+i+"...";$("#appt_date > span.step-li").html(o),$("#appt_date > span.step-li").attr("class","step-li active"),$(".mobile-navbar").removeClass("active"),$("#appt_date > span.mobile-navbar").attr("class","active mobile-navbar"),$("#appt_date > span.step-li").attr("title",a+" "+i+" "+e.getFullYear());e.getFullYear()+"-"+e.getDate()+"-"+(e.getMonth()+1);restrictAfterThisDate&&restricted_Dates.indexOf(restrictAfterThisDate)==-1&&restricted_Dates.indexOf(restrictAfterThisAccDate)==-1&&restricted_Dates.push(restrictAfterThisDate),$("#calendars").DatePickerSetDate(FormatDate(e,"%y-%d-%m"),!0),$("#calendars").show(),$("#loading_icon").hide(),$("#timesheet").html(lang.non_working_day),(s="NoSlotsAvailable")&&$("#timesheet").html(lang.no_slots),$("#timesheet").show(),$("#timesheet").addClass("noSlots")}else{var i=monthsInOtherLang(_months[e.getMonth()]),o=a+" "+i+"...";$("#appt_date > span.step-li").html(o),$("#appt_date > span.step-li").attr("class","step-li active"),$(".mobile-navbar").removeClass("active"),$("#appt_date > span.mobile-navbar").attr("class","active mobile-navbar"),$("#appt_date > span.step-li").attr("title",a+" "+i+" "+e.getFullYear());e.getFullYear()+"-"+e.getDate()+"-"+(e.getMonth()+1);restrictAfterThisDate&&restricted_Dates.indexOf(restrictAfterThisDate)==-1&&restricted_Dates.indexOf(restrictAfterThisAccDate)==-1&&restricted_Dates.push(restrictAfterThisDate),$("#calendars").DatePickerSetDate(FormatDate(e,"%y-%d-%m"),!0),$("#calendars").show(),$("#loading_icon").hide(),fbbdp&&($(".datepickerGoNext a").css("background-image","none"),$(".datepickerGoNext").addClass("newArrowRight"),$(".datepickerGoNext a").css("background-image",'url("/bookingpage/images/right_nav_arrow.svg")'),$(".datepickerGoPrev a").css("background-image","none"),$(".datepickerGoPrev").addClass("newArrowLeft"),$(".datepickerGoPrev a").css("background-image",'url("/bookingpage/images/left_nav_arrow.svg")')),$(".datepickerSelected").hasClass("datepickerDisabled")&&$(".datepickerSelected").removeClass("datepickerDisabled").removeClass("datepickerDisabledRed");var n="";if(n=arguments[3]?generateTimeSlotsForSkipStaff(t):generateTimeSlots(t),fbbdp&&($(".service_title").html(lang.select_preferredtime),$(".chng-tz").addClass("fbbdp-adjustment")),$("#timesheet").html(n),$("#timesheet").removeClass("noSlots"),"No Slots Available"!=n&&"Non Working Day"!=n||$("#timesheet").addClass("noSlots"),$("#timesheet").show(),isWixApp){var r=$("#timesheet").height();wixHeightGenerator(r)}applyToolTip()}},new_generateTimeSlotsForSkipStaff=function(e){if(null!=e&&("No Slots Available"==e||"Non Working Day"==e))return e.indexOf("No Slots Available")!=-1?lang.no_slots:lang.non_working_day;var s=e,t='<ul class="morning"><li class="list_heading">'+lang.morning+"</li>",a='<ul class="afternoon"><li class="list_heading">'+lang.afternoon+"</li>",o='<ul class="evening"><li class="list_heading">'+lang.evening+"</li>",n="h:mm a";for("24 Hours"==customerInfo.timeFormat&&(n="HH:mm"),i=0;i<s.length;i++){var r=s[i];if(moment(r[0]).zone(-(r[1]/6e4)).format("H.mm")<12){var l=r[2]+"_"+r[3],c=getLocalTimeZone(shortTimeZone,clientDate,l,null,r[4]);t+=c}else if(moment(r[0]).zone(-(r[1]/6e4)).format("H.mm")<15.59){var l=r[2]+"_"+r[3],c=getLocalTimeZone(shortTimeZone,clientDate,l,null,r[4]);a+=c}else{var l=r[2]+"_"+r[3],c=getLocalTimeZone(shortTimeZone,clientDate,l,null,r[4]);o+=c}}return t+="</ul>",a+="</ul>",o+="</ul>",t+a+o},new_generateTimeSlots=function(e){if(null!=e&&("No Slots Available"==e||"Non Working Day"==e))return e.indexOf("No Slots Available")!=-1?lang.no_slots:lang.non_working_day;var s=e,t='<ul class="morning"><li class="list_heading">'+lang.morning+"</li>",a='<ul class="afternoon"><li class="list_heading">'+lang.afternoon+"</li>",o='<ul class="evening"><li class="list_heading">'+lang.evening+"</li>",n="h:mm a";for("24 Hours"==customerInfo.timeFormat&&(n="HH:mm"),i=0;i<s.length;i++){var r=s[i];if(moment(r[0]).zone(-(r[1]/6e4)).format("H.mm")<12){var l=resourceKeySelected+"_"+r[3],c=getLocalTimeZone(shortTimeZone,clientDate,l,null,r[4]);t+=c}else if(moment(r[0]).zone(-(r[1]/6e4)).format("H.mm")<15.59){var l=resourceKeySelected+"_"+r[3],c=getLocalTimeZone(shortTimeZone,clientDate,l,null,r[4]);a+=c}else{var l=resourceKeySelected+"_"+r[3],c=getLocalTimeZone(shortTimeZone,clientDate,l,null,r[4]);o+=c}}return t+="</ul>",a+="</ul>",o+="</ul>",t+a+o},generateTimeSlots=function(e){if(serviceDuration&&(null!=bookingSettings||"da213e03-c857-41aa-a91f-bcc9a9b5b88d"==companyKey||"6890a6d5-9f10-4ff6-94de-1429a334816a"==companyKey||"4229656f-e5ad-41ce-9dad-52c810707942"==companyKey||"0f5e06dc-8978-454d-8839-68c25e455968"==companyKey||"e2c38cc0-b299-4096-ada7-468d014d5b13"==companyKey||"15f58bc2-275d-43a0-8654-62161ee0a702"==companyKey||"c09f4065-aead-46b1-8437-76b095356d8a"==companyKey||"ce988387-ae27-42ee-beef-aa70db25c1e1"==companyKey||"31e67443-89d9-4a9d-ac26-d7fb771e00a1"==companyKey||"91294834-c80d-4b48-a1e1-ad476f8057cc"==companyKey||"00ecfa32-7c5f-4225-8680-f993ff199fde"==companyKey))return new_generateTimeSlots(e);if(e&&"No Slots Available"!=e&&"Non Working Day"!=e){var s=jQuery.parseJSON(e),t='<ul class="morning"><li class="list_heading">'+lang.morning+"</li>",a='<ul class="afternoon"><li class="list_heading">'+lang.afternoon+"</li>",i='<ul class="evening"><li class="list_heading">'+lang.evening+"</li>";if("24 Hours"!=customerInfo.timeFormat){for(index in s)if(parseFloat(String(s[index]).split("_")[1])<12){var o=parseFloat(String(s[index]).split("_")[1]).toFixed(2);parseFloat(String(s[index]).split("_")[1])>=0&&parseFloat(String(s[index]).split("_")[1])<=.59&&(o=(parseFloat(String(s[index]).split("_")[1])+12).toFixed(2));var n=String(s[index]).split("_")[0]+"_"+String(o).replace(".",":")+" am",r=getLocalTimeZone(shortTimeZone,clientDate,n);t+=r}else if(parseFloat(String(s[index]).split("_")[1])>=12&&parseFloat(String(s[index]).split("_")[1])<=15.59){var o="";o=parseFloat(String(s[index]).split("_")[1])>=12&&parseFloat(String(s[index]).split("_")[1])<=12.59?parseFloat(String(s[index]).split("_")[1]).toFixed(2):(parseFloat(String(s[index]).split("_")[1])-12).toFixed(2);var n=String(s[index]).split("_")[0]+"_"+String(o).replace(".",":")+" pm",r=getLocalTimeZone(shortTimeZone,clientDate,n);a+=r}else if(parseFloat(String(s[index]).split("_")[1])>=16){var o=(parseFloat(String(s[index]).split("_")[1])-12).toFixed(2),n=String(s[index]).split("_")[0]+"_"+String(o).replace(".",":")+" pm",r=getLocalTimeZone(shortTimeZone,clientDate,n);i+=r}}else for(index in s)if(parseFloat(String(s[index]).split("_")[1])<12){var o=parseFloat(String(s[index]).split("_")[1]).toFixed(2);parseFloat(String(s[index]).split("_")[1])<10&&(o=o.slice(0,0)+"0"+o.slice(0));var n=String(s[index]).split("_")[0]+"_"+String(o).replace(".",":"),r=getLocalTimeZone(shortTimeZone,clientDate,n);t+=r}else if(parseFloat(String(s[index]).split("_")[1])>=12&&parseFloat(String(s[index]).split("_")[1])<=15.59){var o=parseFloat(String(s[index]).split("_")[1]).toFixed(2),n=String(s[index]).split("_")[0]+"_"+String(o).replace(".",":"),r=getLocalTimeZone(shortTimeZone,clientDate,n);a+=r}else if(parseFloat(String(s[index]).split("_")[1])>=16){var o=parseFloat(String(s[index]).split("_")[1]).toFixed(2),n=String(s[index]).split("_")[0]+"_"+String(o).replace(".",":"),r=getLocalTimeZone(shortTimeZone,clientDate,n);
i+=r}return t+="</ul>",a+="</ul>",i+="</ul>",t+a+i}return e.indexOf("No Slots Available")!=-1?lang.no_slots:lang.non_working_day},showTimingsForAllResources=function(){$("#sLoader").show(),$(".gt_act").removeClass("services_tab").removeClass("submitapp_tab").addClass("provider_tab"),$("#services-tab").removeClass("srLst").removeClass("srPro").addClass("srDt"),$("#progress-icon").removeClass("service").removeClass("infoIcon").addClass("serviceIcon"),$(".date").removeClass("pointer_events"),$("#dateCont").hide(),$("#sign_out").removeClass("serviceSelected").addClass("providerSelected"),chkShrtBp(),$("#sp_act").hide(),$(".loaderMessage").show(),$(".provider > span.step-li").attr("class","done step-li"),"frmFailureState"==arguments[0]&&($(".info > span.step-li").removeClass("done"),$("#progress-icon").show()),animateProgressBar();var e="Provider"!=customisedProviderLabel?customisedProviderLabel:"en"!=language?lang.provider:"Provider";if($(".provider > span.step-li").attr("title",htmlDecode(e).toUpperCase()),_enabledCustLocalTimeZone){$(".step_tab > h2").html("");var s=_seletedTimeZoneFullName?_seletedTimeZoneFullName:timeZoneObj.localTimeZoneObj.timeZoneFullName;if($(".chng-tz-a > span").html(s),_selectedTimeZone&&_selectedTimeZone!=timeZoneObj.localTimeZoneObj.timeZoneID)for(var t=0;t<=allTimeZones.length;t++)allTimeZones[t]&&allTimeZones[t].timeZoneID==_selectedTimeZone&&$(".chng-tz-a > span").html(allTimeZones[t].timeZoneFullName)}else $(".step_tab > h2").html(lang.choose_dateandtime+" ("+shortTimeZone+")"),$(".chng-tz").hide();var a=monthsInOtherLang(_months[clientDate.getMonth()]),i=clientDate.getDate()+" "+a+"...";if($("#appt_date > span.step-li").html(i),$("#appt_date > span.step-li").attr("class","active step-li"),$(".mobile-navbar").removeClass("active"),$("#appt_date > span.mobile-navbar").attr("class","active mobile-navbar"),$("#appt_date > span.step-li").attr("title",clientDate.getDate()+" "+_months[clientDate.getMonth()]+" "+clientDate.getFullYear()),console.log(clientDateToInitiliazeDatePicker),clientDate=clientDateToInitiliazeDatePicker,selectedDate=clientDate.getMonth()+1+"/"+clientDate.getDate()+"/"+clientDate.getFullYear(),customerInfo.timeSlot||(customerInfo.timeSlot=15),console.log(" serviceDuration :: "+serviceDuration),console.log(arguments[0]),"multipleServices"==arguments[0]){var o=0;for(var n in serviceCategoryList)selectedServicesKeys.indexOf(serviceCategoryList[n].key)!=-1&&(o+=serviceCategoryList[n].Duration);serviceDuration=o}else for(indexService in serviceCategoryList)indexService.indexOf(String(serviceKey))!=-1&&(serviceName=serviceCategoryList[indexService].ServiceName,serviceDuration=serviceCategoryList[indexService].Duration,serviceId=serviceCategoryList[indexService].key);k=Date.UTC(clientDate.getFullYear(),clientDate.getMonth(),clientDate.getDate(),0,0,0);for(var r=String(serviceCategoryList[serviceKey].ResourceKey).split(","),l=String(customerInfo.resourcesInOrder).split(","),c=new Array,t=0;t<l.length;t++)String(r).indexOf(l[t])!=-1&&""!=l[t]&&c.push(l[t]);for(var n in peopleServicesMap)if(c.indexOf(peopleServicesMap[n].ResourceKey)!=-1&&""==peopleServicesMap[n].WorkingDays&&(c.remove(peopleServicesMap[n].ResourceKey),0==c.length))return alert("This staff doesn't have any working days"),void location.reload();restrictedDatesInRed=[],console.info(" constructedResourceOrderArray :: "+c);var d=moment(selectedDate).format("DD/MM/YYYY"),m="companyKey="+companyKey+"&resourceKeys="+JSON.stringify(c)+"&currentDay="+clientDate.getDay()+"&duration="+serviceDuration+"&selectedDate="+d+"&UTCDate="+k+"&slotLimit="+customerInfo.timeSlot;if(console.log("Selected TZ Offset :: "+_selectedTimeZoneOffSet),_enabledCustLocalTimeZone&&timeZoneObj.companyTimeZoneObj.timeZoneID!=_selectedTimeZone){var p=timeZoneObj.localTimeZoneObj.timeZoneID;arguments[5]?p=arguments[5]:_selectedTimeZone&&(p=_selectedTimeZone),m="companyKey="+companyKey+"&resourceKeys="+JSON.stringify(c)+"&currentDay="+clientDate.getDay()+"&duration="+serviceDuration+"&selectedDate="+d+"&UTCDate="+k+"&slotLimit="+customerInfo.timeSlot+"&lTZ="+p;var u="";if(adavanceDays>0){var h=clientDate.getTime(),v=new Date(h),g=new Date(v.setDate(clientDate.getDate()-parseInt(adavanceDays))),f=FormatDate(g,"%d/%m/%y");u=new Date(clientDateSplit[2],clientDateSplit[1]-1,clientDateSplit[0]);var y=FormatDate(u,"%d/%m/%y"),C=new Date(compclientDateSplit[2],compclientDateSplit[1]-1,compclientDateSplit[0]),_=FormatDate(C,"%d/%m/%y");if(f==y||g.getTime()<u.getTime()||f==_){var b=FormatDate(tempcompyClientDate,"%d/%m/%y"),k=Date.UTC(tempcompyClientDate.getFullYear(),tempcompyClientDate.getMonth(),tempcompyClientDate.getDate(),0,0,0),D=FormatDate(clientDate,"%d/%m/%y");m="companyKey="+companyKey+"&resourceKeys="+JSON.stringify(c)+"&currentDay="+tempcompyClientDate.getDay()+"&duration="+serviceDuration+"&selectedDate="+b+"&UTCDate="+k+"&slotLimit="+customerInfo.timeSlot+"&lTZ="+p+"&advDays="+adavanceDays,companyWorkingDetails.companyWorkingDetails.restrictedBookingDays||(m=m+"&cusDtWithApptLeadTime="+D)}}if(companyWorkingDetails.companyWorkingDetails.restrictedBookingDays){var w=u;w=u?new Date(w.setDate(u.getDate()+parseInt(adavanceDays))):clientDate;var D=FormatDate(w,"%d/%m/%y"),S=FormatDate(restrictAfterThisAccDate,"%d/%m/%y");m=0==m.contains("cusDtWithApptLeadTime")?m+"&cusDtWithApptLeadTime="+D+"&restrictFromDate="+S+"&advDays="+adavanceDays:m+"&restrictFromDate="+S+"&advDays="+adavanceDays,adavanceDays>0&&(m=m+"&sLocDt="+FormatDate(clientDate,"%d/%m/%y"))}}if(!serviceDuration||null==bookingSettings&&"da213e03-c857-41aa-a91f-bcc9a9b5b88d"!=companyKey&&"6890a6d5-9f10-4ff6-94de-1429a334816a"!=companyKey&&"4229656f-e5ad-41ce-9dad-52c810707942"!=companyKey&&"0f5e06dc-8978-454d-8839-68c25e455968"!=companyKey&&"e2c38cc0-b299-4096-ada7-468d014d5b13"!=companyKey&&"15f58bc2-275d-43a0-8654-62161ee0a702"!=companyKey&&"c09f4065-aead-46b1-8437-76b095356d8a"!=companyKey&&"ce988387-ae27-42ee-beef-aa70db25c1e1"!=companyKey&&"31e67443-89d9-4a9d-ac26-d7fb771e00a1"!=companyKey&&"91294834-c80d-4b48-a1e1-ad476f8057cc"!=companyKey&&"00ecfa32-7c5f-4225-8680-f993ff199fde"!=companyKey)pullSlotsForSkipTheStaff(m,clientDate);else{String(isNextAvailableDate).indexOf("true")!=-1?(count=7,F_avl=1):(count=1,F_avl=0),A_D_min=getAdvanceDurationMins();var I={};I.url="/slots/v1/staffs/"+companyKey+"/"+serviceKey+"/"+serviceDuration+"/"+A_D_min+"/"+count+"/"+F_avl,I.dateStr=moment(selectedDate).format("MM/DD/YYYY"),p?I.timezone=p:timeZoneObj.companyTimeZoneObj?I.timezone=timeZoneObj.companyTimeZoneObj.timeZoneID:I.timezone=companyDetails.timezone;var T="h:mm a";"24 Hours"==customerInfo.timeFormat&&(T="HH:mm"),I.format=T,pullNewGenSlotsForSkipTheStaff(I,clientDate)}var i=clientDateToInitiliazeDatePicker.getFullYear()+"-"+clientDateToInitiliazeDatePicker.getDate()+"-"+(clientDateToInitiliazeDatePicker.getMonth()+1);new Date;tempunblockedDates=unblockedDates,unblockedDates=[],restrictedDatesInRed=""!=tempRestDtsInRed?tempRestDtsInRed:restrictedDatesInRed,restricted_Dates=""!=tempRestrDates?tempRestrDates:restricted_Dates,blockedOutDates=""!=tempBlockedDays?tempBlockedDays:blockedOutDates,restrictAfterThisDate=""!=temprestrictAfterThisDate?temprestrictAfterThisDate:restrictAfterThisDate,adavanceDays=0!=tempAdvanceDays&&null!=tempAdvanceDays?tempAdvanceDays:adavanceDays,$("#calendars").DatePicker({flat:!0,date:i,current:new Date(clientsDateInMilliSec),format:"Y-d-m",calendars:1,starts:startDay,onChange:function(e,s){selectedDate=s.getMonth()+1+"/"+s.getDate()+"/"+s.getFullYear();var t=monthsInOtherLang(_months[s.getMonth()]),a=s.getDate()+" "+t;$("#appt_date > span.step-li").html(a),$("#appt_date > span").attr("title",s.getDate()+" "+_months[s.getMonth()]+" "+s.getFullYear()),compressText(".date");try{$("#timesheet").html('<img id="loading_icon_timings"  class="loading_icon_timings"  src="/setmore-loader.gif" style="display:show"></img>'),clientDate=s;for(var i=Date.UTC(s.getFullYear(),s.getMonth(),s.getDate(),0,0,0),o=String(serviceCategoryList[serviceKey].ResourceKey).split(","),n=String(customerInfo.resourcesInOrder).split(","),r=new Array,l=0;l<n.length;l++)String(o).indexOf(n[l])!=-1&&r.push(n[l]);var c=moment(selectedDate).format("DD/MM/YYYY");console.log("skip2"),console.log(_selectedTimeZone);var d=window.multipleServiceDurationRef?window.multipleServiceDurationRef:serviceDuration,m="companyKey="+companyKey+"&resourceKeys="+JSON.stringify(r)+"&currentDay="+clientDate.getDay()+"&duration="+d+"&selectedDate="+c+"&UTCDate="+i+"&slotLimit="+customerInfo.timeSlot;if(_enabledCustLocalTimeZone&&timeZoneObj.companyTimeZoneObj.timeZoneID!=_selectedTimeZone){var p=timeZoneObj.localTimeZoneObj.timeZoneID;arguments[5]?p=arguments[5]:_selectedTimeZone&&(p=_selectedTimeZone),m="companyKey="+companyKey+"&resourceKeys="+JSON.stringify(r)+"&currentDay="+clientDate.getDay()+"&duration="+d+"&selectedDate="+c+"&UTCDate="+i+"&slotLimit="+customerInfo.timeSlot+"&lTZ="+p,console.log(adavanceDays);var u="";if(adavanceDays>0){var h=clientDate.getTime(),v=new Date(h),g=new Date(v.setDate(clientDate.getDate()-parseInt(adavanceDays))),f=FormatDate(g,"%d/%m/%y");u=new Date(clientDateSplit[2],clientDateSplit[1]-1,clientDateSplit[0]);var y=FormatDate(u,"%d/%m/%y"),C=new Date(compclientDateSplit[2],compclientDateSplit[1]-1,compclientDateSplit[0]),_=FormatDate(C,"%d/%m/%y");if(f==y||g.getTime()<u.getTime()||f==_){var b=FormatDate(tempcompyClientDate,"%d/%m/%y"),i=Date.UTC(tempcompyClientDate.getFullYear(),tempcompyClientDate.getMonth(),tempcompyClientDate.getDate(),0,0,0),k=FormatDate(clientDate,"%d/%m/%y");m="companyKey="+companyKey+"&resourceKeys="+JSON.stringify(r)+"&currentDay="+tempcompyClientDate.getDay()+"&duration="+serviceDuration+"&selectedDate="+b+"&UTCDate="+i+"&slotLimit="+customerInfo.timeSlot+"&lTZ="+p+"&advDays="+adavanceDays,companyWorkingDetails.companyWorkingDetails.restrictedBookingDays||(m=m+"&cusDtWithApptLeadTime="+k)}}if(companyWorkingDetails.companyWorkingDetails.restrictedBookingDays){var D=u;D=u?new Date(D.setDate(u.getDate()+parseInt(adavanceDays))):clientDate;var k=FormatDate(D,"%d/%m/%y"),w=FormatDate(restrictAfterThisAccDate,"%d/%m/%y");m=0==m.contains("cusDtWithApptLeadTime")?m+"&cusDtWithApptLeadTime="+k+"&restrictFromDate="+w+"&advDays="+adavanceDays:m+"&restrictFromDate="+w+"&advDays="+adavanceDays,adavanceDays>0&&(m=m+"&sLocDt="+FormatDate(clientDate,"%d/%m/%y"))}}if(!serviceDuration||null==bookingSettings&&"da213e03-c857-41aa-a91f-bcc9a9b5b88d"!=companyKey&&"6890a6d5-9f10-4ff6-94de-1429a334816a"!=companyKey&&"4229656f-e5ad-41ce-9dad-52c810707942"!=companyKey&&"0f5e06dc-8978-454d-8839-68c25e455968"!=companyKey&&"e2c38cc0-b299-4096-ada7-468d014d5b13"!=companyKey&&"15f58bc2-275d-43a0-8654-62161ee0a702"!=companyKey&&"c09f4065-aead-46b1-8437-76b095356d8a"!=companyKey&&"ce988387-ae27-42ee-beef-aa70db25c1e1"!=companyKey&&"31e67443-89d9-4a9d-ac26-d7fb771e00a1"!=companyKey&&"91294834-c80d-4b48-a1e1-ad476f8057cc"!=companyKey&&"00ecfa32-7c5f-4225-8680-f993ff199fde"!=companyKey)pullSlotsForSkipTheStaff(m,clientDate);else{String(isNextAvailableDate).indexOf("true")!=-1?(count=7,F_avl=1):(count=1,F_avl=0),A_D_min=getAdvanceDurationMins();var S={};S.url="/slots/v1/staffs/"+companyKey+"/"+serviceKey+"/"+serviceDuration+"/"+A_D_min+"/"+count+"/"+F_avl,S.dateStr=moment(selectedDate).format("MM/DD/YYYY"),p?S.timezone=p:timeZoneObj.companyTimeZoneObj?S.timezone=timeZoneObj.companyTimeZoneObj.timeZoneID:S.timezone=companyDetails.timezone;var I="h:mm a";"24 Hours"==customerInfo.timeFormat&&(I="HH:mm"),S.format=I,pullNewGenSlotsForSkipTheStaff(S,clientDate)}}catch(T){alert("Error occured in ajax call for showwokringhours ::"+T.message)}}}),$("#calendars").children().length>1&&$("#calendars").children().first().remove()},pullNewGenSlotsForSkipTheStaff=function(e,s){currentCall=$.ajax({type:"GET",url:e.url+"?timezone="+e.timezone+"&date="+e.dateStr+"&timeFormat="+e.format,contentType:"application/json",dataType:"json",beforeSend:function(){null!=currentCall&&currentCall.abort()},success:function(e){if(e)if(String(isNextAvailableDate).indexOf("true")!=-1){var t=new Date(s);for(i=0;i<7;i++){var a=customerInfo&&"false"==customerInfo.enableLocalTimezone?restrictAfterThisDate:restrictAfterThisAccDate;if(""!=a&&a.getTime()<=t.getTime()){var o=new Date(t);o.setDate(t.getDate()-1),buildingtheSlots(o,"NonWorkingDay","No Slots Available");break}var n=moment(t).format("MM/DD/YYYY");if(String(isNextAvailableDate).indexOf("true")!=-1&&null!=e.data.slots[n]&&0!=e.data.slots[n].length)return window.clientDate=t,selectedDate=t.getMonth()+1+"/"+t.getDate()+"/"+t.getFullYear(),void buildingtheSlots(t,"WorkingDay",e.data.slots[n],"SkipStaff");restrictedDatesInRed.push(new Date(t)),t.setDate(t.getDate()+1),6==i&&findTheNextAvailableDateforSkipStaff(t)}}else""==restrictAfterThisDate||""!=restrictAfterThisDate&&s.getTime()<restrictAfterThisDate.getTime()?(e=e.data.slots[moment(selectedDate).format("MM/DD/YYYY")],null!=e&&0!=e.length?buildingtheSlots(s,"WorkingDay",e,"SkipStaff"):buildingtheSlots(s,"WorkingDay","No Slots Available")):buildingtheSlots(s,"NonWorkingDay","No Slots Available")}})},pullSlotsForSkipTheStaff=function(e,s){currentCall=$.ajax({type:"GET",url:"/showWorkingHoursForSkipStaff.do",data:e,dataType:"html",async:!0,cache:!1,beforeSend:function(){null!=currentCall&&currentCall.abort()}}).done(function(e){'<ul class="morning"><li class="list_heading">'+lang.morning+"</li>",'<ul class="afternoon"><li class="list_heading">'+lang.afternoon+"</li>",'<ul class="evening"><li class="list_heading">'+lang.evening+"</li>";if(null!=e&&""!=e)if($("#dateCont").show(),$("#calendars").show(),String(isNextAvailableDate).indexOf("true")!=-1){if(_enabledCustLocalTimeZone&&restrictAfterThisAccDate&&(String(e).indexOf("No Slots Available")!=-1||String(e).indexOf("Non Working Day")!=-1)&&(restrictAfterThisAccDate.getTime()==s.getTime()||s.getTime()>restrictAfterThisAccDate.getTime()))return void buildingtheSlots(s,"NonWorkingDay",e);if(String(e).indexOf("No Slots Available")!=-1){$("#calendars").hide(),$("#loading_icon").show(),$("#timesheet").hide(),restrictedDatesInRed.push(new Date(s));var t=new Date(s);t.setDate(t.getDate()+1),""!=restrictAfterThisDate?restrictAfterThisDate.getTime()!=t.getTime()&&t.getTime()<restrictAfterThisDate.getTime()?findTheNextAvailableDateforSkipStaff(t):buildingtheSlots(s,"NonWorkingDay",e):findTheNextAvailableDateforSkipStaff(t)}else""!=restrictAfterThisDate?s.getTime()<restrictAfterThisDate.getTime()?buildingtheSlots(s,"WorkingDay",e,"SkipStaff"):buildingtheSlots(s,"NonWorkingDay",e):buildingtheSlots(s,"WorkingDay",e,"SkipStaff")}else String(e).indexOf("No Slots Available")!=-1?buildingtheSlots(s,"NoSlotsAvailable",e):""!=restrictAfterThisDate?s.getTime()<restrictAfterThisDate.getTime()?buildingtheSlots(s,"WorkingDay",e,"SkipStaff"):buildingtheSlots(s,"NonWorkingDay",e):buildingtheSlots(s,"WorkingDay",e,"SkipStaff")}).fail(function(e){console.log(" Failed :: while getting the slots for skip the staff ")})},getLocalTimeZone=function(e,s,t,a,i){var o=t.split("_")[0];t=t.split("_")[1].toLowerCase();var n='<li class = skiptranslate><a resourceKey="'+o+'" data-company_time="'+i+'" href="javascript:void(0);">'+t+"</a></li>";return arguments[3]&&(n='<li class = skiptranslate><a appointmentKey="'+o+'" data-company_time="'+i+'" href="javascript:void(0);">'+t+"</a></li>"),n},findTheNextAvailableDateforSkipStaff=function(e){try{selectedDate=e.getMonth()+1+"/"+e.getDate()+"/"+e.getFullYear(),clientDate=e;var s=new Date,t=(s.getTime(),6e4*s.getTimezoneOffset(),Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),0,0,0));customerInfo.timeSlot||(customerInfo.timeSlot=15);for(indexService in serviceCategoryList)indexService.indexOf(String(serviceKey))!=-1&&(serviceName=serviceCategoryList[indexService].ServiceName,serviceDuration=serviceDuration?serviceDuration:serviceCategoryList[indexService].Duration,serviceId=serviceCategoryList[indexService].key);t=Date.UTC(clientDate.getFullYear(),clientDate.getMonth(),clientDate.getDate(),0,0,0);for(var a=String(serviceCategoryList[serviceKey].ResourceKey).split(","),i=String(customerInfo.resourcesInOrder).split(","),o=new Array,n=0;n<i.length;n++)String(a).indexOf(i[n])!=-1&&o.push(i[n]);var r=new Array;r.push(""!=restrictAfterThisDate?restrictAfterThisDate.getTime():""),console.log("selectedDate in findTheNextAvailableDateforSkipStaff ::"+selectedDate);var l=moment(selectedDate).format("DD/MM/YYYY"),c=window.multipleServiceDurationRef?window.multipleServiceDurationRef:serviceDuration,d="companyKey="+companyKey+"&resourceKeys="+JSON.stringify(o)+"&currentDay="+clientDate.getDay()+"&duration="+c+"&selectedDate="+l+"&UTCDate="+t+"&slotLimit="+customerInfo.timeSlot;if(_enabledCustLocalTimeZone&&timeZoneObj.companyTimeZoneObj.timeZoneID!=_selectedTimeZone){var m=timeZoneObj.localTimeZoneObj.timeZoneID;arguments[5]?m=arguments[5]:_selectedTimeZone&&(m=_selectedTimeZone),d="companyKey="+companyKey+"&resourceKeys="+JSON.stringify(o)+"&currentDay="+clientDate.getDay()+"&duration="+c+"&selectedDate="+l+"&UTCDate="+t+"&slotLimit="+customerInfo.timeSlot+"&lTZ="+m;var p="";if(adavanceDays>0){var u=clientDate.getTime(),h=new Date(u),v=new Date(h.setDate(clientDate.getDate()-parseInt(adavanceDays))),g=FormatDate(v,"%d/%m/%y");p=String(currentClientsDate).split("/"),p=new Date(clientDateSplit[2],clientDateSplit[1]-1,clientDateSplit[0]);var f=FormatDate(p,"%d/%m/%y"),y=new Date(compclientDateSplit[2],compclientDateSplit[1]-1,compclientDateSplit[0]),C=FormatDate(y,"%d/%m/%y");if(g==f||v.getTime()<p.getTime()||g==C){var _=FormatDate(tempcompyClientDate,"%d/%m/%y"),t=Date.UTC(tempcompyClientDate.getFullYear(),tempcompyClientDate.getMonth(),tempcompyClientDate.getDate(),0,0,0),b=FormatDate(clientDate,"%d/%m/%y");d="companyKey="+companyKey+"&resourceKeys="+JSON.stringify(o)+"&currentDay="+tempcompyClientDate.getDay()+"&duration="+serviceDuration+"&selectedDate="+_+"&UTCDate="+t+"&slotLimit="+customerInfo.timeSlot+"&lTZ="+m+"&advDays="+adavanceDays,companyWorkingDetails.companyWorkingDetails.restrictedBookingDays||(d=d+"&cusDtWithApptLeadTime="+b)}}if(companyWorkingDetails.companyWorkingDetails.restrictedBookingDays){var $=p;$=p?new Date($.setDate(p.getDate()+parseInt(adavanceDays))):clientDate;var b=FormatDate($,"%d/%m/%y"),k=FormatDate(restrictAfterThisAccDate,"%d/%m/%y");d=0==d.contains("cusDtWithApptLeadTime")?d+"&cusDtWithApptLeadTime="+b+"&restrictFromDate="+k+"&advDays="+adavanceDays:d+"&restrictFromDate="+k+"&advDays="+adavanceDays,adavanceDays>0&&(d=d+"&sLocDt="+FormatDate(clientDate,"%d/%m/%y"))}}if(!serviceDuration||null==bookingSettings&&"da213e03-c857-41aa-a91f-bcc9a9b5b88d"!=companyKey&&"6890a6d5-9f10-4ff6-94de-1429a334816a"!=companyKey&&"4229656f-e5ad-41ce-9dad-52c810707942"!=companyKey&&"0f5e06dc-8978-454d-8839-68c25e455968"!=companyKey&&"e2c38cc0-b299-4096-ada7-468d014d5b13"!=companyKey&&"15f58bc2-275d-43a0-8654-62161ee0a702"!=companyKey&&"c09f4065-aead-46b1-8437-76b095356d8a"!=companyKey&&"ce988387-ae27-42ee-beef-aa70db25c1e1"!=companyKey&&"31e67443-89d9-4a9d-ac26-d7fb771e00a1"!=companyKey&&"91294834-c80d-4b48-a1e1-ad476f8057cc"!=companyKey&&"00ecfa32-7c5f-4225-8680-f993ff199fde"!=companyKey)pullSlotsForSkipTheStaff(d,clientDate);else{String(isNextAvailableDate).indexOf("true")!=-1?(count=7,F_avl=1):(count=1,F_avl=0),A_D_min=getAdvanceDurationMins();var D={};D.url="/slots/v1/staffs/"+companyKey+"/"+serviceKey+"/"+serviceDuration+"/"+A_D_min+"/"+count+"/"+F_avl,D.dateStr=moment(selectedDate).format("MM/DD/YYYY"),m?D.timezone=m:timeZoneObj.companyTimeZoneObj?D.timezone=timeZoneObj.companyTimeZoneObj.timeZoneID:D.timezone=companyDetails.timezone;var w="h:mm a";"24 Hours"==customerInfo.timeFormat&&(w="HH:mm"),D.format=w,pullNewGenSlotsForSkipTheStaff(D,clientDate)}}catch(S){alert("Error occurred in findTheNextAvailableDateSkipStaff function ::"+S.message)}},findTheNextAvailableDate=function(e){try{selectedDate=e.getMonth()+1+"/"+e.getDate()+"/"+e.getFullYear(),clientDate=e;var s=new Date,t=(s.getTime(),6e4*s.getTimezoneOffset(),Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),0,0,0)),a=new Array;if(a.push(""!=restrictAfterThisDate?restrictAfterThisDate.getTime():""),restrictedLongDate.indexOf(e.getTime())==-1){var i=moment(selectedDate).format("DD/MM/YYYY"),o="companyKey="+companyKey+"&currentDay="+clientDate.getDay()+"&duration="+serviceDuration+"&resourceKey="+resourceKey+"&selectedDate="+i+"&longvalue="+e.getTime()+"&UTCDate="+t+"&slotLimit="+customerInfo.timeSlot;if(_enabledCustLocalTimeZone&&timeZoneObj.companyTimeZoneObj.timeZoneID!=_selectedTimeZone){var n=timeZoneObj.localTimeZoneObj.timeZoneID;arguments[5]?n=arguments[5]:_selectedTimeZone&&(n=_selectedTimeZone),o="companyKey="+companyKey+"&currentDay="+clientDate.getDay()+"&duration="+serviceDuration+"&resourceKey="+resourceKey+"&selectedDate="+i+"&longvalue="+e.getTime()+"&UTCDate="+t+"&slotLimit="+customerInfo.timeSlot+"&lTZ="+n;var r="";if(adavanceDays>0){var l=clientDate.getTime(),c=new Date(l),d=new Date(c.setDate(clientDate.getDate()-parseInt(adavanceDays))),m=FormatDate(d,"%d/%m/%y");r=String(currentClientsDate).split("/"),r=new Date(clientDateSplit[2],clientDateSplit[1]-1,clientDateSplit[0]);var p=FormatDate(r,"%d/%m/%y"),u=new Date(compclientDateSplit[2],compclientDateSplit[1]-1,compclientDateSplit[0]),h=FormatDate(u,"%d/%m/%y");if(m==p||d.getTime()<r.getTime()||m==h){var v=FormatDate(tempcompyClientDate,"%d/%m/%y"),t=Date.UTC(tempcompyClientDate.getFullYear(),tempcompyClientDate.getMonth(),tempcompyClientDate.getDate(),0,0,0),g=FormatDate(clientDate,"%d/%m/%y");o="companyKey="+companyKey+"&currentDay="+tempcompyClientDate.getDay()+"&duration="+serviceDuration+"&resourceKey="+resourceKey+"&selectedDate="+v+"&UTCDate="+t+"&slotLimit="+customerInfo.timeSlot+"&lTZ="+n+"&advDays="+adavanceDays,companyWorkingDetails.companyWorkingDetails.restrictedBookingDays||(o=o+"&cusDtWithApptLeadTime="+g)}}if(companyWorkingDetails.companyWorkingDetails.restrictedBookingDays){var f=r;f=r?new Date(f.setDate(r.getDate()+parseInt(adavanceDays))):clientDate;var g=FormatDate(f,"%d/%m/%y"),y=FormatDate(restrictAfterThisAccDate,"%d/%m/%y");o=0==o.contains("cusDtWithApptLeadTime")?o+"&cusDtWithApptLeadTime="+g+"&restrictFromDate="+y+"&advDays="+adavanceDays:o+"&restrictFromDate="+y+"&advDays="+adavanceDays,adavanceDays>0&&(o=o+"&sLocDt="+FormatDate(clientDate,"%d/%m/%y"))}}if(null==serviceDuration||null==bookingSettings&&"da213e03-c857-41aa-a91f-bcc9a9b5b88d"!=companyKey&&"6890a6d5-9f10-4ff6-94de-1429a334816a"!=companyKey&&"4229656f-e5ad-41ce-9dad-52c810707942"!=companyKey&&"0f5e06dc-8978-454d-8839-68c25e455968"!=companyKey&&"e2c38cc0-b299-4096-ada7-468d014d5b13"!=companyKey&&"15f58bc2-275d-43a0-8654-62161ee0a702"!=companyKey&&"c09f4065-aead-46b1-8437-76b095356d8a"!=companyKey&&"ce988387-ae27-42ee-beef-aa70db25c1e1"!=companyKey&&"31e67443-89d9-4a9d-ac26-d7fb771e00a1"!=companyKey&&"91294834-c80d-4b48-a1e1-ad476f8057cc"!=companyKey&&"00ecfa32-7c5f-4225-8680-f993ff199fde"!=companyKey)pullSlotForFirstAvailableAppt(o,e,a);else{A_D_min=getAdvanceDurationMins();var C={};C.url="/slots/v1/"+companyKey+"/"+resourceKey+"/"+serviceDuration+"/"+A_D_min+"/30/1",C.dateStr=moment(selectedDate).format("MM/DD/YYYY"),n?C.timezone=n:timeZoneObj.companyTimeZoneObj?C.timezone=timeZoneObj.companyTimeZoneObj.timeZoneID:C.timezone=companyDetails.timezone,pullNewGenSlots(C,clientDate,a)}}else{restrictedDatesInRed.push(new Date(e));var _=new Date(e);_.setDate(_.getDate()+1),findTheNextAvailableDate(_)}}catch(b){alert("Error occured in ajax call for findNextAvailble ::"+b.message)}},pullSlotForFirstAvailableAppt=function(e,s,t){currentCall=$.ajax({type:"GET",url:"/showWorkinghoursForResource.do",data:e,dataType:"html",async:!0,cache:!1,beforeSend:function(){null!=currentCall&&currentCall.abort()}}).done(function(e){if(e)if(t.indexOf(s.getTime())==-1){if(_enabledCustLocalTimeZone&&restrictAfterThisAccDate&&(String(e).indexOf("No Slots Available")!=-1||String(e).indexOf("Non Working Day")!=-1)&&(restrictAfterThisAccDate.getTime()==clientDate.getTime()||clientDate.getTime()>restrictAfterThisAccDate.getTime()))return void buildingtheSlots(clientDate,"NonWorkingDay",e);if(String(e).indexOf("No Slots Available")!=-1||String(e).indexOf("Non Working Day")!=-1){$("#loading_icon_timings").is(":visible")||$("#loading_icon").is(":visible")||$("#loading_icon").show(),restrictedDatesInRed.push(new Date(s));var a=new Date(s);a.setDate(a.getDate()+1),findTheNextAvailableDate(a)}else""!=restrictAfterThisDate?clientDate.getTime()<restrictAfterThisDate.getTime()?buildingtheSlots(clientDate,"WorkingDay",e):buildingtheSlots(clientDate,"NonWorkingDay",e):buildingtheSlots(clientDate,"WorkingDay",e)}else{var i=clientDate;i.setDate(i.getDate()-1),buildingtheSlots(clientDate,"NonWorkingDay",e)}}).fail(function(e){console.log("Failed :: while getting next available dates ")})},generateTimeSlotsForSkipStaff=function(e){if(serviceDuration&&(null!=bookingSettings||"da213e03-c857-41aa-a91f-bcc9a9b5b88d"==companyKey||"6890a6d5-9f10-4ff6-94de-1429a334816a"==companyKey||"4229656f-e5ad-41ce-9dad-52c810707942"==companyKey||"0f5e06dc-8978-454d-8839-68c25e455968"==companyKey||"e2c38cc0-b299-4096-ada7-468d014d5b13"==companyKey||"15f58bc2-275d-43a0-8654-62161ee0a702"==companyKey||"c09f4065-aead-46b1-8437-76b095356d8a"==companyKey||"ce988387-ae27-42ee-beef-aa70db25c1e1"==companyKey||"31e67443-89d9-4a9d-ac26-d7fb771e00a1"==companyKey||"91294834-c80d-4b48-a1e1-ad476f8057cc"==companyKey||"00ecfa32-7c5f-4225-8680-f993ff199fde"==companyKey))return new_generateTimeSlotsForSkipStaff(e);var s='<ul class="morning"><li class="list_heading">'+lang.morning+"</li>",t='<ul class="afternoon"><li class="list_heading">'+lang.afternoon+"</li>",a='<ul class="evening"><li class="list_heading">'+lang.evening+"</li>",i=jQuery.parseJSON(e),o=new Array;for(index in i)o.push(parseFloat(String(i[index]).split("_")[1]));if(console.log(o.sort(function(e,s){return e-s})),o=o.sort(function(e,s){return e-s}),"24 Hours"!=customerInfo.timeFormat){for(var n=0;n<o.length;n++)if(o[n]<12){var r=o[n].toFixed(2),l="";o[n]>=0&&o[n]<=.59&&(r=(o[n]+12).toFixed(2));for(indexTimings in i)if(parseFloat(String(i[indexTimings]).split("_")[1])>=0&&parseFloat(String(i[indexTimings]).split("_")[1])<=.59){var c=(parseFloat(String(i[indexTimings]).split("_")[1])+12).toFixed(2);if(String(r)===String(c)){l=String(i[indexTimings]).split("_")[0];break}}else if(String(r)===String(i[indexTimings]).split("_")[1]){l=String(i[indexTimings]).split("_")[0];break}var d=l+"_"+String(r).replace(".",":")+" am",m=getLocalTimeZone(shortTimeZone,clientDate,d);s+=m}else if(o[n]>=12&&o[n]<=15.59){var r="",l="";r=o[n]>=12&&o[n]<=12.59?o[n].toFixed(2):(parseFloat(o[n])-12).toFixed(2);for(indexTimings in i)if(String(o[n].toFixed(2))===String(i[indexTimings]).split("_")[1]){l=String(i[indexTimings]).split("_")[0];break}var d=l+"_"+String(r).replace(".",":")+" pm",m=getLocalTimeZone(shortTimeZone,clientDate,d);t+=m}else if(o[n]>=16){var l="",r=(o[n]-12).toFixed(2);for(indexTimings in i)if(String(o[n].toFixed(2))===String(i[indexTimings]).split("_")[1]){l=String(i[indexTimings]).split("_")[0];break}var d=l+"_"+String(r).replace(".",":")+" pm",m=getLocalTimeZone(shortTimeZone,clientDate,d);a+=m}}else for(var n=0;n<o.length;n++)if(o[n]<12){var r=o[n].toFixed(2),l="";o[n]>=0&&o[n]<=.59&&(r=o[n].toFixed(2));for(indexTimings in i)if(String(r)===String(i[indexTimings]).split("_")[1]){l=String(i[indexTimings]).split("_")[0];break}var d=l+"_"+String(r).replace(".",":"),m=getLocalTimeZone(shortTimeZone,clientDate,d);s+=m}else if(o[n]>=12&&o[n]<=15.59){var r="",l="";r=o[n]>=12&&o[n]<=12.59?o[n].toFixed(2):parseFloat(o[n]).toFixed(2);for(indexTimings in i)if(String(o[n].toFixed(2))===String(i[indexTimings]).split("_")[1]){l=String(i[indexTimings]).split("_")[0];break}var d=l+"_"+String(r).replace(".",":"),m=getLocalTimeZone(shortTimeZone,clientDate,d);t+=m}else if(o[n]>=16){var l="",r=o[n].toFixed(2);for(indexTimings in i)if(String(o[n].toFixed(2))===String(i[indexTimings]).split("_")[1]){l=String(i[indexTimings]).split("_")[0];break}var d=l+"_"+String(r).replace(".",":"),m=getLocalTimeZone(shortTimeZone,clientDate,d);a+=m}return s+="</ul>",t+="</ul>",a+="</ul>",s+t+a},customerLogin=function(e){return"true"!=customerInfo.thirdPartyLogin||"true"==facebookPage||1==fromZendesk?($(".skip_step").remove(),$(".classes-container .edit").hide(),$(".service-container .continue").removeClass("socialLogin").addClass("normalLogin"),$(".classes-container .continue").removeClass("socialLogin").addClass("normalLogin"),"true"!=facebookPage&&showForm(),clearCusSession(),!1):null==rescheduleResourceInfo&&null==resuchduleServicesInfo&&"true"!=facebookPage?($(".service-container .continue").hasClass("normalLogin")||$(".classes-container .continue").hasClass("normalLogin")||(checkForCustSessionAttr(),$(".service-container .continue").removeClass("normalLogin").addClass("socialLogin"),$(".classes-container .continue").removeClass("normalLogin").addClass("socialLogin"),$(".service-container .customerlist-name-holder > .input-profile-fields").hide(),$(".classes-container .customerlist-name-holder > .input-profile-fields").hide(),$(".service-container #cust-IEmailId").parent().parent().hide(),$(".classes-container #class_cust-IEmailId").parent().parent().hide(),0==customerInfo.branding&&($("#account_menu > a ").addClass("nobranding"),$("#account_menu").addClass("no-branding"),$("#login").addClass("no-brand")),0==$(".login_details").is(":visible")&&($("#login, .Log-in").show(),$(".login-icon-div").addClass("show-login-icon").removeClass("hide"))),hideLogin(),!0):void 0},showForm=function(){if($(".step_tab > h2").html(lang.enter_your_information),$(".class_step_tab > h2").html(lang.enter_your_information),$(".signIn").hide(),arguments[0]){var e="";$("#services-tab").parent().hasClass("active")?(e=".service-container",$("#services-tab").removeClass("srLst").removeClass("srPro").removeClass("srDt").removeClass("srBkd").removeClass("srCon").removeClass("signInFrm").addClass("skipForm")):$("#classes-tab").parent().hasClass("active")&&(e=".classes-container",$("#classes-tab").removeClass("clsLst").removeClass("clsPro").removeClass("clsDt").removeClass("clsBkd").removeClass("clsCon").removeClass("signInFrm").addClass("skipForm"),$("#class_progress-icon").removeClass("clsLst").removeClass("clsPro").removeClass("clsDt").removeClass("clsCon").removeClass("signInFrm").addClass("skipForm")),setTimeout(function(){$(" "+e+" #cust-IName").focus()},100),$(" "+e+" #sc_act").show(),$(" "+e+" #sc_act .customer-login-form").show(),isWixApp&&wixStepTabCustomerForm($(" "+e+" #sc_act .customer-login-form").height()+$("#company_name").height()),$(" "+e+"  #cust-FirstName,#cust-LastName,#cust-LoginId").hide(),$(" "+e+" .edit").hide(),$(" .classes-container #sc_act .customer-login-form .continue").removeClass("socialLogin").addClass("normalLogin"),$(" .service-container #sc_act .customer-login-form .continue").removeClass("socialLogin").addClass("normalLogin"),$(".service-container .intl-tel-input .selected-dial-code").attr("id","cust-countryCode"),$(".classes-container .intl-tel-input .selected-dial-code").attr("id","class_cust-countryCode"),$(" "+e+" #sc_act .customer-login-form .customerlist-name-holder > .input-profile-fields").show(),contactFields&&contactFields.indexOf("email")!=-1?$(" "+e+" #sc_act .customer-login-form #cust-IEmailId").parent().parent("li").remove():".classes-container"==e?$(" "+e+" #sc_act .customer-login-form #class_cust-IEmailId").parent().parent().show():$(" "+e+" #sc_act .customer-login-form #cust-IEmailId").parent().parent().show(),requiredFields.indexOf("email")!=-1&&(!$(" "+e+" #sc_act .customer-login-form .continue").hasClass("normalLogin")||$(" .service-container #sc_act .customer-login-form #cust-IEmailId").hasClass("starappended")&&$(" .classes-container #sc_act .customer-login-form #class_cust-IEmailId").hasClass("starappended")||($(".service-container #sc_act .customer-login-form #cust-IEmailId, .classes-container #sc_act .customer-login-form #class_cust-IEmailId").addClass("starappended"),
$(".service-container #sc_act .customer-login-form #cust-IEmailId, .classes-container #sc_act .customer-login-form #class_cust-IEmailId").parent().parent().find("label").append('<span style="color: red;font-weight: bold;margin-left:2px">*</span>'),$(".service-container #cust-IEmailId").attr("placeholder",$(" .service-container  #cust-IEmailId").attr("placeholder")+" *"),$(".classes-container #class_cust-IEmailId").attr("placeholder",$(" .classes-container #class_cust-IEmailId").attr("placeholder")+" *"))),$(" "+e+"  #sc_act .customer-login-form .continue").hasClass("normalLogin")&&($(" "+e+" #sc_act .customer-login-form").show(),$(" "+e+" #sc_act .customerImg").hide(),$(" "+e+" #sc_act .customer-details-list").css({"margin-top":"0px"})),$(".col1 > .nav > .gt, .side-menu-col1 > .nav > .gt").hasClass("active")?$("#login").addClass("sSkipLogin"):$("#login").addClass("cSkipLogin"),$(".signIn").removeClass("active"),$(".gt_act").removeClass("signIn_tab"),$(".gt_act").removeClass("timeslot_tab"),$(".col1 > .nav > .gt, .side-menu-col1 > .nav > .gt").hasClass("active")?classes.length&&$("#classes-tab").parent().hasClass("active")?($(".gt_cls .gt_act").addClass("eCusDetails_tab"),$(".gt .gt_act").addClass("signInCont")):$(".gt .gt_act").addClass("eCusDetails_tab"):($(".gt_cls .gt_act").addClass("eCusDetails_tab"),$(".gt .gt_act").addClass("signInCont")),$(".signIn").hasClass("active")||($(".info").removeClass("pointer_events"),$(".info > span").addClass("active"),$("#classes-tab").parent().hasClass("active")&&($(".class_info").removeClass("pointer_events"),$(".class_info > span").addClass("active"))),_bookingPolicy&&$("#policy_link").show(),0==classes.length&&$(".classes-container #sc_act").hide()}animateProgressBar(),animateProgressBar("class")},renderStaff=function(){$("#gt_act,#abts_act,#services_act,#classes_act,#photos_act,#review_act").hide(),$(".gt, .gt_cls, .abts, .srvs, .cls, .pto, .rvw").removeClass("active"),$(".sm").addClass("active"),$("#staff_act").show(),$("#policy_link,#notes_wrapper").hide(),$(".map_addr_businesshours").show(),0===resourceMap.length&&getResourcesJDOMap("isLoadStaff");var e="Service"!=customisedServiceLabel?customisedServiceLabel+""+providerLabel:"en"!=language?lang.services_provided:"Services Provided",s="Provider"!=customisedProviderLabel?customisedProviderLabel:"en"!=language?lang.provider:"Provider",t=new Array,a="",i='<h2 class="service_title">'+s+"</h2><ul>";if(a=resourceMap,_.isEmpty(serviceCategoryList))for(indexResource in a)t.push(a[indexResource].key);else for(indexServiceListMap in serviceCategoryList)t.push(serviceCategoryList[indexServiceListMap].ResourceKey);var o=new Array;try{if(String(customerInfo.resourcesInOrder)&&"null"!=String(customerInfo.resourcesInOrder))o=String(customerInfo.resourcesInOrder).split(",");else for(indexResource in a)o.push(a[indexResource].key)}catch(n){for(indexResource in a)o.push(a[indexResource].key)}for(var r=0;r<o.length;r++)for(indexResources in a)String(t).indexOf(indexResources)!=-1&&a[indexResources].key===o[r]&&(null!=staffResourceInfo?resourceMap[indexResources].key==staffResourceInfo.key&&(i+=buildResTab(indexResources,e,a)):i+=buildResTab(indexResources,e,a));$("#staff_act").html(i+"</ul>")},buildResTab=function(e,s,t){var a="",i="",o=peopleServicesMap,n=resourceMap[e].comment&&"object"==typeof resourceMap[e].comment&&resourceMap[e].comment.value?resourceMap[e].comment:"";if(n=void 0!=n.value&&""!=n.value?n.value.trim().split("\n").join("<br>"):"",a+='<li onclick="return false;"id="'+resourceMap[e].key+'")><div class="staff_desc_connector"></div><div class="bg_holder"><div class="hover-arrow"></div>',resourceMap[e].CompanyLogoPath&&""!=resourceMap[e].CompanyLogoPath&&"null"!=resourceMap[e].CompanyLogoPath&&null!=resourceMap[e].CompanyLogoPath){var r=resourceMap[e].CompanyLogoPath.contains("http:")?resourceMap[e].CompanyLogoPath.replace("http:","https:"):resourceMap[e].CompanyLogoPath;a+='<img src="'+r+'"  width="40" height="40"  />'}else a+='<img src="/bookingpage/images/bookappt_v3/provider_img2.png" width="40" height="40" class="p_img">';var l=resourceMap[e].LastName&&"undefined"!=resourceMap[e].LastName?resourceMap[e].FirstName+" "+resourceMap[e].LastName:resourceMap[e].FirstName;if(a+='<div class="staff_desc"><h3>'+l+"</h3>",void 0!=n&&(a+="<p>"+n+"</p>"),a+='</div><div class="clear"></div></div><div class="list_dtl fixedDet staff_det_popup">',resourceMap[e].CompanyLogoPath&&""!=resourceMap[e].CompanyLogoPath&&"null"!=resourceMap[e].CompanyLogoPath&&null!=resourceMap[e].CompanyLogoPath){var r=resourceMap[e].CompanyLogoPath.contains("http:")?resourceMap[e].CompanyLogoPath.replace("http:","https:"):resourceMap[e].CompanyLogoPath;a+='<img src="'+r+'" width="156" height="158"/>'}else a+='<img src="/bookingpage/images/bookappt_v3/provider_img2.png"  width="156" height="158" class="p_img">';a+="<h2>"+l+'</h2><div class="sidebar_widget weekly_schedule"><h3>'+lang.weekly_schedule+" ("+shortTimeZone+')</h3><ul class="bh sm">',a+=buildResWrkHrs(o,e,t),a+="</ul></div>";for(indexService in serviceCategoryList)String(serviceCategoryList[indexService].ResourceKey).indexOf(String(resourceMap[e].key))!=-1&&"true"!=serviceCategoryList[indexService].isPrivateService&&(i+=String(serviceCategoryList[indexService].ServiceName)+"<br />");""!=i&&null==staffResourceInfo&&(a+='<div class="sidebar_widget services_provided"><h3>'+_customizedSerName+"</h3><p>"+i+"</p></div>");var c="",d=[];if(_fClsResMap)for(var m in _fClsResMap)_fClsResMap[m].indexOf(e)!=-1&&d.indexOf(m)==-1&&d.push(m);if(0!=d.length)for(var p=0;p<d.length;p++)for(var u in classes)d[p]==classes[u].key&&(c+=String(classes[u].title)+"<br />");return""!=c&&null==staffResourceInfo&&(a+='<div class="sidebar_widget services_provided"><h3>'+_customizedClassName+"</h3><p>"+c+"</p></div>"),a+="</li>"},renderSerAndCatTab=function(){if($("#gt_act,#abts_act,#staff_act,#classes_act,#photos_act,#review_act").hide(),$(".gt, .gt_cls, .abts, .sm, .cls, .pto, .rvw").removeClass("active"),$(".srvs").addClass("active"),$("#services_act").show(),$(".map_addr_businesshours").show(),$("#policy_link,#notes_wrapper").hide(),$(".bookingpage_loader").show(),$(".service-container .step_tab .bpAppointmentConfirmed").hide(),null!=staffResourceInfo&&"Active"!=staffResourceInfo.Status)return null==$(".srvices_list").html()&&$("#services_act").append('<h2 class="service_title srvices_list">'+lang.no_services_available+"</h2>"),void $(".bookingpage_loader").hide();var e="Provider"!=customisedProviderLabel?customisedProviderLabel+" "+lang.assigned:"en"!=language?lang.staff_assigned:"Staff Assigned",s="Service"!=customisedServiceLabel?customisedServiceLabel:"en"!=language?lang.services:"Services",t='<h2 class="service_title srvices_list" style="display:none">'+lang.all+" "+s+'</h2><ul id="servicelistsofall">',a=new Array,i=new Array;for(d in categoryList)if("All Services"==categoryList[d].categoryName)for(var o=categoryList[d].serviceIdList,n=0;n<o.length;n++)a.push(o[n]);for(index in serviceCategoryList)for(j in categoryList)"All Services"!=categoryList[j].categoryName&&categoryList[j].serviceIdList.indexOf(serviceCategoryList[index].key)!=-1&&a.remove(serviceCategoryList[index].key);for(var r=0;r<a.length;r++)serviceCategoryList[a[r].toString()]&&"true"!=serviceCategoryList[a[r].toString()].isPrivateService&&String(serviceCategoryList[a[r].toString()].ResourceKey)&&""!=String(serviceCategoryList[a[r].toString()].ResourceKey)&&(null!=staffResourceInfo?"true"==String(serviceCategoryList[a[r].toString()].ResourceKey.contains(staffResourceInfo.key))&&(t+=buildAllSerTab(r,a,e)):t+=buildAllSerTab(r,a,e));for(var l in categoryList)if("All Services"!=categoryList[l].categoryName){var c=!0;i=categoryList[l].serviceIdList;for(var d=0;d<i.length;d++)void 0!=serviceCategoryList[i[d].toString()]&&"true"!=serviceCategoryList[i[d].toString()].isPrivateService&&String(serviceCategoryList[i[d].toString()].ResourceKey)&&""!=String(serviceCategoryList[i[d].toString()].ResourceKey)&&(null!=staffResourceInfo?"true"==String(serviceCategoryList[i[d].toString()].ResourceKey.contains(staffResourceInfo.key))&&(c===!0&&(t+='</ul></ul>&nbsp;<h2 class="service_title srvicescategory_list">'+categoryList[l].categoryName+'</h2><ul id="categryservices_list">',c=!1),t+=buildCatSerTab(i[d],e)):(c===!0&&(t+='</ul></ul>&nbsp;<h2 class="service_title srvicescategory_list">'+categoryList[l].categoryName+'</h2><ul id="categryservices_list">',c=!1),t+=buildCatSerTab(i[d],e)))}t+="</ul>",$("#services_act").html(t),selectServiceTabList(),moreLessEvent(),$("#services_act #servicelistsofall").closest("ul").children("li").length>0?$("#services_act .srvices_list").show():$("#services_act .srvices_list").hide(),$("#categryservices_list").closest("ul").children("li").length>0?$("#services_act .srvicescategory_list").show():$("#services_act .srvicescategory_list").hide(),0==$("#services_act #servicelistsofall").closest("ul").children("li").length&&0==$("#categryservices_list").closest("ul").children("li").length&&($("#services_act .srvices_list").show(),$("#services_act .srvices_list").html("No service is assigned to display")),showClsTabsOnSerTabClicked(),$(".bookingpage_loader").hide()},buildAllSerTab=function(e,s,t){var a="",i=serviceCategoryList[s[e].toString()].description?serviceCategoryList[s[e].toString()].description:{};if(i=htmlDecode(1!=$.isEmptyObject(i)&&""!=i.value?i.value.trim():""),i=i?i.split("\n").join("<br/>"):"",a+='<li class="" id="'+serviceCategoryList[s[e].toString()].key+'"><div class="staff_desc_connector"></div><div class="bg_holder"><div class="hover-arrow"></div>',window.connectService.indexOf(serviceCategoryList[s[e].toString()].key)!=-1&&(a+='<div class="teleport-service-icon" style="width: 40px;height: 40px;position: absolute;"><object type="image/svg+xml" data="/webapp/images/teleport_service.svg" style="float: right;margin-top: 25px;"><img src="/webapp/images/teleport_service.svg" style="float: right;margin-top: 25px;"></object></div>'),serviceCategoryList[s[e].toString()].imageURL&&"null"!=serviceCategoryList[s[e].toString()].imageURL){var o=serviceCategoryList[s[e].toString()].imageURL.contains("http:")?serviceCategoryList[s[e].toString()].imageURL.replace("http:","https:"):serviceCategoryList[s[e].toString()].imageURL;a+='<img src="'+o+'=s100"  width="40" height="40"  />'}else a+='<img src="/bookingpage/images/service-icon-big.png" width="40" height="40" class="p_img">';if(a+='<div class="staff_desc"><div><b class="serviceName">'+String(serviceCategoryList[s[e].toString()].ServiceName)+'</b><p class="servicePrice">',customerInfo.showLabel&&String(customerInfo.showLabel).indexOf("servicename")!=-1)if(0==serviceCategoryList[s[e].toString()].bufferDuration)a+='<span class="service-duration">'+serviceCategoryList[s[e].toString()].Duration+" "+lang.mins;else{var n=serviceCategoryList[s[e].toString()].Duration-serviceCategoryList[s[e].toString()].bufferDuration;a+='<span class="service-duration">'+n+" "+lang.mins}if(a+=customerInfo.showLabel&&String(customerInfo.showLabel).indexOf("price")!=-1?"</span><span>"+sign+(isFloat(serviceCategoryList[s[e].toString()].Cost)?parseFloat(serviceCategoryList[s[e].toString()].Cost).toFixed(2):serviceCategoryList[s[e].toString()].Cost)+'</span></p></div><div class="clear"></div>':customerInfo.showLabel&&String(customerInfo.showLabel).indexOf("servicename")!=-1?'</span></p></div><div class="clear"></div>':'</p></div><div class="clear"></div>',i){var r=i.length;if(console.log(r),r>150){var l=detectTag(i,/<br\/>/g),c=l[0],d=l[1];a+="<p>"+c.trim()+'<span class="moredesc" style="float: none !important;">...&nbsp;</span><span class="morecontent"><span>'+d+'</span>&nbsp;<a class="morelink">'+moretext+"</a></span></p>"}else a+="<p>"+i+"</p>"}if(a+='</div><div class="clear"></div></div><div class="list_dtl staff_det_popup" style="height: 231px;">',serviceCategoryList[s[e].toString()].imageURL&&"null"!=serviceCategoryList[s[e].toString()].imageURL){var o=serviceCategoryList[s[e].toString()].imageURL.contains("http:")?serviceCategoryList[s[e].toString()].imageURL.replace("http:","https:"):serviceCategoryList[s[e].toString()].imageURL;a+='<img src="'+o+'=s200"  width="156" height="158"  />'}else a+='<img src="/bookingpage/images/service-icon-big.png" width="156" height="156" class="p_img">';if(a+="<h2>"+String(serviceCategoryList[s[e].toString()].ServiceName)+"</h2>",customerInfo.showLabel&&String(customerInfo.showLabel).indexOf("servicename")!=-1)if(0==serviceCategoryList[s[e].toString()].bufferDuration)a+='<p class="service-duration">'+serviceCategoryList[s[e].toString()].Duration+" "+lang.mins;else{var n=serviceCategoryList[s[e].toString()].Duration-serviceCategoryList[s[e].toString()].bufferDuration;a+='<p class="service-duration">'+n+lang.mins}customerInfo.showLabel&&String(customerInfo.showLabel).indexOf("price")!=-1&&(a+="<p>"+sign+(isFloat(serviceCategoryList[s[e].toString()].Cost)?parseFloat(serviceCategoryList[s[e].toString()].Cost).toFixed(2):serviceCategoryList[s[e].toString()].Cost+"</p>"));var m="";for(indexResources in resourceMap)if(String(_isSkipStaff).indexOf("true")==-1&&String(serviceCategoryList[s[e].toString()].ResourceKey).indexOf(String(resourceMap[indexResources].key))!=-1){var p=resourceMap[indexResources].LastName&&"undefined"!=resourceMap[indexResources].LastName?String(resourceMap[indexResources].FirstName)+" "+String(resourceMap[indexResources].LastName):String(resourceMap[indexResources].FirstName);m+=p+"<br />"}return""!=m&&null==staffResourceInfo&&(a+='<div class="sidebar_widget services_provided"><h3>'+t+"</h3><p>"+m+"</p></div>"),a+="</li>"},buildCatSerTab=function(e,s){var t="",a=serviceCategoryList[e.toString()].description?serviceCategoryList[e.toString()].description:{};if(a=htmlDecode(1!=$.isEmptyObject(a)&&""!=a.value?a.value.trim():""),a=a?a.split("\n").join("<br/>"):"",t+='<li class="" id="'+serviceCategoryList[e.toString()].key+'" ><div class="staff_desc_connector"></div><div class="bg_holder"><div class="hover-arrow"></div>',serviceCategoryList[e.toString()].imageURL&&"null"!=serviceCategoryList[e.toString()].imageURL){var i=serviceCategoryList[e.toString()].imageURL.contains("http:")?serviceCategoryList[e.toString()].imageURL.replace("http:","https:"):serviceCategoryList[e.toString()].imageURL;t+='<img src="'+i+'=s100"  width="40" height="40"  />'}else t+='<img src="/bookingpage/images/service-icon-big.png" width="40" height="40" class="p_img">';if(t+='<div class="staff_desc"><div><b class="serviceName">'+String(serviceCategoryList[e.toString()].ServiceName)+'</b><p class="servicePrice">',customerInfo.showLabel&&String(customerInfo.showLabel).indexOf("servicename")!=-1)if(0==serviceCategoryList[e.toString()].bufferDuration)t+='<p class="servicePrice" style="min-width: 150px;"><span class="service-duration">'+serviceCategoryList[e.toString()].Duration+" "+lang.mins;else{var o=serviceCategoryList[e.toString()].Duration-serviceCategoryList[e.toString()].bufferDuration;t+='<p class="servicePrice" style="min-width: 150px;"><span style ="float:left;width:70px;" class="service-duration">'+o+" "+lang.mins}if(t+=customerInfo.showLabel&&String(customerInfo.showLabel).indexOf("price")!=-1?"</span><span>"+sign+(isFloat(serviceCategoryList[e.toString()].Cost)?parseFloat(serviceCategoryList[e.toString()].Cost).toFixed(2):serviceCategoryList[e.toString()].Cost)+'</span></p></div><div class="clear"></div>':customerInfo.showLabel&&String(customerInfo.showLabel).indexOf("servicename")!=-1?'</span></p></div><div class="clear"></div>':'</p></div><div class="clear"></div>',a){var n=a.length;if(n>150){var r=a.substring(0,150),l=a.substring(150,a.length);l="/>"==l.substr(0,2)?l.replace("/>",""):"b/>"==l.substr(0,3)?l.replace("b/>",""):l,t+="<p>"+r.trim()+'<span class="moredesc" style="float:none !important;">...&nbsp;</span><span class="morecontent"><span>'+l+'</span>&nbsp;<a class="morelink">'+moretext+"</a></span></p>"}else t+="<p>"+a+"</p>"}if(t+='</div><div class="clear"></div></div><div class="list_dtl staff_det_popup" style="height: 231px;">',serviceCategoryList[e.toString()].imageURL&&""!=serviceCategoryList[e.toString()].imageURL&&"null"!=serviceCategoryList[e.toString()].imageURL&&null!=serviceCategoryList[e.toString()].imageURL){var i=serviceCategoryList[e.toString()].imageURL.contains("http:")?serviceCategoryList[e.toString()].imageURL.replace("http:","https:"):serviceCategoryList[e.toString()].imageURL;t+='<img src="'+i+'=s200"  width="156" height="158"  />'}else t+='<img src="/bookingpage/images/service-icon-big.png" width="156" height="158" class="p_img">';if(t+="<h2>"+String(serviceCategoryList[e.toString()].ServiceName)+"</h2>",customerInfo.showLabel&&String(customerInfo.showLabel).indexOf("servicename")!=-1)if(0==serviceCategoryList[e.toString()].bufferDuration)t+='<p class="service-duration">'+serviceCategoryList[e.toString()].Duration+" "+lang.minutes;else{var o=serviceCategoryList[e.toString()].Duration-serviceCategoryList[e.toString()].bufferDuration;t+='<p class="service-duration">'+o+" mins"}customerInfo.showLabel&&String(customerInfo.showLabel).indexOf("price")!=-1&&(t+="<p>"+sign+(isFloat(serviceCategoryList[e.toString()].Cost)?parseFloat(serviceCategoryList[e.toString()].Cost).toFixed(2):serviceCategoryList[e.toString()].Cost));var c="";for(indexResources in resourceMap)if(String(_isSkipStaff).indexOf("true")==-1&&String(serviceCategoryList[e.toString()].ResourceKey).indexOf(String(resourceMap[indexResources].key))!=-1){var d=resourceMap[indexResources].LastName&&"undefined"!=resourceMap[indexResources].LastName?String(resourceMap[indexResources].FirstName)+" "+String(resourceMap[indexResources].LastName):String(resourceMap[indexResources].FirstName);c+=d+"<br />"}return""!=c&&null==staffResourceInfo&&(t+='<div class="sidebar_widget services_provided"><h3>'+s+"</h3><p>"+c+"</p></div>"),t+="</li>"},rClsAndCatTab=function(){var e="",s="";if($("#gt_act,#abts_act,#staff_act,#services_act,#photos_act,#review_act").hide(),$(".gt, .gt_cls, .abts, .sm, .srvs, .pto, .rvw").removeClass("active"),$(".cls").addClass("active"),$(".reviewPopup").hide(),$(".bookingpage_loader").show(),_disabledTabs.indexOf("classes")==-1){if(_allClasses&&0!=_allClasses.length){e+='<h2 class="service_title class_list allCls" style="display:none;">'+lang.all+" "+_customizedClassName+"</h2> <ul id = allClassesList>";for(var t=_allClasses.length,a=0;a<t;a++)for(var i=classes.length,o=0;o<i;o++)if(classes[o].key==_allClasses[a]&&"true"!=classes[o].isPrivateClass){var n=classes[o].imageURL?classes[o].imageURL.contains("http")?classes[o].imageURL.replace("http:","https:"):classes[o].imageURL:"";if(e+="<li id="+classes[o].key+'><div class="staff_desc_connector"></div><div class="bg_holder"><div class="hover-arrow"></div>',window.connectClass.indexOf(classes[o].key)!=-1&&(e+='<div class="teleport-service-icon" style="width: 40px;height: 40px;position: absolute;"><object type="image/svg+xml" data="/webapp/images/teleport_service.svg" style="float: right;margin-top: 25px;"><img src="/webapp/images/teleport_service.svg" style="float: right;margin-top: 25px;"></object></div>'),e+=n?"<img src="+n+' width="40" height="40" class="p_img">':'<img src="/bookingpage/images/service-icon-big.png" width="40" height="40" class="p_img">',e+='<div class="staff_desc"><div><b class="class-name">'+classes[o].title+'</b><p class="servicePrice" style="min-width: 150px;">',e+=customerInfo.showLabel&&customerInfo.showLabel.toString().indexOf("servicename")!=-1&&classes[o].duration?'<span class="class-duration">'+classes[o].duration+" "+lang.mins+"</span>":"",e+=customerInfo.showLabel&&customerInfo.showLabel.toString().indexOf("price")!=-1?"<span>"+sign+(isFloat(classes[o].cost)?parseFloat(classes[o].cost).toFixed(2):classes[o].cost)+'</span></p></div><div class="clear"></div>':'</p></div><div class="clear"></div>',classes[o].description.value){var r=htmlDecode(classes[o].description.value.trim());r=r.split("\n").join("<br>").toString();var l=r.length;if(l>150){var c=r.substring(0,150),d=r.substring(150,r.length);d="/>"==d.substr(0,2)?d.replace("/>",""):"b/>"==d.substr(0,3)?d.replace("b/>",""):d,e+="<p>"+c.trim()+'<span class="moredesc" style="float: none !important;">...&nbsp;</span><span class="morecontent"><span>'+d+'</span>&nbsp;<a class="morelink">'+moretext+"</a></span></p>"}else e+="<p>"+r+"</p>"}if(e+='</div><div class="clear"></div></div><div class="list_dtl staff_det_popup" style="height: 231px;">',n&&""!=n&&"null"!=n&&null!=n){var m=n.contains("http:")?n.replace("http:","https:"):n;e+="<img src="+m+' width="156" height="156" class="p_img">'}else e+='<img src="/bookingpage/images/service-icon-big.png" width="156" height="156" class="p_img">';e+="<h2>"+classes[o].title+"</h2>",e+=customerInfo.showLabel&&customerInfo.showLabel.toString().indexOf("servicename")!=-1&&classes[o].duration?"<p>"+classes[o].duration+" "+lang.mins+"</p>":"",e+=customerInfo.showLabel&&customerInfo.showLabel.toString().indexOf("price")!=-1?"<p>"+sign+(isFloat(classes[o].cost)?parseFloat(classes[o].cost).toFixed(2):classes[o].cost)+"</p>":'<div class="clear"></div>';var p="";if(_fClsResMap)for(var u in _fClsResMap)if(classes[o].key==u){_fClsResMap[u];for(var h in resourceMap)if(_fClsResMap[u].indexOf(resourceMap[h].key)!=-1&&_isSkipStaff.toString().indexOf("true")==-1){var v=resourceMap[h].LastName&&"undefined"!=resourceMap[h].LastName?resourceMap[h].FirstName.toString()+" "+resourceMap[h].LastName.toString():resourceMap[h].FirstName.toString();p+=v+"<br />"}}""!=p&&null==staffResourceInfo&&(e+='<div class="sidebar_widget services_provided"><h3>'+_customizedProName+"</h3><p>"+p+"</p></div>"),e+="</li>"}e+="</ul>"}else if(null==classes||0==classes.length)return void showNoClsDiv();if(classesCategoryList&&_classsCategoryOrder)for(var g=0;g<_classsCategoryOrder.length;g++){for(var o=0;o<classesCategoryList.length;o++){var f=!0;if(_classsCategoryOrder[g]==classesCategoryList[o].key)for(var y=classesCategoryList[o].classKeys.length,h=0;h<y;h++)for(var a=0;a<classes.length;a++)if(classesCategoryList[o].classKeys[h]==classes[a].key){var n=classes[a].imageURL?classes[a].imageURL.contains("http")?classes[a].imageURL.replace("http:","https:"):classes[a].imageURL:"";if(f===!0&&(s+='<h2 class="service_title class_list" style=" margin-top:10px;" id='+classesCategoryList[o].categoryName+">"+classesCategoryList[o].categoryName+"</h2> <ul id = clsCatList>"),s+="<li id="+classes[a].key+'><div class="staff_desc_connector"></div><div class="bg_holder"><div class="hover-arrow"></div>',window.connectClass.indexOf(classes[a].key)!=-1&&(s+='<div class="teleport-service-icon" style="width: 40px;height: 40px;position: absolute;"><object type="image/svg+xml" data="/webapp/images/teleport_service.svg" style="float: right;margin-top: 25px;"><img src="/webapp/images/teleport_service.svg" style="float: right;margin-top: 25px;"></object></div>'),s+=n?"<img src="+n+' width="40" height="40" class="p_img">':'<img src="/bookingpage/images/service-icon-big.png" width="40" height="40" class="p_img">',s+='<div class="staff_desc"><div><b class="class-name">'+classes[a].title+'</b><p class="servicePrice" style="min-width: 150px;">',s+=customerInfo.showLabel&&customerInfo.showLabel.toString().indexOf("servicename")!=-1&&classes[a].duration?'<span class="class-duration" style="margin-right:5px;">'+classes[a].duration+" "+lang.mins+"</span>":"",s+=customerInfo.showLabel&&customerInfo.showLabel.toString().indexOf("price")!=-1?"<span>"+sign+(isFloat(classes[a].cost)?parseFloat(classes[a].cost).toFixed(2):classes[a].cost)+'</span></p></div><div class="clear"></div>':'</p></div><div class="clear"></div>',classes[a].description.value){var r=htmlDecode(classes[a].description.value.trim());r=r.split("\n").join("<br/>").toString();var l=r.length;if(l>150){var c=r.substring(0,150),d=r.substring(150,r.length);d="/>"==d.substr(0,2)?d.replace("/>",""):"b/>"==d.substr(0,3)?d.replace("b/>",""):d,s+="<p>"+c.trim()+'<span class="moredesc" style="float: none !important;">...&nbsp;</span><span class="morecontent"><span>'+d+'</span>&nbsp;<a class="morelink">'+moretext+"</a></span></p>"}else s+="<p>"+r+"</p>"}if(s+='</div><div class="clear"></div></div><div class="list_dtl staff_det_popup" style="height: 231px;">',n&&""!=n&&"null"!=n&&null!=n){var m=n.contains("http:")?n.replace("http:","https:"):n;s+="<img src="+m+' width="156" height="156" class="p_img">'}else s+='<img src="/bookingpage/images/service-icon-big.png" width="156" height="156" class="p_img">';s+="<h2>"+classes[a].title+"</h2>",s+=customerInfo.showLabel&&customerInfo.showLabel.toString().indexOf("servicename")!=-1&&classes[a].duration?"<p>"+classes[a].duration+" "+lang.mins+"</p>":"",s+=customerInfo.showLabel&&customerInfo.showLabel.toString().indexOf("price")!=-1?"<p>"+sign+(isFloat(classes[a].cost)?parseFloat(classes[a].cost).toFixed(2):classes[a].cost)+"</p>":"";var p="";if(_fClsResMap)for(var u in _fClsResMap)if(classes[a].key==u){_fClsResMap[u];for(indexResources in resourceMap)if(_fClsResMap[u].indexOf(resourceMap[indexResources].key)!=-1&&_isSkipStaff.toString().indexOf("true")==-1){var v=resourceMap[indexResources].LastName&&"undefined"!=resourceMap[indexResources].LastName?resourceMap[indexResources].FirstName.toString()+" "+resourceMap[indexResources].LastName.toString():resourceMap[indexResources].FirstName.toString();p+=v+"<br />"}}""!=p&&null==staffResourceInfo&&(s+='<div class="sidebar_widget services_provided"><h3>'+_customizedProName+"</h3><p>"+p+"</p></div>"),s+="</li>",f=!1}}s+="</ul>"}$("#classes_act").html(e+s),$("#classes_act").show(),$("#classes_act").hasClass("noServices")&&$("#classes_act").removeClass("noServices"),selectClassesTabList(),moreLessEvent(),0!=$("#allClassesList > li").length&&$(".allCls").show(),$("#clsCatList").closest("ul").children("li").length>0?$("#classes_act .clsCatList").show():$("#classes_act .clsCatList").hide()}showSerTabsOnClsTabClicked(),$(".bookingpage_loader").hide()},renderClasses=function(){var e="",s="";$("#class-back").addClass("hide");var t=window.location.pathname.includes("/class")?"classesTab":"bookClassTab";if(classes&&0!=classes.length){if(classesCategoryList){$(".classes-container").show(),$(".class_step_tab").show(),$("#chs_class_act").show(),$("#classes-tab").removeClass("clsBkd").addClass("clsLst");for(var a=classesCategoryList.length,i=0;i<a;i++){var o=classesCategoryList[i],n=o.categoryName;if(n.indexOf("All Class Bookings")!=-1){_allClasses=classesCategoryList[i].classKeys;break}}for(var r=0;r<a;r++){var l=classesCategoryList[r],c=l.categoryName,d=l.classKeys.length;if(c.indexOf("All Class Bookings")==-1)for(var m=0;m<d;m++){var p=l.classKeys[m];_allClasses.indexOf(p)!=-1&&_allClasses.remove(p)}}if(_disabledTabs.indexOf("bookClass")==-1){if(_allClasses&&0!=_allClasses.length){e+='<ul> <h3 class="allClasses" style="display:none;">'+lang.all+" "+_customizedClassName+'</h3> <ul class="last" id="classesList">';for(var m=0;m<_allClasses.length;m++)for(var i=0;i<classes.length;i++)if(classes[i].key==_allClasses[m]&&"true"!=classes[i].isPrivateClass){if(e+=classes[i].description.value?'<li style="line-height:37px;" id="'+classes[i].key+'" class="" ><div class="staff_desc_connector"></div><div class="bg_holder"><div class="hover-arrow"></div>':'<li style="line-height:37px;" id="'+classes[i].key+'" class=""><div class="bg_holder"><div class="arrow" style="display: none;"></div>',e+=window.connectClass.indexOf(classes[i].key)!=-1?'<b class="className">'+classes[i].title+' <img alt="" style="top: -2px;width: 14px;position: relative;" src="/bookingpage/images/teleport-icon.png"></b><p class="sessionPrice">':'<b class="className">'+classes[i].title+'</b><p class="sessionPrice">',e+=customerInfo.showLabel&&customerInfo.showLabel.toString().indexOf("servicename")!=-1&&0!=classes[i].duration?'<span class="class-duration">'+classes[i].duration+" "+lang.mins+"</span>":'<p class="sessionPrice">',customerInfo.showLabel&&customerInfo.showLabel.toString().indexOf("price")!=-1&&(e+='<span style="width:auto;">'+sign+(isFloat(classes[i].cost)?parseFloat(classes[i].cost).toFixed(2):classes[i].cost)+"</span>"),e+='</p></div><div class="clear"></div><div class="list_dtl staff_det_popup" style="height: 231px;">',classes[i].imageURL&&"null"!=classes[i].imageURL){var u=classes[i].imageURL.contains("http:")?classes[i].imageURL.replace("http:","https:"):classes[i].imageURL;e+='<img src="'+u+'=s200"  width="156" height="158"  />'}else e+='<img src="/bookingpage/images/service-icon-big.png" width="156" height="156" class="p_img" />';classes[i].description.value&&(e+='<h3 style="line-height:30px;" class="descServ">'+lang.description+'</h3><p class="clsDesc" style="width: 100%; left: 0%;">'+classes[i].description.value.split("\n").join("<br>")+"</p>"),e+="</div></li>"}e+="</ul>"}if(_classsCategoryOrder){for(var h=0;h<_classsCategoryOrder.length;h++)for(var v=0;v<a;v++)if(_classsCategoryOrder[h]==classesCategoryList[v].key){var g=!0;s=classesCategoryList[v].categoryName;for(var f=classesCategoryList[v].classKeys.length,i=0;i<f;i++)for(var y=0;y<classes.length;y++)if(classesCategoryList[v].classKeys[i]==classes[y].key&&"true"!=classes[y].isPrivateClass){if(g===!0&&(e+='<ul><h3 class="classCategories" id = "clsCat" >'+s+'</h3> <ul class="last" id="classCategoryList">'),e+=classes[y].description.value?'<li style="line-height:37px;" id="'+classes[y].key+'" class=""><div class="staff_desc_connector"></div><div class="bg_holder"><div class="hover-arrow"></div>':'<li style="line-height:37px;" id="'+classes[y].key+'" class=""><div class="bg_holder"><div class="arrow" style="display: none;"></div>',e+=window.connectClass.indexOf(classes[y].key)!=-1?'<b class="className">'+classes[y].title+' <img alt="" style="top: -2px;width: 14px;position: relative;" src="/bookingpage/images/teleport-icon.png"></b><p class="sessionPrice">':'<b class="className">'+classes[y].title+'</b><p class="sessionPrice">',customerInfo.showLabel&&customerInfo.showLabel.toString().indexOf("servicename")!=-1&&0!=classes[y].duration&&(e+='<span class="class-duration">'+classes[y].duration+" "+lang.mins+"</span>"),customerInfo.showLabel&&customerInfo.showLabel.toString().indexOf("price")!=-1&&(e+='<span style="width:auto;" >'+sign+(isFloat(classes[y].cost)?parseFloat(classes[y].cost).toFixed(2):classes[y].cost)+"</span>"),e+='</p></div><div class="clear"></div><div class="list_dtl staff_det_popup" style="height: 231px;">',classes[y].imageURL&&"null"!=classes[y].imageURL){var u=classes[y].imageURL.contains("http:")?classes[y].imageURL.replace("http:","https:"):classes[y].imageURL;e+='<img src="'+u+'=s200"  width="156" height="158"  />'}else e+='<img src="/bookingpage/images/service-icon-big.png" width="156" height="156" class="p_img">';if(classes[y].description.value){var C=htmlDecode(classes[y].description.value.trim());C=C.split("\n").join("<br>").toString(),e+='<h3 style="line-height:30px;" class="descServ">'+lang.description+'</h3><p class="clsDesc" style="width:100%; left:0%;">'+C+"</p>"}e+="</div></li>",$("classCategories").removeClass("hide"),g=!1}else $(".classCategories").hide()}e+="</ul></ul></ul>",$("#chs_class_act").html(e)}}}}else switchToSerOrClsTab("cls",t);0!=$("#classesList > li").length&&$(".allClasses").show(),arguments[0]&&($("#chs_class_act").hide(),$(".class_step_tab").hide(),switchToSerOrClsTab("cls",t),sClsTab())},showClsTimingsForRes=function(e,s){new Array;switch(s){case"nbp":_classBookingDetails.resourceKey=$(e).attr("id"),_classBookingDetails.classKey=$(e).attr("classkey"),currentDate=new Date($(e).attr("date"));break;case"sporss":case"reschedule":case"tzchange":_classBookingDetails.resourceKey=e.resourceKey,_classBookingDetails.classKey=e.classKey,currentDate=new Date(e.currentDate)}if(EventResources.currentDate=currentDate,$(".class").addClass("avoid-clicks"),$("#class_provider").hide(),$("#classes-tab").removeClass("clsLst").removeClass("clsPro").addClass("clsDt"),$("#sessionSheet").empty(),$(".class_date").removeClass("pointer_events"),
$(".classes-container .loading_icon_timings").show(),""==_classBookingDetails.resourceKey||null!=staffResourceInfo)$(".class_provider").next().hide();else{$("#class-back").removeClass("back-to-classes").addClass("back-to-classProvider"),$(".class_provider").addClass("avoid-clicks"),$("#class_progress-icon, .class_provider").show(),$("#class_progress-icon").addClass("clsPro").removeClass("clsLst");for(index in resourceMap)String(resourceMap[index].key).indexOf(String(_classBookingDetails.resourceKey))!=-1&&($(".class_provider > span.class_step-li").html(htmlDecode(String(resourceMap[index].FirstName)).substr(0,6)),$(".class_provider > span.class_step-li").attr("class","class_done class_step-li"),$(".class_provider > span.class_step-li").attr("title",htmlDecode(resourceMap[index].FirstName)+" "+htmlDecode(String(resourceMap[index].LastName))),resourceName=resourceMap[index].FirstName+" "+String(resourceMap[index].LastName))}if(_enabledCustLocalTimeZone&&"tzchange"!=s){$(".class_step_tab > h2").html("");var t=EventResources.classTimeZoneId&&_selectedClassTZFUllName?_selectedClassTZFUllName:timeZoneObj.localTimeZoneObj.timeZoneFullName;$(".chng-cls-tz-a > span").html(t),$(".chng-cls-tz").show(),_bookingPolicy&&$("#policy_link").hide()}else"tzchange"!=s&&($(".class_step_tab > h2").html(lang.choose_dateandtime+" ("+shortTimeZone+")"),$(".chng-cls-tz").hide());$("#classCalendars").children().length>0&&$("#classCalendars").children().remove(),tempBlockedDays=blockedOutDates&&0!=blockedOutDates.length?blockedOutDates:tempBlockedDays,blockedOutDates=[],tempRestDtsInRed=restrictedDatesInRed,restrictedDatesInRed=[],tempRestrDates=restricted_Dates,restricted_Dates=[],temprestrictAfterThisDate=""!=restrictAfterThisDate?restrictAfterThisDate:temprestrictAfterThisDate,restrictAfterThisDate="",tempAdvanceDays=0!=adavanceDays&&null!=adavanceDays?adavanceDays:0,adavanceDays=0,animateProgressBar("class");var a=monthsInOtherLang(_months[currentDate.getMonth()]),i=currentDate.getDate()+" "+a+"...";$("#class_appt_date > span.class_step-li").html(i),$("#class_appt_date > span.class_step-li").attr("class","active class_step-li"),$(".mobile-navbar").removeClass("active"),$("#class_appt_date > span.mobile-navbar").attr("class","active mobile-navbar"),$("#class_appt_date > span.class_step-li").attr("title",currentDate.getDate()+" "+a+" "+currentDate.getFullYear());var o=("0"+(currentDate.getMonth()+1)).slice(-2),n=currentDate.getFullYear()+""+o,r=function(e){if(e){var s={},t=[],a="";if(EventResources.isClsInMigration?(s=JSON.parse(e),t=s.availableDates,a=s.nextAvailableDate):(s=e,t=s.date,a=s.nextAvailableDate),t&&0!=t.length){$("#class_provider").hide(),$("#classDateCont").show(),unblockedDates=[];for(var i=0;i<t.length;i++)unblockedDates.push(t[i]+"");if(0==unblockedDates.length){if(a){a=convertIcalFormateToDateObject(a);var o=FormatDate(a,"%y%m");return void getAvailableDatesInMonth(o,r)}noSlots("noNxtAvl")}if(0!=unblockedDates.length){$(".classes-container .loading_icon_timings").hide(),clientClassDate=convertIcalFormateToDateObject(unblockedDates[0]);var n=clientClassDate.getFullYear()+"-"+clientClassDate.getDate()+"-"+(clientClassDate.getMonth()+1),l=clientClassDate.getDate()+"/"+(clientClassDate.getMonth()+1)+"/"+clientClassDate.getFullYear();EventResources.currentDate=unblockedDates[0],getAvlClsTimSlots(l);var c=(new Date,monthsInOtherLang(_months[clientClassDate.getMonth()])),d=clientClassDate.getDate()+" "+c;$("#class_appt_date > span.class_step-li").html(d),$("#class_appt_date > span").attr("title",clientClassDate.getDate()+" "+c+" "+clientClassDate.getFullYear()),restrictedDatesInRed=[],classDatePicker(n),$("#classCalendars").DatePickerSetDate(FormatDate(clientClassDate,"%y-%d-%m"),!0)}else noSlots("noAvl")}else{if(a){a=convertIcalFormateToDateObject(a);var o=FormatDate(a,"%y%m");return void getAvailableDatesInMonth(o,r)}noSlots("noAvl")}}else console.log(" No  Data "),noSlots("noDate")};getAvailableDatesInMonth(n,r)},noSlots=function(e){var s=monthsInOtherLang(_months[clientDate.getMonth()]),t=clientDate.getFullYear()+"-"+clientDate.getDate()+"-"+s;clientDate.getDate()+" "+_months[clientDate.getMonth()];$(".classes-container .loading_icon_timings").hide(),$("#class_appt_date > span.class_step-li").html("Date");var a=monthsInOtherLang(_months[clientDate.getMonth()]);$("#class_appt_date > span").attr("title",clientDate.getDate()+" "+a+" "+clientDate.getFullYear()),unblockedDates.push(FormatDate(clientDate,"%y%m%d")),"noNxtAvl"!=e&&"crossingRestrictedDates"!=e&&classDatePicker(t),$(".class, .class_provider").removeClass("avoid-clicks"),$(".date_time #sessionSheet").html(lang.no_slots),$("#sessionSheet").addClass("noSlots"),$("#classCalendars").show(),$("#sessionSheet").show()},getClassResources=function(e){if($("#class-back").addClass("back-to-classes").removeClass("hide"),$(".class").addClass("avoid-clicks"),$(".classes-container .loading_icon_timings").hasClass("done")||$(".classes-container  .loading_icon_timings").show(),void 0!==e)_classBookingDetails.classKey=$(e).attr("id"),_classBookingDetails.className=$(e).find("b").html(),classDuration=$(e).find(".class-duration").html(),classDuration=null!=classDuration?classDuration.replace(" mins ",""):"";else{var s=getClassKeyFromRequest(),t=EventResources.classesList.find(function(e){return e.key===s});_classBookingDetails.classKey=t.key,_classBookingDetails.className=t.title,classDuration=t.duration}var a="Provider"!=customisedProviderLabel?customisedProviderLabel:"en"!=language?lang.provider:"Provider";$(".class > span.class_step-li").attr("class","class_step-li class_done"),$(".classesProviders").empty(),$("#class_progress-icon,#class_provider").show(),$("#chs_service_act,#chs_class_act").hide(),$(".class > span.class_step-li").html(_classBookingDetails.className.substr(0,6)),$(".class > span.class_step-li").attr("class","class_step-li class_done"),animateProgressBar("class"),$(".class > span.class_step-li").attr("title",htmlDecode(_classBookingDetails.className));var i="Classes"!=customisedClassLabel?customisedClassLabel:"en"!=language?lang.Class:"CLASS";if($(".class > span.mobile-navbar").html('<i class="icon-sitemap"></i><label>'+i+"<label>"),"true"!=_isSkipStaff&&null==staffResourceInfo){var a="Provider"!=customisedProviderLabel?customisedProviderLabel:"en"!=language?lang.provider:"Provider";$(".class_step_tab > h2").html(""+choose_a_pro+" "+a),$(".class_provider").removeClass("pointer_events")}$("#sp_act").show(),$(".class_provider > span.class_step-li").attr("class","class_step-li active"),$(".class_provider > span.mobile-navbar").attr("class","mobile-navbar active"),$(".class_provider > span.mobile-navbar").html('<i class="icon-group"></i><label>'+a+"<label>"),$(".class_provider > span.class_step-li").html(a),$(".mobile-navbar").removeClass("active"),$(".class_provider > span.mobile-navbar").attr("class","mobile-navbar active"),$("#class_progress-icon").addClass("clsLst"),_disabledTabs.indexOf("bookClass")==-1&&$(".cls").removeClass("active"),$("#classes_act").hide(),$(".gt_cls").addClass("active"),$("#gt_act").show(),$("#sp_act").hide(),$(".service-container").hide(),$(".class_step_tab").show(),$(".classes-container").show(),$("#classes-tab").parent().addClass("active"),$("#services-tab").parent().removeClass("active"),$(".class_step_tab > ul").show(),$(".bookAnotherAppt").hide(),$(".callBackUrl").hide(),clsProviderNavBar(),reqClsRes(_classBookingDetails.classKey)},reqClsRes=function(e){EventResources.isClsInMigration?fetchResByClsKey(e):fetchClsInventoryResByClsKey(e)},fetchResByClsKey=function(e){var s={type:"GET",url:"/getAllFutureResourceList",data:"companyKey="+companyKey+"&classKey="+e,dataType:"html",async:!0,cache:!1};makeRequest(s).done(function(e){e&&buildResForCls(JSON.parse(e))}).fail(function(e){console.log(e)})},fetchClsInventoryResByClsKey=function(e){EventResources.clsStaffTimesByClass=[];var s={},t=[],a={},i=_.find(EventResources.clsStaffKeysList,function(s){return s[e]});a.staffList=i[e],_.each(a.staffList,function(s){var i=EventResources.staffInventoryCollection.findWhere({key:s}),o=_.find(i.get("times"),function(s){return s[e]}),n=_.keys(o[e]);n.sort();var r=createClsStaffTimesByClass(e,s,n,EventResources.classTimeZoneId);t.push(r),a[s]=moment(parseInt(n[0])).tz(EventResources.classTimeZoneId).format("YYYYMMDDHHMM")}),s[e]=t,EventResources.clsStaffTimesByClass.push(s),arguments[1]?callshowClsTimingsForRes(a):buildResForCls(a)},createClsStaffTimesByClass=function(e,s,t,a){var i=[],o={},n="";return _.each(t,function(e){var s={};n=moment(parseInt(e)).tz(EventResources.classTimeZoneId).format("YYYYMM");var t=_.find(i,function(e,s){return e[n]});if(t){var a=i.indexOf(t);s[n]=_.union(e,t[n]),i.splice(a,1,s)}else{var o=[];o.push(e),s[n]=o,i.push(s)}}),o[s]=i,o},buildResForCls=function(e){var s="",t=e.staffList,a=resourceMap,i="",o=peopleServicesMap,n=new Array;if(customerInfo.resourcesInOrder.toString()&&"null"!=customerInfo.resourcesInOrder.toString())n=customerInfo.resourcesInOrder.toString().split(",");else for(indexResources in a)n.push(a[indexResources].key);if($(".classes-container .loading_icon_timings").hide(),$("#class_progress-icon").removeClass("clsPro"),$("#class_progress-icon").hasClass("clsLst")||$("#class_progress-icon").addClass("clsLst"),_isSkipStaff.toString().indexOf("true")==-1&&null==staffResourceInfo&&"true"!=isReschedulePage){var r="Provider"!=customisedProviderLabel?customisedProviderLabel:"en"!=language?lang.provider:"Provider";$(".class_provider").removeClass("pointer_events"),$(".class_title").html(""+choose_a_pro+" "+r),$("#classes-tab").removeClass("clsLst").addClass("clsPro");for(var l=0;l<n.length;l++)if(t.indexOf(n[l])!=-1)for(var c in a){if(t.indexOf(a[c].key)!=-1&&a[c].key===n[l]){var d=e[a[c].key],i=convertIcalFormateToDateObject(d);if(s+='<li id="'+a[c].key+'" class="last" classkey="'+_classBookingDetails.classKey+'" date="'+i+'" ><div class="bg_holder"><div class="hover-arrow"></div>',resourceMap[c].CompanyLogoPath&&"null"!=resourceMap[c].CompanyLogoPath){var m=resourceMap[c].CompanyLogoPath.contains("http:")?resourceMap[c].CompanyLogoPath.replace("http:","https:"):resourceMap[c].CompanyLogoPath;s+='<img src="'+m+'=s75" width="40" height="40" />'}else s+='<img src="/bookingpage/images/bookappt_v3/provider_img2.png" width="40" height="40" class="p_img">';if(s+="<b>"+a[c].FirstName+" "+a[c].LastName+'</b></div><!--- bg_holder---><div class="list_dtl fixedDet staff_det_popup">',resourceMap[c].CompanyLogoPath&&"null"!=resourceMap[c].CompanyLogoPath){var m=resourceMap[c].CompanyLogoPath.contains("http:")?resourceMap[c].CompanyLogoPath.replace("http:",""):resourceMap[c].CompanyLogoPath;s+='<img src="'+m+'=s156" width="156" height="158"/>'}else s+='<img src="/bookingpage/images/bookappt_v3/provider_img2.png"  width="156" height="158" class="p_img">';s+="<h3>"+a[c].FirstName+" "+a[c].LastName+'</h3><div class="weekly_schedule sidebar_widget"><h3>'+lang.weekly_schedule+" ("+shortTimeZone+')</h3><ul class="bh sm">',s+=buildResWrkHrs(o,c,a),s+="</ul></div>";var p="",u=[];if(_fClsResMap){for(var h in _fClsResMap)_fClsResMap[h].indexOf(a[c].key)!=-1&&u.indexOf(h)==-1&&u.push(h);if(0!=u.length)for(var v=0;v<u.length;v++)for(var g in classes)u[v]==classes[g].key&&(p+=classes[g].title.toString()+"<br />");""!=p&&null==staffResourceInfo&&(s+='<div class="sidebar_widget services_provided"><h3>'+_customizedClassName+"</h3><p>"+p+"</p></div>")}s+="</div></li>"}$(".class").removeClass("avoid-clicks"),$("#class_provider > .classesProviders").html(s)}}else{var d=e[t[0]];i=convertIcalFormateToDateObject(d);var f={resourceKey:"",classKey:_classBookingDetails.classKey,currentDate:i};null!=staffResourceInfo?(f.resourceKey=staffResourceInfo.key,showClsTimingsForRes(f,"sporss")):"true"==isReschedulePage&&"class"==apptType?(f.resourceKey=rescheduleResourceInfo.key,showClsTimingsForRes(f,"reschedule")):showClsTimingsForRes(f,"sporss")}},callshowClsTimingsForRes=function(e){var s=_classBookingDetails.resourceKey?convertIcalFormateToDateObject(e[_classBookingDetails.resourceKey]):convertIcalFormateToDateObject(e[e.staffList[0]]),t={classKey:_classBookingDetails.classKey,currentDate:s,lTZ:EventResources.classTimeZoneId,resourceKey:_classBookingDetails.resourceKey?_classBookingDetails.resourceKey:""};showClsTimingsForRes(t,"tzchange")},getFurClsPerRes=function(e){var s="";reqClsObj={type:"GET",url:"/getAllFutureClasses",data:"companyKey="+companyKey+"&resourceKey="+e,dataType:"html",async:!0,cache:!1},makeRequest(reqClsObj).done(function(e){if(e){var t=JSON.parse(e),a=t.data;if(a){for(var i=0;i<a.length;i++)"true"!=a[i].isPrivateClass&&(s+=a[i].title+"<br />");return s}}}).fail(function(e){})},getAvailableDatesInMonth=function(e,s){EventResources.isClsInMigration?getAvailableDatesInMonthByCls(e,s):getAvailableDatesInMonthByClsInventory(e,s)},getAvailableDatesInMonthByCls=function(e,s){var t=""==_classBookingDetails.resourceKey?"companyKey="+companyKey+"&classKey="+_classBookingDetails.classKey+"&month="+e:"companyKey="+companyKey+"&classKey="+_classBookingDetails.classKey+"&staffKey="+_classBookingDetails.resourceKey+"&month="+e,a={type:"GET",url:"/getAvailableDatesInMonth",data:t,dataType:"html",async:!0,cache:!1};makeRequest(a).done(function(e){s(e)}).fail(function(e){console.log("Failed :: While fetching available dates per month")})},getAvailableDatesInMonthByClsInventory=function(e,s){var t=getInventoryDatesByMonth(_classBookingDetails.classKey,_classBookingDetails.resourceKey,e,s);s(t)},getInventoryDatesByMonth=function(e,s,t,a){var i={date:[],timings:[],staffKey:"",clsKey:""},o=_.find(EventResources.clsStaffTimesByClass,function(s){return s[e]});return _.isEmpty(o)?i:_.isEmpty(s)?getInventoryDatesBySkipTheStaff(e,t,o,i):getInventoryDatesByStaffKey(e,s,t,o,i)},getInventoryDatesBySkipTheStaff=function(e,s,t,a){if(!_.isEmpty(t)){var i=t[e],o=_.find(EventResources.clsStaffKeysList,function(s){return s[e]});_.isEmpty(o)||_.each(o[e],function(t){var o=_.find(i,function(e){return e[t]});if(!_.isEmpty(o)){var n=o[t],r=_.find(n,function(e){return e[s]});_.isEmpty(r)||(a.date=_.unique(_.union(a.date,generateAvailableDatesByMonth(r[s]))).sort(),a.timings=_.unique(_.union(a.timings,r[s])).sort(),a.staffKey="",a.clsKey=e)}})}return a},getInventoryDatesByStaffKey=function(e,s,t,a,i){if(!_.isEmpty(a)){var o=a[e],n=_.find(o,function(e){return e[s]});if(!_.isEmpty(n)){var r=n[s],l=_.find(r,function(e){return e[t]});_.isEmpty(l)||(i.date=generateAvailableDatesByMonth(l[t]),i.timings=l[t],i.staffKey=s,i.clsKey=e)}}return i},generateAvailableDatesByMonth=function(e){var s=[],t="";return _.each(e,function(e){t=moment(parseInt(e)).tz(EventResources.classTimeZoneId).format("YYYYMMDD"),s.push(t)}),s.sort()},getAvlClsTimSlots=function(e){EventResources.isClsInMigration?fetchAvlClsTimSlots(e):fetchTimSlotsClsInventory(e)},fetchAvlClsTimSlots=function(e){var s="companyKey="+companyKey+"&classKey="+_classBookingDetails.classKey+"&staffKey="+_classBookingDetails.resourceKey+"&selectedDate="+e;""==_classBookingDetails.resourceKey&&(s="companyKey="+companyKey+"&classKey="+_classBookingDetails.classKey+"&selectedDate="+e);var t={type:"GET",url:"/getAvailableClassTimeSlots",data:s,dataType:"html",async:!0,cache:!1};makeRequest(t).done(function(e){if(e){var s=JSON.parse(e);if(s&&0!=s.length){if("true"==isReschedulePage&&"class"==apptType)for(var t=0;t<s.length;t++){var a=s[t].split("_")[0];if(a==rescheduleSessionKey){var i=s[t];s.remove(i),0==s.length&&(showNoSessions(),$(".date_time #sessionSheet").html(lang.no_slots));break}}s.length>0&&renderSessions(s)}else showNoSessions()}}).fail(function(e){console.log(" Failed while getting the class time slots ")})},fetchTimSlotsClsInventory=function(e){var s=[];s=_.isEmpty(_classBookingDetails.resourceKey)?getClsTimeSlotsInventoryBySkip(_classBookingDetails.classKey,e):getClsTimeSlotsInventoryByStaff(_classBookingDetails.classKey,_classBookingDetails.resourceKey,e),renderClsSessionsForInventory(s,_classBookingDetails.classKey)},showNoSessions=function(){$("#classCalendars").show(),$(".classes-container .loading_icon_timings").hide(),$(".class, .class_provider").removeClass("avoid-clicks"),$(".date_time #sessionSheet").html(lang.no_slots),$("#sessionSheet").addClass("noSlots"),$("#sessionSheet").show(),applyToolTip()},classDatePicker=function(e){$("#classCalendars").DatePicker({flat:!0,date:e,format:"Y-d-m",calendars:1,starts:startDay,onMonthChange:function(e,s){var t=function(e){if(e){tempunblockedDates=unblockedDates,unblockedDates=[],temprestrictAfterThisDate=""!=restrictAfterThisDate?restrictAfterThisDate:temprestrictAfterThisDate,restrictAfterThisDate="";var t={},a=[],i="";if(EventResources.isClsInMigration?(t=JSON.parse(e),a=t.availableDates,i=t.nextAvailableDate):(t=e,a=t.date,i=t.nextAvailableDate),a&&0!=a.length)for(var o=0;o<a.length;o++)unblockedDates.push(a[o]+"");0==unblockedDates.length&&(unblockedDates=tempunblockedDates)}s()};getAvailableDatesInMonth(e,t)},onBeforeShow:function(){var e=FormatDate(convertIcalDateToDateObject(availableDatesJson[0]),"%y-%d-%m");$(this).DatePickerSetDate(e,!0)},onChange:function(e,s){clientClassDate=s,$("#sessionSheet").html('<img id="loading_icon_timings"  class="loading_icon_timings"  src="/setmore-loader.gif" style="display:show"></img>'),selectedDate=s.getMonth()+1+"/"+s.getDate()+"/"+s.getFullYear();var t=monthsInOtherLang(_months[s.getMonth()]),a=s.getDate()+" "+t;$("#class_appt_date > span.class_step-li").html(a),$("#class_appt_date > span").attr("title",s.getDate()+" "+t+" "+s.getFullYear());var i=s.getDate()+"/"+(s.getMonth()+1)+"/"+s.getFullYear();if(EventResources.currentDate=moment(s).format("YYYYMMDD"),getAvlClsTimSlots(i),isWixApp){var o=$("#sessionSheet").height();wixHeightGenerator(o)}}})},getClsTimeSlotsInventoryBySkip=function(e,s){var t=[],a={},i=_.find(EventResources.clsStaffKeysList,function(s){return s[e]}),o=i[e];_.each(o,function(t){a[t]=getClsTimeSlotsInventoryByStaff(e,t,s)});var n=_.keys(a);return n=customerInfo.resourcesInOrder.filter(function(e){return n.indexOf(e)!=-1}),_.each(n,function(e){var s=a[e];_.each(s,function(e){_.isEmpty(_.where(t,{time:e.time}))&&t.push(e)})}),_.sortBy(t,"time")},getClsTimeSlotsInventoryByStaff=function(e,s,t){var a=EventResources.staffInventoryCollection.findWhere({key:s}),i=_.find(a.get("times"),function(s){return s[e]}),o=_.keys(i[e]),n=moment(EventResources.currentDate).format("YYYYMMDD"),r=[];return _.each(o,function(e){if(moment(parseInt(e)).tz(EventResources.classTimeZoneId).format("YYYYMMDD")===n){var t={};t.time=e,t.staffKey=s,r.push(t)}}),_.sortBy(r,"time")},renderClsSessionsForInventory=function(e,s){var t='<ul class="morning"><li class="sessionList_heading">'+lang.morning+"</li>",a='<ul class="afternoon"><li class="sessionList_heading">'+lang.afternoon+"</li>",i='<ul class="evening"><li class="sessionList_heading">'+lang.evening+"</li>",o="",n="",r="",l="HH.MM";if(o="24 Hours"===customerInfo.timeFormat?"HH:mm":"h:mm a",_.each(e,function(e){if(n=moment(parseInt(e.time)).tz(EventResources.classTimeZoneId).format(o),r=moment(parseInt(e.time)).tz(EventResources.classTimeZoneId).format(l),parseFloat(r)<12){var c=buildTimeSlotsTagCls(e.staffKey,s,n,e.time);t+=c}else if(parseFloat(r)>=12&&parseFloat(r)<=15.59){var c=buildTimeSlotsTagCls(e.staffKey,s,n,e.time);a+=c}else if(parseFloat(r)>=16){var c=buildTimeSlotsTagCls(e.staffKey,s,n,e.time);i+=c}}),t+="</ul>",a+="</ul>",i+="</ul>",$(".classes-container .loading_icon_timings").hide(),$(".class, .class_provider").removeClass("avoid-clicks"),$("#sessionSheet").html(t+a+i),$("#sessionSheet").removeClass("noSlots"),$("#classCalendars").show(),$("#sessionSheet").show(),isWixApp){var c=$("#sessionSheet").height();wixHeightGenerator(c)}applyToolTip()},buildTimeSlotsTagCls=function(e,s,t,a){var i=EventResources.staffInventoryCollection.findWhere({key:e}),o=_.find(i.get("times"),function(e){return e[s]});return buildLi='<li class = skiptranslate><a appointmentKey="'+o[s][parseInt(a)][0]+'" sessionCompTime="'+a+'" href="javascript:void(0);">'+t+"</a></li>",buildLi},renderSessions=function(e){var s='<ul class="morning"><li class="sessionList_heading">'+lang.morning+"</li>",t='<ul class="afternoon"><li class="sessionList_heading">'+lang.afternoon+"</li>",a='<ul class="evening"><li class="sessionList_heading">'+lang.evening+"</li>";if("24 Hours"!=customerInfo.timeFormat){for(index in e)if(parseFloat(String(e[index]).split("_")[1])<12){var i=parseFloat(String(e[index]).split("_")[1]).toFixed(2);parseFloat(String(e[index]).split("_")[1])>=0&&parseFloat(String(e[index]).split("_")[1])<=.59&&(i=(parseFloat(String(e[index]).split("_")[1])+12).toFixed(2));var o=String(e[index]).split("_")[0]+"_"+String(i).replace(".",":")+" am",n=getLocalTimeZone(shortTimeZone,clientClassDate,o,"classes");s+=n}else if(parseFloat(String(e[index]).split("_")[1])>=12&&parseFloat(String(e[index]).split("_")[1])<=15.59){var i="";i=parseFloat(String(e[index]).split("_")[1])>=12&&parseFloat(String(e[index]).split("_")[1])<=12.59?parseFloat(String(e[index]).split("_")[1]).toFixed(2):(parseFloat(String(e[index]).split("_")[1])-12).toFixed(2);var o=String(e[index]).split("_")[0]+"_"+String(i).replace(".",":")+" pm",n=getLocalTimeZone(shortTimeZone,clientClassDate,o,"classes");t+=n}else if(parseFloat(String(e[index]).split("_")[1])>=16){var i=(parseFloat(String(e[index]).split("_")[1])-12).toFixed(2),o=String(e[index]).split("_")[0]+"_"+String(i).replace(".",":")+" pm",n=getLocalTimeZone(shortTimeZone,clientClassDate,o,"classes");a+=n}}else for(index in e)if(parseFloat(String(e[index]).split("_")[1])<12){var i=parseFloat(String(e[index]).split("_")[1]).toFixed(2);parseFloat(String(e[index]).split("_")[1])<10&&(i=i.slice(0,0)+"0"+i.slice(0));var o=String(e[index]).split("_")[0]+"_"+String(i).replace(".",":"),n=getLocalTimeZone(shortTimeZone,clientClassDate,o,"classes");s+=n}else if(parseFloat(String(e[index]).split("_")[1])>=12&&parseFloat(String(e[index]).split("_")[1])<=15.59){var i=parseFloat(String(e[index]).split("_")[1]).toFixed(2),o=String(e[index]).split("_")[0]+"_"+String(i).replace(".",":"),n=getLocalTimeZone(shortTimeZone,clientClassDate,o,"classes");t+=n}else if(parseFloat(String(e[index]).split("_")[1])>=16){var i=parseFloat(String(e[index]).split("_")[1]).toFixed(2),o=String(e[index]).split("_")[0]+"_"+String(i).replace(".",":"),n=getLocalTimeZone(shortTimeZone,clientClassDate,o,"classes");a+=n}if(s+="</ul>",t+="</ul>",a+="</ul>",$(".classes-container .loading_icon_timings").hide(),$(".class, .class_provider").removeClass("avoid-clicks"),$("#sessionSheet").html(s+t+a),$("#sessionSheet").removeClass("noSlots"),$("#classCalendars").show(),$("#sessionSheet").show(),isWixApp){var r=$("#sessionSheet").height();wixHeightGenerator(r)}applyToolTip()},getInstagramDetails=function(e,s){return!!Boolean(customerInfo.enableInstagram)&&void(null==instagramUserDetails?makeRequest({url:"/getInstagramInfo?key="+companyKey,type:"GET",cache:!0}).done(function(s){instagramUserDetails=JSON.parse(s),e(instagramUserDetails)}).fail(function(){console.log("failed to fetch instagram"),s()}):e(instagramUserDetails))},renderReviews=function(){$(".gt, .gt_cls, .abts, .sm, .srvs, .cls, .pto").removeClass("active"),$(".rvw").addClass("active"),$("#gt_act,#abts_act,#staff_act,#services_act,#photos_act,#classes_act").hide(),$("#review_act").show(),$("#review_act #review_btn").show(),$("#policy_link,.policyNote").hide();var e="";if("true"==customerInfo.thirdPartyLogin&&$(".login_details").is(":visible")){var s=$("#username").html()?$("#username").html():"",t=$("#userId").html()?$("#userId").html():"";$("#customerName").val(s),$("#customerEmail").val(t)}if(custReviewsCount>0)$(".reviews").html(custReviewsCount+" "+lang.reviews);else{$(".policyNote").hide(),$("#review_act > h2").hide(),$("#review_btn").hide(),e+='<div class="noReview"><div class="starRating">';for(var a=0;a<5;a++)e+='<i class="icon-star">&nbsp;</i>';e+=companyDetails.companyName?'</div><h2 style="margin-top:20px;"> '+lang.be_firstoneto_reviewcompanyname+" "+companyDetails.companyName+"</h2>":"</div><h2>"+lang.be_firstone_toReview+"</h2>",e+='<a class="writeReview" href="javascript:void(0);">'+lang.write_review+"</a></div>",$("#review_act").html(e)}},validatingFields=function(e){var s=".service-container";_bookingPolicy&&($(".gt_cls").hasClass("active")&&!$(".classes-container").hasClass("noServices")&&$("#policy_link").show(),$(".gt").hasClass("active")&&!$("#chs_service_act").hasClass("noServices")&&$("#policy_link").show()),$("#phNoWarn").hasClass("hide")||$("#phNoWarn").addClass("hide"),$("#phNoTick").hasClass("hide")||$("#phNoTick").addClass("hide"),$("#classes-tab").parent().hasClass("active")?(s=".classes-container",$("#login").hasClass("saveChanges")||$("#classes-tab").hasClass("clsLst")||$("#classes-tab").removeClass("signInFrm").addClass("clsInfo")):$("#login").hasClass("saveChanges")||$("#services-tab").hasClass("srLst")||$("#services-tab").removeClass("signInFrm").addClass("srInfo");var t=0,a="",i="";e.FirstName&&($(".classes-container #sc_act #cust-FirstName").html(e.FirstName),$(".service-container #sc_act #cust-FirstName").html(e.FirstName),$(".classes-container #sc_act .customerlist-name-holder").hide(),$(".service-container #sc_act .customerlist-name-holder").hide()),e.LastName&&($(".service-container #sc_act #cust-FirstName").html(e.FirstName+" "+e.LastName),$(".classes-container #sc_act #cust-FirstName").html(e.FirstName+" "+e.LastName),$(".service-container #sc_act #customerName").val(e.FirstName+" "+e.LastName),$(".classes-container #sc_act #customerName").val(e.FirstName+" "+e.LastName)),e.LoginId&&($(".service-container #sc_act #cust-LoginId").html(e.LoginId),$(".classes-container #sc_act #cust-LoginId").html(e.LoginId),$(".service-container #sc_act #customerEmail").val(e.LoginId),$(".classes-container #sc_act #customerEmail").val(e.LoginId)),e.MobileNo&&contactFields.indexOf("phone")==-1?(isIE()?$(".service-container #sc_act #cust-PhoneNo").parent().parent().hide():$(".service-container #sc_act #cust-PhoneNo").parent().parent().parent().hide(),$(".service-container #sc_act .customerlist-MobileNo").addClass("skiptranslate"),$(".service-container #sc_act .customerlist-MobileNo").show(),$(".service-container #sc_act .customerlist-MobileNo").addClass("showFields"),$(".service-container #sc_act .customerlist-MobileNo").html(e.countryCode?'<span class="customerlist-countryCode skiptranslate">'+e.countryCode+'</span><span class="customerlist-PhoneNo skiptranslate"> '+e.MobileNo+"</span>":'<span class="customerlist-PhoneNo skiptranslate">'+e.MobileNo+"</span>"),$(".classes-container #sc_act #class_cust-PhoneNo").parent().parent().parent().hide(),$(".classes-container #sc_act .customerlist-MobileNo").addClass("skiptranslate"),$(".classes-container #sc_act .customerlist-MobileNo").show(),$(".classes-container #sc_act .customerlist-MobileNo").addClass("showFields"),$(".classes-container #sc_act .customerlist-MobileNo").html(e.countryCode?'<span class="customerlist-countryCode skiptranslate">'+e.countryCode+'</span><span class="customerlist-PhoneNo skiptranslate"> '+e.MobileNo+"</span>":'<span class="customerlist-PhoneNo skiptranslate">'+e.MobileNo+"</span>")):(isIE()?($(".service-container #cust-PhoneNo").parent().parent().show(),$(".classes-container #class_cust-PhoneNo").parent().parent().show()):($(".service-container #cust-PhoneNo").parent().parent().parent().show(),$(".classes-container #class_cust-PhoneNo").parent().parent().parent().show()),$(".service-container #cust-PhoneNo").val(""),$(".service-container .customerlist-MobileNo").hide(),$(".service-container .customerlist-MobileNo").empty(),$(".service-container .customerlist-MobileNo").removeClass("showFields"),e.countryCode&&$(".service-container #cust-PhoneNo").intlTelInput("setNumber",e.countryCode),$(".classes-container #class_cust-PhoneNo").parent().parent().parent().show(),$(".classes-container #class_cust-PhoneNo").val(""),$(".classes-container .customerlist-MobileNo").hide(),$(".classes-container .customerlist-MobileNo").empty(),$(".classes-container .customerlist-MobileNo").removeClass("showFields"),e.countryCode&&$(".classes-container #class_cust-PhoneNo").intlTelInput("setNumber",e.countryCode),$(".service-container #cust-countryCode, .classes-container #class_cust-countryCode").attr("placeholder",""));var o=$(".service-container #cust-PhoneNo").val(),n=$(".classes-container #class_cust-PhoneNo").val();isNullOrEmpty(o)&&hideOrDisplayWarn("hideAll","#service"),isNullOrEmpty(n)&&hideOrDisplayWarn("hideAll","#class");var r=!!(e.Address&&e.City&&e.State&&e.Zip);0==r?e.Address&&"null"!=e.Address||requiredFields.indexOf("address")!=-1?($(".service-container #cust-Address, .classes-container #class_cust-Address").val(e.Address?htmlDecode(e.Address):""),$(".service-container #cust-City, .classes-container #class_cust-City").val(e.City?htmlDecode(e.City):""),$(".service-container #cust-State, .classes-container #class_cust-State").val(e.State?htmlDecode(e.State):""),$(".service-container #cust-Zip, .classes-container #class_cust-Zip").val(e.Zip?htmlDecode(e.Zip):""),$(".service-container #cust-City , .service-container #cust-Address").parent().parent().show(),$(".classes-container #class_cust-City, .classes-container #class_cust-Address").parent().parent().show()):($(".service-container #cust-City, .classes-container #class_cust-City").val(e.City?htmlDecode(e.City):""),$(".service-container #cust-State, .classes-container #class_cust-State").val(e.State?htmlDecode(e.State):""),$(".service-container #cust-Zip, .classes-container #class_cust-Zip").val(e.Zip?htmlDecode(e.Zip):"")):(e.Address&&"null"!=e.Address?($(".service-container #cust-Address").parent().parent().hide(),$(".service-container .customerlist-Address").addClass("skiptranslate"),$(".service-container .customerlist-Address").show(),$(".service-container .customerlist-Address").html(htmlDecode(e.Address)),$(".service-container .customerlist-Address").addClass("showFields"),$(".classes-container #class_cust-Address").parent().parent().hide(),$(".classes-container .customerlist-Address").addClass("skiptranslate"),$(".classes-container .customerlist-Address").show(),$(".classes-container .customerlist-Address").html(htmlDecode(e.Address)),$(".classes-container .customerlist-Address").addClass("showFields")):($(".service-container #cust-Address").parent().parent().show(),$(".service-container #cust-Address").val(""),$(".service-container .customerlist-Address").hide(),$(".service-container .customerlist-Address").empty(),$(".service-container .customerlist-Address").removeClass("showFields"),$(".classes-container #class_cust-Address").parent().parent().show(),$(".classes-container #class_cust-Address").val(""),$(".classes-container .customerlist-Address").hide(),$(".classes-container .customerlist-Address").empty(),$(".classes-container .customerlist-Address").removeClass("showFields")),e.City?i+='<span class="city-cust showFields skiptranslate">'+htmlDecode(e.City)+"</span>":($(".service-container .city-cust").empty(),$(".classes-container .city-cust").empty()),e.State?i+=""!=i?'<span class="state-cust showFields skiptranslate">, '+htmlDecode(e.State)+"</span>":'<span class="state-cust showFields">'+htmlDecode(e.State)+"</span>":($(".service-container .state-cust").empty(),$(".classes-container .state-cust").empty()),e.Zip?i+=""!=i?'<span class="zip-cust showFields skiptranslate">, '+htmlDecode(e.Zip)+"</span>":'<span class="zip-cust showFields">'+htmlDecode(e.Zip)+"</span>":($(".service-container .zip-cust").empty(),$(".classes-container .zip-cust").empty()),i?($(".service-container .customerlist-City-State-Zip").html("skiptranslate"),$(".service-container .customerlist-City-State-Zip").show(),$(".service-container .customerlist-City-State-Zip").html(i),$(".service-container #cust-City").parent().parent().hide(),$(".service-container .customerlist-City-State-Zip").addClass("showFields"),e.Address?$(".service-container .customerlist-Address").show():$(".service-container #cust-Address").parent().parent().hide(),
$(".classes-container .customerlist-City-State-Zip").addClass("skiptranslate"),$(".classes-container .customerlist-City-State-Zip").show(),$(".classes-container .customerlist-City-State-Zip").html(i),$(".classes-container #class_cust-City").parent().parent().hide(),$(".classes-container .customerlist-City-State-Zip").addClass("showFields"),e.Address?$(".classes-container .customerlist-Address").show():$(".classes-container #class_cust-Address").parent().parent().hide()):($(".service-container .customerlist-City-State-Zip").removeClass("showFields"),$(".classes-container .customerlist-City-State-Zip").removeClass("showFields"),e.Address?($(".service-container #cust-City").parent().parent().hide(),$(".classes-container #class_cust-City").parent().parent().hide()):($(".service-container #cust-City").parent().parent().show(),$(".classes-container #class_cust-City").parent().parent().show())));var l=additionalFields.length,c=customerInfo.requiredContactFields;if(null!=e.additionalFields&&"null"!=e.additionalFields&&"undefined"!=e.additionalFields){if(""!=e.additionalFields.value&&"{}"!=e.additionalFields.value){var d=JSON.parse(e.additionalFields.value);a=d;for(var m in a)if(additionalFields.indexOf(m)!=-1)for(var p=0;p<l;p++)$(".service-container #custAdditionalFields_"+p).attr("placeholder")!=htmlDecode(m)&&$(".service-container #custAdditionalFields_"+p).attr("placeholder")!=htmlDecode(m)+" *"||(a[m]?($(".service-container #custAdditionalFields_"+p).parent().parent().hide(),$(".service-container .customerlistAdditionalFields_"+p).addClass("skiptranslate"),$(".service-container .customerlistAdditionalFields_"+p).show(),$(".service-container .customerlistAdditionalFields_"+p).html(htmlDecode(a[m])),$(".service-container .customerlistAdditionalFields_"+p).addClass("showFields")):(t+=1,$(".service-container .customerlistAdditionalFields_"+p).addClass("skiptranslate"),$(".service-container #custAdditionalFields_"+p).parent().parent().show(),$(".service-container #custAdditionalFields_"+p).val(""),$(".service-container .customerlistAdditionalFields_"+p).hide(),$(".service-container .customerlistAdditionalFields_"+p).empty(),$(".service-container .customerlistAdditionalFields_"+p).removeClass("showFields"))),$(".classes-container #class_custAdditionalFields_"+p).attr("placeholder")!=htmlDecode(m)&&$(".classes-container #class_custAdditionalFields_"+p).attr("placeholder")!=htmlDecode(m)+" *"||(a[m]?($(".classes-container #class_custAdditionalFields_"+p).parent().parent().hide(),$(".classes-container .customerlistAdditionalFields_"+p).addClass("skiptranslate"),$(".classes-container .customerlistAdditionalFields_"+p).show(),$(".classes-container .customerlistAdditionalFields_"+p).html(htmlDecode(a[m])),$(".classes-container .customerlistAdditionalFields_"+p).addClass("showFields")):(t+=1,$(".classes-container #class_custAdditionalFields_"+p).parent().parent().show(),$(".classes-container #class_custAdditionalFields_"+p).val(""),$(".classes-container .customerlistAdditionalFields_"+p).hide(),$(".classes-container .customerlistAdditionalFields_"+p).empty(),$(".classes-container .customerlistAdditionalFields_"+p).removeClass("showFields")));else if(additionalFields&&0!=l)for(var m=0;m<l;m++)isValueExists=c&&c.indexOf(additionalFields[m])!=-1?"false":"true"}else if(additionalFields&&0!=l)for(var m=0;m<l;m++)isValueExists=c&&c.indexOf(additionalFields[m])!=-1?"false":"true"}else if(additionalFields&&0!=l)for(var m=0;m<l;m++)isValueExists=c&&c.indexOf(additionalFields[m])!=-1?"false":"true";if(t>0&&(isValueExists="true"),t=0,"true"==isValueExists?($(".service-container .customer-AdditionalFields").show(),$(".classes-container .customer-AdditionalFields").show(),isValueExists="false"):($(".service-container .customer-AdditionalFields").hide(),$(".classes-container .customer-AdditionalFields").hide(),isValueExists="false"),e.CompanyLogoPath&&"null"!=e.CompanyLogoPath?($(".customerlist-image").attr("src",e.CompanyLogoPath),$(".custImageIcon").attr("src",e.CompanyLogoPath),$(".custProfilePic").attr("src",e.CompanyLogoPath)):customerProfileImage&&"null"!=customerProfileImage?($(".customerlist-image").attr("src",customerProfileImage),$(".custImageIcon").attr("src",customerProfileImage),$(".custProfilePic").attr("src",customerProfileImage)):$(".customerlist-image,.custImageIcon,.custProfilePic").attr("src","/bookingpage/images/bookappt_v3/provider_img2.png"),$("#progress-icon").hasClass("serviceIcon")||$("#progress-icon").hasClass("service")){var u="Service"!=customisedServiceLabel?customisedServiceLabel:"en"!=language?lang.services:"Services";window.isMobile.matches&&(u=customisedServiceLabel),$(".step_tab > h2").html(choose_a_ser+" "+u),$("#provider").hasClass("active")&&$(".step_tab > h2").html(choose_a_pro+" "+cusPro)}else{$(" "+s+" .yourinfo").show(),$(" "+s+" .customer-login-form").show();var h=e.FirstName+" "+e.LastName;window.isMobile.matches?$(".step_tab > h2").html(lang.hi+" "+h.trim()+", <br/>"+lang.please_review_your_info):$(".step_tab > h2").html(lang.hi+" "+h.trim()+", "+lang.please_review_your_info)}if($("#classes-tab").parent().hasClass("active")&&!$("#classes-tab").hasClass("clsLst")){$(" "+s+" .yourinfo").show(),$(" "+s+" .customer-login-form").show();var h=e.FirstName+" "+e.LastName;$(".class_step_tab > h2").html(lang.hi+" "+h.trim()+", "+lang.please_review_your_info)}$(".customerImg").show(),$(".service-container .cust-details , .classes-container .cust-details").show(),$(".signIn, .signUp").hide(),$("#login").hide(),$(".login-container-close").hide(),$(".login_details").show(),$(".login-icon-div").removeClass("show-login-icon").addClass("hide"),$("#username").html(e.FirstName+" "+e.LastName),$("#userId").html(e.LoginId),customerKey=e.key,loginType=e.hasOwnProperty("loginType")&&e.loginType?e.loginType.toString():"",cust_emailReminders=e.haveEmailReminderEnabled,cust_textReminders=e.haveTextReminderEnabled,enPwd=e.EncryptedPassword,$("#cust-edit-FirstName").attr("readonly","true"),$("#cust-edit-LastName").attr("readonly","true"),$(".signIn").removeClass("active"),loginType.contains("[")&&(loginType=loginType.replace("[").trim(),loginType=loginType.replace("]").trim()),$("#login").hasClass("active")&&!$("#login").hasClass("saveChanges")&&($(".edit").trigger("click"),$(".customer-profile-cancel").addClass("login-active")),showActiveMobileTab(),$(".customerLoginContainer").addClass("removePaddingTop").removeClass("addPaddingTop")},getCusContDtls=function(e){var s=new Array;arguments[1]&&(s=arguments[1]);var t=(!!arguments[2],arguments[3]?arguments[3]:"test");if(e){var a=e.firstName&&"null"!=e.firstName?e.firstName:"",i=e.lastName&&"null"!=e.lastName?e.lastName:"",o=e.email&&"null"!=e.email?e.email:"",n=e.customerImage&&"null"!=e.customerImage?e.customerImage:"",r=e.loginType&&"null"!=e.loginType?e.loginType:"",l=e.fbUserLoginId&&"null"!=e.fbUserLoginId?e.fbUserLoginId:"",c=countryObject.getIntlCountryData(countryInitial.toLowerCase(),!0,!0,"iso2").iso3?countryObject.getIntlCountryData(countryInitial.toLowerCase(),!0,!0,"iso2").iso3.toLowerCase():"",d=countryObject.getIntlCountryData(countryInitial.toLowerCase(),!0,!0,"iso2").dialCode?"+"+countryObject.getIntlCountryData(countryInitial.toLowerCase(),!0,!0,"iso2").dialCode:"",m="emailId="+o+"&companyKey="+e.companyKey+"&firstName="+encodeURIComponent(a)+"&lastName="+encodeURIComponent(i)+"&custImage="+n+"&loginType="+r+"&fbUserLoginId="+l+"&Country="+encodeURIComponent(c)+"&countryCode="+encodeURIComponent(d);e.customerKey&&(m="emailId="+o+"&companyKey="+e.companyKey+"&customerKey="+e.customerKey),$.ajax({type:"POST",url:"/getUserInformation.do",data:m,dataType:"json",async:!0,success:function(e){!_.isEmpty(e)&&isNullOrEmpty(e.error)&&(_countryCode=e.countryCode,_countryCode&&(_countryCode.contains("+")||(_countryCode="+"+_countryCode,e.countryCode="+"+e.countryCode)),validatingFields(e),setCustInfo(e)),t&&"function"==typeof t&&t()},error:function(e){console.log("Error :: Failed to get user info")}})}},setmoreSignup=function(e,s,t){e=htmlDecode(e);var a=e.split(" ")[0];console.log(a);var i=e.replace(a,"");i=i.trim();var o=countryObject.getIntlCountryData(countryInitial.toLowerCase(),!0,!0,"iso2"),n={firstName:a,lastName:i,email:s,password:t,companyKey:companyKey,companyName:companyDetails.companyName,Country:o&&o.iso3?o.iso3.toLowerCase():"",countryCode:o&&o.dialCode?"+"+o.dialCode:""};$.ajax({type:"POST",url:"/setmoreCustomerSignup.do",data:JSON.stringify(n),dataType:"json",contentType:"application/json",async:!0,success:function(e){if(e)if(console.log(e),"alreadyExists"==e.error)showValidationAletMsg(lang.emailID_exists),$("#setEmail").addClass("inputError");else if("OnlySocialLoginEnabled"==e.error)showValidationAletMsg("Sorry, the above email address is in use");else{$(".signUp").hide(),$(".customer-login-form,.edit").show(),customerKey=e.key,e.FirstName=htmlDecode(e.FirstName),e.LastName=htmlDecode(e.LastName),encrytPwd=e.EncryptedPassword;var s=htmlDecode(e.FirstName)+" "+htmlDecode(e.LastName);$(".step_tab > h2").html(lang.hi+" "+s.trim()+", "+lang.please_review_your_info),$(".setmore-signup > input").val(""),validatingFields(e)}else showValidationAletMsg(lang.sorry_went_wrong)},error:function(e){console.log(" Error: Failed to signup ")}})},getCusSetmoreLoginInfo=function(e,s){$.ajax({type:"POST",url:"/getCusSetmoreLoginInfo.do",data:"emailId="+urlencode(e)+"&password="+urlencode(s)+"&companyKey="+companyKey,dataType:"json",async:!0,success:function(e){if(e)if("InvalidPassword"==e.error)showValidationAletMsg(lang.invalid_pass);else if("OnlySocialLoginEnabled"==e.error)showValidationAletMsg("Sorry, we were unable to verify an account with this email address under Setmore Login. Please try social logins");else if("newEmailId"==e.error)$(".signUp").is(":visible")||$(".signIn").is(":visible")?showValidationAletMsg(lang.sorry_emailId_doesntExist):clearCusSession();else{if(customerKey=e.key,cust_emailReminders=e.haveEmailReminderEnabled,cust_textReminders=e.haveTextReminderEnabled,sPwd=s,$(".signIn").hide(),$(".login_details,.customer-login-form,.edit").show(),$("#progress-icon").hasClass("serviceIcon")){var t="Service"!=customisedServiceLabel?customisedServiceLabel:"en"!=language?lang.services:"Services";$(".step_tab > h2").html(choose_a_ser+" "+t)}else{var a=e.FirstName+" "+e.LastName;$(".step_tab > h2").html(lang.hi+" "+a.trim()+", "+lang.please_review_your_info)}$(".mobile-navbar").removeClass("active"),$(".info > span.mobile-navbar").addClass("active"),$(".class_info > span.mobile-navbar").addClass("active"),_countryCode=e.countryCode,validatingFields(e),setCustInfo(e)}},error:function(e){console.log("Error :: Failed to get user info")}})},getEmailInfoDetails=function(e){if("Never"!=customerInfo.cancellationPolicyHours&&_.isEmpty(rescheduleAndCancelLink)){var s={type:"GET",url:"/getEmailInfo",data:"companyKey="+e,dataType:"html",async:!1,cache:!1};makeRequest(s).done(function(e){e&&console.log(e),console.log(typeof e),rescheduleAndCancelLink=JSON.parse(e)}).fail(function(e){})}},renderCusAppt=function(e){var s=[],t=[],a=[],i=[],o=[],n=function(e,s){return isNullOrEmpty(e.StartTimeLong)&&(e.StartTimeLong=e.startTimeLong),isNullOrEmpty(s.StartTimeLong)&&(s.StartTimeLong=s.startTimeLong),e.StartTimeLong<s.StartTimeLong?-1:e.StartTimeLong>s.StartTimeLong?1:e.StartTimeLong==s.StartTimeLong?0:void 0};if("upcoming"==e?(t=_.union(t,upcomingCustomerEvents.events),t.sort(n),s=t):"past"==e&&(a=_.union(a,pastCustomerEvents.events),a.sort(n),a.reverse(),s=a),s)for(var r=0;r<s.length;r++)if(s[r].classKey){var l=convertIcalFormateToDateObject(s[r].startDateAndTime).getTime();s[r].longDate=l,s[r].apptType="Classes";var c=_.where(EventResources.classList,{key:s[r].classKey});0===c.length&&i.push(s[r].classKey)}else{var d=new Date(s[r].startDate);d.setHours(parseInt(s[r].startTime/60));var m=d.setMinutes(s[r].startTime%60);s[r].longDate=m,s[r].apptType="Appointment",0===Object.keys(customerServiceList).length&&(customerServiceList=JSON.parse(JSON.stringify(EventResources.serviceList)));var p=_.where(customerServiceList,{key:s[r].serviceKey});0===p.length&&o.push(s[r].serviceKey)}var u={};0!==o.length?(u.appDetails=s,u.apptSerKeys=o,u.clsApptSerKeys=i,u.type=e,fetchServicesByCustomer(u)):0!==i.length?(u.appDetails=s,u.clsApptSerKeys=i,u.type=e,fetchClassesByCustomer(u)):renderCustApptEventsCallBack(s,e)},renderCustApptEventsCallBack=function(e,s){e?bCustAppt(e,s):0==$(".customer-appointments > ul").find("li").length&&$(".customer-appointments > ul").append('<li class="noCurrentAppts" style="margin-top:145px;"><div class="noAppointments" style="text-align:center;">'+lang.no_appt+"</div></li>")},fetchClassesByCustomer=function(e){var e=e,s=_.uniq(e.clsApptSerKeys),t=10,a=_.groupBy(s,function(e,s){return Math.floor(s/t)}),i=Object.keys(a).length,o=0;$.each(a,function(s,t){$.ajax({url:"/fetchClassesByKeys",type:"POST",data:JSON.stringify(t),contentType:"application/json"}).done(function(s){o+=1,EventResources.classList=_.union(EventResources.classList,JSON.parse(s)),o===i&&renderCustApptEventsCallBack(e.appDetails,e.type)}).fail(function(e,s,t){fetchErrorCallBack("Classes Fetch",s,t)})})},fetchServicesByCustomer=function(e){var e=e,s=_.uniq(e.apptSerKeys),t=10,a=_.groupBy(s,function(e,s){return Math.floor(s/t)}),i=Object.keys(a).length,o=0;$.each(a,function(s,t){$.ajax({url:"/fetchServicesByKeys",type:"POST",data:JSON.stringify(t),contentType:"application/json"}).done(function(s){if(o+=1,_.each(JSON.parse(s),function(e){customerServiceList[e.key]=e}),o===i){if(!_.isEmpty(e.clsApptSerKeys))return void fetchClassesByCustomer(e);renderCustApptEventsCallBack(e.appDetails,e.type)}}).fail(function(e,s,t){fetchErrorCallBack("Service Fetch",s,t)})})},bCustAppt=function(e,s){var t="",a=getCurrentClientTimeInBusinessHoursTimeZone(),i=e.length,o="",n="",r="",l="",c=!0,d="",m=window.isMobile.matches?8:20;rescheduleAndCancelLink.reschedule&&rescheduleAndCancelLink.cancel?d="both":rescheduleAndCancelLink.reschedule?d="reschedule":rescheduleAndCancelLink.cancel?d="cancel":c=!1;for(var p=0;p<i;p++){var u="",h="",v="",g="",f="",y="",C="",b="",k="",D="",w=e[p].apptType,S="",I="",T='<div class="editNdel" style="left: 33px;">',L="",A=!0;if("Appointment"==w){u=new Date(e[p].startDate),u.setHours(parseInt(e[p].startTime/60)),u.setMinutes(e[p].startTime%60);var P=customerServiceList[e[p].serviceKey];if("undefined"==typeof P){console.log("Inactive Service "+e[p].serviceKey);continue}g=P.ColorCode,f=void 0!=e[p].cost&&null!=e[p].cost&&""!=e[p].cost?e[p].cost:P.Cost,h=htmlDecode(P.ServiceName),v=h.length>14?h.substring(0,14)+".. ":h,y=0==P.bufferDuration?P.Duration:P.Duration-P.bufferDuration,C=y,C=void 0!=e[p].bufferDuration&&null!=e[p].bufferDuration&&""!==e[p].bufferDuration&&"null"!=e[p].bufferDuration?e[p].endTime-e[p].startTime-e[p].bufferDuration:y,C=C.toString().length>3?C.toString().substring(0,3)+"..":C,b=void 0!=resourceMap[e[p].resourceKey]?resourceMap[e[p].resourceKey].LastName&&void 0!=resourceMap[e[p].resourceKey].LastName?resourceMap[e[p].resourceKey].FirstName+" "+resourceMap[e[p].resourceKey].LastName:resourceMap[e[p].resourceKey].FirstName:"Deleted Staff",b=htmlDecode(b),k=b.length>m?b.substring(0,m)+".. ":b;var x=null!=staffResourceInfo?"https://"+location.host+"/reschedule/appt?cKey="+e[p].cancelAppointmentKey+"&isEdited=true&isStaffPage=true":"https://"+location.host+"/reschedule/appt?cKey="+e[p].cancelAppointmentKey+"&isEdited=true",N="https://"+location.host+"/cancel/appt?cKey="+e[p].cancelAppointmentKey,F="true"==e[p].haveRecurring?"hide":"",O="",E="";if(A=1==c&&"yes"==checkCancellationPolicyHours(companyTimeZoneOffset,u,_canclPlcyHrs),F)E="",O="";else{var M=e[p].service&&"true"==e[p].service.isPrivateService;"both"==d?(S=M?"":'<div class="popover-title"><h3>'+lang.edit_or_del_appt+'</h3><h4 style="margin-top: -23px;margin-left: 169px;color: #AEB1B3;">x</h4></div>',T=M?"":'<div class="editNdel"><div class="btn"><a class = "btn-edit" href='+x+' target="_blank">'+lang.edit+"</a></div>",L=M?"":'<div class="btn"> <a class = "btn-cancel" href='+N+'  target="_blank">'+lang.del+"</a></div>"):"reschedule"==d?(S=M?"":'<div class="popover-title" style="width: 144px;"><h3>Edit Appointment?</h3><h4 style="margin-top: -23px;margin-left: 143px;color: #AEB1B3;">x</h4></div>',T=M?"":'<div class="editNdel" style="left: 33px;"><div class="btn"><a class = "btn-edit" href='+x+' target="_blank">'+lang.edit+"</a></div>",I="showDelApptAlone"):"cancel"==d&&(S=M?"":'<div class="popover-title" style="width: 144px;"><h3>Delete Appointment?</h3><h4 style="margin-top: -23px;margin-left: 143px;color: #AEB1B3;">x</h4></div>',I="showDelApptAlone",L=M?"":'<div class="btn"> <a class = "btn-cancel" href='+N+'  target="_blank">'+lang.del+"</a></div>"),E='<div class="edit-icon"><a class="editAppt" style="display: block!important;" id='+e[p].key+'><i class="icon-pencil" style="display: block;"></i></a><div>',O='<div class="editApptPopup '+I+' hide" id='+e[p].key+"_key >"+S+T+L+'</div><div class="arrow"></div><div class="arrow arrow-under"></div><div class=clear></div></div>'}}else if("Classes"==w){D="Classes"!=customisedClassLabel?customisedClassLabel:"en"!=language?lang.Class:"Class",u=convertIcalFormateToDateObject(e[p].startDateAndTime),b=resourceMap[e[p].staffKey].LastName&&"undefined"!=resourceMap[e[p].staffKey].LastName?resourceMap[e[p].staffKey].FirstName+" "+resourceMap[e[p].staffKey].LastName:resourceMap[e[p].staffKey].FirstName,k=b.length>m?b.substring(0,m)+".. ":b,y=e[p].endTimeMins-e[p].startTimeMins,C=y.toString().length>3?y.toString().substring(0,3)+"..":y,f=e[p].cost;var R=_.where(EventResources.classList,{key:e[p].classKey})[0],B=_.where(EventResources.classesList,{key:e[p].classKey})[0];h=void 0==R?htmlDecode(B.title):htmlDecode(R.title),v=h.length>14?h.substring(0,14)+".. ":h,g=void 0==R?B.colorCode:R.colorCode,A=1==c&&"yes"==checkCancellationPolicyHours(companyTimeZoneOffset,u,_canclPlcyHrs);var Z=null!=staffResourceInfo?"https://"+location.host+"/reschedule/classattendee?cKey="+e[p].key+"_"+customerKey+"&isEdited=true&isStaffPage=true":"https://"+location.host+"/reschedule/classattendee?cKey="+e[p].key+"_"+customerKey+"&isEdited=true",K="https://"+location.host+"/cancel/classattendee?cKey="+e[p].key+"_"+customerKey;"both"==d?(S='<div class="popover-title"><h3>'+lang.edit_or_del_appt+'</h3><h4 style="margin-top: -23px;margin-left: 169px;color: #AEB1B3;">x</h4></div>',T='<div class="editNdel"><div class="btn"><a class = "btn-edit" href='+Z+' target="_blank">'+lang.edit+"</a></div>",L='<div class="btn"> <a class = "btn-cancel" href='+K+'  target="_blank">'+lang.del+"</a></div>"):"reschedule"==d?(S='<div class="popover-title" style="width: 144px;"><h3>Edit Appointment?</h3><h4 style="margin-top: -23px;margin-left: 143px;color: #AEB1B3;">x</h4></div>',T='<div class="editNdel" style="left: 33px;"><div class="btn"><a class = "btn-edit" href='+Z+' target="_blank">'+lang.edit+"</a></div>",I="showDelApptAlone"):"cancel"==d&&(S='<div class="popover-title" style="width: 144px;"><h3>Delete Appointment?</h3><h4 style="margin-top: -23px;margin-left: 143px;color: #AEB1B3;">x</h4></div>',I="showDelApptAlone",L='<div class="btn"> <a class = "btn-cancel" href='+K+'  target="_blank">'+lang.del+"</a></div>"),E='<div class="edit-icon"><a class="editAppt session" style="display: block!important;" id='+e[p].key+'><i class="icon-pencil" style="display: block;"></i></a><div>',O='<div class="editApptPopup '+I+' hide" id='+e[p].key+"_key >"+S+T+L+'</div><div class="arrow"></div><div class="arrow arrow-under"></div><div class=clear></div></div>'}var j=FormatDate(u,"%m%y"),z=FormatDate(u,"%n, %y"),W=(FormatDate(u,"%k %n %y"),FormatDate(u,"%w, %n %k")),V="24 Hours"==customerInfo.timeFormat?FormatDate(u,"%H:%M"):FormatDate(u,"%s:%M %p"),U="Recurring",q=e[p].longDate,Y="",H="",J="";"upcoming"==s?(a==q?(n=o!=q?'<li class="apptMonthly TodayAppointments" id="Today">'+lang.today+"</li>":"",o=q,t+="Appointment"==w?n+'<li class="TodayAppointments" id="'+w+"_"+c+"_isRecurring_"+F+'"  style="border-left:5px solid #'+g+'">':n+'<li class="TodayAppointments" style="border-left:5px solid #'+g+'">'):(l=r!=j?'<li class="apptMonthly UpcomingAppointments hide" id='+j+">"+z+"</li>":"",r=j,t+="Appointment"==w?l+'<li class="UpcomingAppointments hide" id="'+w+"_"+c+"_isRecurring_"+F+'"  style="border-left:5px solid #'+g+'">':l+'<li class="UpcomingAppointments hide" style="border-left:5px solid #'+g+'">'),Y+=1==A?E:"",H+=1==A?O:"",J=F?"recurring":""==Y?"noEdit":""):"past"==s&&(l=r!=j?'<li class="apptMonthly oldAppointments hide" id='+j+">"+z+"</li>":"",r=j,t+=l+'<li class="oldAppointments hide" style="border-left:5px solid #'+g+'">');var G=isFloat(f)?parseFloat(f).toFixed(2):f,Q=G.toString().length>4?G.toString().substring(0,3)+"..":G;t+='<div class=appt-time-date><div class="appt-day">'+W+'</div><label class="appt-time">'+V+'</label></div><div class="appt-Info '+J+'"><div style="margin-top:10px;">',t+="Classes"==w?'<label class="cal-appt-show-label">'+D+"</label>":F?'<label class="cal-appt-show-label">'+U+"</label>":"",t+='<span original-title = "'+h+'" class="appt-service-name">'+v+'</span></div><div class="clear"></div><div class="customer-appt-info"><label class="resource-name" original-title = "'+b+'" >w/ '+k+', </label><label class="appt-duration" original-title = "'+y+lang.mins+'" >'+C+lang.mins+', </label><label class="appt-price" original-title = "'+sign+G+'" >'+sign+Q+'</label></div><div class="clear"></div></div>'+Y+'<div class="clear"></div>'+H+"</li>"}$(".customer-appointments > ul").html(t),$(".companyName, .appt-service-name , .resource-name , .appt-duration ,.appt-price").tipsy({gravity:"s"}),isIE()&&($(".UpcomingAppointments .appt-time-date").addClass("IEappt-time-date"),$(".oldAppointments .appt-time-date").addClass("IEappt-time-date-oldappts")),showAppts(s)},showAppts=function(e){window.customerEventScrollType=e,"upcoming"==e?($(".oldAppointments").hide(),$(".UpcomingAppointments").show()):"past"==e&&($(".TodayAppointments,.UpcomingAppointments").hide(),$(".oldAppointments").show()),"upcoming"==e?(0==$(".customer-appointments > ul").find(".UpcomingAppointments").length&&$(".customer-appointments > ul").append('<li class="noUpcomingAppts" style="margin-top:145px;"><img src="/bookingpage/images/empty-calendar.svg" class="Empty-Calendar"></img><p class="No-Future-Appointment">'+lang.no_future_appt+"</p></li>"),$("#setmore-loader").hide()):"past"==e&&(0==$(".customer-appointments > ul").find(".oldAppointments").length&&($(".customer-appointments > ul").append('<li class="noPastAppts" style="margin-top:145px;"><img src="/bookingpage/images/empty-calendar.svg" class="Empty-Calendar"></img><p class="No-Future-Appointment">'+lang.no_past_appt+"</p></li>"),$("#setmore-loader").hide()),$("#setmore-loader").hide()),$(".recuring").off("click").on("click",function(e){$(e.currentTarget).parent().parent().hide()})};$(".customer-appointments").on("scroll",function(){if($(this).scrollTop()+$(this).innerHeight()>=$(this)[0].scrollHeight){var e="past"===customerEventScrollType?pastCustomerEvents:upcomingCustomerEvents;e.events.length>=7&&(""!==e.apptCursor&&"null"!==e.apptCursor||""!==e.clsApptCursor&&"null"!==e.clsApptCursor)&&getCusBks(customerKey,e,!0)}}),$(".customer-appointments > ul").on("scroll",function(){if($(this).scrollTop()+$(this).innerHeight()>=$(this)[0].scrollHeight){var e="past"===customerEventScrollType?pastCustomerEvents:upcomingCustomerEvents;e.events.length>=7&&(""!==e.apptCursor&&"null"!==e.apptCursor||""!==e.clsApptCursor&&"null"!==e.clsApptCursor)&&getCusBks(customerKey,e,!0)}});var getCusBks=function(e,s,t){var s=s,a={};a.customerKey=e,a.companyKey=companyKey,a.startTimeLong=s.startTimeLong,a.endTimeLong=s.endTimeLong,a.limit=7,a.order="upcoming"==s.type?"asc":"desc",a.apptCursor=s.apptCursor,a.clsApptCursor=s.clsApptCursor,s.isFetchInProgress||(!t||"null"===s.apptCursor&&"null"===s.clsApptCursor?renderCustomerApptEventsCallBack(s):(s.isFetchInProgress=!0,showLoaderCustApptView(!1),currentCall=$.ajax({url:"/getAllEventsForCustomer",method:"GET",data:a,success:function(e){1==e.response?(s.events=_.union(s.events,e.data.appointments),s.events=_.union(s.events,e.data.classAppointments),s.apptCursor=null===e.data.apptcursor?"null":e.data.apptcursor,s.clsApptCursor=null===e.data.clsapptcursor?"null":e.data.clsapptcursor,renderCustomerApptEventsCallBack(s)):showAppts(s.type),s.isFetchInProgress=!1}})))},renderCustomerApptEventsCallBack=function(e){var s=[];pastAppts=[],futureAppts=[],s=_.union(s,e.events),s=s.reverse();for(var t=s.length,a=0;a<t;a++)if(s[a].classKey){var i=getCurrentClientTimeInBusinessHoursTimeZone(),o=convertIcalFormateToDateObject(s[a].startDateAndTime),n=new Date(o).getTime();if(n<=i)pastAppts.push(s[a]);else{var r=[];if(0!=futureAppts.length)for(var l=0;l<futureAppts.length;l++){if(futureAppts[l].key!=s[a].key){s[a].classKey&&futureAppts.push(s[a]);break}r.push(s[a]),s.remove(s[a])}else futureAppts.push(s[a])}}else{var c=getCurrentClientTimeInBusinessHoursTimeZone(),d=new Date(s[a].startDate);d.setHours(Math.floor(s[a].startTime)/60),d.setMinutes(s[a].startTime%60);var m=d;m<=c?pastAppts.push(s[a]):futureAppts.push(s[a])}"upcoming"===e.type&&(0===futureAppts.length?($("#setmore-loader").hide(),$(".noUpcomingAppts").length<1&&$(".customer-appointments > ul").append('<li class="noUpcomingAppts" style="margin-top:145px;"><img src="/bookingpage/images/empty-calendar.svg" class="Empty-Calendar"></img><p class="No-Future-Appointment">'+lang.no_future_appt+"</p></li>")):renderCusAppt("upcoming")),"past"===e.type&&(0===pastAppts.length?($("#setmore-loader").hide(),$(".noUpcomingAppts").length<1&&$(".customer-appointments > ul").append('<li class="noPastAppts" style="margin-top:145px;"><img src="/bookingpage/images/empty-calendar.svg" class="Empty-Calendar"></img><p class="No-Future-Appointment">'+lang.no_past_appt+"</p></li>")):renderCusAppt("past"))},forgetPassword=function(e){var s={type:"POST",url:"/checkCustIdExists.do",data:"email="+e+"&companyKey="+companyKey,dataType:"html",async:!0,cache:!1};makeRequest(s).done(function(s){if("Doesn'tExist"==s)showValidationAletMsg(lang.no_emailId_exist),$("#forget-email").addClass("inputError");else if("Exists"==s){var t={type:"POST",url:"/ForgotPassword.do",data:"forgotEmail="+e+"&role=Customer&companyKey="+companyKey,dataType:"html",async:!0,cache:!1};makeRequest(t).done(function(e){showValidationAletMsg(lang.email_send)}).fail(function(e){console.error("Failed forgot password ")})}}).fail(function(e){console.error(" Failed to check customer existence ")})},checkForCustSessionAttr=function(){var e="facebook"!=loginType?customerLoginFirstName&&"null"!=customerLoginFirstName&&customerEmailId&&"null"!=customerEmailId&&null==rescheduleResourceInfo&&null==resuchduleServicesInfo:customerLoginFirstName&&"null"!=customerLoginFirstName&&null==rescheduleResourceInfo&&null==resuchduleServicesInfo;if(e){var s={firstName:customerLoginFirstName,lastName:customerLoginLastName,email:customerEmailId,companyKey:companyKey,fbUserLoginId:CustomerLoginUserId,loginType:loginType};sPwd?getCusSetmoreLoginInfo(customerEmailId,sPwd):(s.customerKey=customerKey,getCusContDtls(s)),$(".signIn").hide(),$(".service-container .customer-login-form").show(),$(".classes-container .customer-login-form").show(),$("#sign_out").addClass("serviceSelected")}},displayAppointmentCount=function(e){try{var s;if(monthName=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],!appointmentCountArray[e-1]){currentYear=(new Date).getFullYear(),lastDateInMonth=new Date(currentYear,e,0).getDate(),fullMonth=e+"",fullMonth.length<2&&(fullMonth="0"+fullMonth),fromDate="01/"+fullMonth+"/"+currentYear,toDate=lastDateInMonth+"/"+fullMonth+"/"+currentYear,companyKey=companyDetails.key;var t="companyKey="+companyKey+"&fromDate="+fromDate+"&toDate="+toDate,a={type:"GET",url:"/getAppointmentCountsBetweenDate.do",data:t,dataType:"json",async:!0,cache:!1};makeRequest(a).done(function(e){s=e}).fail(function(){})}}catch(i){alert("Error occured in displayAppointmentCount() ::"+i.message)}return s},sShareAndFollow=function(){$(".socialButtonLineAndShare").hide(),null==customerInfo.socialMedia||""==customerInfo.socialMedia||void 0==customerInfo.socialMedia?$("#fbButtonSetmore").hide():$("#fbButtonSetmore").show(),null==customerInfo.socialMediaTwitter||""==customerInfo.socialMediaTwitter||void 0==customerInfo.socialMediaTwitter?$("#twitterButtonSetmore").hide():$("#twitterButtonSetmore").show(),customerInfo.showSocialShare&&"true"==customerInfo.showSocialShare&&$("#confirm_ul").append('<li id="share_fb"><label>Share :</label><div onclick=gplus("'+custFirstName+'","'+custLastName+'") class="google_signin_btn_share"></div><div onclick=fbshare("'+custFirstName+'","'+custLastName+'") class="facebook_signin_btn"></div></li>')},showCalBkUrl=function(){if(null==rescheduleResourceInfo&&null==resuchduleServicesInfo&&customerInfo.callBackUrl){$(".callBackUrl").show(),$(".socialButtonLineAndShare").css("margin-top","0px"),customerInfo.callBackUrlLabel?$("#callBackLink").text(htmlDecode(customerInfo.callBackUrlLabel)):$("#callBackLink").text("Click Here");var e=customerInfo.callBackUrl;e.indexOf("http")!==-1||e.indexOf("https")!==-1?$("#callBackLink").attr("href",customerInfo.callBackUrl):e.indexOf("www")!=-1?$("#callBackLink").attr("href",e.replace("www.","//")):$("#callBackLink").attr("href","//"+e)}},updateCusLoginDts=function(e){$.ajax({type:"POST",url:"/updateCustomerLoginDetails.do",data:JSON.stringify(e),dataType:"json",contentType:"application/json",async:!0,success:function(e){"Failure"!=e&&($(".customer-profile-edit").hide(),$("#blockpage").hide(),fbbdp||isNullOrEmpty(_bookingPolicy)||$(".policyNote").hasClass("viewed")||$("#notes_wrapper").show(),$(".gt_cls").hasClass("active")&&$(".classes-container").hasClass("noServices")&&$("#notes_wrapper").hide(),$(".gt").hasClass("active")&&$("#chs_service_act").hasClass("noServices")&&$("#notes_wrapper").hide(),$(".customer-profile-signout").hasClass("loginActive")||$(".customer-profile-signout").addClass("loginActive"),$("#login").addClass("saveChanges"),_countryCode=e.countryCode,_countryCode&&(_countryCode.contains("+")||(_countryCode="+"+_countryCode)),validatingFields(e),e.FirstName=htmlDecode(e.FirstName),e.LastName=htmlDecode(e.LastName),customerLoginFirstName=e.FirstName,customerLoginLastName=e.LastName,($(".service-container #cust-continue").hasClass("normalLogin")||$(".classes-container #cust-continue").hasClass("normalLogin"))&&($(".service-container #cust-continue").removeClass("normalLogin").addClass("socialLogin"),$(".classes-container #cust-continue").removeClass("normalLogin").addClass("socialLogin")),showTabs())},error:function(e){console.error(" Error Message : Failed while saving updated customer details ::"+customerObj)}})},bookAnotherAppt=function(){"true"==customerInfo.bookAnotherApptbutton&&"true"!=facebookPage&&(null!=rescheduleResourceInfo&&"true"==isReschedulePage?$(".bookAnotherAppt").hide():$(".bookAnotherAppt").show())},gAnalytics=function(e,s,t){if("Appointments"==s){if(ga("send","event","Appointments",companyKey,"Booking Page"),ga("send","event","Customers",companyKey,"Booking Page"),""!=customerInfo.googleAnalyticsCode){var a,i="",o="";t?(a=e.resourceKey,i=resourceMap[a].FirstName+" "+resourceMap[a].LastName,o=serviceCategoryList[e.serviceKey].ServiceName):(a=e[0].appointments[0].resourceKey,i=resourceMap[a].FirstName+" "+resourceMap[a].LastName,o=serviceCategoryList[e[0].appointments[0].serviceKey].ServiceName),ga("send","event","Appointments",a,o);try{ga("customerUATracker.send","event","Appointments",i,o)}catch(n){console.error(n)}}}else"Classes"==s&&ga("send","event","Classes",companyKey,"Booking Page")},pullSlotsForoffHoursFromBookingPage=function(e,s,t,a,i){var o=" ";new Date(s).getTime(),(new Date).getTime();i=Date.UTC(moment(s).year(),moment(s).month(),moment(s).date(),0,0,0);var n=moment(s).date();n<10&&(n="0"+n);var r=moment(s).month()+1;
r<10&&(r="0"+r),a=n+"/"+r+"/"+moment(s).year(),tz=clientTimeZone;var l="companyKey="+e+"&currentDay="+moment(s).day()+"&duration="+t+"&resourceKey="+resourceKey+"&selectedDate="+a+"&UTCDate="+i+"&slotLimit="+customerInfo.timeSlot+"&lTZ="+tz+"&advDays="+adavanceDays+"&cusDtWithApptLeadTime="+a;return currentCall=$.ajax({type:"GET",url:"/showWorkinghoursForResource.do",data:l,dataType:"html",async:!1,cache:!1,beforeSend:function(){null!=currentCall&&currentCall.abort()}}).done(function(e){if("No Slots Available"==e&&(o=e),"No Slots Available"!=o){var t=JSON.parse("["+e+"]"),a=t[0].length,i=moment(s).minutes();0!=i&&i<10&&(i="0"+i);var n=i.toString().charAt(i.toString().length-1);"0"==n&&(i=i.toString().charAt(0));for(var r=resourceKey+"_"+moment(s).hours()+"."+i,l=0;l<a;l++)if(r==t[0][l]){o="Available";break}if("Available"!=o)for(var l=0;l<a;l++)if(r!=t[0][l]){o="No Slots";break}}}),o},saveAppointment=function(e,s,t){if($(".confirm_appt").addClass("show-more-content-btn"),e[0].bookedFromFB=window.checkingIframeUrl,e[0].smsStatusCustomer=window.smsStatusCustomer,""==e[0].customer.firstName||null==e[0].customer.firstName||void 0==e[0].customer.firstName)return alert("Customer Name is Empty!"),void location.reload(!0);var a=e[0].appointments[0].AptStartDate,i=pullSlotsForoffHoursFromBookingPage(companyKey,a,serviceDuration,selectedDate,selectedDateUTC);if("No Slots Available"==i||"No Slots"==i)$.alert("This slot is unavailable. Please choose another slot to continue.","We&#x2019;re Sorry!","Okay"),getUpdatedSlots(),removePointerEvent(),$(".yourinfo").hide(),$(".confirmation").hide(),$("#voice-box").hide(),$(".setmore_loading_icon , .loader").hide(),$("#pageBlock, #loading_set, #loading_set #setmore_loading_icon").hide();else{var o={type:"POST",url:"/confirmAppointmentv3.do",data:"jsoncustomer_details="+urlencode(JSON.stringify(e)),dataType:"html",async:!0,cache:!1};makeRequest(o).done(function(a){try{if("Failure"!=a&&"PastTime"!=a){var i=JSON.parse(a);if("true"==i.response){if($("#statusMessage").html(lang.saved),setTimeout("hideStatusMessage()",1e3),$(".global_btn2_lt").hide(),$("#policy_link").hide(),$("#confirm_remainder").hide(),$("h2").html(lang.appt_confirmed),window.isMobile.matches&&$("h2").removeClass("bpAppointmentConfirmed"),"true"==customerInfo.enableBookingId&&$("#confirm_ul").append("<li> <label>"+lang.booking_id+":</label> <span>"+i.bookingId+"</span></li>"),window.connectService.indexOf(i.serviceKey)!=-1&&$("#confirm_ul").append('<li> <label>VIDEO LINK :</label> <span><img alt="" style="top: 3px;position: relative;width: 15px;" src="/bookingpage/images/group.png">  Link will be sent in your confirmation/reminder email.</span></li>'),"true"==isReschedulePage){$(window.parent.document).find("#header-text").html("Please see your rescheduled appointment details below:");var o="",n=$("#date_time_selected");o=0!=n.length?n.html().indexOf(">")!=-1?n.html().split(">")[2].replace("(","").replace(")","").trim():n.html().replace("(","").replace(")","").trim():$("#date_time_selected_cmpy").html().split(">")[2].replace("(","").replace(")","").replace("at ","").trim(),$(window.parent.document).find("#appt_date_and_time").html(o),$(window.parent.document).find("#need_to_reschedule").hide(),$(window.parent.document).find("#booking_url").show(),$(".service_title").html("Appointment Rescheduled")}if(chkShrtBp(),"pymt"==s)return $("#pageBlock, #loading_set, #loading_set #setmore_loading_icon").hide(),null!=t&&"square"==t.gateWayType?void renderPaymentView(e,i,"Appointment",t):1==i.isMultiService?void renderPaymentView(e,i,"Appointment",t):void renderPaymentView(e,i,"Appointment",t);if($("#services-tab").removeClass("srLst").removeClass("srPro").removeClass("srDt").removeClass("srInfo").removeClass("signInFrm").removeClass("srCon").addClass("srBkd"),$(".step_tab > ul").hide(),$(".gt .gt_act").removeClass("confirmCusDetails_tab"),$(".gt .gt_act").addClass("submitapp_tab"),fbbdp||"true"==isReschedulePage||($(".service_title").hide(),$(".bpAppointmentConfirmed").html(lang.appt_confirmed),$(".bpAppointmentConfirmed").show()),fbq("trackCustom","LDP_Purchase",{business_id:companyKey}),void 0!=typeof facebookPage&&"true"==facebookPage)for(var r=0;r<e[0].appointments.length;r++){var l=new Date(e[0].appointments[r].startTimeLong),c=FormatDate(new Date(l.getTime()+companyTimeZoneOffset),"%y-%m-%dT%h:%M:00.000Z");fbq("track","Booking_completed",{reservation_id:i.bookingId,reservation_time:c,type:"Appointment",reservation_size:"1",merchant_id:companyDetails.companyName})}gAnalytics(e,"Appointments",!1),aftrSave()}else if(JSON.parse(a).Error){var d=JSON.parse(a);d.Staff?(delete resourceMap[d.Staff],$.alert(d.message,d.header,"Okay",'<input id="alertOk" type="button" value="Okay" onclick="window.location.reload()">')):d.Service&&(deletedServiceKey=JSON.parse(a).Service,delete serviceCategoryList[deletedServiceKey],$.alert(d.message,d.header,"Okay",'<input id="alertOk" type="button" value="Okay" onclick="window.location.reload()">'))}else $.alert("This slot was just booked and is unavailable. Please choose another slot to continue.","We&#x2019;re Sorry!","Okay"),getUpdatedSlots(),removePointerEvent(),$(".yourinfo").hide(),$(".confirmation").hide(),$("#voice-box").hide(),$("#pageBlock, #loading_set, #loading_set #setmore_loading_icon").hide()}else if("PastTime"==a){console.log("Past Time slots..."),$("#statusMessage").html(lang.sorry_went_wrong),$.alert("This slot has elapsed. Please choose a different time slot to continue.","We&#x2019;re Sorry!","Okay"),window.clientDate=new Date,clientDate.setHours(0,0,0,0);var m=clientDate.getDateInTwoDigits()+"/"+clientDate.getMonthInTwoDigits()+"/"+clientDate.getFullYear(),p=String(m).split("/"),u=new Date(p[2],p[1]-1,p[0]);adavanceDays>0?(clientDate.setDate(clientDate.getDate()+parseInt(adavanceDays)),clientDateToInitiliazeDatePicker.setDate(u.getDate()+parseInt(adavanceDays))):clientDateToInitiliazeDatePicker.setDate(clientDate.getDate()),$("#calendars").DatePickerSetLocalTimeZoneDate(clientDate),calculateRestrictedDate(p),getUpdatedSlots(),removePointerEvent(),$(".yourinfo").hide(),$(".confirmation").hide(),$("#voice-box").hide(),$(".setmore_loading_icon , .loader").hide(),$("#pageBlock, #loading_set, #loading_set #setmore_loading_icon").hide()}else $("#statusMessage").html(lang.sorry_went_wrong),$.alert("This slot was just booked and is unavailable. Please choose another slot to continue.","We&#x2019;re Sorry!","Okay"),getUpdatedSlots(),removePointerEvent(),$(".yourinfo").hide(),$(".confirmation").hide(),$("#voice-box").hide(),$(".setmore_loading_icon , .loader").hide(),$("#pageBlock, #loading_set, #loading_set #setmore_loading_icon").hide()}catch(h){showFailureMessage("jserror","",h)}}).fail(function(a,i,o){console.log(a),a&&a.status&&(i="error"==i?a.status:i);var n=a.responseText,r=/<[a-z][\s\S]*>/i.test(n);$("#pageBlock, #loading_set, #loading_set #setmore_loading_icon").hide();try{if(r||"Failure"==n||"PastTime"==n)retrySaveApptCall(n,i,o,e,s,t);else{var l=JSON.parse(n);if(l.appointmentKey){var c=$("#date_time_selected").html();$.alert("Your appointment with "+companyDetails.companyName+" on "+c+" was booked.","Booking Confirmed","Okay")}else retrySaveApptCall(n,i,o,e,s,t)}}catch(d){showFailureMessage(n,i,o+""+d)}}),createContact(e)}},retrySaveApptCall=function(e,s,t,a,i,o){0!=retrySaveAppt||"500"!=s.toString()&&"503"!=s.toString()?showFailureMessage(e,s,t):(saveAppointment(a,i,o),retrySaveAppt++)},showFailureMessage=function(e,s,t){"jserror"!=e&&$.alert("Your appointment with "+companyDetails.companyName+" was not booked. Please try booking the appointment again.","Booking Unsuccessful!","Try Again"),notifyFrontEndErrorToDev(e,s,t)},notifyFrontEndErrorToDev=function(e,s,t){var a={type:"GET",url:"/notifyFrontEndErrorToDev",data:"xhr="+urlencode(JSON.stringify(e))+"&error="+t+"&errorStatus="+s+"&ckey="+companyKey+"&retry="+retrySaveAppt,async:!0,cache:!1};makeRequest(a).done(function(e){console.info("Sent Error Email"),getUpdatedSlots(),removePointerEvent(),$(".yourinfo").hide(),$(".confirmation").hide(),$("#voice-box").hide(),$(".setmore_loading_icon , .loader").hide()}).fail(function(e,s,t){console.log(" Error while sending mail"+t)})},sMailToCus=function(e){var s={type:"POST",url:"/sendMailOnAppointmentSuccess.do",data:"jsonEmailDetails="+urlencode(JSON.stringify(e)),dataType:"json",async:!0,cache:!1};makeRequest(s).done(function(e){200==e.status&&aftrSave()}).fail(function(e){200==e.status&&aftrSave(),console.log(" Error occured while sending mail"),console.log(e)})},aftrSave=function(){bookAnotherAppt(),showCalBkUrl(),sShareAndFollow(),$("#pageBlock, #loading_set, #loading_set #setmore_loading_icon").hide()},saveClsAppt=function(e,s){$.ajax({type:"POST",url:"/addCustomerToSession",contentType:"application/json",dataType:"json",data:JSON.stringify(e),success:function(e){if(e)if("success"==e.Response){var t=e.data;if($(".loader").hide(),$("#confirm_remainder").hide(),"true"==isReschedulePage&&$(".class_step_tab h2").html(_clsName+" Rescheduled"),"true"==customerInfo.enableBookingId){for(var a=t.customerList,i=t.selectedAttendeeKey,o="",n=0;n<a.length;n++)i===a[n].customerKey&&(o=a[n].bookingId);o&&$("#class_confirm_ul").append("<li> <label>"+lang.booking_id+":</label> <span>"+o+"</span></li>")}if(_classBookingDetails.isVideoEnabled&&$("#class_confirm_ul").append('<li> <label>VIDEO LINK :</label> <span><img alt="" style="top: 3px;position: relative;width: 15px;" src="/bookingpage/images/group.png"> '+lang.video_link_sent_to_mail+"</span></li>"),$("#policy_link, .policyNote").hide(),"true"==isReschedulePage){var r=$("#class_confirm_ul #date_time_selected").html(),l=new CustomEvent("classReschedule",{detail:r});window.parent.document.dispatchEvent(l)}if(e.pdata){var c=e.pdata,d="";if($("#pageBlock, #loading_set, #loading_set #setmore_loading_icon").hide(),1==c.isPayment&&null!=s&&1==s.isPaymentEnabled){for(var n=(classes.length,0);n<classes.length;n++)t.classKey==classes[n].key&&(t.duration=classes[n].duration,t.className=classes[n].title);return $(".class_step_tab h2").html(lang.payment_title),""!=e.sessionId&&(d=e.sessionId),void renderPaymentView(t,c,"ClassAppointment",s,d)}}if($(".class_step_tab ul").hide(),$(".classConfirmed").html(_clsName+" "+lang.confirmed),$(".classConfirmed").show(),$(".class_title").hide(),$(".class_progressBar").css({"margin-bottom":"0px"}),bookAnotherAppt(),showCalBkUrl(),void 0!=typeof facebookPage&&"true"==facebookPage){var m=new Date(e.data.startTimeLong),p=FormatDate(new Date(m.getTime()+companyTimeZoneOffset+6e4*m.getTimezoneOffset()),"%y-%m-%dT%h:%M:00.000Z");fbq("track","Booking_completed",{reservation_id:a[0].bookingId,reservation_time:p,type:"Class",reservation_size:"1",merchant_id:companyDetails.companyName})}gAnalytics("","Classes",!1),$("#classes-tab").removeClass("clsLst").removeClass("clsPro").removeClass("clsDt").removeClass("clsInfo").removeClass("clsCon").removeClass("signInFrm").addClass("clsBkd"),$("#class_progress-icon").removeClass("clsLst").removeClass("clsPro").removeClass("clsDt").removeClass("clsInfo").addClass("clsCon").removeClass("signInFrm"),$("#pageBlock, #loading_set, #loading_set #setmore_loading_icon").hide()}else(e.classError||"failure"==e.Response)&&($("#pageBlock, #loading_set, #loading_set #setmore_loading_icon").show(),$(".classes-container #sc_act").hide(),$("#classes-tab").addClass("clsRebk"),e.message.contains("You can try booking another")?$.alert(lang.try_another_session+" "+companyDetails.companyName+" "+lang.create_new,lang.session_just_filled,"Okay",'<input id="alertOk" type="button" value="Okay" onclick="window.location.reload()">'):$.alert(e.message,e.header,"Okay",'<input id="alertOk" type="button" value="Okay" onclick="window.location.reload()">'))}})},getUpdatedSlots=function(){"true"==_isSkipStaff&&null==staffResourceInfo?showTimingsForAllResources("frmFailureState"):($(".step_tab > h2").html(lang.choose_dateandtime+" ("+shortTimeZone+")"),$(".info > span.step-li").removeClass("done"),$("#progress-icon").show(),$(".gt_act").removeClass("services_tab").removeClass("submitapp_tab").addClass("provider_tab"),$("#progress-icon").removeClass("serviceIcon").removeClass("infoIcon").addClass("appt_dateIcon"),$("#services-tab").removeClass("srLst").removeClass("srPro").removeClass("skipForm").addClass("srDt"),animateProgressBar(),getWorkingHoursForSingleResource(companyKey,clientDate,serviceDuration,selectedDate,selectedDateUTC)),_enabledCustLocalTimeZone&&$(".service_title").html(""),$("#policy_link").hide()},renderPaymentView=function(e,s,t,a,i){s.dateFormatted=dateFormatted,"Appointment"==t?($(".confirmation").hide(),gateWayType=a.gateWayType,s.timeForPayments=timeForPayments,apptDtInLocalTZ&&(s.localTimeForPayments=apptDtInLocalTZ,s.accTimeForPayments=apptDtInAcclTZ),PaymentProcessingView=new app.PaymentProcessingView({el:"#payments-info-holder"}),PaymentProcessingView.render({commonDetails:e,response:s,type:t,gateWayType:gateWayType})):($(".class_confirmation").hide(),gateWayType=a.gateWayType,_classBookingDetails.classLocalTZDate&&(s.classLocalTimeForPayments=_classBookingDetails.classLocalTZDate,s.classAccTimeForPayments=_classBookingDetails.classCompanyTZDate),s.timeForPayments=_classBookingDetails.classDate,PaymentProcessingView=new app.PaymentProcessingView({el:"#class-payments-info-holder"}),isClassSMSAllowed(function(a){PaymentProcessingView.renderClass({classSMS:a,commonDetails:e,response:s,type:t,gateWayType:gateWayType,sessionId:i})}))},getResourcesJDOMap=function(){var e=arguments&&0!=arguments.length?arguments[0]:"";if(""==resourceMap){var s={type:"GET",url:"/getResourcesJDOMap.do",data:"companyKey="+companyKey,contentType:"application/json",dataType:"json",async:!1,cache:!1};makeRequest(s).done(function(s){resourceMap=s,sortedResourceInOrderList(),renderResourceCallBack(e)}).fail(function(e){console.error(" Fails while getting resourceMap ")})}else e&&renderResourceCallBack(e)},renderResourceCallBack=function(e){"isLoadStaff"==e?renderStaff():"isLoadCls"==e?rClsAndCatTab():e===selectedServiceKey?(hideOtherMenusByServiceBpage(),getResources(void 0,selectedServiceKey)):e===selectedClassKey?getClassResources(void 0):"initial_load"===e&&fetchServiceRequest()},sortedResourceInOrderList=function(){for(var e=customerInfo.resourcesInOrder,s=$.map(resourceMap,function(e,s){return s}),t=0;t<customerInfo.resourcesInOrder.length;t++)s.indexOf(customerInfo.resourcesInOrder[t])==-1&&e.splice(t,1);for(var t=0;t<s.length;t++)customerInfo.resourcesInOrder.indexOf(s[t])==-1&&e.push(s[t]);customerInfo.resourcesInOrder=e},getPlanJDOMap=function(){if(""==planJDOMap){var e={type:"GET",url:"/getplanJDOMap.do",data:"companyKey="+companyKey,dataType:"html",async:!0,cache:!1};makeRequest(e).done(function(e){e&&(planJDOMap=JSON.parse(e),"Premium Plan"!=planJDOMap.planName&&"Legacy Plan"!=planJDOMap.planName||($("#TextReminders").show(),$(".textReminder").show()))}).fail(function(e){console.log(" Fail while getting plan Jdo map ")})}},reschCusInfo=function(){if("true"==isReschedulePage&&"class"==apptType&&null!=rescheduleCustomerInfo){$(".class_title").html("Enter Your Information"),$(".class_provider").removeClass("pointer_events");var e={};if($(".classes-container #customerEdit").hide(),""!=rescheduleCustomerInfo.FirstName&&($(".classes-container #first_name").val(htmlDecode(rescheduleCustomerInfo.FirstName)),$(".classes-container #class_cust-IName").val(htmlDecode(rescheduleCustomerInfo.FirstName))),""!=rescheduleCustomerInfo.LastName&&($(".classes-container #last_name").val(htmlDecode(rescheduleCustomerInfo.LastName)),$(".classes-container #class_cust-IName").val(htmlDecode(rescheduleCustomerInfo.FirstName)+" "+htmlDecode(rescheduleCustomerInfo.LastName))),""!=rescheduleCustomerInfo.countryCode){var s=rescheduleCustomerInfo.countryCode;s=s.contains("+")?s:"+"+s,$(".classes-container #class_cust-PhoneNo").intlTelInput("setNumber",s),$(".classes-container #class_cust-countryCode").attr("placeholder","")}if(""!=rescheduleCustomerInfo.MobileNo&&($(".classes-container #phone_num").val(rescheduleCustomerInfo.MobileNo),$(".classes-container #class_cust-PhoneNo").val(rescheduleCustomerInfo.MobileNo)),""!=rescheduleCustomerInfo.LoginId&&($(".classes-container #email").val(rescheduleCustomerInfo.LoginId),$(".classes-container #class_cust-IEmailId").val(rescheduleCustomerInfo.LoginId)),""!=rescheduleCustomerInfo.Address&&($(".classes-container #address").val(htmlDecode(rescheduleCustomerInfo.Address)),$(".classes-container #class_cust-Address").val(htmlDecode(rescheduleCustomerInfo.Address))),""!=rescheduleCustomerInfo.City&&($(".classes-container #city").val(htmlDecode(rescheduleCustomerInfo.City)),$(".classes-container #class_cust-City").val(htmlDecode(rescheduleCustomerInfo.City))),""!=rescheduleCustomerInfo.State&&($(".classes-container #state").val(htmlDecode(rescheduleCustomerInfo.State)),$(".classes-container #class_cust-State").val(htmlDecode(rescheduleCustomerInfo.State))),""!=rescheduleCustomerInfo.Zip&&($(".classes-container #zip").val(rescheduleCustomerInfo.Zip),$(".classes-container #class_cust-Zip").val(rescheduleCustomerInfo.Zip)),rescheduleCustomerInfo.additionalFields&&rescheduleCustomerInfo.additionalFields.value&&""!=rescheduleCustomerInfo.additionalFields.value){e=JSON.parse(rescheduleCustomerInfo.additionalFields.value);var t=[];$.each(e,function(e,s){t.push(e)}),$(".classes-container .customer-details-list").find("input").each(function(){t.indexOf($(this).attr("name"))!=-1&&$(this).attr("id").indexOf("custAdditionalFields")!=-1&&e[$(this).attr("name")]&&$(this).val(htmlDecode(e[$(this).attr("name")]))})}}if(null!=rescheduleCustomerInfo&&null!=rescheudleAppointmentInfo){var e={};if($(".service-container #customerEdit").hide(),""!=rescheduleCustomerInfo.FirstName&&($(".service-container #first_name").val(htmlDecode(rescheduleCustomerInfo.FirstName)),$(".service-container #cust-IName").val(htmlDecode(rescheduleCustomerInfo.FirstName))),""!=rescheduleCustomerInfo.LastName&&($(".service-container #last_name").val(htmlDecode(rescheduleCustomerInfo.LastName)),$(".service-container #cust-IName").val(htmlDecode(rescheduleCustomerInfo.FirstName)+" "+htmlDecode(rescheduleCustomerInfo.LastName))),""!=rescheduleCustomerInfo.countryCode&&($(".service-container #cust-PhoneNo").intlTelInput("setNumber",rescheduleCustomerInfo.countryCode),$(".service-container #cust-countryCode").attr("placeholder","")),""!=rescheduleCustomerInfo.MobileNo&&($(".service-container #phone_num").val(rescheduleCustomerInfo.MobileNo),$(".service-container #cust-PhoneNo").val(rescheduleCustomerInfo.MobileNo)),""!=rescheduleCustomerInfo.LoginId&&($(".service-container #email").val(rescheduleCustomerInfo.LoginId),$(".service-container #cust-IEmailId").val(rescheduleCustomerInfo.LoginId)),""!=rescheduleCustomerInfo.Address&&($(".service-container #address").val(htmlDecode(rescheduleCustomerInfo.Address)),$(".service-container #cust-Address").val(htmlDecode(rescheduleCustomerInfo.Address))),""!=rescheduleCustomerInfo.City&&($(".service-container #city").val(htmlDecode(rescheduleCustomerInfo.City)),$(".service-container #cust-City").val(htmlDecode(rescheduleCustomerInfo.City))),""!=rescheduleCustomerInfo.State&&($(".service-container #state").val(htmlDecode(rescheduleCustomerInfo.State)),$(".service-container #cust-State").val(htmlDecode(rescheduleCustomerInfo.State))),""!=rescheduleCustomerInfo.Zip&&($(".service-container #zip").val(rescheduleCustomerInfo.Zip),$(".service-container #cust-Zip").val(rescheduleCustomerInfo.Zip)),""!=rescheudleAppointmentInfo.Comments&&($(".service-container #comments").val(htmlDecode(rescheudleAppointmentInfo.Comments)),$(".service-container #cust-Comments").val(htmlDecode(rescheudleAppointmentInfo.Comments))),rescheduleCustomerInfo.additionalFields&&rescheduleCustomerInfo.additionalFields.value&&""!=rescheduleCustomerInfo.additionalFields.value){e=JSON.parse(rescheduleCustomerInfo.additionalFields.value);var t=[];$.each(e,function(e,s){t.push(e)}),$(".customer-details-list").find("input").each(function(){t.indexOf($(this).attr("name"))!=-1&&$(this).attr("id").indexOf("custAdditionalFields")!=-1&&e[$(this).attr("name")]&&$(this).val(htmlDecode(e[$(this).attr("name")]))})}}},serSt=function(){null!=currentCall&&(currentCall.abort(),$("#sLoader").hide(),$(".loaderMessage").hide()),nextAvailabilitySlotReq&&nextAvailabilitySlotReq.abort(),requestAbortState=!0,$("#service-back").addClass("back-to-service"),$("#progress-icon").hide(),$(".step_tab > h2").html(choose_a_ser+" "+_customizedSerName),$(".col1 #gt_sr, .side-menu-col1 #gt_sr").addClass("service_tab").removeClass("services_tab").removeClass("provider_tab").removeClass("timeslot_tab").removeClass("payappt_tab"),$(".mobile-navbar").removeClass("active"),$(".provider > span").removeClass("active").removeClass("done"),$(".provider").addClass("pointer_events"),$("#appt_date > span").removeClass("active").removeClass("done"),$("#appt_date").addClass("pointer_events"),$(".info > span").removeClass("active").removeClass("done"),$(".info").addClass("pointer_events"),$(".confirm > span").removeClass("active").removeClass("done"),$(".confirm").addClass("pointer_events"),$("#sp_act").hide(),$("#dateCont").hide(),$("#sc_act").hide(),$(".confirm_appt").hide(),$(".gdpr_info_container").hide(),$(".global_btn2_lt").hide(),$(".bookAnotherAppt").hide(),$(".callBackUrl").hide(),$(".socialButtonLineAndShare").hide(),$("#chs_service_act").show(),$("#progress-icon").removeClass("providerIcon"),chkShrtBp(),$(".service > span.step-li").attr("class","step-li active"),$(".service > span.mobile-navbar").attr("class","mobile-navbar active"),$(".service > span.mobile-navbar").addClass("active"),$(".service > span.mobile-navbar").html('<i class="icon-truck"></i><label>'+_customizedSerName+"<label>"),_isSkipStaff&&$("#progress-icon").addClass("serviceIcon").removeClass("service").removeClass("appt_dateIcon"),$("#login").removeClass("sSkipLogin").removeClass("cSkipLogin"),$(".gt_act").removeClass("signIn_tab").removeClass("eCusDetails_tab").removeClass("confirmCusDetails_tab"),$("#login").hasClass("hidded")&&$("#login").show(),$(".login_details").is(":visible")&&($("#login").hide(),$(".login-icon-div").removeClass("show-login-icon").addClass("hide")),$(".gt_act").hasClass("signIn_tab")||($(".customerLoginContainer").hide(),$(".signIn").removeClass("active")),$("#services-tab").removeClass("srPro").removeClass("srDt").removeClass("signInFrm").removeClass("srInfo").removeClass("srCon").removeClass("srBkd").removeClass("srPay"),$("#services-tab").hasClass("srLst")||$("#services-tab").addClass("srLst"),$("#payments-info-holder").is(":visible")&&removePaymentView(),bookingPolicy("link"),animateProgressBar(),renderSerAndCat()},proSt=function(){null!=currentCall&&(currentCall.abort(),$("#sLoader").hide(),$(".loaderMessage").hide()),$(".map_addr_businesshours").show(),$(".provider > span").hasClass("done")&&null!=staffResourceInfo||($(".provider > span").hasClass("done")&&String(_isSkipStaff).indexOf("true")==-1&&($("#service-back").addClass("back-to-service").removeClass("back-to-provider"),$("#sp_act").show(),$(".step_tab > h2").html(choose_a_pro+" "+_customizedProName),$(".col1 #gt_sr, .side-menu-col1 #gt_sr").removeClass("service_tab").removeClass("timeslot_tab").removeClass("payappt_tab").removeClass("provider_tab").addClass("services_tab"),$(".provider > span").removeClass("active").removeClass("done"),$(".mobile-navbar").removeClass("active"),$("#appt_date > span").removeClass("active").removeClass("done"),$("#appt_date").addClass("pointer_events"),$(".info > span").removeClass("active").removeClass("done"),$(".info").addClass("pointer_events"),$(".confirm > span").removeClass("active").removeClass("done"),$(".confirm").addClass("pointer_events"),$(".global_btn2_lt").hide(),$(".bookAnotherAppt").hide(),$(".callBackUrl").hide(),$(".socialButtonLineAndShare").hide(),$("#dateCont").hide(),$("#sc_act").hide(),$(".confirm_appt").hide(),$(".gdpr_info_container").hide(),$(".global_btn2_lt").hide(),$(".provider > span.mobile-navbar").addClass("active"),$("#progress-icon").removeClass("providerIcon").removeClass("infoIcon").addClass("serviceIcon"),$(".service > .step-li").hasClass("done")||$(".service > .step-li").addClass("done"),$("#progress-icon").removeClass("appt_dateIcon"),$(".gt_act").hasClass("signIn_tab")&&$(".gt_act").removeClass("signIn_tab"),$(".customerLoginContainer").hide(),$("#login").hasClass("hidded")&&($("#login").show(),$(".login-icon-div").removeClass("hide").addClass("show-login-icon")),$(".login_details").is(":visible")&&($("#login").hide(),$(".login-icon-div").removeClass("show-login-icon").addClass("hide")),bookingPolicy("link"),$("#login").removeClass("sSkipLogin").removeClass("cSkipLogin"),$(".gt_act").removeClass("eCusDetails_tab"),$("#services-tab").removeClass("srLst").removeClass("srDt").removeClass("signInFrm").removeClass("srInfo").removeClass("srCon").removeClass("srBkd").removeClass("srPay"),$("#services-tab").hasClass("srPro")||$("#services-tab").addClass("srPro")),animateProgressBar(),$("#payments-info-holder").is(":visible")&&removePaymentView())},appDateSt=function(){$("#appt_date").trigger("click"),validateAndFormatPhNo("#cust-PhoneNo"),"true"==_isSkipStaff||null!=staffResourceInfo?($("#progress-icon").addClass("serviceIcon").removeClass("service").removeClass("appt_dateIcon"),$("#service-back").addClass("back-to-service").removeClass("back-to-provider")):($("#progress-icon").addClass("providerIcon").removeClass("service").removeClass("appt_dateIcon"),$("#service-back").removeClass("back-to-service").addClass("back-to-provider").removeClass("back-to-datePicker"))},infoSt=function(){if($(".info > span").hasClass("done")||$(".info > span").hasClass("active")){if($("#service-back").removeClass("back-to-service").removeClass("back-to-provider").removeClass("back-to-info").addClass("back-to-datePicker"),$("#payments-info-holder").is(":visible")&&($("#payments-info-holder").hide(),removePaymentView()),$(".service-container .continue").hasClass("normalLogin"))$(".step_tab > h2").html(lang.enter_your_information);else if(!$(".signIn").hasClass("active")){var e=$(".service-container #cust-FirstName")&&$(".service-container #cust-FirstName").html()?$(".service-container #cust-FirstName").html():$(".service-container #cust-IName")&&$(".service-container #cust-IName").val()?$(".service-container #cust-IName").val():"";window.isMobile.matches?$(".step_tab > h2").html(lang.hi+" "+e.trim()+", <br/>"+lang.please_review_your_info):$(".step_tab > h2").html(lang.hi+" "+e.trim()+", "+lang.please_review_your_info)}$(".customer-details-list > li > .input-profile-fields").hasClass("inputError")&&$(".customer-details-list > li > .input-profile-fields").removeClass("inputError"),$(".info > span").removeClass("done").removeClass("active"),$(".mobile-navbar").removeClass("active"),$(".confirm").removeClass("pointer_events"),$(".info > span.mobile-navbar").addClass("active"),$("#progress-icon").removeClass("infoIcon").addClass("appt_dateIcon"),$(".confirmation").hide(),$(".service-container #sc_act").show(),$(".service-container .customer-login-form").show(),isWixApp&&wixStepTabCustomerForm($(".customer-login-form").height()+$("#company_name").height()),$(".signIn").hasClass("active")&&($(".info").addClass("pointer_events"),$(".info > span").removeClass("active"),$(".service-container #sc_act").hide(),$(".service-container .customer-login-form").hide()),$("#services-tab").removeClass("srLst").removeClass("srPro").removeClass("srDt").removeClass("signInFrm").removeClass("srCon").removeClass("srBkd").removeClass("srPay"),$("#services-tab").hasClass("srInfo")||$("#services-tab").addClass("srInfo"),$(".gt_act").hasClass("confirmCusDetails_tab")&&($(".gt_act").removeClass("confirmCusDetails_tab"),$(".gt_act").addClass("eCusDetails_tab")),validateAndFormatPhNo("#cust-PhoneNo"),animateProgressBar()}},daysInLang=function(e){return"arabic"!=language&&"hebrew"!=language&&("mon"==e.toLowerCase()?e=lang.mon:"tue"==e.toLowerCase()?e=lang.tue:"wed"==e.toLowerCase()?e=lang.wed:"thu"==e.toLowerCase()?e=lang.thu:"fri"==e.toLowerCase()?e=lang.fri:"sat"==e.toLowerCase()?e=lang.sat:"sun"==e.toLowerCase()&&(e=lang.sun)),e},monthsInOtherLang=function(e){return"arabic"!=language&&"hebrew"!=language&&("jan"==e.toLowerCase()?e=lang.jan:"feb"==e.toLowerCase()?e=lang.feb:"mar"==e.toLowerCase()?e=lang.mar:"apr"==e.toLowerCase()?e=lang.apr:"may"==e.toLowerCase()?e=lang.may:"jun"==e.toLowerCase()?e=lang.jun:"jul"==e.toLowerCase()?e=lang.jul:"aug"==e.toLowerCase()?e=lang.aug:"sep"==e.toLowerCase()?e=lang.sep:"oct"==e.toLowerCase()?e=lang.oct:"nov"==e.toLowerCase()?e=lang.nov:"dec"==e.toLowerCase()&&(e=lang.dec)),e},sortList=function(e){if(e&&!$.isEmptyObject(e)){var s=[],t=[],a=[];s=e.slice(),t=Object.keys(s),t.sort(function(e,t){return e=s[e].longDate,t=s[t].longDate,t-e});for(var i=t.length,o=0;o<i;o++){var n=s[t[o]];n&&a.push(s[t[o]])}e=a}return e},removePointerEvent=function(){$(".service").removeClass("pointer_events"),$(".provider").removeClass("pointer_events"),$(".date").removeClass("pointer_events"),$(".info").removeClass("pointer_events")},removePaymentView=function(){arguments&&0!=arguments.length?PaymentProcessingView.removeClass():PaymentProcessingView.remove()},signout=function(){clearCusSession("signOut")},clearCusSession=function(e){var s={type:"GET",url:"/clearSessionAttributes.do",data:"",dataType:"html",async:!1,cache:!1};makeRequest(s).done(function(s){if(customerLoginFirstName="",customerLoginLastName="",customerEmailId="",sPwd="",customerKey="",cust_emailReminders="",cust_textReminders="",customerProfileImage="",CustomerLoginUserId="",cust_textReminders="",cust_textReminders="",loginType="",e){window.onbeforeunload=null;var t=window.location.href;window.location=t}}).fail(function(e){console.log("Error  :: While Clearing session")})},chkShrtBp=function(){String(isShortBookingPage).indexOf("true")!=-1?$(".map_addr_businesshours").addClass("wordPress"):$(".map_addr_businesshours").show()},setCustInfo=function(e){void 0!==typeof e&&_.isEmpty(reviewerInfo)&&(e.hasOwnProperty("FirstName")?reviewerInfo.FirstName=e.FirstName:reviewerInfo.FirstName=e.custFirstName,e.hasOwnProperty("LastName")&&(reviewerInfo.LastName=e.LastName),void 0!=reviewerInfo.LastName&&reviewerInfo.LastName.contains("amp;")?reviewerInfo.LastName=reviewerInfo.LastName.replace("amp;",""):reviewerInfo.LastName=e.custLastName,void 0!=reviewerInfo.LastName&&reviewerInfo.LastName.contains("amp;")&&(reviewerInfo.LastName=reviewerInfo.LastName.replace("amp;","")),e.hasOwnProperty("LoginId")?reviewerInfo.LoginId=e.LoginId:reviewerInfo.LoginId=e.cusEmail)},setCustomerInfoReviewPopup=function(){if(_.isEmpty(reviewerInfo))$("#customerName,#customerReview,#customerEmail").val("");else{var e=isNullOrEmpty(reviewerInfo.FirstName)?"":reviewerInfo.FirstName,s=isNullOrEmpty(reviewerInfo.LastName)?"":reviewerInfo.LastName,t=isNullOrEmpty(reviewerInfo.LoginId)?"":reviewerInfo.LoginId,a=e+" "+s;isNullOrEmpty(e)||($("#customerName").val(a.trim()),$("#customerName").attr("readonly",!0)),isNullOrEmpty(t)||($("#customerEmail").val(t),$("#customerEmail").attr("readonly",!0))}},isNullOrEmpty=function(e){try{if(e&&("string"==typeof e&&(e=e.trim().toLowerCase()),""!=e&&"null"!=e&&"undefined"!=e))return!1}catch(s){return void console.warn(s.message)}return!0},hTitle=function(e){var s=".service-container",t=".step_tab";if("classes-container"==e&&(s=".classes-container",t=".class_step_tab"),$(s+" .continue").hasClass("normalLogin"))$(t+" > h2").html(lang.enter_your_information);else if($(s+" .continue").hasClass("socialLogin")){var a=$(s+"  #cust-FirstName").html()?$(s+" #cust-FirstName").html():$(s+" #cust-FirstName").html();a=a?a:$(s+"  #cust-IName").val()?$(s+" #cust-IName").val():$(s+" #cust-IName").val(),window.isMobile.matches&&".service-container"==s?$(t+" > h2").html(lang.hi+" "+a.trim()+", <br/>"+lang.please_review_your_info):$(t+" > h2").html(lang.hi+" "+a.trim()+", "+lang.please_review_your_info);
}},hideProTab=function(){"true"!=_isSkipStaff&&null==staffResourceInfo||($(".class_provider").hide(),$(".class_provider").next().hide(),$(".class_step_tab ul li").css({padding:"5px","line-height":"38px"}),$(".provider").hide(),$(".provider").next().hide(),$(".provider > span.step-li").removeClass("done"),$(".step_tab ul li").css({padding:"5px","line-height":"38px"}))},showLoginButton=function(){$("#gt_sr").hasClass("payappt_tab")||($(".customerLoginContainer").removeClass("login-container"),"true"==customerInfo.thirdPartyLogin&&$(".login_details").is(":visible")?($(".customerLoginContainer").show(),$("#login").hide(),$(".login-icon-div").addClass("hide").removeClass("show-login-icon")):"true"==customerInfo.thirdPartyLogin&&"false"===isReschedulePage&&"true"!=facebookPage&&($(".customerLoginContainer").hide(),$("#login").show(),$(".login-icon-div").addClass("show-login-icon").removeClass("hide"),$(".login-icon-div img").show()))},compressText=function(e){var s="";s=e.contains("class")?$(e).find("span.class_step-li"):$(e).find("span.step-li");var t=s,a=7,i=t.html(),o=i.substr(0,a);i=o+"...",t.html(i)},cust_notes_count=function(e){var s=$(".yourinfo #cust-Comments")[0].value.length;$(".serviceComments").text(500-s)},editApptPopup=function(e){$("#"+e).parent().parent().parent().siblings().find(".editApptPopup").hide(),$("#"+e).show(),$("#"+e+"_key").show()},popitup=function(e){var s=800,t=600,a=screen.width/2-s/2,i=screen.height/2-t/2,o=null!=customerName&&""!=customerName?window.open(e+"?key="+companyKey+"&customerName="+customerName,"Oauth","height="+t+",width="+s+" , top="+i+",left="+a):window.open(e+"?key="+companyKey,"Oauth","height="+t+",width="+s+" , top="+i+",left="+a);return window.focus&&o.focus(),!1},bindWindowScroll=function(){$(window).scroll(function(){positionDetailsHolder()})},positionDetailsHolder=function(){$(window).scrollTop()>50?$(".displaying").addClass("fixedDet"):$(".displaying").removeClass("fixedDet")},showPopup=function(){$("#pageBlock").show(),$("#pageBlock").css({opacity:"0"}),$("#rating").children().first().addClass("icon-star-empty-active"),$("#rating").attr("value","5"),setCustomerInfoReviewPopup(),$(".reviewPopup").show()},setRating=function(e){var s=$(e).attr("index");$(".icon-star-empty").removeClass("icon-star-empty-active"),$(e).addClass("icon-star-empty-active"),$("#rating").attr("value",s)},showDetailedDes=function(e){$(window).width()>769&&(String(isShortBookingPage).indexOf("false")!=-1?($(e).removeClass("slctd").find("div.list_dtl").addClass("displaying").show(),$("#"+e.id).find(".list_dtl > img").attr("src",$("#"+e.id).find(".list_dtl > img").attr("imagesrc")),0==customerInfo.branding&&$(e).find(".staff_det_popup").css({top:"45px"}),positionDetailsHolder()):$(".hover-arrow").hide())},hideDetailedDes=function(e){String(isShortBookingPage).indexOf("false")!=-1?($("div.list_dtl").removeClass("displaying"),$(e).removeClass("slctd").find("div.list_dtl").addClass("displaying").hide()):$(".hover-arrow").hide()},showValidationAletMsg=function(e){document.getElementById("statusMessage").innerHTML=e,document.getElementById("voice-box").setAttribute("status","saving"),$("#voice-box").fadeIn(300),document.getElementById("statusMessage").innerHTML=e,document.getElementById("voice-box").setAttribute("status","saved"),setTimeout("hideStatusMessage()",1750)},hideStatusMessage=function(){"saved"==document.getElementById("voice-box").getAttribute("status")&&$("#voice-box").fadeOut(300)},compressName=function(e,s,t,a){var i=htmlDecode(e),o=i.length;return e=o>s?i.substring(0,s)+"..":i,o>s&&(t.tipsy({gravity:a}),t.attr("original-title",htmlDecode(i))),e},applyToolTip=function(){void 0!=customerInfo.enableLocalTimezone&&"true"!=customerInfo.enableLocalTimezone||window.isMobile.matches||$(".morning > li , .afternoon > li , .evening > li").tipsy({gravity:"n"})},animateProgressBar=function(){var e=null!=staffResourceInfo||"true"==_isSkipStaff?30:15;if(null==staffResourceInfo&&"true"!=_isSkipStaff||$(".step_tab ul li.provider span").removeClass("done"),arguments[0]){var s=$(".class_done").length*(78+e);$("#class_progressStatus").animate({width:s+"px"})}else{var s=$(".done").length*(78+e);$("#progressStatus").animate({width:s+"px"})}},makeRequest=function(e){return $.ajax({type:e.type,url:e.url,data:e.data,dataType:e.dataType,async:!e.async||e.async,cache:!!e.cache&&e.cache})},getLocationBasedTimeZone=function(){if(_enabledCustLocalTimeZone){var e;try{e=jstz.determine()}catch(s){"undefined"==typeof Intl&&(window.Intl=void 0,e=jstz.determine())}custLoTZ=e.name();var t={type:"GET",url:"/getLocationBasedTimeZone.do",data:"companyTimeZone="+companyDetails.timezone+"&cLocalTZ="+custLoTZ,dataType:"html",async:!0,cache:!1};makeRequest(t).done(function(e){if(e){timeZoneObj=JSON.parse(e);var s=timeZoneObj.localTimeZoneObj;_selectedTimeZone=s.timeZoneID,_selectedTimeZoneOffSet=s.timeZoneOffset,_seletedTimeZoneFullName=s.timeZoneFullName;var t=timeZoneObj.companyTimeZoneObj.timeZoneID,a=timeZoneObj.companyTimeZoneObj.timeZoneShortName;customerInfo.enableLocalTimezone&&(a=timeZoneObj.localTimeZoneObj.timeZoneShortName,t=timeZoneObj.localTimeZoneObj.timeZoneID,_selectedTimeZone=timeZoneObj.localTimeZoneObj.timeZoneID),EventResources.classTimeZoneId=t,EventResources.timezoneId=t,totalRestrictedDates&&timeZoneObj.companyTimeZoneObj.timeZoneID!=timeZoneObj.localTimeZoneObj.timeZoneID&&_selectedTimeZoneOffSet!=companyTimeZoneOffset&&restrictAfterThisDate.setDate(restrictAfterThisDate.getDate()+1),$(".selectedTZ").html(_selectedTimeZone),$(".selectedTZ").attr("index",t),getAllTimeZones()}}).fail(function(e){console.log("Error  :: While fetching the customer local timezone")})}else EventResources.timezoneId=getTimeZone(companyDetails.timezone),EventResources.classTimeZoneId=EventResources.timezoneId},getAllTimeZones=function(){_enabledCustLocalTimeZone&&$.ajax({type:"GET",url:"/getAllTimeZones.do",success:function(e){if(e){allTimeZones=e;for(var s=timeZoneObj.localTimeZoneObj.timeZoneOffset!=companyTimeZoneOffset?'<li class="tz-lst"><a href="javascript:void(0);" style="font-weight: 800;" class="localTimeZone" index="'+timeZoneObj.localTimeZoneObj.timeZoneID+'">'+timeZoneObj.localTimeZoneObj.timeZoneFullName+'</a></li><li class="tz-lst hide" id="cmpyTZ"><a href="javascript:void(0);" style="font-weight: 800;" id="companyTimezone" class="companyTimezone" index></a></li>':'<li class="tz-lst hide" id="cmpyTZ"><a href="javascript:void(0);" style="font-weight: 600;" id="companyTimezone" class="companyTimezone" index="'+timeZoneObj.localTimeZoneObj.timeZoneID+'">'+timeZoneObj.localTimeZoneObj.timeZoneFullName+"</a></li>",t=allTimeZones.length,a=0;a<t;a++){var i="";timeZoneObj.localTimeZoneObj.timeZoneID!=allTimeZones[a].timeZoneID||timeZoneObj.localTimeZoneObj.timeZoneOffset==companyTimeZoneOffset?timeZoneObj.companyTimeZoneObj.timeZoneID!=allTimeZones[a].timeZoneID?s+='<li class="tz-lst"><a href="javascript:void(0);" class="'+i+'" index="'+allTimeZones[a].timeZoneID+'">'+allTimeZones[a].timeZoneFullName+"</a></li>":i="companyTimezone":i="localTime"}$(".tz-dropdown-menu").html(s),$(".cls-tz-dropdown-menu").html(s),tzEvents(),chooseTZEvent()}}})},pullBookingSettings=function(){bookingSettings=null,$.ajax({type:"GET",url:"/slots/v1/bookingsettings/get/"+companyKey,success:function(e){console.log(e),bookingSettings=e.data.bookingSettings},error:function(e,s,t){console.log(e.responseText)}})},getSquareAuthInfo=function(){$.ajax({type:"POST",url:"/getPaymentAuthInfoForSquare",data:{companyKey:companyKey},success:function(e){if(e){var s=JSON.parse(e);window.squareLocationId=s.defaultLocationID}}})},bindEventsAndOtherProbTab=function(){EventResources.isEventBinded=!0,customerLogin(),updateCompanyDetails(),hComAndStaffName(),bindWindowScroll(),buildAddFields(),showOrHideTabs(),hideProTab(),0==isReschedulePage&&reschedulePage(),null!=PaymentBookingPolicy&&1==PaymentBookingPolicy.isPaymentEnabled&&"square"==PaymentBookingPolicy.gateWayType&&getSquareAuthInfo(),events(),getPlanJDOMap(),customLabelAndForm()},fetchCompanyDependencies=function(){$.ajax({url:"/fetchCompanyDependencies/"+companyKey,type:"GET",contentType:"application/json"}).done(function(e){e&&"invalid_request"!==e.error&&(window.connectService=e.data.connect_service_list,window.connectClass=e.data.connect_class_list,EventResources.isClsInMigration=!e.data.provision_enabled||e.data.in_cls_migration),renderPageByRequest()}).fail(function(e,s,t){console.error("While fetching company dependencies"),renderPageByRequest()})},fetchServiceRequest=function(){_disabledTabs&&(_disabledTabs.indexOf("bookAppt")==-1&&_disabledTabs.indexOf("bookClass")!=-1||_disabledTabs.indexOf("services")==-1&&window.location.pathname.contains("services")||_disabledTabs.indexOf("bookAppt")==-1&&_disabledTabs.indexOf("bookClass")==-1||_disabledTabs.indexOf("bookAppt")!=-1&&window.location.pathname.contains("bookappointment"))&&!window.location.pathname.toLowerCase().contains("class")?fetchCompanyServiceDetails():fetchCompanyClassesDetails()},renderPageByRequest=function(){window.location.pathname.contains("aboutus")||window.location.pathname.contains("reviews")||window.location.pathname.contains("photos")?(EventResources.isEventBinded||bindEventsAndOtherProbTab(),changeLocation(),getResourcesJDOMap(),$(".bookingpage_loader").hide()):getResourcesJDOMap("initial_load"),map.callMap()},fetchCompanyServiceDetails=function(e,s){"null"===selectedServiceKey?fetchAllServicesByCompany(e,s):fetchServiceByKey(e,s,selectedServiceKey)},fetchAllServicesByCompany=function(e,s){EventResources.servFetchInProcess?fetchServiceCallBack(e,s,EventResources):(bkPolicy("serv"),EventResources.isServiceFetched?fetchServiceCallBack(e,s,EventResources):initiateServicesFetch(e,s,""))},fetchServiceByKey=function(e,s,t){EventResources.servFetchInProcess?fetchServiceCallBack(e,s,EventResources):(bkPolicy("serv"),EventResources.isServiceFetched?fetchServiceCallBack(e,s,EventResources):initiateServiceFetchByKey(e,s,t))},initiateServiceFetchByKey=function(e,s,t){EventResources.servFetchInProcess=!0,$.ajax({url:"/fetchService/"+t,type:"GET",contentType:"application/json"}).done(function(t){t&&"invalid_request"!==t.error&&(EventResources.serviceList=_.extend(EventResources.serviceList,t.data.service),initiateServiceCategoryFetch(e,s,"",EventResources))}).fail(function(e,s,t){fetchErrorCallBack("Services Fetch",s,t)})},initiateServicesFetch=function(e,s,t){EventResources.servFetchInProcess=!0,$.ajax({url:"/fetchServices/"+companyKey+"?cursor="+t+"&range="+EventResources.range,type:"GET",contentType:"application/json"}).done(function(t){t&&"invalid_request"!==t.error&&(EventResources.serviceList=_.extend(EventResources.serviceList,t.data.servicesList),null!==t.data.cursor?initiateServicesFetch(e,s,t.data.cursor):initiateServiceCategoryFetch(e,s,"",EventResources))}).fail(function(e,s,t){fetchErrorCallBack("Services Fetch",s,t)})},initiateServiceCategoryFetch=function(e,s,t,a){$.ajax({url:"/fetchServiceCategories/"+companyKey+"?cursor="+t+"&range="+a.range,type:"GET",contentType:"application/json"}).done(function(t){t&&"invalid_request"!==t.error&&(a.serviceCategoryList=_.extend(a.serviceCategoryList,t.data.categoryList),null!==t.data.cursor?initiateServiceCategoryFetch(e,s,t.data.cursor,a):(a.isServiceFetched=!0,a.servFetchInProcess=!1,fetchServiceCallBack(e,s,a)))}).fail(function(e,s,t){fetchErrorCallBack("Category Fetch by Keys",s,t)})},fetchServiceCallBack=function(e,s,t){return categoryList=t.serviceCategoryList,serviceCategoryList=t.serviceList,t.isEventBinded||bindEventsAndOtherProbTab(),"true"===isReschedulePage?(reschedulePage(),void $(".bookingpage_loader").hide()):("undefined"!=typeof s&&s?serviceRenderCallBack(e):changeLocation(),void $(".bookingpage_loader").hide())},fetchCompanyClassesDetails=function(e,s){EventResources.isClsInMigration?fetchReqOnClasses(e,s,EventResources):fetchReqOnClsInventory(e,s,EventResources)},fetchReqOnClasses=function(e,s,t){var a="companyKey="+companyKey;isStaffBookingPage&&"false"!=isStaffBookingPage&&(a="companyKey="+companyKey+"&isStaffBookingPage="+isStaffBookingPage+"&resourceKey="+staffResourceInfo.key),"true"==isReschedulePage&&"class"==apptType&&(a+="&reschedule=true&apptType="+apptType+"&classKey="+rescheduleClassKey+"&resourceKey="+rescheduleResourceInfo.key);var i={type:"POST",url:"/fetchAllClasses",data:a,dataType:"html",async:!0,cache:!1};makeRequest(i).done(function(a){if($(".bookingpage_loader").hide(),a){var i=JSON.parse(a);null!=i.integrationDetails&&""!=i.integrationDetails&&void 0!=i.integrationDetails?window.connectService=JSON.parse(JSON.parse(i.integrationDetails).metaData.value).servicelist:window.connectService=[];var o=JSON.parse(i.classesDetails);t.classesList="success"==o.Response?o.data:[],t.classCategoryList=JSON.parse(i.classCategories),fClsRes=JSON.parse(i.fClsRes),_fClsResMap=null!=fClsRes&&"null"!=fClsRes?fClsRes:{},classesFetchCallBack(e,s,t)}})},fetchReqOnClsInventory=function(e,s,t){if(t.clsFetchInProcess)classesFetchCallBack(e,s,t);else if(bkPolicy("cls"),t.isClsFetched)classesFetchCallBack(e,s,t);else if("true"==isReschedulePage&&"class"==apptType||"null"!==selectedClassKey){var a=getClassKeyFromRequest();fetchClassInventoryByClsKey(a)}else fetchClassInventory(e,s,"")},fetchClassInventoryByClsKey=function(e){EventResources.clsFetchInProcess=!0,$.ajax({url:"/slots/v1/inventories/"+e,type:"GET"}).done(function(e){e&&$(".bookingpage_loader").show(),initiateInventoryReport(void 0,void 0,e,e.data.cursor)}).fail(function(e,s,t){fetchErrorCallBack("Inventory Fetch",s,t)})},fetchClassInventory=function(e,s,t){EventResources.clsFetchInProcess=!0,$.ajax({url:"/slots/v1/inventories/"+companyKey+"/0?cursor="+t+"&limit="+EventResources.range,type:"GET"}).done(function(t){t&&$(".bookingpage_loader").show(),initiateInventoryReport(e,s,t,t.data.cursor)}).fail(function(e,s,t){fetchErrorCallBack("Inventory Fetch",s,t)})},initiateInventoryReport=function(e,s,t,a){_.each(t.data.classes,function(e,s){EventResources.classCategoryKeys=_.union(EventResources.classCategoryKeys,e.categoryKeys),EventResources.classKeys.push(e.key),createStaffInventory(JSON.parse(e.staffAvailability),e.key)}),t.data.classes.length>0&&t.data.classes.length==EventResources.range?fetchClassInventory(e,s,a):initiateClassCategoryFetch(e,s,EventResources)},createStaffInventory=function(e,s){var t=!1;if(_.isEmpty(staffResourceInfo)&&_.isEmpty(rescheduleResourceInfo))buildStaffInventory(e,s);else{var a={};_.isEmpty(staffResourceInfo)||(a=staffResourceInfo),_.isEmpty(rescheduleResourceInfo)||(a=rescheduleResourceInfo);var i={};_.isEmpty(rescheduleSessionKey)||_.each(e,function(e,s){var t=[];_.each(e,function(e,s){e.indexOf(rescheduleSessionKey)>-1&&t.push(s)}),_.isEmpty(t)||delete e[t[0]]}),_.each(e,function(e,s){s!==a.key||_.isEmpty(e)||(i[s]=e,t=!0)}),t?buildStaffInventory(i,s):EventResources.classKeys.pop(s)}},buildStaffInventory=function(e,s){var t={},a=[];_.each(e,function(e,t){a.push(t);var i={},o=EventResources.staffInventoryCollection.findWhere({key:t});if(i[s]=e,o)o.get("times").push(i);else{var n={};n.times=[],n.key=t,n.times.push(i),o=new StaffClassInventory(n)}EventResources.staffInventoryCollection.add(o)}),t[s]=a,EventResources.clsStaffKeysList.push(t)},initiateClassCategoryFetch=function(e,s,t){var a=_.uniq(t.classCategoryKeys),i=50,o=_.groupBy(a,function(e,s){return Math.floor(s/i)}),n=Object.keys(o).length,r=0;return _.isEmpty(o)?(renderClasses(),void $(".bookingpage_loader").hide()):void $.each(o,function(a,i){$.ajax({url:"/fetchClassCategorysByKeys",type:"POST",data:JSON.stringify(i),contentType:"application/json"}).done(function(a){r+=1,t.classCategoryList=_.union(t.classCategoryList,JSON.parse(a)),r===n&&initiateClassesFetch(e,s,t)}).fail(function(e,s,t){fetchErrorCallBack("Class Category Fetch",s,t)})})},renderDefaultMsgClass=function(){"true"==isReschedulePage?$(".classes-container").html("<div><p>"+lang.no_session_available+"</p></div>"):$(".classes-container").html("<div><p>"+lang.booking_class_unavailable+"</p></div>"),$(".classes-container").show(),$(".classes-container").addClass("noServices"),$(".col1 > .nav>li.gt_cls, .side-menu-col1 > .nav>li.gt_cls").addClass("active"),updateCompanyDetails(),isStaffBookingPage&&location.href.indexOf("reschedule")==-1&&hComAndStaffName(),$("#policy_link, .policyNote").hide(),$(".bookingpage_loader").hide()},initiateClassesFetch=function(e,s,t){var a=_.uniq(t.classKeys),i=50,o=_.groupBy(a,function(e,s){return Math.floor(s/i)}),n=Object.keys(o).length,r=0;return $.isEmptyObject(o)?void renderDefaultMsgClass():void $.each(o,function(a,i){$.ajax({url:"/fetchClassesByKeys",type:"POST",data:JSON.stringify(i),contentType:"application/json"}).done(function(a){r+=1,t.classesList=_.union(t.classesList,JSON.parse(a)),r===n&&(t.isClsFetched=!0,t.clsFetchInProcess=!1,classesFetchCallBack(e,s,t))}).fail(function(e,s,t){fetchErrorCallBack("Classes Fetch",s,t)})})},classesFetchCallBack=function(e,s,t){_classsCategoryOrder=[],classes=t.classesList,classesCategoryList=t.classCategoryList;for(var a=[],i=0;i<classesCategoryList.length;i++)"All Class Bookings"!=classesCategoryList[i].categoryName&&a.push([classesCategoryList[i].key,classesCategoryList[i].categoryOrder]);if(a.sort(function(e,s){return e[1]-s[1]}),a)for(var o=0;o<a.length;o++)for(var i=0;i<a[o].length;i++)_classsCategoryOrder.push(a[o][i]);return t.isEventBinded||bindEventsAndOtherProbTab(),"true"===isReschedulePage?(reschedulePage(),void $(".bookingpage_loader").hide()):("undefined"!=typeof s&&s?classRenderCallBack(e):changeLocation(),void $(".bookingpage_loader").hide())},fetchErrorCallBack=function(e,s,t){$(".bookingpage_loader").hide(),console.log(e+" : "+s+" : "+t)},getLabelsWidth=function(){labels=document.querySelectorAll("#confirm_ul label, .reminder-title")},findMaxLabelsWidth=function(){labels&&labels.length>0&&(labels.forEach(function(e){return labelsArr.push(e.clientWidth)}),maxLabelWidth=Math.max.apply(Math,labelsArr))},setLabelsWidth=function(){labels&&labels.length>0&&labels.forEach(function(e){return e.style.width=maxLabelWidth})},changeLabelWidth=function(){getLabelsWidth(),findMaxLabelsWidth(),setLabelsWidth()},instaFix=function(){var e=navigator.userAgent.toLowerCase();1==(e.includes("iphone")&&e.includes("instagram")&&window.innerHeight<900)&&document.body.classList.add("insta-fix")},offsetDescPopup=function(){var e,s,t;if(window.innerWidth<=1199){t=document.querySelectorAll(".staff_det_popup"),e=document.querySelector(".col2"),s=64.5*e.clientWidth/100,serviceDescOffset=535.5-s;for(var a=0;a<t.length;a++)t[a].style.marginLeft=568-serviceDescOffset+"px"}},setFormattedNumber=function(e,s){var t=$(e).intlTelInput("getSelectedCountryData").iso2,a="+"+$(e).intlTelInput("getSelectedCountryData").dialCode,i=$(e).val();$(e).val(formatPhoneNumber(a,i,t,s))},detectTag=function(e,s){for(var t,a,i="";;){if(i=s.exec(e),null==i){t=e.substring(0,150),a=e.substring(150);break}if(!(i.index<150)){t=e.substring(0,150),a=e.substring(150);break}t=e.substring(0,i.index),a=e.substring(i.index)}return[t,a]},adjustServiceImgAndNameAlignment=function(e){if(customerInfo.showLabel&&String(customerInfo.showLabel).indexOf("servicename")==-1&&customerInfo.showLabel&&String(customerInfo.showLabel).indexOf("price")==-1&&1==window.isMobile.matches)for(var s=0;s<e.length;s++){var t=$(e[s]).find(".service__name").height();(t<=20&&0!=t||t<=23&&0!=t&&0!=connectService)&&$(e[s]).find(".service__name").css("padding-top","8px")}};return this.init=function(){"https:"!=location.protocol&&"LOCALHOST"!=APP_MODE&&(location.href="https:"+window.location.href.substring(window.location.protocol.length)),pullBookingSettings(),redirectProtocolForIEBrw(),getLocationBasedTimeZone(),$(".bookingpage_loader").show(),fetchCompanyDependencies(),instaFix(),$("input[phoneNumberFormat = 'true'] ").on("blur",function(){validateAndFormatPhNo($(this))})}(),{getCusContDtls:getCusContDtls,cusNotesCount:cust_notes_count,showValidationAletMsg:showValidationAletMsg,bookAnotherAppt:bookAnotherAppt,showCalBkUrl:showCalBkUrl,clsName:_clsName,gAnalytics:gAnalytics,createStaffInventory:createStaffInventory,saveAppointment:saveAppointment,validateAndFormatPhNo:validateAndFormatPhNo}}(),app=app||{};!function(e){app.PaymentProcessingModel=Backbone.Model.extend({url:function(){return this.newUrl},initialize:function(e){this.newUrl=e.url},defaults:{cardCvv:"",cardExp:"",cardName:"",cardNumber:"",lineItem:[],amount:"10"}})}(jQuery),window.channels={},window.message={},window.syncappt={},window.notificationApptMap={added:{},updated:{},deleted:{}},notificationApptMap.message=[],PaymentNotifications={socketMaxTryAttepts:3,socketTryNo:0,getToken:function(e,s){this.paymentView=s;var t=this;console.log(companyDetails);void 0!=companyDetails.key?companyDetails.key:companyKey;return channels.clientID=e+"__bookingpage",$.ajax({type:"POST",url:"/getTokenPaypal",dataType:"text",data:"AccountID="+channels.clientID,success:function(e){if(console.log(e),channels.token=e,channels.socket)try{channels.socket.close()}catch(s){console.log("channels.socket.close();"),console.log(s.message)}t.socketTryNo++,"failure"!=e&&t.openChannel()}}),t},openChannel:function(){if(PaymentNotifications.socketError={},!channels.sync){var e=new goog.appengine.Channel(channels.token);channels.socket=e.open(),channels.socket.onopen=this.onSocketOpen,channels.socket.onmessage=this.onSocketMessage,channels.socket.onerror=this.onSocketError,channels.socket.onclose=this.onSocketClose}},onSocketError:function(e){channels.sync=!1,console.log("booking page for paypal is out of Sync"),$("#sync-status").setmoreSlider({defaultState:"no"}),console.log(e),PaymentNotifications.resetClock(),PaymentNotifications.socketError=e},onSocketClose:function(){channels.sync=!1,console.log("Socket Connection closed"),$("#sync-status").setmoreSlider({defaultState:"no"}),PaymentNotifications.resetClock()},onSocketOpen:function(){var e=this;channels.sync=!0,$("#connectingchannel").hide(),console.log("Calender is in Sync"),$("#sync-status").setmoreSlider({defaultState:"yes"}),$("#sync-status").unbind("click").click(function(){channels.sync?channels.socket.close():(console.log(e),PaymentNotifications.getToken())})},onSocketMessage:function(e){if(e){message=JSON.parse(e.data),console.log("channel for paypal booking page received"+message);var s=message.type.toLowerCase();switch(console.log("channel for paypal booking page msg_type"+s),s){case"paypalbookingpage":PaymentProcessingView.channelMessage(message);break;case"paypalclassbookingpage":PaymentProcessingView.channelMessageClass(message);break;default:console.log("Invalid message type")}}},resetClock:function(){this.Lclock=this.LclockC},ClockSet:function(){this.LclockC=10,this.clock=0,this.Lclock=this.LclockC,this.setClock=setInterval(function(){!channels.sync,PaymentNotifications.clock==PaymentNotifications.Lclock&&(PaymentNotifications.Lclock=PaymentNotifications.LclockC,channels.sync||console.log("Auto sync ")),PaymentNotifications.Lclock--,PaymentNotifications.socketTryNo==PaymentNotifications.socketMaxTryAttepts&&(clearInterval(PaymentNotifications.setClock),console.log("Interval cleared"))},1e3)}};var app=app||{};!function(e){app.PaymentProcessingView=Backbone.View.extend({options:{},paymentDone:!1,timerInterval:"",events:{"keypress #payment-card-number":"preventWordsInput","keyup #payment-card-number":"checkAndSetCardNum","keypress #payment-card-mmyy":"preventWordsInput","keyup #payment-card-mmyy":"checkAndSetCardExp","keypress #payment-card-cvv":"preventWordsInput","keyup #payment-card-cvv":"checkAndSetCardCVV","change #payment-card-number":"checkAndSetCardNum","change #payment-card-mmyy":"checkAndSetCardExp","change #payment-card-cvv":"checkAndSetCardCVV","click #pay-now":"processPayments","click #nonce-request":"createNounce","click #chargeRequest":"requestForCharge","click #chargeRequestSca":"processPaymentsSca","click #chargeRequestClassSca":"processPaymentsSca","click #chargeRequestForClass":"requestForClassCharge","click #skip-Payment":"showConfirmBox","click #skip-Payment-mulSer":"showMulSerConfirmBox","click #skip-payment-appt":"skipPayment","click #cancel-Payment":"cancelAppointment","click #cancel-mulSerPayment":"cancelMultipleService","focus #payment-card-det-holder > input":"removeErrorFocus","focus #payment-card-name":"removeErrorFocus","keypress #class-payment-card-number":"preventWordsInput","keyup #class-payment-card-number":"checkAndSetCardNum","keypress #class-payment-card-mmyy":"preventWordsInput","keyup #class-payment-card-mmyy":"checkAndSetCardExp","keypress #class-payment-card-cvv":"preventWordsInput","keyup #class-payment-card-cvv":"checkAndSetCardCVV","change #class-payment-card-number":"checkAndSetCardNum","change #class-payment-card-mmyy":"checkAndSetCardExp","change #class-payment-card-cvv":"checkAndSetCardCVV","focus #class-payment-card-det-holder > input":"removeErrorFocus","focus #class-payment-card-name":"removeErrorFocus","click #pay-class-now":"processPayments","click #cancel-class-payment":"cancelClassSession","click #skip-class-payment":"showClassConfirmBox","click #message_remainder_check":"getReminderValue","click #dasButton, #div1, #div2":"mobileButtonAction","click input[type='radio']":"switchApptConfirmationOptions","click #paymentOptionHolder_newDiv, #skip-div":"switchApptConfirmationOptions","click #show-edit-popup":"showPaymentEditOption","click #continue-booking":"hidePaymentEditPopup","click #start-over-again":"startOverAgain","click #reminder-toggle-card":"switchCardSlider","click #reminder-toggle-skip":"switchSkipSlider"},initialize:function(){},render:function(s){this.options=s,type=this.options.type,apptObj=this,e(".service-container #sc_act").hide(),e(".service-container .customer-login-form").hide(),e("#payments-info-holder").show(),gateWayType=this.options.gateWayType;var t=this.options.response.paymentType;if(1==s.response.isMultiService){var a=this.getViewDataForMultipleservice();"square"==gateWayType?(this.$el.html(_.template(e("#squarePayment-input-template").html(),a)),this.sqPaymentForm(type)):(this.$el.html(_.template(e("#payment-input-template1").html(),a)),this.setWindowSizeFilter()&&(e(".step_tab").hide(),this.intializeCardView()),scaEnabled&&"stripe"==PaymentBookingPolicy.gateWayType&&this.loadStripeElement(type)),e(".service_title").html(lang.payment_title),fbbdp&&(document.title=lang.payment_title)}else{var a=this.getViewDataByPaymentType(t);a.gateWayType=gateWayType,a.multiAppt=!1,"square"==gateWayType?(this.$el.html(_.template(e("#squarePayment-input-template").html(),a)),this.sqPaymentForm()):(this.$el.html(_.template(e("#payment-input-template").html(),a)),this.setWindowSizeFilter()&&(e(".step_tab").hide(),this.intializeCardView()),scaEnabled&&"stripe"==PaymentBookingPolicy.gateWayType&&this.loadStripeElement(type))}this.showtimerAndManageReload(gateWayType),this.options.viewData=a,"paypal"==gateWayType&&this.proceedWithPayPal(),e(".gdpr_info_container.payment").show()},mobileButtonAction:function(s){var t=e("#dasButton").attr("value");s.stopPropagation(),"Expand"==t?(e("#div1").animate({height:"150px"},1),document.getElementById("div1").style.border="1px solid #cfcfcf",document.getElementById("div1").style.padding="8px 2px 2px 12px",e("#dasButton").attr("value","Reduce"),e("#div2").hide()):"Reduce"==t&&(e("#div1").animate({height:"0px"},10),document.getElementById("div1").style.padding="0px 0px 0px 0px",document.getElementById("div1").style.border="0px solid white",e("#dasButton").attr("value","Expand"),e("#div2").show())},switchApptConfirmationOptions:function(){e("#email-reminder").val("true"),e("#sms-reminder").val("true");var s=e("input[name='paymentPageRadio']:checked").val(),t=e("."+s);if(e(".confirm-option").not(t).hide(),e(t).show(),"skip-payment"==s){document.getElementById("paymentOptionHolder_newDiv").style.padding="12px 24px 12px 12px";var a=e(".card-skip-option");e(".confirm-appt-option").not(t).hide(),e(a).show()}else{document.getElementById("paymentOptionHolder_newDiv").style.padding="12px 24px 12px 12px";var a=e(".card-payment-option");e(".confirm-appt-option").not(t).hide(),e(a).show()}},intializeCardView:function(){var s="card-payment",t=e("."+s);e(".confirm-option").not(t).hide(),e(t).show(),e("#paymentOption").prop("checked",!0);var a=e(".card-payment-option");e(".confirm-appt-option").not(t).hide(),e(a).show()},switchCardSlider:function(){var s=e("#reminder-toggle-card").attr("value");"enabled"==s?(e("#reminder-toggle-card").attr("src","/bookingpage/images/off_image.png"),e("#reminder-toggle-card").attr("value","disabled"),e("table tr.reminder-block td:nth-child(2)").attr("value","no")):(e("#reminder-toggle-card").attr("src","/bookingpage/images/on_image.png"),e("#reminder-toggle-card").attr("value","enabled"),e("table tr.reminder-block td:nth-child(2)").attr("value","yes")),this.setReminderMobileView()},switchSkipSlider:function(){var s=e("#reminder-toggle-skip").attr("value");"enabled"==s?(e("#reminder-toggle-skip").attr("src","/bookingpage/images/off_image.png"),e("#reminder-toggle-skip").attr("value","disabled"),e("table tr.reminder-block td:nth-child(2)").attr("value","no")):(e("#reminder-toggle-skip").attr("src","/bookingpage/images/on_image.png"),e("#reminder-toggle-skip").attr("value","enabled"),e("table tr.reminder-block td:nth-child(2)").attr("value","yes")),this.setReminderMobileView()},showPaymentEditOption:function(){e("#editPopupContainer").fadeTo(200,1)},hidePaymentEditPopup:function(){e("#editPopupContainer").fadeOut(200)},startOverAgain:function(){location.reload()},setWindowSizeFilter:function(){var e=!1;return/Android|webOS|iPhone|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)?(console.log("you are in mobile screen"),e=!0):console.log("you are not in mobile screen"),e},getReminderValue:function(){e("#email-reminder").val("true"),e("#sms-reminder").val("true"),e("input").hasClass("reminder_SMSEMAIL_check")&&!e('input[name="reminder_SMSEMAIL_check"]').is(":checked")&&(e("#email-reminder").val("false"),e("#sms-reminder").val("false")),e("input").hasClass("reminder_SMS_EMAIL_check")&&!e('input[name="reminder_SMS_EMAIL_check"]').is(":checked")&&e("#sms-reminder").val("false"),e("input").hasClass("reminder_EMAILSMS_check")&&!e('input[name="reminder_EMAILSMS_check"]').is(":checked")&&e("#email-reminder").val("false"),e("input").hasClass("reminder_SMS_check")&&!e('input[name="reminder_SMS_check"]').is(":checked")&&e("#sms-reminder").val("false"),e("input").hasClass("reminder_EMAIL_check")&&!e('input[name="reminder_EMAIL_check"]').is(":checked")&&e("#email-reminder").val("false"),e("input").hasClass("cls_Reminder_SMSEMAIL_check")&&(e('input[name="cls_Reminder_EMAIL_SMS_check"]').length&&!e('input[name="cls_Reminder_EMAIL_SMS_check"]').is(":checked")&&(e("#email-reminder").val("false"),e("#sms-reminder").val("false")),e('input[name="cls_Reminder_SMS_check"]').length&&!e('input[name="cls_Reminder_SMS_check"]').is(":checked")&&e("#sms-reminder").val("false"),e('input[name="cls_Reminder_EMAIL_check"]').length&&!e('input[name="cls_Reminder_EMAIL_check"]').is(":checked")&&e("#email-reminder").val("false"))},setReminderMobileView:function(){if(e("#email-reminder").val("true"),e("#sms-reminder").val("true"),e("table").hasClass("set-reminder")){var s=e("table tr.reminder-block td:nth-child(2)").attr("value"),t=e("table tr.reminder-block td:nth-child(2)").attr("class");switch(t){case"reminder-email-sms":"no"==s&&(e("#email-reminder").val("false"),e("#sms-reminder").val("false"));break;case"reminder-sms":"no"==s&&e("#sms-reminder").val("false");break;case"reminder-email":"no"==s&&e("#email-reminder").val("false")}}},renderClass:function(s){this.options=s,type=this.options.type,classApptObj=this,e(".classes-container #sc_act").hide(),e(".classes-container .customer-login-form").hide(),e("#class-payments-info-holder").show(),gateWayType=this.options.gateWayType;var t=this.options.response.paymentType,a=this.getViewDataByPaymentType(t);a.type=type,
a.gateWayType=gateWayType,a.isClassSMS=this.options.classSMS,"square"==gateWayType?(this.$el.html(_.template(e("#squarePayment-input-template").html(),a)),this.sqPaymentForm(type)):(this.$el.html(_.template(e("#class-payment-input-template").html(),a)),this.setWindowSizeFilter()&&(e(".class_step_tab").remove(),this.intializeCardView()),scaEnabled&&"stripe"==PaymentBookingPolicy.gateWayType&&this.loadStripeElement(type)),this.showtimerAndManageReload(gateWayType),this.options.viewData=a,"paypal"==gateWayType&&this.proceedWithPayPal(),e(".gdpr_info_container.payment").show()},cancelAppointment:function(){this.deleteAppointment(),this.clearTimerAndSetView(),location.reload()},cancelClassSession:function(){this.deleteClassSession(),this.classClearTimerAndSetView(),location.reload()},cancelMultipleService:function(){for(var e=apptObj.options.response.multipleServiceData,s=apptObj.options.response.resourceKey,t=0;t<e.length;t++)this.cancelMultipleAppointment(e[t].appointmentKey,s);this.clearTimerAndSetView(),window.clearInterval(apptObj.timerInterval),location.reload()},createNounce:function(e){document.getElementById("nonce-request").style.pointerEvents="none",BookAppointment.showValidationAletMsg("Processing Payments..."),this.stopPropagation(e),this.paymentForm.requestCardNonce()},sqPaymentForm:function(s){var t,a=this,i=squareApplicationId,o=squareLocationId;t=this.options.commonDetails[0]?this.options.commonDetails[0].customer.zip:this.options.commonDetails.newCustomer.Zip,this.paymentForm=new SqPaymentForm({applicationId:i,locationId:o,inputClass:"sq-input",postalCode:!1,applePay:!1,masterpass:!1,autoBuild:!1,inputStyles:[{fontSize:"13px",padding:"10px 0px 10px 0px"}],cardNumber:{elementId:"payment-card-number",placeholder:lang.place_card_number},cvv:{elementId:"payment-card-cvv",placeholder:"CVV"},expirationDate:{elementId:"payment-card-mmyy",placeholder:"MM/YY"},postalCode:{elementId:"postal-code",placeholder:"ZIP CODE"},callbacks:{methodsSupported:function(e){},cardNonceResponseReceived:function(t,i,o){var n=document.getElementById("nonce-request");if(n.style.pointerEvents="none",n.setAttribute("disabled",!0),event.preventDefault(),event.stopPropagation(),event.stopImmediatePropagation(),t){if(n.style.pointerEvents="",n.setAttribute("disabled",!1),4==t.length)return e.alert("Please double-check your card number, CVV, expiration date, and/or postal code.","We were unable to verify your payment"),e("#payment-card-name-holder").addClass("error-focus"),void e("#payment-card-det-holder").addClass("error-focus");if(3==t.length){var r=e.formError(t);return void e.alert("Please double-check your "+r[0]+" , "+r[1]+" , "+r[2],"We were unable to verify your payment")}if(2==t.length){var r=e.formError(t);return void e.alert("Please double-check your "+r[0]+" , "+r[1],"We were unable to verify your payment")}var r=e.formError(t);return void e.alert("Please double-check your "+r[0],"We were unable to verify your payment")}const l={intent:"CHARGE",amount:parseFloat(a.options.response.paymentAmount).toFixed(2),currencyCode:a.getPaymentCurrency(),billingContact:{givenName:a.options.viewData.Name,familyName:a.options.viewData.Name}};a.paymentForm.verifyBuyer(i,l,function(e,t){null==e&&(document.getElementById("card-nonce").value=i,document.getElementById("verifyBuyerToken").value=t.token,"ClassAppointment"==s?document.getElementById("chargeRequestForClass").click():document.getElementById("chargeRequest").click())})},unsupportedBrowserDetected:function(){},inputEventReceived:function(s){switch(s.eventType){case"focusClassAdded":e("#payment-card-det-holder").removeClass("error-focus"),e("#payment-card-name-holder").removeClass("error-focus");break;case"focusClassRemoved":break;case"errorClassAdded":break;case"errorClassRemoved":break;case"cardBrandChanged":break;case"postalCodeChanged":}},paymentFormLoaded:function(){n.focus("cardNumber"),n.setPostalCode(t)}}});var n=this.paymentForm;this.paymentForm.build()},squareNewPaymentForm:function(s){var t,a=this,i=squareApplicationId,o=squareLocationId;t=this.options.commonDetails[0]?this.options.commonDetails[0].customer.zip:this.options.commonDetails.newCustomer.Zip,this.paymentForm=new SqPaymentForm({applicationId:i,locationId:o,inputClass:"sq-input",postalCode:!1,applePay:!1,masterpass:!1,autoBuild:!1,inputStyles:[{fontSize:"13px",padding:"10px 0px 10px 3px"}],cardNumber:{elementId:"payment-card-number-new",placeholder:lang.place_card_number},cvv:{elementId:"payment-card-cvv-new",placeholder:"CVV"},expirationDate:{elementId:"payment-card-mmyy-new",placeholder:"MM/YY"},postalCode:{elementId:"postal-code-new",placeholder:"ZIP CODE"},callbacks:{methodsSupported:function(e){},cardNonceResponseReceived:function(t,i,o){var n=document.getElementById("nonce-request");if(n.style.pointerEvents="none",n.setAttribute("disabled",!0),event.preventDefault(),event.stopPropagation(),event.stopImmediatePropagation(),t){if(n.style.pointerEvents="",n.setAttribute("disabled",!1),4==t.length)return e.alert("Please double-check your card number, CVV, expiration date, and/or postal code.","We were unable to verify your payment"),e("#payment-card-name-holder").addClass("error-focus"),void e("#payment-card-det-holder").addClass("error-focus");if(3==t.length){var r=e.formError(t);return void e.alert("Please double-check your "+r[0]+" , "+r[1]+" , "+r[2],"We were unable to verify your payment")}if(2==t.length){var r=e.formError(t);return void e.alert("Please double-check your "+r[0]+" , "+r[1],"We were unable to verify your payment")}var r=e.formError(t);return void e.alert("Please double-check your "+r[0],"We were unable to verify your payment")}const l={intent:"CHARGE",amount:parseFloat(a.options.response.paymentAmount).toFixed(2),currencyCode:a.getPaymentCurrency(),billingContact:{givenName:a.options.viewData.Name,familyName:a.options.viewData.Name}};a.paymentForm.verifyBuyer(i,l,function(e,t){null==e&&(document.getElementById("card-nonce").value=i,document.getElementById("verifyBuyerToken").value=t.token,"ClassAppointment"==s?document.getElementById("chargeRequestForClass").click():document.getElementById("chargeRequest").click())})},unsupportedBrowserDetected:function(){},inputEventReceived:function(s){switch(s.eventType){case"focusClassAdded":e("#payment-card-det-holder").removeClass("error-focus"),e("#payment-card-name-holder").removeClass("error-focus");break;case"focusClassRemoved":break;case"errorClassAdded":break;case"errorClassRemoved":break;case"cardBrandChanged":break;case"postalCodeChanged":}},paymentFormLoaded:function(){n.focus("cardNumber"),n.setPostalCode(t)}}});var n=this.paymentForm;this.paymentForm.build()},requestForCharge:function(s){var t="chargeRequest"==s.currentTarget.id?"appointment":"class";if(e(".agreeCancellationPolicyTerms").hide(),this.validateTotal(t)){e("#pageBlock").css("height",e("body").height()),e("#pageBlock, #loading_set, #loading_set #setmore_loading_icon").show();"appointment"==t&&(e("#skip-Payment,#cancel-Payment").hide(),this.options=apptObj.options);var a=this,i=e("#card-nonce").val(),o=e("#verifyBuyerToken").val(),n={};n=this.getCommonDataForSquare(t);var r="false";if(1==this.options.response.isMultiService){r="true";var l=this.getViewDataForMultipleservice();n.sessionIdList=l.sessionIdList,n.amount=l.total,n.lineItemsInfo=l.allLinetItem}n.isMultipleService=r,n.paymentToken=i,n.verifyBuyerToken=o,n.billing_address=this.getBillingAddress(),n.haveTextReminderEnabled=e("#sms-reminder").val().trim(),n.haveEmailReminderEnabled=e("#email-reminder").val().trim(),e(".payment-blocker-holder").removeClass("hide");var c=JSON.stringify(n);clearInterval(this.timerInterval),e.ajax({type:"POST",url:"/payment/square/charge",contentType:"application/json",dataType:"json",data:c,success:function(s){if(e(".payment-blocker-holder").addClass("hide"),"appointment"==t?e("#skip-Payment,#cancel-Payment").show():e("#skip-class-payment,#cancel-class-payment").show(),hideStatusMessage(),1==s.status)"appointment"==t&&("true"==r?a.handleMultApptEle(a):a.handleApptEle(a),e(".confirm_appt").addClass("apptPaid"),e(".gt > .gt_act").removeClass("confirmCusDetails_tab").addClass("submitapp_tab")),e("#payments-info-holder").hide(),e(".gdpr_info_container.payment").hide(),BookAppointment.bookAnotherAppt(),BookAppointment.showCalBkUrl(),BookAppointment.showValidationAletMsg(lang.saved);else if(s.errors){var i=s.errors[0];"INVALID_EXPIRATION"==i.code?e.alert("We're sorry, it looks like your Expiration date may have been entered incorrectly. Please check your card and try again.","Match Failure: Expiration date","Ok, let me try again"):"VERIFY_CVV_FAILURE"==i.code?e.alert("We're sorry, it looks like your CVV may have been entered incorrectly. Please check your card and try again.","Match Failure: CVV","Ok, let me try again"):"VERIFY_AVS_FAILURE"==i.code?e.alert("We're sorry, it looks like your Postal Code may have been entered incorrectly. Please check your card and try again.","Match Failure: Postal Code","Ok, let me try again"):"NOT_FOUND"==i.code||"ACCESS_TOKEN_REVOKED"==i.code||"UNAUTHORIZED"==i.code?e.alert("We're sorry, we're unable to take your payment at this time. Please contact us to complete your booking.","Please Contact Us","Okay"):"CARD_DECLINED"==i.code?e.alert("We're sorry, we're unable to take your payment at this time. Please check your card.","Card Declined","Okay"):e.alert("We're sorry, it looks like the authorization for the payment provider has expired. Please contact the administrator of this page.","Authorization Failure","Ok, let me do that")}else alert("payment failure"),location.reload();e("#pageBlock, #loading_set, #loading_set #setmore_loading_icon").hide()},error:function(){alert("Something went wrong.. Please try again")}})}},requestForClassCharge:function(){if(e(".agreeCancellationPolicyTerms").hide(),this.validateTotal("class")){e("#pageBlock").css("height",e("body").height()),e("#pageBlock, #loading_set, #loading_set #setmore_loading_icon").show();var s=this,t="",a="",i=e("#card-nonce").val();console.log(i);var o=e("#verifyBuyerToken").val();e("#skip-class-payment,#cancel-class-payment").hide(),this.options=classApptObj.options,t=classApptObj.options.commonDetails.startDateAndTime,a=classApptObj.options.commonDetails.endDateAndTime;var n=(this.options.viewData.Name,{});n=this.getCommonDataForSquareClass("class");var r="false";n.isMultipleService=r,n.paymentToken=i,n.billing_address=this.getBillingAddressClass(),n.isClass=!0,n.verifyBuyerToken=o,n.startDateAndTime=t,n.endDateAndTime=a,n.haveTextReminderEnabled=e("#sms-reminder").val().trim(),n.haveEmailReminderEnabled=e("#email-reminder").val().trim(),n.bookedFrom="Booking Page";var l=JSON.stringify(n);clearInterval(this.timerInterval),e(".payment-blocker-holder").removeClass("hide"),e.ajax({type:"POST",url:"/square/class/charge",contentType:"application/json",dataType:"json",data:l,success:function(t){console.log(t),e(".payment-blocker-holder").addClass("hide"),e("#skip-class-payment,#cancel-class-payment").show(),hideStatusMessage(),1==t.status?(s.handleClsEle(s),e(".class_confirm_appt").addClass("clsPaid"),e("#gt_cls").removeClass("confirmCusDetails_tab").addClass("submitapp_tab"),e("#classes-tab").removeClass("clsLst").removeClass("clsPro").removeClass("clsDt").removeClass("signInFrm").removeClass("clsInfo").removeClass("clsPay").addClass("clsCon"),e("#payments-info-holder").hide(),e(".gdpr_info_container.payment").hide(),BookAppointment.bookAnotherAppt(),BookAppointment.showCalBkUrl(),BookAppointment.showValidationAletMsg(lang.saved),e("#pageBlock, #loading_set, #loading_set #setmore_loading_icon").hide()):(e("#pageBlock, #loading_set, #loading_set #setmore_loading_icon").hide(),alert(t.message),location.reload())},error:function(){alert("Something went wrong.. Please try again")}})}},getBillingAddress:function(){var e={},s=this.options.commonDetails,t=s[0].customer;return e.address_line_1=t.address,e.locality=t.state,e.postal_code=t.zip,e.country=countryInitial,e},getBillingAddressClass:function(){var e={},s=this.options.commonDetails.newCustomer;return e.address_line_1=s.Address,e.locality=s.State,e.postal_code=s.Zip,e.country=countryInitial,e},remove:function(){this.clearTimerAndSetView(),e("#payments-info-holder").html("")},removeClass:function(){this.classClearTimerAndSetView(),e("#class-payments-info-holder").html("")},deleteClassSession:function(){var s=classApptObj.options.commonDetails,t=s.customerKeysList;t.remove(s.newCustomer.key),s.customerKeysList=t;var a=s.key+"_"+s.newCustomer.key;e.ajax({type:"POST",url:"/deleteCustomerFromSession",data:"customerKey="+a+"&companyKey="+companyKey,success:function(e){window.clearInterval(classApptObj.timerInterval)}})},deleteAppointment:function(){var s=apptObj.options.response.appointmentKey,t=apptObj.options.response.resourceKey;e.ajax({type:"GET",url:"/deleteAppointmentForPayment.do",data:"appointmentKey="+s+"&resourceKey="+t,success:function(e){window.clearInterval(apptObj.timerInterval)}})},cancelMultipleAppointment:function(s,t){var s=s,t=t;e.ajax({type:"GET",url:"/deleteAppointmentForPayment.do",data:"appointmentKey="+s+"&resourceKey="+t,success:function(e){}})},showtimerAndManageReload:function(s){function t(){return"You may lose this appointment slot upon reloading."}var a="Appointment"==type?".timer-holder":".class-timer-holder";e(a).css("display","block"),this.startTimer(s,!1,0),window.onbeforeunload=t},getCommonViewData:function(){var e=this,s=this.options.commonDetails,t={},a="Provider"!=customisedProviderLabel?customisedProviderLabel:"en"!=language?lang.provider:"Provider";if(t.TimeLable=lang.dateandtime,t.Time=this.options.response.dateFormatted+" "+lang.at+" "+this.options.response.timeForPayments+" ("+shortTimeZone+")",t.isSkipStaff=customerInfo.skipStaff,t.staffLable=a,t.LocalTime="","Appointment"==this.options.type){var i="Service"!=customisedServiceLabel?customisedServiceLabel:"en"!=language?lang.service:"Services";t.service=serviceCategoryList[e.options.response.serviceKey],t.serviceLabel=i;var o=t.service.bufferDuration?t.service.Duration-t.service.bufferDuration:t.service.Duration,n=customerInfo.showLabel.toString().indexOf("servicename")!=-1?o+" "+lang.minutes+" -":"";t.seriveName=t.service.ServiceName+" - "+n+" "+sign+t.service.Cost,t.Name=s[0].customer.firstName+" "+s[0].customer.lastName,t.Email=s[0].customer.email,t.phoneNumber=s[0].customer.mobile;var r=this.options.response.resourceKey;t.staffName=resourceMap[r].FirstName+" "+resourceMap[r].LastName,t.service=serviceCategoryList[e.options.response.serviceKey],this.options.response.localTimeForPayments&&(t.LocalTime=this.options.response.localTimeForPayments,t.Time=this.options.response.accTimeForPayments)}else if("ClassAppointment"==this.options.type){t.classes=s.classKey,t.classLabel=BookAppointment.clsName;var n=customerInfo.showLabel.toString().indexOf("servicename")!=-1?s.duration+" "+lang.minutes+" - ":"";t.className=s.className+" - "+n+sign+s.cost,t.Name=s.newCustomer.FirstName+" "+s.newCustomer.LastName,t.Email=s.newCustomer.LoginId,t.Text=s.newCustomer.MobileNo;var r=s.staffKey[0];t.staffName=resourceMap[r].FirstName+" "+resourceMap[r].LastName,this.options.response.classLocalTimeForPayments&&(t.LocalTime=this.options.response.classLocalTimeForPayments,t.Time=this.options.response.classAccTimeForPayments)}return t.paymentType=this.options.response.paymentType,t},getCommonDataForMultipleSer:function(){var e=this,s=this.options.commonDetails,t={},a="Provider"!=customisedProviderLabel?customisedProviderLabel:"en"!=language?lang.provider:"Provider";t.TimeLable=lang.dateandtime,t.Time=this.options.response.localTimeForPayments?this.options.response.localTimeForPayments:this.options.response.dateFormatted+" "+lang.at+" "+this.options.response.timeForPayments+" ("+shortTimeZone+")",t.isSkipStaff=customerInfo.skipStaff,t.staffLable=a,t.LocalTime="";var i=new Array,o=[];if("Appointment"==this.options.type){var n="Service"!=customisedServiceLabel?customisedServiceLabel:"en"!=language?lang.service:"Services",r=e.options.response.multipleServiceData,l=0;r.forEach(function(e){i[l]=serviceCategoryList[e.serviceKey],t.service=serviceCategoryList[e.serviceKey],t.serviceLabel=[n];var s=t.service.bufferDuration?t.service.Duration-t.service.bufferDuration:t.service.Duration,a=customerInfo.showLabel.toString().indexOf("servicename")!=-1?s+" "+lang.minutes+" -":"";t.seriveName=t.service.ServiceName+" - "+a+" "+sign+t.service.Cost,t.service=serviceCategoryList[e.serviceKey],l+=1});for(var c=0;c<this.options.response.sessionIdList.length;c++)o[c]=this.options.response.sessionIdList[c];var d=this.options.response.resourceKey;this.options.response.localTimeForPayments&&(t.LocalTime=this.options.response.localTimeForPayments,t.Time=this.options.response.accTimeForPayments),t.Name=s[0].customer.firstName+" "+s[0].customer.lastName,t.Email=s[0].customer.email,t.phoneNumber=s[0].customer.mobile,t.staffName=resourceMap[d].FirstName+" "+resourceMap[d].LastName}return t.paymentType=this.options.response.paymentType,t.serviceListTest=i,t.sessionIdList=o,t},getViewDataForType1:function(){var e=this.getCommonViewData();return e.itemList=this.getItemsListAndTotal().addition,e.discountList=this.getItemsListAndTotal().reduction,e.allLinetItem=this.getItemsListAndTotal().allLinetItem,e.total=this.getItemsListAndTotal().total,e},getViewDataForType2:function(){var e=this.getCommonViewData();return e.itemList=this.getItemAndTotalType2().addition,e.discountList=[],e.allLinetItem=this.getItemAndTotalType2().allLinetItem,e.total=this.getItemAndTotalType2().total,e},getViewDataForType3:function(){var e=this.getCommonViewData();return e.itemList=this.getItemAndTotalType3().addition,e.discountList=[],e.allLinetItem=this.getItemAndTotalType3().allLinetItem,e.total=this.getItemAndTotalType3().total,e},getViewDataForMultipleservice:function(){var e=this.getCommonDataForMultipleSer();return e.itemList=this.getMultipleServiceItemsListAndTotal().addition,e.discountList=this.getMultipleServiceItemsListAndTotal().reduction,e.allLinetItem=this.getMultipleServiceItemsListAndTotal().allLinetItem,e.total=this.getMultipleServiceItemsListAndTotal().total,e},getViewDataByPaymentType:function(s,t){var a=this,i={};switch(e(".service_title").html(lang.payment_title),fbbdp&&(document.title=lang.payment_title),s){case"0":i=a.getViewDataForType1();break;case"1":i=a.getViewDataForType2();break;case"2":i=a.getViewDataForType3();break;case"3":i=a.getViewDataForType1()}return i},getItemsListAndTotal:function(){var e={},s=[],t=[],a=[],i=0,o=0,n=this;if("Appointment"==this.options.type&&this.options.response.isMultiService)for(var r=n.options.response.multipleServiceData,l=0;l<r.length;l++){var c=serviceCategoryList[r[l].serviceKey],d=c.Cost,m={};m.itemName=c.ServiceName,m.amount=d.toFixed(2),m.itemType="lineItem",m.isService=1,m.serviceKey=r[l].serviceKey,m.appointmentKey=r[l].appointmentKey;var p=c.bufferDuration?c.Duration-c.bufferDuration:c.Duration;m.duration=p+" mins",s.push(m),a.push(m),o+=d,i+=parseFloat(d)}else if("ClassAppointment"==this.options.type||!this.options.response.isMultiService){var c=serviceCategoryList[n.options.response.serviceKey],d="Appointment"==n.options.type?c.Cost:n.options.commonDetails.cost,m={};m.itemName="Appointment"==n.options.type?c.ServiceName:n.options.commonDetails.className,m.amount=d.toFixed(2),m.itemType="lineItem",m.isService=1,m.appointmentKey="ClassAppointment"==this.options.type?n.options.commonDetails.key:n.options.response.appointmentKey,m.serviceKey=n.options.response.serviceKey,s.push(m),a.push(m),i+=parseFloat(d)}for(var u=this.options.response.additonalCharges,h=0;h<u.length;h++){var v=u[h];if("Addition"==v.itemtype){var g="Amount"==v.amountType?v.amount:d*(v.precentage/100);i+=parseFloat(g);var f={};f.itemName=v.itemName,f.amount=g.toFixed(2),f.itemType="lineItem",f.isService=0,s.push(f),a.push(f)}else{var g="Amount"==v.amountType?v.amount:d*(v.precentage/100);i-=parseFloat(g);var f={};f.itemName=v.itemName,f.amount=g.toFixed(2),f.itemType="discount",f.isService=0,t.push(f),a.push(f)}}this.options.commonDetails;return e.addition=s,e.reduction=t,e.allLinetItem=a,e.total=i.toFixed(2),e},getMultipleServiceItemsListAndTotal:function(){var e={},s=[],t=[],a=[],i=0,o=0,n=this;if("Appointment"==n.options.type)var r=n.options.response.multipleServiceData;r.forEach(function(e){var t=serviceCategoryList[e.serviceKey],r="Appointment"==n.options.type?t.Cost:n.options.commonDetails.cost,l={};l.itemName="Appointment"==n.options.type?t.ServiceName:n.options.commonDetails.className,l.amount=r.toFixed(2),l.itemType="lineItem",l.isService=1,l.serviceKey=e.serviceKey,l.appointmentKey=e.appointmentKey;var c=t.bufferDuration?t.Duration-t.bufferDuration:t.Duration;l.duration=c+" mins",s.push(l),a.push(l),o+=r,i+=parseFloat(r)});for(var l=this.options.response.additonalCharges,c=0;c<l.length;c++){var d=l[c];if("Addition"==d.itemtype){var m="Amount"==d.amountType?d.amount:o*(d.precentage/100);i+=parseFloat(m);var p={};p.itemName=d.itemName,p.amount=m.toFixed(2),p.itemType="lineItem",p.isService=0,s.push(p),a.push(p)}else{var m="Amount"==d.amountType?d.amount:o*(d.precentage/100);i-=parseFloat(m);var p={};p.itemName=d.itemName,p.amount=m.toFixed(2),p.itemType="discount",p.isService=0,t.push(p),a.push(p)}}this.options.commonDetails;return e.addition=s,e.reduction=t,e.allLinetItem=a,e.total=i.toFixed(2),e},getItemAndTotalType2:function(){var e={},s=[],t=[],a=0,i=this,o=serviceCategoryList[i.options.response.serviceKey],n=this.options.response.paymentPercentage,r={};return a=parseFloat(o.Cost*(n/100)),a.toFixed(2),r.itemName=o.ServiceName+" ("+n+"% of "+sign+o.Cost+")",r.amount=a,r.itemType="lineItem",s.push(r),t.push(r),e.addition=s,e.allLinetItem=t,e.total=a,e},getItemAndTotalType3:function(){var e={},s=[],t=[],a=0,i=this,o=(serviceCategoryList[i.options.response.serviceKey],this.options.response.paymentAmount.toFixed(2)),n={};return n.itemName="Depoist Amount of "+sign+" "+o,n.amount=o,n.itemType="lineItem",s.push(n),t.push(n),a=parseFloat(n.amount),e.addition=s,e.allLinetItem=t,e.total=a.toFixed(2),e},checkAndSetCardNum:function(s){e(s.currentTarget).val(e(s.currentTarget).val().replace(/[^0-9]/g,""));var t=e(s.currentTarget).val().split(" ").join("");t.length>0&&(e(s.currentTarget).removeClass("app-payment-error-focus error_field"),e("#charge-customer").removeClass("save-greyout"),t.length<15&&(e(s.currentTarget).addClass("app-payment-error-focus"),e("#charge-customer").addClass("save-greyout")),t=t.match(new RegExp(".{1,4}","g")).join(" ")),e(s.currentTarget).val(t)},preventWordsInput:function(e){var s;return!(!e.metaKey&&!e.ctrlKey)||32!==e.which&&(0===e.which||(e.which<33||(s=String.fromCharCode(e.which),!!/[\d\s]/.test(s))))},checkAndSetCardExp:function(s){if(!(s=s||window.event).done){var t,a,i;a=String.fromCharCode(s.which),t=e(s.currentTarget),i=t.val().trim();var o,n,r,l;if(n=i.match(/^\D*(\d{1,2})(\D+)?(\d{1,4})?/),!n)return"";o=n[1]||"",r=n[2]||"",l=n[3]||"",l.length>0?r=" / ":" /"===r?r="":2===o.length||r.length>0?r=" / ":1===o.length&&"0"!==o&&"1"!==o&&(o="0"+o,r=" / "),t.val(o+r+l),s.done=!0}},checkAndSetCardCVV:function(s){var t,a;t=e(s.currentTarget),e(s.currentTarget).val(e(s.currentTarget).val().replace(/[^0-9]/g,"")),a=e(s.currentTarget).val(),a.length>0&&(e(s.currentTarget).removeClass("app-payment-error-focus error_field"),e("#charge-customer").removeClass("save-greyout"),a.length<2&&(e(s.currentTarget).addClass("app-payment-error-focus"),e("#charge-customer").addClass("save-greyout")))},getCommonDataForSquare:function(e){var s=this.options.response.paymentType,t=this.getViewDataByPaymentType(s,e),a={};return a.appointmentKey=this.options.response.appointmentKey,a.bookingId=this.options.response.bookingId,a.companyKey=this.options.response.companyKey,a.customerKey=this.options.response.customerKey,a.sessionKey=this.options.response.sessionId,a.currency=this.getPaymentCurrency(),a.customerName=this.getcustomerName(),a.buyerEmailAddress=this.getbuyerEmailAddress(),a.staffKey=this.options.response.resourceKey,a.staffName=this.options.viewData.staffName,a.serviceKey=this.options.response.serviceKey,a.lineItemsInfo=t.allLinetItem,a.amount=t.total,a.paymentGateway="square",a},getCommonDataForStripe:function(e){var s=this.options.response.paymentType,t=this.getViewDataByPaymentType(s,e),a={};return a.appointmentKey=this.options.response.appointmentKey,a.bookingId=this.options.response.bookingId,a.companyKey=this.options.response.companyKey,a.customerKey=this.options.response.customerKey,a.sessionKey=this.options.response.sessionId,a.currency=this.getPaymentCurrency(),a.customerName=this.getcustomerName(),a.staffKey=this.options.response.resourceKey,a.staffName=this.options.viewData.staffName,a.serviceKey=this.options.response.serviceKey,a.lineItemsInfo=t.allLinetItem,a.amount=t.total,a.paymentGateway="stripe",a},getCommonDataForSquareClass:function(e){var s=this.options.response.paymentType,t=this.getViewDataByPaymentType(s,e),a={};return a.appointmentKey=this.options.commonDetails.key,a.bookingId=this.options.response.bookingId,a.companyKey=this.options.commonDetails.companyKey,a.customerKey=this.options.commonDetails.newCustomer.key,a.sessionKey=this.options.sessionId,a.currency=this.getPaymentCurrency(),a.customerName=this.options.commonDetails.newCustomer.FirstName+this.options.commonDetails.newCustomer.LastName,a.buyerEmailAddress=this.options.commonDetails.newCustomer.LoginId,a.staffKey=this.options.commonDetails.staffKey[0],a.staffName=this.options.viewData.staffName,a.serviceKey=this.options.commonDetails.classKey,a.startDateAndTime=this.options.commonDetails.startDateAndTime,a.endDateAndTime=this.options.commonDetails.endDateAndTime,a.lineItemsInfo=t.allLinetItem,a.amount=t.total,a.paymentGateway="square",a},getTransactionInfo:function(s){var t="class"==s?"class-":"",a=this.options.response.paymentType,i=this.getViewDataByPaymentType(a,s),o=e("#"+t+"payment-card-mmyy").val().split("/"),n={};return n.name=htmlEscape(e("#"+t+"payment-card-name").val().trim()),n.accountNo=e("#"+t+"payment-card-number").val().split(" ").join(""),n.cvv=e("#"+t+"payment-card-cvv").val().trim(),n.exp_month=e.trim(o[0]),n.exp_year=e.trim(o[1]),n.amount=i.total,n.lineItems=i.allLinetItem,n},proceedWithPayPal:function(){var s=this.options,t=this;e.ajax({url:"/getPaypalButtonHostId?companyKey="+this.options.response.companyKey,type:"GET",success:function(e){if(e)if("failure"!=e){var a=JSON.parse(e);s.companyButtonHostId=a.button_host_id,s.businessId=a.business_id,t.getPayPalIdentityToken(),t.addmorePaypalOptions()}else alert("Something went wrong.. Please try again")},error:function(){alert("Something went wrong.. Please try again")}})},getPayPalIdentityToken:function(){},getLineItemInfo:function(){var e=[];return jQuery.each(this.options.viewData.allLinetItem,function(s,t){var a={};a.amount=t.amount,a.itemName=t.itemName,a.itemType=t.itemType,a.isService=t.isService,e.push(a)}),e},returnPayPalCurrency:function(e){return e.currencyCode==currency},addmorePaypalOptions:function(){console.log(this.options.type),this.app_mode=window.location.hostname.indexOf("staging");var e=this.options,s=this.getLineItemInfo(),t=currencyList.filter(this.returnPayPalCurrency)[0].paypalCurrencyCode,a=this.options;this.paymentTimeStamp=Date.now(),a.data=s,a.amount=e.viewData.total,a.discount=0,a.currency_code=t,a.hosted_button_id=a.companyButtonHostId,a.item_name=this.options.viewData.allLinetItem[0].itemName,a.item_number=1,a.notify_url=this.app_mode!=-1?STAGING_PAYPAL_NOTIFY_URL:LIVE_PAYPAL_NOTIFY_URL,a.return_url="",console.log(e.type),"ClassAppointment"==this.options.type?(a.address1=this.options.commonDetails.newCustomer.Address,a.city=this.options.commonDetails.newCustomer.City,a.country=this.options.commonDetails.newCustomer.Country,a.email=this.options.commonDetails.newCustomer.LoginId,a.first_name=this.options.commonDetails.newCustomer.FirstName,a.last_name=this.options.commonDetails.newCustomer.LastName,a.state=this.options.commonDetails.newCustomer.State,a.zip=this.options.commonDetails.newCustomer.Zip,a.startDateAndTime=this.options.commonDetails.startDateAndTime,a.endDateAndTime=this.options.commonDetails.endDateAndTime,console.log("--\tpaypalOptionsObj.startDateAndTime--"+a.startDateAndTime),console.log("--\tpaypalOptionsObj.endDateAndTime--"+a.endDateAndTime),a.custom=a.commonDetails.key+"_"+this.paymentTimeStamp+"_"+a.businessId+"_classapptbookingpage_"+a.sessionId+"_"+a.commonDetails.newCustomer.key+"_"+a.startDateAndTime+"_"+a.endDateAndTime):(a.address1=this.options.commonDetails[0].customer.address,a.city=this.options.commonDetails[0].customer.city,a.country=this.options.commonDetails[0].customer.country,a.email=this.options.commonDetails[0].customer.email,a.first_name=this.options.commonDetails[0].customer.firstName,a.last_name=this.options.commonDetails[0].customer.lastName,a.state=this.options.commonDetails[0].customer.state,a.zip=this.options.commonDetails[0].customer.zip,a.custom=a.response.appointmentKey+"_"+this.paymentTimeStamp+"_"+a.businessId+"_bookingpage_"+a.response.sessionId),this.paypalOptionsObj=a,console.log(JSON.stringify(a))},addApptToMakePaymentLookupJDO:function(){var s=this,t={};"ClassAppointment"==this.options.type?(t.key=this.options.commonDetails.key+"_"+this.paymentTimeStamp,t.appID=this.options.commonDetails.key+"_"+this.options.commonDetails.newCustomer.key,t.companyKey=this.options.commonDetails.companyKey,t.bookingpageSessionKey=this.options.sessionId):(t.key=this.options.response.appointmentKey+"_"+this.paymentTimeStamp,t.appID=this.options.response.appointmentKey,t.companyKey=this.options.response.companyKey,t.bookingpageSessionKey=this.options.response.sessionId),t.amount=this.paypalOptionsObj.amount,t.paymentGateWay="paypal",t.requestType="charge",t.currency=this.paypalOptionsObj.currency_code,t.paymentStatus="pending",t.processTime=Date.now(),t.discountAmount=this.paypalOptionsObj.discount,t.bookedFromPage="bookingpage",t.apptFrom=this.options.type,void 0==s.paypalOptionsObj.data||null==s.paypalOptionsObj.data?t.itemInfoJson="{}":t.itemInfoJson=JSON.stringify(s.paypalOptionsObj.data),console.log(t),e.ajax({url:"/addApptToMakePaymentLookupJDO",method:"POST",data:t,success:function(e){"success"==e?console.log("Success fully persisted MakePayment"):console.log("problem with presisting")},failure:function(){alert("Something went wrong.. Please try again")}})},proceedWithPaypalPayment:function(){var s=this.app_mode!=-1?STAGING_PAYPAL_URL:LIVE_PAYPAL_URL;this.addApptToMakePaymentLookupJDO(),e("#pageBlock").css("height",e("body").height()),e("#pageBlock, #loading_set, #loading_set #setmore_loading_icon").show(),e("#skip-Payment,#cancel-Payment").hide(),BookAppointment.showValidationAletMsg("Processing Payments..."),e("#show_timer").show();var t=s+this.paypalOptionsObj.hosted_button_id+"&amount="+this.paypalOptionsObj.amount+"&currency_code="+this.paypalOptionsObj.currency_code+"&custom="+this.paypalOptionsObj.custom+"&country="+this.paypalOptionsObj.country+"&item_name="+this.paypalOptionsObj.item_name+"&item_number="+this.paypalOptionsObj.item_number+"&notify_url="+this.paypalOptionsObj.notify_url+"&rm=2&address1="+this.paypalOptionsObj.address1+"&first_name="+this.paypalOptionsObj.first_name+"&last_name="+this.paypalOptionsObj.last_name+"&city="+this.paypalOptionsObj.city+"&state="+this.paypalOptionsObj.state+"&zip="+this.paypalOptionsObj.zip+"&email="+this.paypalOptionsObj.email,a=800,i=600,o=screen.width/2-a/2,n=screen.height/2-i/2;window.newwindow=window.open(t,"Paypal","toolbar=no,location=no,status=no,menubar=no,scrollbars=yes,resizable=no,height="+i+",width="+a+" , top="+n+",left="+o)},channelMessage:function(s){console.log(s);var t=this;clearTimeout(this.callIfIpnNotRespond),e(".payment-blocker-holder").addClass("hide"),e("#skip-Payment,#cancel-Payment").show(),hideStatusMessage(),"success"==s.model.toLowerCase()?(t.handleApptEle(t),e(".confirm_appt").addClass("apptPaid"),
e(".gt > .gt_act").removeClass("confirmCusDetails_tab").addClass("submitapp_tab"),e("#payments-info-holder").hide(),BookAppointment.bookAnotherAppt(),BookAppointment.showCalBkUrl(),BookAppointment.showValidationAletMsg(lang.saved),e("#pageBlock, #loading_set, #loading_set #setmore_loading_icon").hide(),e("#show_timer").hide(),newwindow.focus&&(window.focus(),window.newwindow.close())):(e("#pageBlock, #loading_set, #loading_set #setmore_loading_icon").hide(),e("#show_timer").hide(),alert(s.model),newwindow.focus&&(window.focus(),window.newwindow.close()),location.reload())},channelMessageClass:function(s){console.log(s);var t=this;clearTimeout(this.callIfIpnNotRespond),e(".payment-blocker-holder").addClass("hide"),e("#skip-class-payment,#cancel-class-payment").show(),hideStatusMessage(),"success"==s.model.toLowerCase()?(t.handleClsEle(t),e(".class_confirm_appt").addClass("clsPaid"),e("#gt_cls").removeClass("confirmCusDetails_tab").addClass("submitapp_tab"),e("#payments-info-holder").hide(),BookAppointment.bookAnotherAppt(),BookAppointment.showCalBkUrl(),BookAppointment.showValidationAletMsg(lang.saved),e("#pageBlock, #loading_set, #loading_set #setmore_loading_icon").hide(),e("#show_timer").hide(),newwindow.focus&&(window.focus(),window.newwindow.close())):(e("#pageBlock, #loading_set, #loading_set #setmore_loading_icon").hide(),e("#show_timer").hide(),alert(s.model),newwindow.focus&&(window.focus(),window.newwindow.close()),location.reload())},callIfIpnNotResponse:function(s){var t=this,a="";console.log(JSON.stringify(t.options)),"appointment"==s?a=t.options.response.appointmentKey+"_"+t.paymentTimeStamp:"class"==s&&(a=t.options.commonDetails.key+"_"+t.paymentTimeStamp),this.callIfIpnNotRespond=setTimeout(function(){e.ajax({type:"GET",url:"/bookingpageTransactionSearch",data:"key="+a,dataType:"json",success:function(e){},error:function(e,s,t){500==e.status?console.log("Internal error: "+e.responseText):console.log("Unexpected error."+s)}})},21e4)},processPayments:function(s){this.stopPropagation(s);var t="pay-now"==s.currentTarget.id?"appointment":"class";if("paypal"===this.options.gateWayType)console.log("paypal payment"),this.callIfIpnNotResponse(t),"appointment"==t?PaymentNotifications.getToken(this.options.response.appointmentKey+"_"+this.paymentTimeStamp,this):"class"==t&&PaymentNotifications.getToken(this.options.commonDetails.key+"_"+this.paymentTimeStamp,this),this.proceedWithPaypalPayment();else{var t="pay-now"==s.currentTarget.id?"appointment":"class";if(e(".agreeCancellationPolicyTerms").hide(),1==this.options.response.isMultiService){if(this.validateTotalForMul(t)&&this.validateCardDetails(t)){e("#pageBlock").css("height",e("body").height()),e("#pageBlock, #loading_set, #loading_set #setmore_loading_icon").show();var a="",i="";if("appointment"==t){e("#skip-Payment-mulSer,#cancel-mulSerPayment").hide(),this.options=apptObj.options;var o=this.getcustomerName()}else{e("#skip-class-payment,#cancel-class-payment").hide(),this.options=classApptObj.options,a=classApptObj.options.commonDetails.startDateAndTime,i=classApptObj.options.commonDetails.endDateAndTime;var o=this.options.viewData.Name}var n=this.options.response.accessURl,r=this;BookAppointment.showValidationAletMsg("Processing Payments...");var l=this.getTransactionInfoMul(t,scaEnabled),c=this.getPaymentCurrency(),d={};d=this.getReminderValue();var m=d.haveTextReminderEnabled,p=d.haveEmailReminderEnabled,u="true";clearInterval(this.timerInterval),e(".payment-blocker-holder").removeClass("hide"),e.ajax({type:"POST",url:n,data:"amount="+l.amount+"&cardInfo="+encodeURIComponent(JSON.stringify(l))+"&lineItemInfo="+encodeURIComponent(JSON.stringify(l.lineItems))+"&currencyType="+c+"&startDateAndTime="+a+"&endDateAndTime="+i+"&customerName="+o+"&multipleService="+u+"&sessionIdList="+l.sessionIdList+"&haveTextReminderEnabled="+m+"&haveEmailReminderEnabled="+p,dataType:"json",success:function(s){e(".payment-blocker-holder").addClass("hide"),"appointment"==t?e("#skip-Payment-mulSer,#cancel-mulSerPayment").show():e("#skip-class-payment,#cancel-class-payment").show(),hideStatusMessage(),1==s.status?("appointment"==t?(r.handleMultApptEle(r),e(".confirm_appt").addClass("apptPaid"),e(".gt > .gt_act").removeClass("confirmCusDetails_tab").addClass("submitapp_tab")):(r.handleClsEle(r),e(".class_confirm_appt").addClass("clsPaid"),e("#gt_cls").removeClass("confirmCusDetails_tab").addClass("submitapp_tab")),e("#payments-info-holder").hide(),e(".gdpr_info_container.payment").hide(),BookAppointment.bookAnotherAppt(),BookAppointment.showCalBkUrl(),BookAppointment.showValidationAletMsg(lang.saved),e("#pageBlock, #loading_set, #loading_set #setmore_loading_icon").hide(),fbq("trackCustom","LDP_Purchase",{business_id:companyKey})):(e("#pageBlock, #loading_set, #loading_set #setmore_loading_icon").hide(),alert(s.message),location.reload())},error:function(){alert("Something went wrong.. Please try again")}})}}else if(this.validateTotal(t)&&this.validateCardDetails(t)){e("#pageBlock").css("height",e("body").height()),e("#pageBlock, #loading_set, #loading_set #setmore_loading_icon").show();var a="",i="";if("appointment"==t){e("#skip-Payment,#cancel-Payment").hide(),this.options=apptObj.options;var o=this.getcustomerName()}else{e("#skip-class-payment,#cancel-class-payment").hide(),this.options=classApptObj.options,a=classApptObj.options.commonDetails.startDateAndTime,i=classApptObj.options.commonDetails.endDateAndTime;var o=this.options.viewData.Name}var n=this.options.response.accessURl,r=this;BookAppointment.showValidationAletMsg("Processing Payments...");var l=this.getTransactionInfo(t),c=this.getPaymentCurrency(),u="false",h=new Array,d={};d=this.getReminderValue();var m=d.haveTextReminderEnabled,p=d.haveEmailReminderEnabled;clearInterval(this.timerInterval),e(".payment-blocker-holder").removeClass("hide"),e.ajax({type:"POST",url:n,data:"amount="+l.amount+"&cardInfo="+encodeURIComponent(JSON.stringify(l))+"&lineItemInfo="+encodeURIComponent(JSON.stringify(l.lineItems))+"&currencyType="+c+"&startDateAndTime="+a+"&endDateAndTime="+i+"&customerName="+o+"&multipleService="+u+"&sessionIdList="+h+"&haveTextReminderEnabled="+m+"&haveEmailReminderEnabled="+p,dataType:"json",success:function(s){console.log(s),e(".payment-blocker-holder").addClass("hide"),"appointment"==t?e("#skip-Payment,#cancel-Payment").show():e("#skip-class-payment,#cancel-class-payment").show(),hideStatusMessage(),1==s.status?("appointment"==t?(r.handleApptEle(r),e(".confirm_appt").addClass("apptPaid"),e(".gt > .gt_act").removeClass("confirmCusDetails_tab").addClass("submitapp_tab")):(r.handleClsEle(r),e(".class_confirm_appt").addClass("clsPaid"),e("#gt_cls").removeClass("confirmCusDetails_tab").addClass("submitapp_tab")),e("#payments-info-holder").hide(),e(".gdpr_info_container.payment").hide(),BookAppointment.bookAnotherAppt(),BookAppointment.showCalBkUrl(),BookAppointment.showValidationAletMsg(lang.saved),e("#pageBlock, #loading_set, #loading_set #setmore_loading_icon").hide(),fbq("trackCustom","LDP_Purchase",{business_id:companyKey})):(e("#pageBlock, #loading_set, #loading_set #setmore_loading_icon").hide(),alert(s.message),location.reload())},error:function(){alert("Something went wrong.. Please try again")}})}}},processPaymentsSca:function(s){s.preventDefault(),s.stopPropagation(),s.stopImmediatePropagation();var t=document.getElementById("pay-now-sca");t.style.pointerEvents="",t.setAttribute("disabled",!1);var a="chargeRequestSca"==s.currentTarget.id?"appointment":"class";if(e(".agreeCancellationPolicyTerms").hide(),this.validateTotal(a)){if(e("#pageBlock").css("height",e("body").height()),e("#pageBlock, #loading_set, #loading_set #setmore_loading_icon").show(),"appointment"==a)e("#skip-Payment,#cancel-Payment").hide(),this.options=apptObj.options;else{e("#skip-class-payment,#cancel-class-payment").hide(),this.options=classApptObj.options,i=classApptObj.options.commonDetails.startDateAndTime,o=classApptObj.options.commonDetails.endDateAndTime;this.options.viewData.Name}var i,o;BookAppointment.showValidationAletMsg("Processing Payments...");var n=e("#method-id").val(),r=e("#intent-id").val();r&&(n=null);var l={};if(l.haveEmailReminderEnabled=!1,"appointment"!=a||this.options.response.isMultiService)if(1==this.options.response.isMultiService&&void 0!=this.options.response.isMultiService){isMultipleService="true",l=this.getCommonDataForStripe(a);var c=this.getViewDataForMultipleservice();l.sessionIdList=c.sessionIdList,l.amount=c.total,l.lineItemsInfo=c.allLinetItem,l.haveTextReminderEnabled=e("#sms-reminder").val().trim()}else l.isMultipleService="false";else l=this.getCommonDataForStripe(a),l.haveTextReminderEnabled=e("#sms-reminder").val().trim();"class"==a&&(l=this.getCommonDataForSquareClass(a),l.isClass=!0),l.paymentMethodId=n,l.paymentIntentId=r,l.bookedFrom="Booking Page",l.haveEmailReminderEnabled=e("#email-reminder").val().trim(),l.haveTextReminderEnabled=e("#sms-reminder").val().trim(),e(".payment-blocker-holder").removeClass("hide");var d=JSON.stringify(l);this.stripeCharge(a,d,s)}},stripeCharge:function(s,t,a){this.stopPropagation(a);var i=this;e.ajax({type:"POST",url:"/payment/stripe/"+s,contentType:"application/json",dataType:"json",data:t,success:function(a){e(".payment-blocker-holder").addClass("hide"),"appointment"==s?e("#skip-Payment,#cancel-Payment").show():e("#skip-class-payment,#cancel-class-payment").show(),hideStatusMessage();var o=JSON.parse(t);if("true"==o.isMultipleService?"true":"false",1==a.status)a.paymentStatus&&"pending"==a.paymentStatus?(clearInterval(i.timerInterval),e("html,body").animate({scrollTop:0},0),e("#pageBlock").css("height",e("body").height()),e("#pageBlock, #loading_set, #loading_set #setmore_loading_icon").show(),i.showAuthenticationWindow(a.client_secret,s,o)):("appointment"==s&&(1==i.options.response.isMultiService?i.handleMultApptEle(i):i.handleApptEle(i),e(".confirm_appt").addClass("apptPaid"),e(".gt > .gt_act").removeClass("confirmCusDetails_tab").addClass("submitapp_tab")),"class"==s&&(i.handleClsEle(i),e(".class_confirm_appt").addClass("clsPaid"),e("#gt_cls").removeClass("confirmCusDetails_tab").addClass("submitapp_tab"),e("#classes-tab").removeClass("clsLst").removeClass("clsPro").removeClass("clsDt").removeClass("signInFrm").removeClass("clsInfo").removeClass("clsPay").addClass("clsCon")),e("#payments-info-holder").hide(),e(".gdpr_info_container.payment").hide(),BookAppointment.bookAnotherAppt(),BookAppointment.showCalBkUrl(),BookAppointment.showValidationAletMsg(lang.saved));else if(a.errors){var n=a.errors[0];"INVALID_EXPIRATION"==n.code?e.alert("We're sorry, it looks like your Expiration date may have been entered incorrectly. Please check your card and try again.","Match Failure: Expiration date","Ok, let me try again"):"VERIFY_CVV_FAILURE"==n.code?e.alert("We're sorry, it looks like your CVV may have been entered incorrectly. Please check your card and try again.","Match Failure: CVV","Ok, let me try again"):"VERIFY_AVS_FAILURE"==n.code?e.alert("We're sorry, it looks like your Postal Code may have been entered incorrectly. Please check your card and try again.","Match Failure: Postal Code","Ok, let me try again"):"NOT_FOUND"==n.code||"ACCESS_TOKEN_REVOKED"==n.code||"UNAUTHORIZED"==n.code?e.alert("We're sorry, we're unable to take your payment at this time. Please contact us to complete your booking.","Please Contact Us","Okay"):"CARD_DECLINED"==n.code?e.alert("We're sorry, we're unable to take your payment at this time. Please check your card.","Card Declined","Okay"):e.alert("We're sorry, it looks like the authorization for the payment provider has expired. Please contact the administrator of this page.","Authorization Failure","Ok, let me do that")}else"amount_too_small"==a.msg?e.alert("The service cost is less than the minimum amount. Please contact"+companyDetails.companyName+" directly to book your appointment.","Amount too small to process","","<button id='close-alert' onclick='window.location.reload()'>Okay</button>"):"amount_too_large"==a.msg?e.alert("The service cost is greater than the maximum limit. Please contact"+companyDetails.companyName+" directly to book your appointment.","Amount too large to process","","<button id='close-alert'  onclick='window.location.reload()'>Okay</button>"):"card_declined"==a.msg?e.alert("The transaction was declined by the card issuer. Please try another card to complete the booking.","Card declined","Okay"):"expired_card"==a.msg?e.alert("You have provided an expired card. Please try another card to complete the transaction.","Card expired","Okay"):"invalid_number"==a.msg?e.alert("Please verify your card number and try again. If the card number is correct, please contact your card issuer or try another card to complete the booking.","Card number is invalid","Okay"):"processing_error"==a.msg?e.alert("A processing error has occurred. Please try again.","Something’s not right","Okay"):"balance_insufficient"==a.msg?e.alert("This transaction could not be processed due to insufficient balance. Please try another payment method.","Verify your balance","Okay"):"balance_insufficient"==a.msg?e.alert("The bank account linked to your card could not be verified. Please contact your bank or try another payment method.","Could not charge this account","Okay"):(alert("payment failure"),location.reload());e("#pageBlock, #loading_set, #loading_set #setmore_loading_icon").hide()},error:function(){alert("Something went wrong.. Please try again")}})},showAuthenticationWindow:function(s,t,a){var i;"appointment"==t?(e(".timer-holder").css("display","none"),i=e("#payment-timer").html().trim()):(e(".class-timer-holder").css("display","none"),i=e("#class-payment-timer").html().trim(),t="clsAppointment"),e("#show_timer").show(),e("#show_timer").addClass(t);var o=this.getRetainedSeconds(i);this.startTimer("stripe",!0,o),this.updateBufferTime(o,t,a);var n=stripePublicKey,r=Stripe(n);r.handleCardAction(s).then(function(s){if(s.error)s.error.code&&"payment_intent_authentication_failure"==s.error.code?(e(".timer-holder").css("display","none"),e("#show_timer").hide(),e(".payment-blocker-holder").addClass("hide"),setTimeout(function(){window.onbeforeunload="",alert("Your authentication failed.. Please try again"),location.reload()},100)):e.alert("It looks like the authorization for the payment provider has expired or Failed. Please try again.","Authorization Failure","Ok, let me do that");else{e("#show_timer").hide(),e(".payment-blocker-holder").addClass("hide");var a=s.paymentIntent.id;document.getElementById("intent-id").value=a,"appointment"==t?document.getElementById("chargeRequestSca").click():document.getElementById("chargeRequestClassSca").click()}})},getRetainedSeconds:function(e){var s=[];s=e.split(":");var t=s[0],a=s[1];a=parseFloat(a),a>30&&(t=parseInt(t)+1);var i=parseInt(60*t)+180;return i},updateBufferTime:function(s,t,a){var i=!1,o={},n="appointment"==t?"appointment":"class";o.lineItemsInfo=a.lineItemsInfo,o.customerKey=a.customerKey,o.appointmentKey=a.appointmentKey,o.additionalSecs=s,o.requestType=n;var r=JSON.stringify(o);return e.ajax({url:"/payment/additional/time",type:"POST",contentType:"application/json",dataType:"json",data:r,success:function(e){e.status&&(i=!0)}}),i},skipPayment:function(s){this.stopPropagation(s),document.getElementById("skip-payment-appt").style.pointerEvents="none",BookAppointment.showValidationAletMsg("Processing ...");var t="skip-payment-appt"==s.currentTarget.id?"appointment":"class",a=this.skipPaymentRequstObj(t),i=JSON.stringify(a),o=this;e("html,body").animate({scrollTop:0},0),e("#pageBlock").css("height",e("body").height()),e("#pageBlock, #loading_set, #loading_set #setmore_loading_icon").show(),e.ajax({type:"POST",url:"/skip/payment/appointment",contentType:"application/json",dataType:"json",data:i,success:function(s){1==s.status?(document.getElementById("skip-payment-appt").style.pointerEvents="",e("#pageBlock, #loading_set, #loading_set #setmore_loading_icon").hide(),e(".confirmation").show(),e(".step_tab").show(),e(".service_title").html(lang.appt_confirmed),e("#payments-info-holder").html(""),o.ClearProgessBar(),o.clearTimerAndSetView(),e("#gt_sr").removeClass("payappt_tab").addClass("submitapp_tab"),e("#services-tab").removeClass("srLst").removeClass("srPro").removeClass("srDt").removeClass("signInFrm").removeClass("srInfo").removeClass("srPay").addClass("srBkd"),BookAppointment.bookAnotherAppt(),BookAppointment.showCalBkUrl(),BookAppointment.showValidationAletMsg(lang.saved),fbq("trackCustom","LDP_Purchase",{business_id:companyKey})):(document.getElementById("skip-payment-appt").style.pointerEvents="",e("#pageBlock, #loading_set, #loading_set #setmore_loading_icon").hide(),alert(s.msg))}})},skipPaymentRequstObj:function(s){var t={};return t=this.getCommonDataForStripe(s),t.haveTextReminderEnabled=e("#email-reminder").val().trim(),t.haveEmailReminderEnabled=e("#sms-reminder").val().trim(),t},loadStripeElement:function(s){var t=stripePublicKey,a=Stripe(t),i=a.elements(),o={lineHeight:"1.35",fontSize:"0.11rem",color:"#495057",fontFamily:"Lato,Helvetica,sans-serif"},n=i.create("cardNumber",{placeholder:"Card Number",style:o});n.mount("#payment-card-number-sca");var n=i.create("cardCvc",{placeholder:"CVV",style:o});n.mount("#payment-card-cvv");var n=i.create("cardExpiry",{placeholder:"MM/YY",style:o});if(n.mount("#payment-card-mmyy"),"ClassAppointment"!=s)var r=e("#payment-card-name").val().trim();else var r=e("#class-payment-card-name").val().trim();e("#pay-now-sca").on("click",function(e){var t=document.getElementById("pay-now-sca");t.style.pointerEvents="none",t.setAttribute("disabled",!0),e.preventDefault(),e.stopPropagation(),e.stopImmediatePropagation(),a.createPaymentMethod("card",n,{billing_details:{name:r}}).then(function(e){if(e.error&&e.error.message){var t=document.getElementById("pay-now-sca");t.style.pointerEvents="",t.setAttribute("disabled",!1),alert(e.error.message)}else{console.log(e.paymentMethod.id);var a=e.paymentMethod.id;document.getElementById("method-id").value=a,"ClassAppointment"!=s?document.getElementById("chargeRequestSca").click():document.getElementById("chargeRequestClassSca").click()}})})},getcustomerName:function(){var e=this.options.commonDetails,s=e[0].customer.firstName+" "+e[0].customer.lastName;return s},getbuyerEmailAddress:function(){try{var e=this.options.commonDetails[0].customer.email;return void 0!=e||""!=e?e:""}catch(s){return""}},handleApptEle:function(s){s.confimPaymentView(),s.ClearProgessBar(),s.clearTimerAndSetView(),e("#gt_sr").removeClass("payappt_tab").addClass("submitapp_tab"),e("#services-tab").removeClass("srLst").removeClass("srPro").removeClass("srDt").removeClass("signInFrm").removeClass("srInfo").removeClass("srPay").addClass("srBkd"),e(".service_title").html(lang.appt_confirmed),e(".service-container #sc_act").hide(),e(".service-container .customer-login-form").hide(),e(".confirmation").show()},handleClsEle:function(s){e("#class-payments-info-holder").hide(),s.classConfimPaymentView(),s.classClearProgessBar(),s.classClearTimerAndSetView(),s.sendClassConfirmationMail(),e("#gt_cls").removeClass("payappt_tab").addClass("submitapp_tab"),e("#classes-tab").removeClass("clsLst").removeClass("clsPro").removeClass("clsDt").removeClass("signInFrm").removeClass("clsInfo").removeClass("clsPay").addClass("clsBkd"),e(".class_title").html(lang.appt_confirmed),e(".classes-container #sc_act").hide(),e(".classes-container .customer-login-form").hide(),e(".class_confirmation").show(),e(".class_title").html(BookAppointment.clsName+" "+lang.confirmed)},handleMultApptEle:function(s){s.confimPaymentViewForMult(),s.ClearProgessBar(),s.clearTimerAndSetView(),e("#gt_sr").removeClass("payappt_tab").addClass("submitapp_tab"),e("#services-tab").removeClass("srLst").removeClass("srPro").removeClass("srDt").removeClass("signInFrm").removeClass("srInfo").removeClass("srPay").addClass("srBkd"),e(".service_title").html(lang.appt_confirmed),e(".service-container #sc_act").hide(),e(".service-container .customer-login-form").hide(),e(".confirmation").show()},getPaymentCurrency:function(){var e="";try{e=currencyMap[currency].stripeCurrencyCode?currencyMap[currency].stripeCurrencyCode:currency}catch(s){e=currency}return e},confimPaymentView:function(){var s=apptObj.options.response.paymentType,t=apptObj.getViewDataByPaymentType(s);e("#confirm_ul > li.payment-confirm-info").hasClass("payment-detail-label-card")&&e("#confirm_ul > li > label").remove("payment-confirm-info"),e("#confirm_ul").append(_.template(e("#payment-confirm-info").html(),t))},confimPaymentViewForMult:function(){var s=(apptObj.options.response.paymentType,apptObj.getViewDataForMultipleservice());e("#confirm_ul > li.payment-confirm-info").hasClass("payment-detail-label-card")&&e("#confirm_ul > li > label").remove("payment-confirm-info"),e("#confirm_ul").append(_.template(e("#payment-confirm-info").html(),s))},classConfimPaymentView:function(){var s=classApptObj.options.response.paymentType,t=classApptObj.getViewDataByPaymentType(s);e("#class_confirm_ul > li.payment-confirm-info").hasClass("payment-detail-label-card")&&e("#class_confirm_ul > li > label").remove("payment-confirm-info"),e("#class_confirm_ul").append(_.template(e("#payment-confirm-info").html(),t))},clearTimerAndSetView:function(){e(".timer-holder").css("display","none"),e(".timer-holder > b").html(""),window.clearInterval(apptObj.timerInterval),window.onbeforeunload=""},classClearTimerAndSetView:function(){e(".class-timer-holder").css("display","none"),e(".class-timer-holder > b").html(""),window.clearInterval(classApptObj.timerInterval),window.onbeforeunload=""},sendConfirmationMail:function(){e.ajax({type:"POST",url:"/sendMailOnAppointmentSuccess.do",dataType:"json",data:"jsonEmailDetails="+urlencode(JSON.stringify(apptObj.options.response)),success:function(e){}}),BookAppointment.gAnalytics(apptObj.options.response,"Appointments",!0)},sendClassConfirmationMail:function(){e.ajax({type:"POST",url:"/sendClsConfirmationEmail.do",dataType:"json",data:"classApptJSON="+urlencode(JSON.stringify(classApptObj.options.commonDetails)),success:function(e){}}),BookAppointment.gAnalytics("","Classes",!0)},showConfirmBox:function(s){if(this.stopPropagation(s),1==this.options.response.isMultiService)return void this.showMulSerConfirmBox(s);var t=this;e("html,body").animate({scrollTop:0},0),e("#pageBlock").css("height",e("body").height()),e("#pageBlock, #loading_set, #loading_set #setmore_loading_icon").show();var a=!1,i=e("#email-reminder").val().trim();e.ajax({type:"POST",url:apptObj.options.response.skipUrl,data:"haveTextReminderEnabled="+a+"&haveEmailReminderEnabled="+i,success:function(s){"true"==s?(e("#pageBlock, #loading_set, #loading_set #setmore_loading_icon").hide(),e(".confirmation").show(),e(".service_title").html(lang.appt_confirmed),e("#payments-info-holder").html(""),t.ClearProgessBar(),t.clearTimerAndSetView(),t.sendConfirmationMail(),e("#gt_sr").removeClass("payappt_tab").addClass("submitapp_tab"),e("#services-tab").removeClass("srLst").removeClass("srPro").removeClass("srDt").removeClass("signInFrm").removeClass("srInfo").removeClass("srPay").addClass("srBkd"),BookAppointment.bookAnotherAppt(),BookAppointment.showCalBkUrl(),BookAppointment.showValidationAletMsg(lang.saved),fbq("trackCustom","LDP_Purchase",{business_id:companyKey})):(e("#pageBlock, #loading_set, #loading_set #setmore_loading_icon").hide(),alert("cant skip"))}})},showMulSerConfirmBox:function(s){this.stopPropagation(s);var t=this;e("html,body").animate({scrollTop:0},200),e("#pageBlock").css("height",e("body").height()),e("#pageBlock, #loading_set, #loading_set #setmore_loading_icon").show();var a=apptObj.options.response.multipleServiceData,i=apptObj.options.response.companyKey,o="Appointment",n=0,r={};r=this.getReminderValue();for(var l=r.haveTextReminderEnabled,c=r.haveEmailReminderEnabled,d=0;d<a.length;d++)e.ajax({async:!1,type:"POST",url:/skippayment/+i+"/"+apptObj.options.response.multipleServiceData[n].appointmentKey+"/"+apptObj.options.response.multipleServiceData[n].SessionKey+"/"+o,data:"haveTextReminderEnabled="+l+"&haveEmailReminderEnabled="+c,success:function(s){if("true"==s){if(n==a.length-1){e(".confirmation").show(),e(".service_title").html(lang.appt_confirmed),e("#payments-info-holder").html(""),t.ClearProgessBar(),t.clearTimerAndSetView();for(var o=0;o<t.options.response.multipleServiceData.length;o++)t.options.response.appointmentKey=t.options.response.multipleServiceData[o].appointmentKey,t.sendConfirmationMail(),fbq("trackCustom","LDP_Purchase",{business_id:i});e("#gt_sr").removeClass("payappt_tab").addClass("submitapp_tab"),e("#services-tab").removeClass("srLst").removeClass("srPro").removeClass("srDt").removeClass("signInFrm").removeClass("srInfo").removeClass("srPay").addClass("srBkd"),e(".gdpr_info_container.payment").hide(),BookAppointment.bookAnotherAppt(),BookAppointment.showCalBkUrl(),BookAppointment.showValidationAletMsg(lang.saved),e("#pageBlock, #loading_set, #loading_set #setmore_loading_icon").hide()}}else e("#pageBlock, #loading_set, #loading_set #setmore_loading_icon").hide(),alert("cant skip");n++}})},showClassConfirmBox:function(s){this.stopPropagation(s);var t=this;e("html,body").animate({scrollTop:0},0),e("#pageBlock").css("height",e("body").height()),e("#pageBlock, #loading_set, #loading_set #setmore_loading_icon").show();var a=e("#sms-reminder").val().trim(),i=e("#email-reminder").val().trim();e.ajax({type:"POST",url:classApptObj.options.response.skipUrl,data:"haveTextReminderEnabled="+a+"&haveEmailReminderEnabled="+i,success:function(s){"true"==s?(e(".class_confirmation").show(),e(".class_title").html(BookAppointment.clsName+" "+lang.confirmed),e("#class-payments-info-holder").html(""),t.classClearProgessBar(),t.classClearTimerAndSetView(),t.sendClassConfirmationMail(),e("#gt_cls").removeClass("payappt_tab").addClass("submitapp_tab"),e("#classes-tab").removeClass("clsLst").removeClass("clsPro").removeClass("clsDt").removeClass("signInFrm").removeClass("clsInfo").removeClass("clsPay").addClass("clsCon"),e(".gdpr_info_container.payment").hide(),BookAppointment.bookAnotherAppt(),BookAppointment.showCalBkUrl(),BookAppointment.showValidationAletMsg(lang.saved),e("#pageBlock, #loading_set, #loading_set #setmore_loading_icon").hide()):(e("#pageBlock, #loading_set, #loading_set #setmore_loading_icon").hide(),alert("cant skip"))}})},ClearProgessBar:function(){e(".step_tab > ul").hide(),e("#progress-icon").hide(),e("#service-back").addClass("hide"),e("#progressStatus").animate({width:"100%"},100).css("overflow","visible")},classClearProgessBar:function(){e(".class_step_tab > ul").hide(),e("#class_progress-icon").hide(),e("#class-back").addClass("hide"),e("#class_progressStatus").animate({width:"100%"},100).css("overflow","visible")},validateTotal:function(e){var s;return"square"==gateWayType?(s="class"==e?this.getCommonDataForSquareClass(e):this.getCommonDataForSquare(e),1==this.options.response.isMultiService&&(s.amount=this.getMultipleServiceItemsListAndTotal().total)):s="class"==e?this.getCommonDataForSquareClass(e):this.getCommonDataForStripe(e),this.validTotal(s.amount,gateWayType)},validTotal:function(e,s){var t=!0;return e<.5?(alert("Cannot Process Payment Amount is less than 0.5"),t=!1):e>999999.99?(alert("Cannot Process Payment Amount is greater than 999999.99"),t=!1):"square"==s&&e<1&&(alert("Cannot Process Payment Amount is less than 1.0"),t=!1),t},validateCardDetails:function(s){var t,a,i,o,n="class"==s?"class-":"",r=!0;if(t=e("#"+n+"payment-card-name").val().trim(),a=e("#"+n+"payment-card-number").val().split(" ").join(""),o=e("#"+n+"payment-card-mmyy").val().trim(),i=e("#"+n+"payment-card-cvv").val().trim(),t.length<=0)r=!1,e("#"+n+"payment-card-name-holder").addClass("error-focus"),BookAppointment.showValidationAletMsg("Please Enter Valid Payee Name");else if(a.length<12)BookAppointment.showValidationAletMsg("Please Enter Valid Card Number"),e("#"+n+"payment-card-det-holder").addClass("error-focus"),r=!1;else if(o.length<7&&i.length<3)BookAppointment.showValidationAletMsg("Please Enter Valid Exp Month and Year"),e("#"+n+"payment-card-det-holder").addClass("error-focus"),r=!1;else if(o.length<7)BookAppointment.showValidationAletMsg("Please Enter Valid Exp Date"),e("#"+n+"payment-card-det-holder").addClass("error-focus"),r=!1;else if(i.length<3)BookAppointment.showValidationAletMsg("Please Enter Valid CVV"),e("#"+n+"payment-card-det-holder").addClass("error-focus"),r=!1;else if(7==o.length||o.length>7){var l=o.split("/");if(l.length>1){var c,d;c=e.trim(l[0]),d=e.trim(l[1]),(c>13||0==c.length)&&(BookAppointment.showValidationAletMsg("Please Enter Valid Exp Month and Year"),e("#"+n+"payment-card-det-holder").addClass("error-focus"),r=!1);var m=new Date(clientDate);7==o.length&&(d="20"+d),(d<m.getFullYear()||0==d.length)&&(BookAppointment.showValidationAletMsg("Please Enter Valid Exp Month and Year"),e("#"+n+"payment-card-det-holder").addClass("error-focus"),r=!1)}else BookAppointment.showValidationAletMsg("Please Enter Valid Exp Date"),r=!1}else BookAppointment.showValidationAletMsg("Please Enter  CVV"),e("#"+n+"payment-card-det-holder").addClass("error-focus"),r=!1;return r},startTimer:function(s,t,a){var i=e("Appointment"==type?"#payment-timer":"#class-payment-timer");i.html("");var o;if(t){var n=a/60;o=60*n*1e3}else o=60*PAYMENT_TIMER*1e3;var r,l,c=this,d=new Date,m=d.getTime()+6e4*d.getTimezoneOffset();m+=o,this.bindKeyEscape(),this.timerInterval=setInterval(function(){var t=new Date,a=t.getTime()+6e4*t.getTimezoneOffset(),o=m-a;if(r<=1&&l<=0||o<=0){if(clearInterval(c.timerInterval),e("#payment-timer").is(":visible"))"paypal"!=s&&(console.log("should not come to this"),"00:01"!=e("#payment-timer").html()&&"00:00"!=e("#payment-timer").html()||c.deleteAppointment());else if(e("#class-payment-timer").is(":visible"))"paypal"!=s&&("00:01"!=e("#class-payment-timer").html()&&"00:00"!=e("#class-payment-timer").html()||c.deleteClassSession());else if(e("#timer_proccessing_payment").is(":visible")&&"paypal"!=s&&("00:01"==e("#timer_proccessing_payment").html()||"00:00"==e("#timer_proccessing_payment").html())){var n=e("#show_timer").attr("class"),d=n.split(" ");"appointment"==d[1]?c.deleteAppointment():"clsAppointment"==d[1]&&c.deleteClassSession()}setTimeout(function(){window.onbeforeunload="",alert("We're sorry, your session has timed out. Please re-book your appointment and submit payment again to confirm your time slot!"),"paypal"==s&&window.newwindow&&window.newwindow.close(),location.reload()},1e3)}r=Math.floor(o/1e3),l=Math.floor(r/60),l%=60,r%=60,r>=0&&l>=0&&(i.html(c.zeroPad(l,2)+":"+c.zeroPad(r,2)),"stripe"!=s&&"paypal"!=s||e("#timer_proccessing_payment").html(c.zeroPad(l,2)+":"+c.zeroPad(r,2)))},1e3)},removeErrorFocus:function(){e("#payment-card-det-holder,#payment-card-name-holder").removeClass("error-focus")},stopPropagation:function(e){e.preventDefault(),e.stopPropagation(),e.stopImmediatePropagation()},bindKeyEscape:function(s){var t=this;e(window).bind("keyup",function(e){27==e.keyCode&&t.stopPropagation(e)})},zeroPad:function(e,s){var t=s-e.toString().length+1;return Array(+(t>0&&t)).join("0")+e},validateTotalForMul:function(e){var s=this.getTransactionInfoMul(e,scaEnabled),t=!0;return s.amount<.5?(alert("Cannot Process Payment Amount is less than 0.5"),t=!1):s.amount>999999.99?(alert("Cannot Process Payment Amount is greater than 999999.99"),t=!1):"square"==gateWayType&&s.amount<1&&(alert("Cannot Process Payment Amount is less than 1.0"),t=!1),t},getTransactionInfoMul:function(s,t){var a="class"==s?"class-":"",i=(this.options.response.paymentType,this.getViewDataForMultipleservice()),o=e("#"+a+"payment-card-mmyy").val().split("/"),n={};return t?(n.amount=i.total,n.lineItems=i.allLinetItem,n.sessionIdList=i.sessionIdList):(n.name=htmlEscape(e("#"+a+"payment-card-name").val().trim()),n.accountNo=e("#"+a+"payment-card-number").val().split(" ").join(""),n.cvv=e("#"+a+"payment-card-cvv").val().trim(),
n.exp_month=e.trim(o[0]),n.exp_year=e.trim(o[1]),n.amount=i.total,n.lineItems=i.allLinetItem,n.sessionIdList=i.sessionIdList),n}})}(jQuery);var map=function(){var e={aboutus:{wrapper:"map_wrapper_aboutus",component:"comp_map_aboutus"},sidebar:{wrapper:"map_wrapper_sidebar",component:"comp_map_sidebar"}},s=function(){var e={_baseEndpoint:"https://maps.googleapis.com/maps/api/staticmap?",constructMarker:function(e){var s=e.reduce(function(e,s){return e.push("color:"+s.color+"|label:"+s.label+"|"+s.coordinates),e},[]);return s.join("&markers")},getKey:function(){return MAPS_KEY[APP_MODE.toUpperCase()]?MAPS_KEY[APP_MODE.toUpperCase()]:MAPS_KEY.DEFAULT},validateParams:function(e){var s=$("#"+e.wrapperDOM);return!e.marker||e.marker.length<=0?(console.warn("Atleast one marker should be provided"),!1):!e.wrapperDOM||$(s).length<=0?(console.warn("no wrapper or invalid wrapper supplied"),!1):e.marker.reduce(function(e,s){return e&&Boolean(s.coordinates)},!0)},constructHrefWithAddress:function(e){var s="https://www.google.com/maps/search/?api=1";if(e.address){var t=e.address.split(",").filter(Boolean).map(function(e){return e.trim()}).join("+");return s.concat("&query=").concat(encodeURIComponent(t)).concat("&query=").concat(e.marker[0].coordinates)}console.info("address not found on the account")}},s=function(s){var t=$("#"+s.wrapperDOM),a=e.constructMarker(s.marker),i=e.getKey(),o=s.zoom?s.zoom:15,n=s.center?s.center:s.marker[0].coordinates,r={size:parseInt(t.width())+"x"+parseInt(t.height()),mapType:"roadmap",markers:a,key:i,scale:2,zoom:o,center:n};return encodeURI(e._baseEndpoint+"size="+r.size+"&scale="+r.scale+"&maptype="+r.mapType+"&markers="+r.markers+"&zoom="+r.zoom+"&center="+r.center+"&key="+r.key)},t=function(t,a){try{if(!e.validateParams(t))return console.log("Invalid params supplied . "+t),a(!1),!1;var i=$("#"+t.wrapperDOM+" .static_map"),o=$(i).find("img"),n=$("#"+t.wrapperDOM),r=s(t);return r?($(i).attr("href",e.constructHrefWithAddress(t)),$(i).attr("target","_blank"),o.attr("src",r),o.attr("width",n.width()),o.attr("height",n.height()),a(!0),!0):(console.log("Cannot render map."),a(!1),!1)}catch(l){return a(!1),console.warn("could not render map. "+l.stack),!1}};return{endPoint:s,renderMap:t}}(),t=function(e){var s=e.address&&"null"!=e.address?e.address:"",t=e.city&&"null"!=e.city?e.city:"",a=e.state&&"null"!=e.state?e.state:"",i=e.zip&&"null"!=e.zip?e.zip:"";return htmlDecode(s)+", "+htmlDecode(t)+", "+htmlDecode(a)+","+htmlDecode(i)},a={sidebar:function(s){s?$("#"+e.sidebar.wrapper).show():$("#"+e.sidebar.wrapper).hide()},aboutus:function(s){s?$("#"+e.aboutus.wrapper).show():$("#"+e.aboutus.wrapper).hide()}},i=function(t,i){t&&t.toLowerCase().indexOf("aboutus")!=-1?(o(),i.wrapperDOM=e.aboutus.component,s.renderMap(i,a.aboutus)):(i.wrapperDOM=e.sidebar.component,s.renderMap(i,a.sidebar))},o=function(){var e='<ul><li><div id="map_wrapper_aboutus"><div id="comp_map_aboutus"><a class = "static_map"><img src = "#"></a></div><div id="mapinfowindow1"style="display:none" ><b>#name</b><br>#description</div></div></li></ul>';$(".about_map_addr_businesshours").html(e)},n=function(){if(!customerInfo.mapCoordinates)return $("#"+e.sidebar.wrapper).hide(),$("#"+e.aboutus.wrapper).hide(),console.log("no coordinate found. "),!1;var s=/Android|webOS|iPhone|iPad|iPod|BlackBerry|BB|PlayBook|IEMobile|Windows Phone|Kindle|Silk|Opera Mini|Mobile/i.test(navigator.userAgent),a={marker:[{color:"red",label:"",coordinates:customerInfo.mapCoordinates}],wrapperDOM:e.sidebar.component,address:t(window.companyDetails),zoom:15,center:customerInfo.mapCoordinates};s||i("",a),window.location.pathname.contains("aboutus")&&(customerInfo.aboutCompany&&customerInfo.aboutCompany.value||i("aboutus",a))};return{staticMaps:s,callMap:n}}(),bookingPageInstagram=function(){var e=null,s={fetchAndDoCallbackForInstagramImgs:function(t,i){var o=t.clientHashTag?htmlDecode(t.clientHashTag):"";if(o=o.contains("#")?o.replace(/#/g,""):o,o=o.split(",").filter(Boolean),!Array.isArray(o)||o.length<=0)return console.warn("The hashtag is illegal "+o),i([]),!1;if(!t||_.isEmpty(t)||!t.clientAccessToken)return console.warn("No access token or userid found for instagram "+t),i([]),!1;try{var n=JSON.parse(window.localStorage.getItem("igData")),r=new Date;if((!n||APP_VERSION!=n.APP_VERSION||r.getTime()>=n.expirationTime||JSON.stringify(n.userTags)!=JSON.stringify(t.clientHashTag)||n.accessToken!=t.clientAccessToken||n.userId!=t.clientUserId)&&(console.warn("resetting ig data"),n=this.resetInstagramData(t)),!n.hasNext){var l=n.data.map(function(e){return e.media_url});return i(l),!0}var c=n.next_url;this.makeRequestToInstagramAPI(c).done(function(e){var t=s.filterIGDataByUserHashTags(o,e.data);t=t.filter(function(e){return!e.type||"image"==e.type.toLowerCase()});var a=JSON.parse(window.localStorage.getItem("igData")),n=a.data.map(function(e){return e.id});t.forEach(function(e){(n.length<=0||n.indexOf(e.id)==-1)&&a.data.push(e)}),$.isEmptyObject(e.pagination)||!e.pagination.next_url?(a.hasNext=!1,a.next_url=null):(a.hasNext=!0,a.next_url=e.pagination.next_url),window.localStorage.setItem("igData",JSON.stringify(a));var r=a.data.map(function(e){return e.media_url});i(r)}).fail(function(t,a,o){console.error("text status: "+t.responseJSON+" error: "+a+","+o),s.resetInstagramData(e),i([])})}catch(d){return console.error("could not fetch ig images. -> "+d.name+"::"+d.message+"::"+d.stack),$(".photoGallery").show(),$("#photos_loading_icon").addClass("display_none"),a(),i([]),!1}},resetInstagramData:function(e){var s=240,t=new Date;t.setMinutes(t.getMinutes()+s);var a={userId:"",accessToken:"",userTags:[],hasNext:!0,data:[],expirationTime:t.getTime(),next_url:"",APP_VERSION:APP_VERSION};if(e&&e.clientAccessToken){var i="/photos/instagram?companykey="+window.companyKey+"&next=";a.userId=e.clientUserId,a.accessToken=e.clientAccessToken,a.userTags=e.clientHashTag,a.next_url=i}var o=JSON.stringify(a);return window.localStorage.setItem("igData",o),JSON.parse(window.localStorage.getItem("igData"))},makeRequestToInstagramAPI:function(e){return $.ajax({type:"GET",dataType:"json",cache:!0,url:e}).always(function(){$(".photoGallery").show(),$("#photos_loading_icon").addClass("display_none")})},filterIGDataByUserHashTags:function(e,s){var t=[];return e&&Array.isArray(e)?(e=e.map(function(e){return e.toLowerCase()}),s.reduce(function(s,t){var a=t.tags.map(function(e){return e.toLowerCase()}).filter(function(s){return e.indexOf(s)>-1});return a.length&&s.push(t),s},t),t):t},displayImages:function(e){if(!e||!Array.isArray(e)||e.length<=0)return void $(".photoGallery").html('<div class="noPhotos"><h3>'+window.lang.no_photos+"</h3></div>");$("#photos_act").scrollTop();$(".photoGallery").hide(),$("#photos_loading_icon").removeClass("display_none");var s=e.slice($("#photos_act li").length);s.forEach(function(e){if(e){var s="<li><a href="+e+"><img src='"+e+"'></img></a></li>";$(".photoGallery").append(s)}}),$(".photoGallery").show(),$("#photos_loading_icon").addClass("display_none"),$(".photoGallery").magnificPopup({delegate:"a",type:"image",tLoading:"Loading image ...",mainClass:"mfp-img-mobile",gallery:{enabled:!0,navigateByImgClick:!0,preload:[0,1]},image:{tError:'<a href="%url%">The image #%curr%</a> could not be loaded.',titleSrc:function(e){return e.el.attr("title")}}})},getInstagramDetails:function(s,t){if(!Boolean(window.customerInfo.enableInstagram)){var a={reason:"instagram is not enabled on the account"};return t(a),!1}null==e||$.isEmptyObject(e)?$.ajax({type:"GET",url:"/getInstagramInfo?key="+window.companyKey,async:!0,cache:!0,dataType:"json"}).done(function(a){a&&!$.isEmptyObject(a)?(e=a,s(e)):t(a)}).fail(function(e){console.warn("failed to fetch instagram user details. "),t(e)}):s(e)},registerOnScroll:function(){var e=this;$("#photos_act").off("scrolledToBottom").on("scrolledToBottom",function(t){t.preventDefault(),t.stopPropagation();var a=JSON.parse(localStorage.getItem("igData"));a&&!a.hasNext&&$("#photos_act li").length==a.data.length||$(".pto").hasClass("active")&&(console.log("Asking instagram for more pictures..."),e.getInstagramDetails(function(t){e.fetchAndDoCallbackForInstagramImgs(t,s.displayImages)},function(){e.displayImages([])}))})}},t=function(){s.getInstagramDetails(function(e){s.fetchAndDoCallbackForInstagramImgs(e,s.displayImages),s.registerOnScroll()},function(){s.displayImages([])})},a=function(){e=null,window.localStorage.removeItem("igData")};return{render:t,__private__:{flushCachedData:a}}}(),formatPhoneNumber=function(e,s,t,a){if(isNullOrEmpty(t))o="";else if(3===t.length)var i=isNullOrEmpty(t)?isNullOrEmpty(app.CompanyModel.get("Country"))?countryObject.getIntlCountryData(countryInitial.toLowerCase(),!0,!0,"iso2").iso3:app.CompanyModel.get("Country"):t,o=countryObject.getIntlCountryData(i.toLowerCase(),!0,!0,"iso3").iso2;else o=t;if(isNullOrEmpty(o)&&(s=e+s),"undefined"==typeof intlTelHelper&&(window.intlTelHelper=intlTelInputUtils),intlTelHelper){var n=intlTelHelper.numberFormat;switch(a=a&&!isNullOrEmpty(a)?a:"national",a.toLowerCase()){case"national":a=n.NATIONAL;break;case"international":a=n.INTERNATIONAL;break;case"e164":o="",s=e+s,a=n.E164;break;default:a=n.NATIONAL}s=intlTelHelper.formatNumber(s,o,a)}if("in"==o.toLowerCase()||e.contains("91"))for(;"0"===s.charAt(0);)s=s.substr(1);return s.contains(e)&&(s=s.replace(e,""),s=s.trim()),s};
